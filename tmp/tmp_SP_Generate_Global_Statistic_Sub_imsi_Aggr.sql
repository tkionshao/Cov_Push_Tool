CREATE DEFINER=`covmo`@`%` PROCEDURE `SP_Generate_Global_Statistic_Sub_imsi_Aggr`(IN TECH_MASK TINYINT(2),IN  WORKER_ID VARCHAR(10),IN FLAG TINYINT(2),IN exDate VARCHAR(10),PENDING_FLAG TINYINT(2),IN IMSI_CELL TINYINT(2))
BEGIN
	DECLARE SP_Process VARCHAR(100) DEFAULT NULL;
	DECLARE START_TIME DATETIME DEFAULT SYSDATE();
	DECLARE STEP_START_TIME DATETIME DEFAULT SYSDATE();
	DECLARE KPI_ERROR CONDITION FOR SQLSTATE '99999' ;
	DECLARE v_DATA_DATE VARCHAR(10) DEFAULT NULL;
	DECLARE v_DATA_HOUR TINYINT(2) DEFAULT NULL;
	DECLARE v_PU_ID MEDIUMINT(9) DEFAULT NULL;
	DECLARE v_TECH_MASK TINYINT(2) DEFAULT NULL;
	DECLARE SUB_WORKER_ID VARCHAR(10) DEFAULT CONNECTION_ID();
	DECLARE v_group_db_name VARCHAR(100) DEFAULT '';
	
	DECLARE SHARE_IP VARCHAR(100) DEFAULT NULL;
	DECLARE SHARE_PORT VARCHAR(10) DEFAULT NULL;
	DECLARE SHARE_ACCOUNT VARCHAR(100) DEFAULT NULL;
	DECLARE SHARE_PW VARCHAR(100) DEFAULT NULL;
	DECLARE SHARE_DB VARCHAR(100) DEFAULT NULL;
	
	DECLARE UMTS_IMSI_COLUMN_STR VARCHAR(2500) DEFAULT 
		'CALL_CNT,
		VOICE_MO_CNT,
		VOICE_MT_CNT,
		VIDEO_MO_CNT,
		VIDEO_MT_CNT,
		R99_MO_CNT,
		R99_MT_CNT,
		HSPA_MO_CNT,
		HSPA_MT_CNT,
		MRAB_MO_CNT,
		MRAB_MT_CNT,
		SIGNAL_MO_CNT,
		SIGNAL_MT_CNT,
		SMS_MO_CNT,
		SMS_MT_CNT,
		PS_OTHER_CNT,
		CALL_DUR_SUM,
		VOICE_DUR_SUM,
		VIDEO_DUR_SUM,
		R99_DUR_SUM,
		HSPA_DUR_SUM,
		MRAB_DUR_SUM,
		DROP_CNT,
		DROP_VOICE_CNT,
		DROP_VEDIO_CNT,
		DROP_R99_CNT,
		DROP_HSPA_CNT,
		DROP_MRAB_CNT,
		DROP_SMS_CNT,
		DROP_SIGNAL_CNT,
		DROP_PS_OTHER_CNT,
		DROP_RF_CNT,
		DROP_CONG_CNT,
		DROP_TRANS_CNT,
		DROP_SHO_CNT,
		DROP_HHO_CNT,
		DROP_IRAT_CNT,
		BLOCK_CNT,
		BLOCK_VOICE_CNT,
		BLOCK_VEDIO_CNT,
		BLOCK_R99_CNT,
		BLOCK_HSPA_CNT,
		BLOCK_MRAB_CNT,
		BLOCK_SMS_CNT,
		BLOCK_SMS_MT_CNT,
		BLOCK_SMS_MO_CNT,
		BLOCK_SIGNAL_CNT,
		BLOCK_PS_OTHER_CNT,
		SHO_ATTEMPT_CNT,
		SHO_FAILURE_CNT,
		HHO_ATTEMPT_CNT,
		HHO_FAILURE_CNT,
		IRAT_ATTEMPT_CNT,
		IRAT_FAILURE_CNT,
		MOVING_CALL_CNT,
		INDOOR_CALL_CNT,
		PS_UL_VOLUME_SUM,
		PS_DL_VOLUME_SUM,
		PS_UL_SPEED_MAX,
		PS_DL_SPEED_MAX,
		FIRST_RSCP_SUM,
		FIRST_RSCP_CNT,
		FIRST_ECNO_SUM,
		FIRST_ECNO_CNT,
		CALL_SETUP_TIME_SUM,
		CALL_SETUP_TIME_CNT,
		CALL_SETUP_TIME_VOICE_SUM,
		CALL_SETUP_TIME_VOICE_CNT,
		CALL_SETUP_TIME_VEDIO_SUM,
		CALL_SETUP_TIME_VEDIO_CNT,
		CALL_SETUP_TIME_R99_SUM,
		CALL_SETUP_TIME_R99_CNT,
		CALL_SETUP_TIME_HSPA_SUM,
		CALL_SETUP_TIME_HSPA_CNT,
		CALL_SETUP_TIME_MRAB_SUM,
		CALL_SETUP_TIME_MRAB_CNT,
		CALL_SETUP_TIME_SIG_SUM,
		CALL_SETUP_TIME_SIG_CNT,
		CALL_SETUP_TIME_OTH_SUM,
		CALL_SETUP_TIME_OTH_CNT,
		CALL_SETUP_TIME_SMS_SUM,
		CALL_SETUP_TIME_SMS_CNT,
		SF_CNT,
		SF_VOICE_CNT,
		SF_VEDIO_CNT,
		SF_R99_CNT,
		SF_HSPA_CNT,
		SF_MRAB_CNT,
		SF_SMS_CNT,
		SF_SMS_MT_CNT,
		SF_SMS_MO_CNT,
		SF_SIGNAL_CNT,
		SF_PS_OTHER_CNT,
		PDP_ACTIVATION_REQUEST,
		PDP_ACTIVATION_ACCEPT,
		PDP_DEACTIVATION_REQUEST,
		PDP_DEACTIVATION_ACCEPT,
		AUTH_REQUEST,
		AUTH_RESPONSE,
		AUTH_CIPH_REQUEST,
		AUTH_CIPH_RESPONSE,
		SECURITY_MODE_ATT,
		SECURITY_MODE_SUCCESS,
		LU_REQUEST,
		LU_ACCEPT,
		RAU_REQUEST,
		RAU_ACCEPT';
		  
	DECLARE UMTS_IMSI_IFNULL_STR VARCHAR(6000) DEFAULT 
		'IFNULL(CALL_CNT,0) AS CALL_CNT,
		IFNULL(VOICE_MO_CNT,0) AS VOICE_MO_CNT,
		IFNULL(VOICE_MT_CNT,0) AS VOICE_MT_CNT,
		IFNULL(VIDEO_MO_CNT,0) AS VIDEO_MO_CNT,
		IFNULL(VIDEO_MT_CNT,0) AS VIDEO_MT_CNT,
		IFNULL(R99_MO_CNT,0) AS R99_MO_CNT,
		IFNULL(R99_MT_CNT,0) AS R99_MT_CNT,
		IFNULL(HSPA_MO_CNT,0) AS HSPA_MO_CNT,
		IFNULL(HSPA_MT_CNT,0) AS HSPA_MT_CNT,
		IFNULL(MRAB_MO_CNT,0) AS MRAB_MO_CNT,
		IFNULL(MRAB_MT_CNT,0) AS MRAB_MT_CNT,
		IFNULL(SIGNAL_MO_CNT,0) AS SIGNAL_MO_CNT,
		IFNULL(SIGNAL_MT_CNT,0) AS SIGNAL_MT_CNT,
		IFNULL(SMS_MO_CNT,0) AS SMS_MO_CNT,
		IFNULL(SMS_MT_CNT,0) AS SMS_MT_CNT,
		IFNULL(PS_OTHER_CNT,0) AS PS_OTHER_CNT,
		IFNULL(CALL_DUR_SUM,0) AS CALL_DUR_SUM,
		IFNULL(VOICE_DUR_SUM,0) AS VOICE_DUR_SUM,
		IFNULL(VIDEO_DUR_SUM,0) AS VIDEO_DUR_SUM,
		IFNULL(R99_DUR_SUM,0) AS R99_DUR_SUM,
		IFNULL(HSPA_DUR_SUM,0) AS HSPA_DUR_SUM,
		IFNULL(MRAB_DUR_SUM,0) AS MRAB_DUR_SUM,
		IFNULL(DROP_CNT,0) AS DROP_CNT,
		IFNULL(DROP_VOICE_CNT,0) AS DROP_VOICE_CNT,
		IFNULL(DROP_VEDIO_CNT,0) AS DROP_VEDIO_CNT,
		IFNULL(DROP_R99_CNT,0) AS DROP_R99_CNT,
		IFNULL(DROP_HSPA_CNT,0) AS DROP_HSPA_CNT,
		IFNULL(DROP_MRAB_CNT,0) AS DROP_MRAB_CNT,
		IFNULL(DROP_SMS_CNT,0) AS DROP_SMS_CNT,
		IFNULL(DROP_SIGNAL_CNT,0) AS DROP_SIGNAL_CNT,
		IFNULL(DROP_PS_OTHER_CNT,0) AS DROP_PS_OTHER_CNT,
		IFNULL(DROP_RF_CNT,0) AS DROP_RF_CNT,
		IFNULL(DROP_CONG_CNT,0) AS DROP_CONG_CNT,
		IFNULL(DROP_TRANS_CNT,0) AS DROP_TRANS_CNT,
		IFNULL(DROP_SHO_CNT,0) AS DROP_SHO_CNT,
		IFNULL(DROP_HHO_CNT,0) AS DROP_HHO_CNT,
		IFNULL(DROP_IRAT_CNT,0) AS DROP_IRAT_CNT,
		IFNULL(BLOCK_CNT,0) AS BLOCK_CNT,
		IFNULL(BLOCK_VOICE_CNT,0) AS BLOCK_VOICE_CNT,
		IFNULL(BLOCK_VEDIO_CNT,0) AS BLOCK_VEDIO_CNT,
		IFNULL(BLOCK_R99_CNT,0) AS BLOCK_R99_CNT,
		IFNULL(BLOCK_HSPA_CNT,0) AS BLOCK_HSPA_CNT,
		IFNULL(BLOCK_MRAB_CNT,0) AS BLOCK_MRAB_CNT,
		IFNULL(BLOCK_SMS_CNT,0) AS BLOCK_SMS_CNT,
	
		IFNULL(BLOCK_SMS_MT_CNT,0) AS BLOCK_SMS_MT_CNT,
		IFNULL(BLOCK_SMS_MO_CNT,0) AS BLOCK_SMS_MO_CNT,
	
		IFNULL(BLOCK_SIGNAL_CNT,0) AS BLOCK_SIGNAL_CNT,
		IFNULL(BLOCK_PS_OTHER_CNT,0) AS BLOCK_PS_OTHER_CNT,
		IFNULL(SHO_ATTEMPT_CNT,0) AS SHO_ATTEMPT_CNT,
		IFNULL(SHO_FAILURE_CNT,0) AS SHO_FAILURE_CNT,
		IFNULL(HHO_ATTEMPT_CNT,0) AS HHO_ATTEMPT_CNT,
		IFNULL(HHO_FAILURE_CNT,0) AS HHO_FAILURE_CNT,
		IFNULL(IRAT_ATTEMPT_CNT,0) AS IRAT_ATTEMPT_CNT,
		IFNULL(IRAT_FAILURE_CNT,0) AS IRAT_FAILURE_CNT,
		IFNULL(MOVING_CALL_CNT,0) AS MOVING_CALL_CNT,
		IFNULL(INDOOR_CALL_CNT,0) AS INDOOR_CALL_CNT,
		IFNULL(PS_UL_VOLUME_SUM,0) AS PS_UL_VOLUME_SUM,
		IFNULL(PS_DL_VOLUME_SUM,0) AS PS_DL_VOLUME_SUM,
		IFNULL(PS_UL_SPEED_MAX,0) AS PS_UL_SPEED_MAX,
		IFNULL(PS_DL_SPEED_MAX,0) AS PS_DL_SPEED_MAX,
		IFNULL(FIRST_RSCP_SUM,0) AS FIRST_RSCP_SUM,
		IFNULL(FIRST_RSCP_CNT,0) AS FIRST_RSCP_CNT,
		IFNULL(FIRST_ECNO_SUM,0) AS FIRST_ECNO_SUM,
		IFNULL(FIRST_ECNO_CNT,0) AS FIRST_ECNO_CNT,
		IFNULL(CALL_SETUP_TIME_SUM,0) AS CALL_SETUP_TIME_SUM,
		IFNULL(CALL_SETUP_TIME_CNT,0) AS CALL_SETUP_TIME_CNT,
	
		IFNULL(`CALL_SETUP_TIME_VOICE_SUM`,0) AS `CALL_SETUP_TIME_VOICE_SUM`,
		IFNULL(`CALL_SETUP_TIME_VOICE_CNT`,0) AS `CALL_SETUP_TIME_VOICE_CNT`,
		IFNULL(`CALL_SETUP_TIME_VEDIO_SUM`,0) AS `CALL_SETUP_TIME_VEDIO_SUM`,
		IFNULL(`CALL_SETUP_TIME_VEDIO_CNT`,0) AS `CALL_SETUP_TIME_VEDIO_CNT`,
		IFNULL(`CALL_SETUP_TIME_R99_SUM`,0) AS `CALL_SETUP_TIME_R99_SUM`,
		IFNULL(`CALL_SETUP_TIME_R99_CNT`,0) AS `CALL_SETUP_TIME_R99_CNT`,
		IFNULL(`CALL_SETUP_TIME_HSPA_SUM`,0) AS `CALL_SETUP_TIME_HSPA_SUM`,
		IFNULL(`CALL_SETUP_TIME_HSPA_CNT`,0) AS `CALL_SETUP_TIME_HSPA_CNT`,
		IFNULL(`CALL_SETUP_TIME_MRAB_SUM`,0) AS `CALL_SETUP_TIME_MRAB_SUM`,
		IFNULL(`CALL_SETUP_TIME_MRAB_CNT`,0) AS `CALL_SETUP_TIME_MRAB_CNT`,
		IFNULL(`CALL_SETUP_TIME_SIG_SUM`,0) AS `CALL_SETUP_TIME_SIG_SUM`,
		IFNULL(`CALL_SETUP_TIME_SIG_CNT`,0) AS `CALL_SETUP_TIME_SIG_CNT`,
		IFNULL(`CALL_SETUP_TIME_OTH_SUM`,0) AS `CALL_SETUP_TIME_OTH_SUM`,
		IFNULL(`CALL_SETUP_TIME_OTH_CNT`,0) AS `CALL_SETUP_TIME_OTH_CNT`,
		IFNULL(`CALL_SETUP_TIME_SMS_SUM`,0) AS `CALL_SETUP_TIME_SMS_SUM`,
		IFNULL(`CALL_SETUP_TIME_SMS_CNT`,0) AS `CALL_SETUP_TIME_SMS_CNT`,
	
		IFNULL(SF_CNT,0) AS SF_CNT,
		IFNULL(SF_VOICE_CNT,0) AS SF_VOICE_CNT,
		IFNULL(SF_VEDIO_CNT,0) AS SF_VEDIO_CNT,
		IFNULL(SF_R99_CNT,0) AS SF_R99_CNT,
		IFNULL(SF_HSPA_CNT,0) AS SF_HSPA_CNT,
		IFNULL(SF_MRAB_CNT,0) AS SF_MRAB_CNT,
		IFNULL(SF_SMS_CNT,0) AS SF_SMS_CNT,
		IFNULL(SF_SMS_MT_CNT,0) AS SF_SMS_MT_CNT0,
		IFNULL(SF_SMS_MO_CNT,0) AS SF_SMS_MO_CNT0,
		IFNULL(SF_SIGNAL_CNT,0) AS SF_SIGNAL_CNT,
		IFNULL(SF_PS_OTHER_CNT,0) AS SF_PS_OTHER_CNT,
		IFNULL(PDP_ACTIVATION_REQUEST,0) AS PDP_ACTIVATION_REQUEST,
		IFNULL(PDP_ACTIVATION_ACCEPT,0) AS PDP_ACTIVATION_ACCEPT,
		IFNULL(PDP_DEACTIVATION_REQUEST,0) AS PDP_DEACTIVATION_REQUEST,
		IFNULL(PDP_DEACTIVATION_ACCEPT,0) AS PDP_DEACTIVATION_ACCEPT,
		IFNULL(AUTH_REQUEST,0) AS AUTH_REQUEST,
		IFNULL(AUTH_RESPONSE,0) AS AUTH_RESPONSE,
		IFNULL(AUTH_CIPH_REQUEST,0) AS AUTH_CIPH_REQUEST,
		IFNULL(AUTH_CIPH_RESPONSE,0) AS AUTH_CIPH_RESPONSE,
		IFNULL(SECURITY_MODE_ATT,0) AS SECURITY_MODE_ATT,
		IFNULL(SECURITY_MODE_SUCCESS,0) AS SECURITY_MODE_SUCCESS,
		IFNULL(LU_REQUEST,0) AS LU_REQUEST,
		IFNULL(LU_ACCEPT,0) AS LU_ACCEPT,
		IFNULL(RAU_REQUEST,0) AS RAU_REQUEST,
		IFNULL(RAU_ACCEPT,0) AS RAU_ACCEPT';
		
	DECLARE UMTS_IMSI_SUM_STR VARCHAR(6000) DEFAULT 
		'SUM(IFNULL(CALL_CNT,0)) AS CALL_CNT,
		SUM(IFNULL(VOICE_MO_CNT,0)) AS VOICE_MO_CNT,
		SUM(IFNULL(VOICE_MT_CNT,0)) AS VOICE_MT_CNT,
		SUM(IFNULL(VIDEO_MO_CNT,0)) AS VIDEO_MO_CNT,
		SUM(IFNULL(VIDEO_MT_CNT,0)) AS VIDEO_MT_CNT,
		SUM(IFNULL(R99_MO_CNT,0)) AS R99_MO_CNT,
		SUM(IFNULL(R99_MT_CNT,0)) AS R99_MT_CNT,
		SUM(IFNULL(HSPA_MO_CNT,0)) AS HSPA_MO_CNT,
		SUM(IFNULL(HSPA_MT_CNT,0)) AS HSPA_MT_CNT,
		SUM(IFNULL(MRAB_MO_CNT,0)) AS MRAB_MO_CNT,
		SUM(IFNULL(MRAB_MT_CNT,0)) AS MRAB_MT_CNT,
		SUM(IFNULL(SIGNAL_MO_CNT,0)) AS SIGNAL_MO_CNT,
		SUM(IFNULL(SIGNAL_MT_CNT,0)) AS SIGNAL_MT_CNT,
		SUM(IFNULL(SMS_MO_CNT,0)) AS SMS_MO_CNT,
		SUM(IFNULL(SMS_MT_CNT,0)) AS SMS_MT_CNT,
		SUM(IFNULL(PS_OTHER_CNT,0)) AS PS_OTHER_CNT,
		SUM(IFNULL(CALL_DUR_SUM,0)) AS CALL_DUR_SUM,
		SUM(IFNULL(VOICE_DUR_SUM,0)) AS VOICE_DUR_SUM,
		SUM(IFNULL(VIDEO_DUR_SUM,0)) AS VIDEO_DUR_SUM,
		SUM(IFNULL(R99_DUR_SUM,0)) AS R99_DUR_SUM,
		SUM(IFNULL(HSPA_DUR_SUM,0)) AS HSPA_DUR_SUM,
		SUM(IFNULL(MRAB_DUR_SUM,0)) AS MRAB_DUR_SUM,
		SUM(IFNULL(DROP_CNT,0)) AS DROP_CNT,
		SUM(IFNULL(DROP_VOICE_CNT,0)) AS DROP_VOICE_CNT,
		SUM(IFNULL(DROP_VEDIO_CNT,0)) AS DROP_VEDIO_CNT,
		SUM(IFNULL(DROP_R99_CNT,0)) AS DROP_R99_CNT,
		SUM(IFNULL(DROP_HSPA_CNT,0)) AS DROP_HSPA_CNT,
		SUM(IFNULL(DROP_MRAB_CNT,0)) AS DROP_MRAB_CNT,
		SUM(IFNULL(DROP_SMS_CNT,0)) AS DROP_SMS_CNT,
		SUM(IFNULL(DROP_SIGNAL_CNT,0)) AS DROP_SIGNAL_CNT,
		SUM(IFNULL(DROP_PS_OTHER_CNT,0)) AS DROP_PS_OTHER_CNT,
		SUM(IFNULL(DROP_RF_CNT,0)) AS DROP_RF_CNT,
		SUM(IFNULL(DROP_CONG_CNT,0)) AS DROP_CONG_CNT,
		SUM(IFNULL(DROP_TRANS_CNT,0)) AS DROP_TRANS_CNT,
		SUM(IFNULL(DROP_SHO_CNT,0)) AS DROP_SHO_CNT,
		SUM(IFNULL(DROP_HHO_CNT,0)) AS DROP_HHO_CNT,
		SUM(IFNULL(DROP_IRAT_CNT,0)) AS DROP_IRAT_CNT,
		SUM(IFNULL(BLOCK_CNT,0)) AS BLOCK_CNT,
		SUM(IFNULL(BLOCK_VOICE_CNT,0)) AS BLOCK_VOICE_CNT,
		SUM(IFNULL(BLOCK_VEDIO_CNT,0)) AS BLOCK_VEDIO_CNT,
		SUM(IFNULL(BLOCK_R99_CNT,0)) AS BLOCK_R99_CNT,
		SUM(IFNULL(BLOCK_HSPA_CNT,0)) AS BLOCK_HSPA_CNT,
		SUM(IFNULL(BLOCK_MRAB_CNT,0)) AS BLOCK_MRAB_CNT,
		SUM(IFNULL(BLOCK_SMS_CNT,0)) AS BLOCK_SMS_CNT,
	
		SUM(IFNULL(BLOCK_SMS_MT_CNT,0)) AS BLOCK_SMS_MT_CNT,
		SUM(IFNULL(BLOCK_SMS_MO_CNT,0)) AS BLOCK_SMS_MO_CNT,
	
		SUM(IFNULL(BLOCK_SIGNAL_CNT,0)) AS BLOCK_SIGNAL_CNT,
		SUM(IFNULL(BLOCK_PS_OTHER_CNT,0)) AS BLOCK_PS_OTHER_CNT,
		SUM(IFNULL(SHO_ATTEMPT_CNT,0)) AS SHO_ATTEMPT_CNT,
		SUM(IFNULL(SHO_FAILURE_CNT,0)) AS SHO_FAILURE_CNT,
		SUM(IFNULL(HHO_ATTEMPT_CNT,0)) AS HHO_ATTEMPT_CNT,
		SUM(IFNULL(HHO_FAILURE_CNT,0)) AS HHO_FAILURE_CNT,
		SUM(IFNULL(IRAT_ATTEMPT_CNT,0)) AS IRAT_ATTEMPT_CNT,
		SUM(IFNULL(IRAT_FAILURE_CNT,0)) AS IRAT_FAILURE_CNT,
		SUM(IFNULL(MOVING_CALL_CNT,0)) AS MOVING_CALL_CNT,
		SUM(IFNULL(INDOOR_CALL_CNT,0)) AS INDOOR_CALL_CNT,
		SUM(IFNULL(PS_UL_VOLUME_SUM,0)) AS PS_UL_VOLUME_SUM,
		SUM(IFNULL(PS_DL_VOLUME_SUM,0)) AS PS_DL_VOLUME_SUM,
		MAX(IFNULL(PS_UL_SPEED_MAX,0)) AS PS_UL_SPEED_MAX,
		MAX(IFNULL(PS_DL_SPEED_MAX,0)) AS PS_DL_SPEED_MAX,
		SUM(IFNULL(FIRST_RSCP_SUM,0)) AS FIRST_RSCP_SUM,
		SUM(IFNULL(FIRST_RSCP_CNT,0)) AS FIRST_RSCP_CNT,
		SUM(IFNULL(FIRST_ECNO_SUM,0)) AS FIRST_ECNO_SUM,
		SUM(IFNULL(FIRST_ECNO_CNT,0)) AS FIRST_ECNO_CNT,
		SUM(IFNULL(CALL_SETUP_TIME_SUM,0)) AS CALL_SETUP_TIME_SUM,
		SUM(IFNULL(CALL_SETUP_TIME_CNT,0)) AS CALL_SETUP_TIME_CNT,
	
		SUM(IFNULL(`CALL_SETUP_TIME_VOICE_SUM`,0)) AS `CALL_SETUP_TIME_VOICE_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_VOICE_CNT`,0)) AS `CALL_SETUP_TIME_VOICE_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_VEDIO_SUM`,0)) AS `CALL_SETUP_TIME_VEDIO_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_VEDIO_CNT`,0)) AS `CALL_SETUP_TIME_VEDIO_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_R99_SUM`,0)) AS `CALL_SETUP_TIME_R99_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_R99_CNT`,0)) AS `CALL_SETUP_TIME_R99_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_HSPA_SUM`,0)) AS `CALL_SETUP_TIME_HSPA_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_HSPA_CNT`,0)) AS `CALL_SETUP_TIME_HSPA_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_MRAB_SUM`,0)) AS `CALL_SETUP_TIME_MRAB_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_MRAB_CNT`,0)) AS `CALL_SETUP_TIME_MRAB_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_SIG_SUM`,0)) AS `CALL_SETUP_TIME_SIG_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_SIG_CNT`,0)) AS `CALL_SETUP_TIME_SIG_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_OTH_SUM`,0)) AS `CALL_SETUP_TIME_OTH_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_OTH_CNT`,0)) AS `CALL_SETUP_TIME_OTH_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_SMS_SUM`,0)) AS `CALL_SETUP_TIME_SMS_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_SMS_CNT`,0)) AS `CALL_SETUP_TIME_SMS_CNT`,
	
		SUM(IFNULL(SF_CNT,0)) AS SF_CNT,
		SUM(IFNULL(SF_VOICE_CNT,0)) AS SF_VOICE_CNT,
		SUM(IFNULL(SF_VEDIO_CNT,0)) AS SF_VEDIO_CNT,
		SUM(IFNULL(SF_R99_CNT,0)) AS SF_R99_CNT,
		SUM(IFNULL(SF_HSPA_CNT,0)) AS SF_HSPA_CNT,
		SUM(IFNULL(SF_MRAB_CNT,0)) AS SF_MRAB_CNT,
		SUM(IFNULL(SF_SMS_CNT,0)) AS SF_SMS_CNT,
	
		SUM(IFNULL(SF_SMS_MT_CNT,0)) AS SF_SMS_MT_CNT,
		SUM(IFNULL(SF_SMS_MO_CNT,0)) AS SF_SMS_MO_CNT,
	
		SUM(IFNULL(SF_SIGNAL_CNT,0)) AS SF_SIGNAL_CNT,
		SUM(IFNULL(SF_PS_OTHER_CNT,0)) AS SF_PS_OTHER_CNT,
		SUM(IFNULL(PDP_ACTIVATION_REQUEST,0)) AS PDP_ACTIVATION_REQUEST,
		SUM(IFNULL(PDP_ACTIVATION_ACCEPT,0)) AS PDP_ACTIVATION_ACCEPT,
		SUM(IFNULL(PDP_DEACTIVATION_REQUEST,0)) AS PDP_DEACTIVATION_REQUEST,
		SUM(IFNULL(PDP_DEACTIVATION_ACCEPT,0)) AS PDP_DEACTIVATION_ACCEPT,
		SUM(IFNULL(AUTH_REQUEST,0)) AS AUTH_REQUEST,
		SUM(IFNULL(AUTH_RESPONSE,0)) AS AUTH_RESPONSE,
		SUM(IFNULL(AUTH_CIPH_REQUEST,0)) AS AUTH_CIPH_REQUEST,
		SUM(IFNULL(AUTH_CIPH_RESPONSE,0)) AS AUTH_CIPH_RESPONSE,
		SUM(IFNULL(SECURITY_MODE_ATT,0)) AS SECURITY_MODE_ATT,
		SUM(IFNULL(SECURITY_MODE_SUCCESS,0)) AS SECURITY_MODE_SUCCESS,
		SUM(IFNULL(LU_REQUEST,0)) AS LU_REQUEST,
		SUM(IFNULL(LU_ACCEPT,0)) AS LU_ACCEPT,
		SUM(IFNULL(RAU_REQUEST,0)) AS RAU_REQUEST,
		SUM(IFNULL(RAU_ACCEPT,0)) AS RAU_ACCEPT';
		
	DECLARE UMTS_IMSI_UDP_STR VARCHAR(10000) DEFAULT 
		'RPT_TABLE_NAME.CALL_CNT=RPT_TABLE_NAME.CALL_CNT+VALUES(CALL_CNT),
		RPT_TABLE_NAME.VOICE_MO_CNT=RPT_TABLE_NAME.VOICE_MO_CNT+VALUES(VOICE_MO_CNT),
		RPT_TABLE_NAME.VOICE_MT_CNT=RPT_TABLE_NAME.VOICE_MT_CNT+VALUES(VOICE_MT_CNT),
		RPT_TABLE_NAME.VIDEO_MO_CNT=RPT_TABLE_NAME.VIDEO_MO_CNT+VALUES(VIDEO_MO_CNT),
		RPT_TABLE_NAME.VIDEO_MT_CNT=RPT_TABLE_NAME.VIDEO_MT_CNT+VALUES(VIDEO_MT_CNT),
		RPT_TABLE_NAME.R99_MO_CNT=RPT_TABLE_NAME.R99_MO_CNT+VALUES(R99_MO_CNT),
		RPT_TABLE_NAME.R99_MT_CNT=RPT_TABLE_NAME.R99_MT_CNT+VALUES(R99_MT_CNT),
		RPT_TABLE_NAME.HSPA_MO_CNT=RPT_TABLE_NAME.HSPA_MO_CNT+VALUES(HSPA_MO_CNT),
		RPT_TABLE_NAME.HSPA_MT_CNT=RPT_TABLE_NAME.HSPA_MT_CNT+VALUES(HSPA_MT_CNT),
		RPT_TABLE_NAME.MRAB_MO_CNT=RPT_TABLE_NAME.MRAB_MO_CNT+VALUES(MRAB_MO_CNT),
		RPT_TABLE_NAME.MRAB_MT_CNT=RPT_TABLE_NAME.MRAB_MT_CNT+VALUES(MRAB_MT_CNT),
		RPT_TABLE_NAME.SIGNAL_MO_CNT=RPT_TABLE_NAME.SIGNAL_MO_CNT+VALUES(SIGNAL_MO_CNT),
		RPT_TABLE_NAME.SIGNAL_MT_CNT=RPT_TABLE_NAME.SIGNAL_MT_CNT+VALUES(SIGNAL_MT_CNT),
		RPT_TABLE_NAME.SMS_MO_CNT=RPT_TABLE_NAME.SMS_MO_CNT+VALUES(SMS_MO_CNT),
		RPT_TABLE_NAME.SMS_MT_CNT=RPT_TABLE_NAME.SMS_MT_CNT+VALUES(SMS_MT_CNT),
		RPT_TABLE_NAME.PS_OTHER_CNT=RPT_TABLE_NAME.PS_OTHER_CNT+VALUES(PS_OTHER_CNT),
		RPT_TABLE_NAME.CALL_DUR_SUM=RPT_TABLE_NAME.CALL_DUR_SUM+VALUES(CALL_DUR_SUM),
		RPT_TABLE_NAME.VOICE_DUR_SUM=RPT_TABLE_NAME.VOICE_DUR_SUM+VALUES(VOICE_DUR_SUM),
		RPT_TABLE_NAME.VIDEO_DUR_SUM=RPT_TABLE_NAME.VIDEO_DUR_SUM+VALUES(VIDEO_DUR_SUM),
		RPT_TABLE_NAME.R99_DUR_SUM=RPT_TABLE_NAME.R99_DUR_SUM+VALUES(R99_DUR_SUM),
		RPT_TABLE_NAME.HSPA_DUR_SUM=RPT_TABLE_NAME.HSPA_DUR_SUM+VALUES(HSPA_DUR_SUM),
		RPT_TABLE_NAME.MRAB_DUR_SUM=RPT_TABLE_NAME.MRAB_DUR_SUM+VALUES(MRAB_DUR_SUM),
		RPT_TABLE_NAME.DROP_CNT=RPT_TABLE_NAME.DROP_CNT+VALUES(DROP_CNT),
		RPT_TABLE_NAME.DROP_VOICE_CNT=RPT_TABLE_NAME.DROP_VOICE_CNT+VALUES(DROP_VOICE_CNT),
		RPT_TABLE_NAME.DROP_VEDIO_CNT=RPT_TABLE_NAME.DROP_VEDIO_CNT+VALUES(DROP_VEDIO_CNT),
		RPT_TABLE_NAME.DROP_R99_CNT=RPT_TABLE_NAME.DROP_R99_CNT+VALUES(DROP_R99_CNT),
		RPT_TABLE_NAME.DROP_HSPA_CNT=RPT_TABLE_NAME.DROP_HSPA_CNT+VALUES(DROP_HSPA_CNT),
		RPT_TABLE_NAME.DROP_MRAB_CNT=RPT_TABLE_NAME.DROP_MRAB_CNT+VALUES(DROP_MRAB_CNT),
		RPT_TABLE_NAME.DROP_SMS_CNT=RPT_TABLE_NAME.DROP_SMS_CNT+VALUES(DROP_SMS_CNT),
		RPT_TABLE_NAME.DROP_SIGNAL_CNT=RPT_TABLE_NAME.DROP_SIGNAL_CNT+VALUES(DROP_SIGNAL_CNT),
		RPT_TABLE_NAME.DROP_PS_OTHER_CNT=RPT_TABLE_NAME.DROP_PS_OTHER_CNT+VALUES(DROP_PS_OTHER_CNT),
		RPT_TABLE_NAME.DROP_RF_CNT=RPT_TABLE_NAME.DROP_RF_CNT+VALUES(DROP_RF_CNT),
		RPT_TABLE_NAME.DROP_CONG_CNT=RPT_TABLE_NAME.DROP_CONG_CNT+VALUES(DROP_CONG_CNT),
		RPT_TABLE_NAME.DROP_TRANS_CNT=RPT_TABLE_NAME.DROP_TRANS_CNT+VALUES(DROP_TRANS_CNT),
		RPT_TABLE_NAME.DROP_SHO_CNT=RPT_TABLE_NAME.DROP_SHO_CNT+VALUES(DROP_SHO_CNT),
		RPT_TABLE_NAME.DROP_HHO_CNT=RPT_TABLE_NAME.DROP_HHO_CNT+VALUES(DROP_HHO_CNT),
		RPT_TABLE_NAME.DROP_IRAT_CNT=RPT_TABLE_NAME.DROP_IRAT_CNT+VALUES(DROP_IRAT_CNT),
		RPT_TABLE_NAME.BLOCK_CNT=RPT_TABLE_NAME.BLOCK_CNT+VALUES(BLOCK_CNT),
		RPT_TABLE_NAME.BLOCK_VOICE_CNT=RPT_TABLE_NAME.BLOCK_VOICE_CNT+VALUES(BLOCK_VOICE_CNT),
		RPT_TABLE_NAME.BLOCK_VEDIO_CNT=RPT_TABLE_NAME.BLOCK_VEDIO_CNT+VALUES(BLOCK_VEDIO_CNT),
		RPT_TABLE_NAME.BLOCK_R99_CNT=RPT_TABLE_NAME.BLOCK_R99_CNT+VALUES(BLOCK_R99_CNT),
		RPT_TABLE_NAME.BLOCK_HSPA_CNT=RPT_TABLE_NAME.BLOCK_HSPA_CNT+VALUES(BLOCK_HSPA_CNT),
		RPT_TABLE_NAME.BLOCK_MRAB_CNT=RPT_TABLE_NAME.BLOCK_MRAB_CNT+VALUES(BLOCK_MRAB_CNT),
		RPT_TABLE_NAME.BLOCK_SMS_CNT=RPT_TABLE_NAME.BLOCK_SMS_CNT+VALUES(BLOCK_SMS_CNT),
	
		RPT_TABLE_NAME.BLOCK_SMS_MT_CNT=RPT_TABLE_NAME.BLOCK_SMS_MT_CNT+VALUES(BLOCK_SMS_MT_CNT),
		RPT_TABLE_NAME.BLOCK_SMS_MO_CNT=RPT_TABLE_NAME.BLOCK_SMS_MO_CNT+VALUES(BLOCK_SMS_MO_CNT),
	
		RPT_TABLE_NAME.BLOCK_SIGNAL_CNT=RPT_TABLE_NAME.BLOCK_SIGNAL_CNT+VALUES(BLOCK_SIGNAL_CNT),
		RPT_TABLE_NAME.BLOCK_PS_OTHER_CNT=RPT_TABLE_NAME.BLOCK_PS_OTHER_CNT+VALUES(BLOCK_PS_OTHER_CNT),
		RPT_TABLE_NAME.SHO_ATTEMPT_CNT=RPT_TABLE_NAME.SHO_ATTEMPT_CNT+VALUES(SHO_ATTEMPT_CNT),
		RPT_TABLE_NAME.SHO_FAILURE_CNT=RPT_TABLE_NAME.SHO_FAILURE_CNT+VALUES(SHO_FAILURE_CNT),
		RPT_TABLE_NAME.HHO_ATTEMPT_CNT=RPT_TABLE_NAME.HHO_ATTEMPT_CNT+VALUES(HHO_ATTEMPT_CNT),
		RPT_TABLE_NAME.HHO_FAILURE_CNT=RPT_TABLE_NAME.HHO_FAILURE_CNT+VALUES(HHO_FAILURE_CNT),
		RPT_TABLE_NAME.IRAT_ATTEMPT_CNT=RPT_TABLE_NAME.IRAT_ATTEMPT_CNT+VALUES(IRAT_ATTEMPT_CNT),
		RPT_TABLE_NAME.IRAT_FAILURE_CNT=RPT_TABLE_NAME.IRAT_FAILURE_CNT+VALUES(IRAT_FAILURE_CNT),
		RPT_TABLE_NAME.MOVING_CALL_CNT=RPT_TABLE_NAME.MOVING_CALL_CNT+VALUES(MOVING_CALL_CNT),
		RPT_TABLE_NAME.INDOOR_CALL_CNT=RPT_TABLE_NAME.INDOOR_CALL_CNT+VALUES(INDOOR_CALL_CNT),
		RPT_TABLE_NAME.PS_UL_VOLUME_SUM=RPT_TABLE_NAME.PS_UL_VOLUME_SUM+VALUES(PS_UL_VOLUME_SUM),
		RPT_TABLE_NAME.PS_DL_VOLUME_SUM=RPT_TABLE_NAME.PS_DL_VOLUME_SUM+VALUES(PS_DL_VOLUME_SUM),
		RPT_TABLE_NAME.PS_UL_SPEED_MAX=IF(RPT_TABLE_NAME.PS_UL_SPEED_MAX > VALUES(PS_UL_SPEED_MAX),RPT_TABLE_NAME.PS_UL_SPEED_MAX,VALUES(PS_UL_SPEED_MAX)),
		RPT_TABLE_NAME.PS_DL_SPEED_MAX=IF(RPT_TABLE_NAME.PS_DL_SPEED_MAX > VALUES(PS_DL_SPEED_MAX),RPT_TABLE_NAME.PS_DL_SPEED_MAX,VALUES(PS_DL_SPEED_MAX)),
		RPT_TABLE_NAME.FIRST_RSCP_SUM=RPT_TABLE_NAME.FIRST_RSCP_SUM+VALUES(FIRST_RSCP_SUM),
		RPT_TABLE_NAME.FIRST_RSCP_CNT=RPT_TABLE_NAME.FIRST_RSCP_CNT+VALUES(FIRST_RSCP_CNT),
		RPT_TABLE_NAME.FIRST_ECNO_SUM=RPT_TABLE_NAME.FIRST_ECNO_SUM+VALUES(FIRST_ECNO_SUM),
		RPT_TABLE_NAME.FIRST_ECNO_CNT=RPT_TABLE_NAME.FIRST_ECNO_CNT+VALUES(FIRST_ECNO_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_SUM+VALUES(CALL_SETUP_TIME_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_CNT+VALUES(CALL_SETUP_TIME_CNT),
	
		RPT_TABLE_NAME.CALL_SETUP_TIME_VOICE_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_VOICE_SUM+VALUES(CALL_SETUP_TIME_VOICE_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_VOICE_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_VOICE_CNT+VALUES(CALL_SETUP_TIME_VOICE_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_VEDIO_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_VEDIO_SUM+VALUES(CALL_SETUP_TIME_VEDIO_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_VEDIO_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_VEDIO_CNT+VALUES(CALL_SETUP_TIME_VEDIO_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_R99_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_R99_SUM+VALUES(CALL_SETUP_TIME_R99_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_R99_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_R99_CNT+VALUES(CALL_SETUP_TIME_R99_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_HSPA_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_HSPA_SUM+VALUES(CALL_SETUP_TIME_HSPA_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_HSPA_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_HSPA_CNT+VALUES(CALL_SETUP_TIME_HSPA_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_MRAB_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_MRAB_SUM+VALUES(CALL_SETUP_TIME_MRAB_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_MRAB_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_MRAB_CNT+VALUES(CALL_SETUP_TIME_MRAB_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_SIG_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_SIG_SUM+VALUES(CALL_SETUP_TIME_SIG_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_SIG_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_SIG_CNT+VALUES(CALL_SETUP_TIME_SIG_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_OTH_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_OTH_SUM+VALUES(CALL_SETUP_TIME_OTH_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_OTH_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_OTH_CNT+VALUES(CALL_SETUP_TIME_OTH_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_SMS_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_SMS_SUM+VALUES(CALL_SETUP_TIME_SMS_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_SMS_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_SMS_CNT+VALUES(CALL_SETUP_TIME_SMS_CNT),
	
		RPT_TABLE_NAME.SF_CNT=RPT_TABLE_NAME.SF_CNT+VALUES(SF_CNT),
		RPT_TABLE_NAME.SF_VOICE_CNT=RPT_TABLE_NAME.SF_VOICE_CNT+VALUES(SF_VOICE_CNT),
		RPT_TABLE_NAME.SF_VEDIO_CNT=RPT_TABLE_NAME.SF_VEDIO_CNT+VALUES(SF_VEDIO_CNT),
		RPT_TABLE_NAME.SF_R99_CNT=RPT_TABLE_NAME.SF_R99_CNT+VALUES(SF_R99_CNT),
		RPT_TABLE_NAME.SF_HSPA_CNT=RPT_TABLE_NAME.SF_HSPA_CNT+VALUES(SF_HSPA_CNT),
		RPT_TABLE_NAME.SF_MRAB_CNT=RPT_TABLE_NAME.SF_MRAB_CNT+VALUES(SF_MRAB_CNT),
		RPT_TABLE_NAME.SF_SMS_CNT=RPT_TABLE_NAME.SF_SMS_CNT+VALUES(SF_SMS_CNT),
	
		RPT_TABLE_NAME.SF_SMS_MT_CNT=RPT_TABLE_NAME.SF_SMS_MT_CNT+VALUES(SF_SMS_MT_CNT),
		RPT_TABLE_NAME.SF_SMS_MO_CNT=RPT_TABLE_NAME.SF_SMS_MO_CNT+VALUES(SF_SMS_MO_CNT),
		RPT_TABLE_NAME.SF_SIGNAL_CNT=RPT_TABLE_NAME.SF_SIGNAL_CNT+VALUES(SF_SIGNAL_CNT),
		RPT_TABLE_NAME.SF_PS_OTHER_CNT=RPT_TABLE_NAME.SF_PS_OTHER_CNT+VALUES(SF_PS_OTHER_CNT),
		RPT_TABLE_NAME.PDP_ACTIVATION_REQUEST=RPT_TABLE_NAME.PDP_ACTIVATION_REQUEST+VALUES(PDP_ACTIVATION_REQUEST),
		RPT_TABLE_NAME.PDP_ACTIVATION_ACCEPT=RPT_TABLE_NAME.PDP_ACTIVATION_ACCEPT+VALUES(PDP_ACTIVATION_ACCEPT),
		RPT_TABLE_NAME.PDP_DEACTIVATION_REQUEST=RPT_TABLE_NAME.PDP_DEACTIVATION_REQUEST+VALUES(PDP_DEACTIVATION_REQUEST),
		RPT_TABLE_NAME.PDP_DEACTIVATION_ACCEPT=RPT_TABLE_NAME.PDP_DEACTIVATION_ACCEPT+VALUES(PDP_DEACTIVATION_ACCEPT),
		RPT_TABLE_NAME.AUTH_REQUEST=RPT_TABLE_NAME.AUTH_REQUEST+VALUES(AUTH_REQUEST),
		RPT_TABLE_NAME.AUTH_RESPONSE=RPT_TABLE_NAME.AUTH_RESPONSE+VALUES(AUTH_RESPONSE),
		RPT_TABLE_NAME.AUTH_CIPH_REQUEST=RPT_TABLE_NAME.AUTH_CIPH_REQUEST+VALUES(AUTH_CIPH_REQUEST),
		RPT_TABLE_NAME.AUTH_CIPH_RESPONSE=RPT_TABLE_NAME.AUTH_CIPH_RESPONSE+VALUES(AUTH_CIPH_RESPONSE),
		RPT_TABLE_NAME.SECURITY_MODE_ATT=RPT_TABLE_NAME.SECURITY_MODE_ATT+VALUES(SECURITY_MODE_ATT),
		RPT_TABLE_NAME.SECURITY_MODE_SUCCESS=RPT_TABLE_NAME.SECURITY_MODE_SUCCESS+VALUES(SECURITY_MODE_SUCCESS),
		RPT_TABLE_NAME.LU_REQUEST=RPT_TABLE_NAME.LU_REQUEST+VALUES(LU_REQUEST),
		RPT_TABLE_NAME.LU_ACCEPT=RPT_TABLE_NAME.LU_ACCEPT+VALUES(LU_ACCEPT),
		RPT_TABLE_NAME.RAU_REQUEST=RPT_TABLE_NAME.RAU_REQUEST+VALUES(RAU_REQUEST),
		RPT_TABLE_NAME.RAU_ACCEPT=RPT_TABLE_NAME.RAU_ACCEPT+VALUES(RAU_ACCEPT)';
			
	DECLARE LTE_IMSI_COLUMN_STR VARCHAR(2000) DEFAULT 
		'`CALL_CNT`,
		`DATA_CNT`,
		`SIGNAL_CNT`,
		`SMS_CNT`,
		`VOLTE_CNT`,
		`UNSPECIFIED_CNT`,
		`CALL_DUR_SUM`,
		`DATA_DUR_SUM`,
		`SIGNAL_DUR_SUM`,
		`DROP_CNT`,
		`DROP_DATA_CNT`,
		`DROP_SIGNAL_CNT`,
		`DROP_SMS_CNT`,
		`DROP_VOLTE_CNT`,
		`DROP_UNSPECIFIED_CNT`,
		`BLOCK_CNT`,
		`BLOCK_DATA_CNT`,
		`BLOCK_SIGNAL_CNT`,
		`BLOCK_SMS_CNT`,
		`BLOCK_SMS_MT_CNT`,
		`BLOCK_SMS_MO_CNT`,
		`BLOCK_VOLTE_CNT`,
		`BLOCK_UNSPECIFIED_CNT`,
		`DROP_RDO_NW_CNT`,
		`DROP_TRANS_CNT`,
		`DROP_NAS_CNT`,
		`DROP_MISC_CNT`,
		`DROP_PROTOCOL_CNT`,
		`INTER_FREQ_ATTEMPT_CNT`,
		`INTER_FREQ_FAILURE_CNT`,
		`INTRA_FREQ_ATTEMPT_CNT`,
		`INTRA_FREQ_FAILURE_CNT`,
		`4G_3G_ATTEMPT_CNT`,
		`4G_3G_FAILURE_CNT`,
		`4G_2G_ATTEMPT_CNT`,
		`4G_2G_FAILURE_CNT`,
		`MOVING_CALL_CNT`,
		`INDOOR_CALL_CNT`,
		`PS_UL_VOLUME_SUM`,
		`PS_DL_VOLUME_SUM`,
		`PS_UL_SPEED_MAX`,
		`PS_DL_SPEED_MAX`,
		`FIRST_RSRP_SUM`,
		`FIRST_RSRP_CNT`,
		`FIRST_RSRQ_SUM`,
		`FIRST_RSRQ_CNT`,
		`CALL_SETUP_TIME_SUM`,
		`CALL_SETUP_TIME_CNT`,
		
		`CALL_SETUP_TIME_SIG_SUM`,
		`CALL_SETUP_TIME_SIG_CNT`,
		`CALL_SETUP_TIME_DATA_SUM`,
		`CALL_SETUP_TIME_DATA_CNT`,
		`CALL_SETUP_TIME_SMS_SUM`,
		`CALL_SETUP_TIME_SMS_CNT`,
		`CALL_SETUP_TIME_VOLTE_SUM`,
		`CALL_SETUP_TIME_VOLTE_CNT`,
		`CALL_SETUP_TIME_UNSP_SUM`,
		`CALL_SETUP_TIME_UNSP_CNT`,
	
		`SF_CNT`,
		`SF_DATA_CNT`,
		`SF_SIGNAL_CNT`,
		`SF_SMS_CNT`,
		`SF_SMS_MT_CNT`,
		`SF_SMS_MO_CNT`,
		`SF_VOLTE_CNT`,
		`SF_UNSPECIFIED_CNT`,
		`MT_DATA_CNT`,
		`MO_DATA_CNT`,
		`MT_SMS_CNT`,
		`MO_SMS_CNT`,
		`MT_VOLTE_CNT`,
		`MO_VOLTE_CNT`,
		`CSFB_SIGNAL_CNT`,
		`CSFB_DATA_CNT`,
		`CSFB_SMS_CNT`,
		`CSFB_VOLTE_CNT`,
		`CSFB_UNSPECIFIED_CNT`,
		`CSFB_CNT`,
		`LATENCY_SUM`,
		`LATENCY_CNT`';
		  
	DECLARE LTE_IMSI_IFNULL_STR VARCHAR(6000) DEFAULT 
		'IFNULL(`CALL_CNT`,0) AS `CALL_CNT`,
		IFNULL(`DATA_CNT`,0) AS `DATA_CNT`,
		IFNULL(`SIGNAL_CNT`,0) AS `SIGNAL_CNT`,
		IFNULL(`SMS_CNT`,0) AS `SMS_CNT`,
		IFNULL(`VOLTE_CNT`,0) AS `VOLTE_CNT`,
		IFNULL(`UNSPECIFIED_CNT`,0) AS `UNSPECIFIED_CNT`,
		IFNULL(`CALL_DUR_SUM`,0) AS `CALL_DUR_SUM`,
		IFNULL(`DATA_DUR_SUM`,0) AS `DATA_DUR_SUM`,
		IFNULL(`SIGNAL_DUR_SUM`,0) AS `SIGNAL_DUR_SUM`,
		IFNULL(`DROP_CNT`,0) AS `DROP_CNT`,
		IFNULL(`DROP_DATA_CNT`,0) AS `DROP_DATA_CNT`,
		IFNULL(`DROP_SIGNAL_CNT`,0) AS `DROP_SIGNAL_CNT`,
		IFNULL(`DROP_SMS_CNT`,0) AS `DROP_SMS_CNT`,
		IFNULL(`DROP_VOLTE_CNT`,0) AS `DROP_VOLTE_CNT`,
		IFNULL(`DROP_UNSPECIFIED_CNT`,0) AS `DROP_UNSPECIFIED_CNT`,
		IFNULL(`BLOCK_CNT`,0) AS `BLOCK_CNT`,
		IFNULL(`BLOCK_DATA_CNT`,0) AS `BLOCK_DATA_CNT`,
		IFNULL(`BLOCK_SIGNAL_CNT`,0) AS `BLOCK_SIGNAL_CNT`,
		IFNULL(`BLOCK_SMS_CNT`,0) AS `BLOCK_SMS_CNT`,
	
		IFNULL(`BLOCK_SMS_MT_CNT`,0) AS `BLOCK_SMS_MT_CNT`,
		IFNULL(`BLOCK_SMS_MO_CNT`,0) AS `BLOCK_SMS_MO_CNT`,
	
		IFNULL(`BLOCK_VOLTE_CNT`,0) AS `BLOCK_VOLTE_CNT`,
		IFNULL(`BLOCK_UNSPECIFIED_CNT`,0) AS `BLOCK_UNSPECIFIED_CNT`,
		IFNULL(`DROP_RDO_NW_CNT`,0) AS `DROP_RDO_NW_CNT`,
		IFNULL(`DROP_TRANS_CNT`,0) AS `DROP_TRANS_CNT`,
		IFNULL(`DROP_NAS_CNT`,0) AS `DROP_NAS_CNT`,
		IFNULL(`DROP_MISC_CNT`,0) AS `DROP_MISC_CNT`,
		IFNULL(`DROP_PROTOCOL_CNT`,0) AS `DROP_PROTOCOL_CNT`,
		IFNULL(`INTER_FREQ_ATTEMPT_CNT`,0) AS `INTER_FREQ_ATTEMPT_CNT`,
		IFNULL(`INTER_FREQ_FAILURE_CNT`,0) AS `INTER_FREQ_FAILURE_CNT`,
		IFNULL(`INTRA_FREQ_ATTEMPT_CNT`,0) AS `INTRA_FREQ_ATTEMPT_CNT`,
		IFNULL(`INTRA_FREQ_FAILURE_CNT`,0) AS `INTRA_FREQ_FAILURE_CNT`,
		IFNULL(`4G_3G_ATTEMPT_CNT`,0) AS `4G_3G_ATTEMPT_CNT`,
		IFNULL(`4G_3G_FAILURE_CNT`,0) AS `4G_3G_FAILURE_CNT`,
		IFNULL(`4G_2G_ATTEMPT_CNT`,0) AS `4G_2G_ATTEMPT_CNT`,
		IFNULL(`4G_2G_FAILURE_CNT`,0) AS `4G_2G_FAILURE_CNT`,
		IFNULL(`MOVING_CALL_CNT`,0) AS `MOVING_CALL_CNT`,
		IFNULL(`INDOOR_CALL_CNT`,0) AS `INDOOR_CALL_CNT`,
		IFNULL(`PS_UL_VOLUME_SUM`,0) AS `PS_UL_VOLUME_SUM`,
		IFNULL(`PS_DL_VOLUME_SUM`,0) AS `PS_DL_VOLUME_SUM`,
		IFNULL(`PS_UL_SPEED_MAX`,0) AS `PS_UL_SPEED_MAX`,
		IFNULL(`PS_DL_SPEED_MAX`,0) AS `PS_DL_SPEED_MAX`,
		IFNULL(`FIRST_RSRP_SUM`,0) AS `FIRST_RSRP_SUM`,
		IFNULL(`FIRST_RSRP_CNT`,0) AS `FIRST_RSRP_CNT`,
		IFNULL(`FIRST_RSRQ_SUM`,0) AS `FIRST_RSRQ_SUM`,
		IFNULL(`FIRST_RSRQ_CNT`,0) AS `FIRST_RSRQ_CNT`,
		IFNULL(`CALL_SETUP_TIME_SUM`,0) AS `CALL_SETUP_TIME_SUM`,
		IFNULL(`CALL_SETUP_TIME_CNT`,0) AS `CALL_SETUP_TIME_CNT`,
	
		IFNULL(`CALL_SETUP_TIME_SIG_SUM`,0) AS `CALL_SETUP_TIME_SIG_SUM`,
		IFNULL(`CALL_SETUP_TIME_SIG_CNT`,0) AS `CALL_SETUP_TIME_SIG_CNT`,
		IFNULL(`CALL_SETUP_TIME_DATA_SUM`,0) AS `CALL_SETUP_TIME_DATA_SUM`,
		IFNULL(`CALL_SETUP_TIME_DATA_CNT`,0) AS `CALL_SETUP_TIME_DATA_CNT`,
		IFNULL(`CALL_SETUP_TIME_SMS_SUM`,0) AS `CALL_SETUP_TIME_SMS_SUM`,
		IFNULL(`CALL_SETUP_TIME_SMS_CNT`,0) AS `CALL_SETUP_TIME_SMS_CNT`,
		IFNULL(`CALL_SETUP_TIME_VOLTE_SUM`,0) AS `CALL_SETUP_TIME_VOLTE_SUM`,
		IFNULL(`CALL_SETUP_TIME_VOLTE_CNT`,0) AS `CALL_SETUP_TIME_VOLTE_CNT`,
		IFNULL(`CALL_SETUP_TIME_UNSP_SUM`,0) AS `CALL_SETUP_TIME_UNSP_SUM`,
		IFNULL(`CALL_SETUP_TIME_UNSP_CNT`,0) AS `CALL_SETUP_TIME_UNSP_CNT`,
	
		IFNULL(`SF_CNT`,0) AS `SF_CNT`,
		IFNULL(`SF_DATA_CNT`,0) AS `SF_DATA_CNT`,
		IFNULL(`SF_SIGNAL_CNT`,0) AS `SF_SIGNAL_CNT`,
		IFNULL(`SF_SMS_CNT`,0) AS `SF_SMS_CNT`,
	
		IFNULL(`SF_SMS_MT_CNT`,0) AS `SF_SMS_MT_CNT`,
		IFNULL(`SF_SMS_MO_CNT`,0) AS `SF_SMS_MO_CNT`,
		IFNULL(`SF_VOLTE_CNT`,0) AS `SF_VOLTE_CNT`,
		IFNULL(`SF_UNSPECIFIED_CNT`,0) AS `SF_UNSPECIFIED_CNT`,
		IFNULL(`MT_DATA_CNT`,0) AS `MT_DATA_CNT`,
		IFNULL(`MO_DATA_CNT`,0) AS `MO_DATA_CNT`,
		IFNULL(`MT_SMS_CNT`,0) AS `MT_SMS_CNT`,
		IFNULL(`MO_SMS_CNT`,0) AS `MO_SMS_CNT`,
		IFNULL(`MT_VOLTE_CNT`,0) AS `MT_VOLTE_CNT`,
		IFNULL(`MO_VOLTE_CNT`,0) AS `MO_VOLTE_CNT`,
		IFNULL(`CSFB_SIGNAL_CNT`,0) AS `CSFB_SIGNAL_CNT`,
		IFNULL(`CSFB_DATA_CNT`,0) AS `CSFB_DATA_CNT`,
		IFNULL(`CSFB_SMS_CNT`,0) AS `CSFB_SMS_CNT`,
		IFNULL(`CSFB_VOLTE_CNT`,0) AS `CSFB_VOLTE_CNT`,
		IFNULL(`CSFB_UNSPECIFIED_CNT`,0) AS `CSFB_UNSPECIFIED_CNT`,
		IFNULL(`CSFB_CNT`,0) AS `CSFB_CNT`,
		IFNULL(`LATENCY_SUM`,0) AS `LATENCY_SUM`,
		IFNULL(`LATENCY_CNT`,0) AS `LATENCY_CNT`';
		
	DECLARE LTE_IMSI_SUM_STR VARCHAR(5000) DEFAULT 
		'SUM(IFNULL(`CALL_CNT`,0)) AS `CALL_CNT`,
		SUM(IFNULL(`DATA_CNT`,0)) AS `DATA_CNT`,
		SUM(IFNULL(`SIGNAL_CNT`,0)) AS `SIGNAL_CNT`,
		SUM(IFNULL(`SMS_CNT`,0)) AS `SMS_CNT`,
		SUM(IFNULL(`VOLTE_CNT`,0)) AS `VOLTE_CNT`,
		SUM(IFNULL(`UNSPECIFIED_CNT`,0)) AS `UNSPECIFIED_CNT`,
		SUM(IFNULL(`CALL_DUR_SUM`,0)) AS `CALL_DUR_SUM`,
		SUM(IFNULL(`DATA_DUR_SUM`,0)) AS `DATA_DUR_SUM`,
		SUM(IFNULL(`SIGNAL_DUR_SUM`,0)) AS `SIGNAL_DUR_SUM`,
		SUM(IFNULL(`DROP_CNT`,0)) AS `DROP_CNT`,
		SUM(IFNULL(`DROP_DATA_CNT`,0)) AS `DROP_DATA_CNT`,
		SUM(IFNULL(`DROP_SIGNAL_CNT`,0)) AS `DROP_SIGNAL_CNT`,
		SUM(IFNULL(`DROP_SMS_CNT`,0)) AS `DROP_SMS_CNT`,
		SUM(IFNULL(`DROP_VOLTE_CNT`,0)) AS `DROP_VOLTE_CNT`,
		SUM(IFNULL(`DROP_UNSPECIFIED_CNT`,0)) AS `DROP_UNSPECIFIED_CNT`,
		SUM(IFNULL(`BLOCK_CNT`,0)) AS `BLOCK_CNT`,
		SUM(IFNULL(`BLOCK_DATA_CNT`,0)) AS `BLOCK_DATA_CNT`,
		SUM(IFNULL(`BLOCK_SIGNAL_CNT`,0)) AS `BLOCK_SIGNAL_CNT`,
		SUM(IFNULL(`BLOCK_SMS_CNT`,0)) AS `BLOCK_SMS_CNT`,
	
		SUM(IFNULL(`BLOCK_SMS_MT_CNT`,0)) AS `BLOCK_SMS_MT_CNT`,
		SUM(IFNULL(`BLOCK_SMS_MO_CNT`,0)) AS `BLOCK_SMS_MO_CNT`,
	
		SUM(IFNULL(`BLOCK_VOLTE_CNT`,0)) AS `BLOCK_VOLTE_CNT`,
		SUM(IFNULL(`BLOCK_UNSPECIFIED_CNT`,0)) AS `BLOCK_UNSPECIFIED_CNT`,
		SUM(IFNULL(`DROP_RDO_NW_CNT`,0)) AS `DROP_RDO_NW_CNT`,
		SUM(IFNULL(`DROP_TRANS_CNT`,0)) AS `DROP_TRANS_CNT`,
		SUM(IFNULL(`DROP_NAS_CNT`,0)) AS `DROP_NAS_CNT`,
		SUM(IFNULL(`DROP_MISC_CNT`,0)) AS `DROP_MISC_CNT`,
		SUM(IFNULL(`DROP_PROTOCOL_CNT`,0)) AS `DROP_PROTOCOL_CNT`,
		SUM(IFNULL(`INTER_FREQ_ATTEMPT_CNT`,0)) AS `INTER_FREQ_ATTEMPT_CNT`,
		SUM(IFNULL(`INTER_FREQ_FAILURE_CNT`,0)) AS `INTER_FREQ_FAILURE_CNT`,
		SUM(IFNULL(`INTRA_FREQ_ATTEMPT_CNT`,0)) AS `INTRA_FREQ_ATTEMPT_CNT`,
		SUM(IFNULL(`INTRA_FREQ_FAILURE_CNT`,0)) AS `INTRA_FREQ_FAILURE_CNT`,
		SUM(IFNULL(`4G_3G_ATTEMPT_CNT`,0)) AS `4G_3G_ATTEMPT_CNT`,
		SUM(IFNULL(`4G_3G_FAILURE_CNT`,0)) AS `4G_3G_FAILURE_CNT`,
		SUM(IFNULL(`4G_2G_ATTEMPT_CNT`,0)) AS `4G_2G_ATTEMPT_CNT`,
		SUM(IFNULL(`4G_2G_FAILURE_CNT`,0)) AS `4G_2G_FAILURE_CNT`,
		SUM(IFNULL(`MOVING_CALL_CNT`,0)) AS `MOVING_CALL_CNT`,
		SUM(IFNULL(`INDOOR_CALL_CNT`,0)) AS `INDOOR_CALL_CNT`,
		SUM(IFNULL(`PS_UL_VOLUME_SUM`,0)) AS `PS_UL_VOLUME_SUM`,
		SUM(IFNULL(`PS_DL_VOLUME_SUM`,0)) AS `PS_DL_VOLUME_SUM`,
		MAX(IFNULL(`PS_UL_SPEED_MAX`,0)) AS `PS_UL_SPEED_MAX`,
		MAX(IFNULL(`PS_DL_SPEED_MAX`,0)) AS `PS_DL_SPEED_MAX`,
		SUM(IFNULL(`FIRST_RSRP_SUM`,0)) AS `FIRST_RSRP_SUM`,
		SUM(IFNULL(`FIRST_RSRP_CNT`,0)) AS `FIRST_RSRP_CNT`,
		SUM(IFNULL(`FIRST_RSRQ_SUM`,0)) AS `FIRST_RSRQ_SUM`,
		SUM(IFNULL(`FIRST_RSRQ_CNT`,0)) AS `FIRST_RSRQ_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_SUM`,0)) AS `CALL_SETUP_TIME_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_CNT`,0)) AS `CALL_SETUP_TIME_CNT`,
	
		SUM(IFNULL(`CALL_SETUP_TIME_SIG_SUM`,0)) AS `CALL_SETUP_TIME_SIG_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_SIG_CNT`,0)) AS `CALL_SETUP_TIME_SIG_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_DATA_SUM`,0)) AS `CALL_SETUP_TIME_DATA_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_DATA_CNT`,0)) AS `CALL_SETUP_TIME_DATA_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_SMS_SUM`,0)) AS `CALL_SETUP_TIME_SMS_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_SMS_CNT`,0)) AS `CALL_SETUP_TIME_SMS_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_VOLTE_SUM`,0)) AS `CALL_SETUP_TIME_VOLTE_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_VOLTE_CNT`,0)) AS `CALL_SETUP_TIME_VOLTE_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_UNSP_SUM`,0)) AS `CALL_SETUP_TIME_UNSP_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_UNSP_CNT`,0)) AS `CALL_SETUP_TIME_UNSP_CNT`,
	
		SUM(IFNULL(`SF_CNT`,0)) AS `SF_CNT`,
		SUM(IFNULL(`SF_DATA_CNT`,0)) AS `SF_DATA_CNT`,
		SUM(IFNULL(`SF_SIGNAL_CNT`,0)) AS `SF_SIGNAL_CNT`,
		SUM(IFNULL(`SF_SMS_CNT`,0)) AS `SF_SMS_CNT`,
	
		SUM(IFNULL(`SF_SMS_MT_CNT`,0)) AS `SF_SMS_MT_CNT`,
		SUM(IFNULL(`SF_SMS_MO_CNT`,0)) AS `SF_SMS_MO_CNT`,
	
		SUM(IFNULL(`SF_VOLTE_CNT`,0)) AS `SF_VOLTE_CNT`,
		SUM(IFNULL(`SF_UNSPECIFIED_CNT`,0)) AS `SF_UNSPECIFIED_CNT`,
		SUM(IFNULL(`MT_DATA_CNT`,0)) AS `MT_DATA_CNT`,
		SUM(IFNULL(`MO_DATA_CNT`,0)) AS `MO_DATA_CNT`,
		SUM(IFNULL(`MT_SMS_CNT`,0)) AS `MT_SMS_CNT`,
		SUM(IFNULL(`MO_SMS_CNT`,0)) AS `MO_SMS_CNT`,
		SUM(IFNULL(`MT_VOLTE_CNT`,0)) AS `MT_VOLTE_CNT`,
		SUM(IFNULL(`MO_VOLTE_CNT`,0)) AS `MO_VOLTE_CNT`,
		SUM(IFNULL(`CSFB_SIGNAL_CNT`,0)) AS `CSFB_SIGNAL_CNT`,
		SUM(IFNULL(`CSFB_DATA_CNT`,0)) AS `CSFB_DATA_CNT`,
		SUM(IFNULL(`CSFB_SMS_CNT`,0)) AS `CSFB_SMS_CNT`,
		SUM(IFNULL(`CSFB_VOLTE_CNT`,0)) AS `CSFB_VOLTE_CNT`,
		SUM(IFNULL(`CSFB_UNSPECIFIED_CNT`,0)) AS `CSFB_UNSPECIFIED_CNT`,
		SUM(IFNULL(`CSFB_CNT`,0)) AS `CSFB_CNT`,
		SUM(IFNULL(`LATENCY_SUM`,0)) AS `LATENCY_SUM`,
		SUM(IFNULL(`LATENCY_CNT`,0)) AS `LATENCY_CNT`';
		
	DECLARE LTE_IMSI_UDP_STR VARCHAR(10000) DEFAULT 
		'RPT_TABLE_NAME.`CALL_CNT`=RPT_TABLE_NAME.`CALL_CNT`+VALUES(`CALL_CNT`),
		RPT_TABLE_NAME.`DATA_CNT`=RPT_TABLE_NAME.`DATA_CNT`+VALUES(`DATA_CNT`),
		RPT_TABLE_NAME.`SIGNAL_CNT`=RPT_TABLE_NAME.`SIGNAL_CNT`+VALUES(`SIGNAL_CNT`),
		RPT_TABLE_NAME.`SMS_CNT`=RPT_TABLE_NAME.`SMS_CNT`+VALUES(`SMS_CNT`),
		RPT_TABLE_NAME.`VOLTE_CNT`=RPT_TABLE_NAME.`VOLTE_CNT`+VALUES(`VOLTE_CNT`),
		RPT_TABLE_NAME.`UNSPECIFIED_CNT`=RPT_TABLE_NAME.`UNSPECIFIED_CNT`+VALUES(`UNSPECIFIED_CNT`),
		RPT_TABLE_NAME.`CALL_DUR_SUM`=RPT_TABLE_NAME.`CALL_DUR_SUM`+VALUES(`CALL_DUR_SUM`),
		RPT_TABLE_NAME.`DATA_DUR_SUM`=RPT_TABLE_NAME.`DATA_DUR_SUM`+VALUES(`DATA_DUR_SUM`),
		RPT_TABLE_NAME.`SIGNAL_DUR_SUM`=RPT_TABLE_NAME.`SIGNAL_DUR_SUM`+VALUES(`SIGNAL_DUR_SUM`),
		RPT_TABLE_NAME.`DROP_CNT`=RPT_TABLE_NAME.`DROP_CNT`+VALUES(`DROP_CNT`),
		RPT_TABLE_NAME.`DROP_DATA_CNT`=RPT_TABLE_NAME.`DROP_DATA_CNT`+VALUES(`DROP_DATA_CNT`),
		RPT_TABLE_NAME.`DROP_SIGNAL_CNT`=RPT_TABLE_NAME.`DROP_SIGNAL_CNT`+VALUES(`DROP_SIGNAL_CNT`),
		RPT_TABLE_NAME.`DROP_SMS_CNT`=RPT_TABLE_NAME.`DROP_SMS_CNT`+VALUES(`DROP_SMS_CNT`),
		RPT_TABLE_NAME.`DROP_VOLTE_CNT`=RPT_TABLE_NAME.`DROP_VOLTE_CNT`+VALUES(`DROP_VOLTE_CNT`),
		RPT_TABLE_NAME.`DROP_UNSPECIFIED_CNT`=RPT_TABLE_NAME.`DROP_UNSPECIFIED_CNT`+VALUES(`DROP_UNSPECIFIED_CNT`),
		RPT_TABLE_NAME.`BLOCK_CNT`=RPT_TABLE_NAME.`BLOCK_CNT`+VALUES(`BLOCK_CNT`),
		RPT_TABLE_NAME.`BLOCK_DATA_CNT`=RPT_TABLE_NAME.`BLOCK_DATA_CNT`+VALUES(`BLOCK_DATA_CNT`),
		RPT_TABLE_NAME.`BLOCK_SIGNAL_CNT`=RPT_TABLE_NAME.`BLOCK_SIGNAL_CNT`+VALUES(`BLOCK_SIGNAL_CNT`),
		RPT_TABLE_NAME.`BLOCK_SMS_CNT`=RPT_TABLE_NAME.`BLOCK_SMS_CNT`+VALUES(`BLOCK_SMS_CNT`),
	
		RPT_TABLE_NAME.`BLOCK_SMS_MT_CNT`=RPT_TABLE_NAME.`BLOCK_SMS_MT_CNT`+VALUES(`BLOCK_SMS_MT_CNT`),
		RPT_TABLE_NAME.`BLOCK_SMS_MO_CNT`=RPT_TABLE_NAME.`BLOCK_SMS_MO_CNT`+VALUES(`BLOCK_SMS_MO_CNT`),
	
		RPT_TABLE_NAME.`BLOCK_VOLTE_CNT`=RPT_TABLE_NAME.`BLOCK_VOLTE_CNT`+VALUES(`BLOCK_VOLTE_CNT`),
		RPT_TABLE_NAME.`BLOCK_UNSPECIFIED_CNT`=RPT_TABLE_NAME.`BLOCK_UNSPECIFIED_CNT`+VALUES(`BLOCK_UNSPECIFIED_CNT`),
		RPT_TABLE_NAME.`DROP_RDO_NW_CNT`=RPT_TABLE_NAME.`DROP_RDO_NW_CNT`+VALUES(`DROP_RDO_NW_CNT`),
		RPT_TABLE_NAME.`DROP_TRANS_CNT`=RPT_TABLE_NAME.`DROP_TRANS_CNT`+VALUES(`DROP_TRANS_CNT`),
		RPT_TABLE_NAME.`DROP_NAS_CNT`=RPT_TABLE_NAME.`DROP_NAS_CNT`+VALUES(`DROP_NAS_CNT`),
		RPT_TABLE_NAME.`DROP_MISC_CNT`=RPT_TABLE_NAME.`DROP_MISC_CNT`+VALUES(`DROP_MISC_CNT`),
		RPT_TABLE_NAME.`DROP_PROTOCOL_CNT`=RPT_TABLE_NAME.`DROP_PROTOCOL_CNT`+VALUES(DROP_PROTOCOL_CNT),
		RPT_TABLE_NAME.`INTER_FREQ_ATTEMPT_CNT`=RPT_TABLE_NAME.`INTER_FREQ_ATTEMPT_CNT`+VALUES(`INTER_FREQ_ATTEMPT_CNT`),
		RPT_TABLE_NAME.`INTER_FREQ_FAILURE_CNT`=RPT_TABLE_NAME.`INTER_FREQ_FAILURE_CNT`+VALUES(`INTER_FREQ_FAILURE_CNT`),
		RPT_TABLE_NAME.`INTRA_FREQ_ATTEMPT_CNT`=RPT_TABLE_NAME.`INTRA_FREQ_ATTEMPT_CNT`+VALUES(`INTRA_FREQ_ATTEMPT_CNT`),
		RPT_TABLE_NAME.`INTRA_FREQ_FAILURE_CNT`=RPT_TABLE_NAME.`INTRA_FREQ_FAILURE_CNT`+VALUES(`INTRA_FREQ_FAILURE_CNT`),
		RPT_TABLE_NAME.`4G_3G_ATTEMPT_CNT`=RPT_TABLE_NAME.`4G_3G_ATTEMPT_CNT`+VALUES(`4G_3G_ATTEMPT_CNT`),
		RPT_TABLE_NAME.`4G_3G_FAILURE_CNT`=RPT_TABLE_NAME.`4G_3G_FAILURE_CNT`+VALUES(`4G_3G_FAILURE_CNT`),
		RPT_TABLE_NAME.`4G_2G_ATTEMPT_CNT`=RPT_TABLE_NAME.`4G_2G_ATTEMPT_CNT`+VALUES(`4G_2G_ATTEMPT_CNT`),
		RPT_TABLE_NAME.`4G_2G_FAILURE_CNT`=RPT_TABLE_NAME.`4G_2G_FAILURE_CNT`+VALUES(`4G_2G_FAILURE_CNT`),
		RPT_TABLE_NAME.`MOVING_CALL_CNT`=RPT_TABLE_NAME.`MOVING_CALL_CNT`+VALUES(`MOVING_CALL_CNT`),
		RPT_TABLE_NAME.`INDOOR_CALL_CNT`=RPT_TABLE_NAME.`INDOOR_CALL_CNT`+VALUES(`INDOOR_CALL_CNT`),
		RPT_TABLE_NAME.`PS_UL_VOLUME_SUM`=RPT_TABLE_NAME.`PS_UL_VOLUME_SUM`+VALUES(`PS_UL_VOLUME_SUM`),
		RPT_TABLE_NAME.`PS_DL_VOLUME_SUM`=RPT_TABLE_NAME.`PS_DL_VOLUME_SUM`+VALUES(`PS_DL_VOLUME_SUM`),
		RPT_TABLE_NAME.PS_UL_SPEED_MAX=IF(RPT_TABLE_NAME.PS_UL_SPEED_MAX > VALUES(PS_UL_SPEED_MAX),RPT_TABLE_NAME.PS_UL_SPEED_MAX,VALUES(PS_UL_SPEED_MAX)),
		RPT_TABLE_NAME.PS_DL_SPEED_MAX=IF(RPT_TABLE_NAME.PS_DL_SPEED_MAX > VALUES(PS_DL_SPEED_MAX),RPT_TABLE_NAME.PS_DL_SPEED_MAX,VALUES(PS_DL_SPEED_MAX)),
		RPT_TABLE_NAME.`FIRST_RSRP_SUM`=RPT_TABLE_NAME.`FIRST_RSRP_SUM`+VALUES(`FIRST_RSRP_SUM`),
		RPT_TABLE_NAME.`FIRST_RSRP_CNT`=RPT_TABLE_NAME.`FIRST_RSRP_CNT`+VALUES(`FIRST_RSRP_CNT`),
		RPT_TABLE_NAME.`FIRST_RSRQ_SUM`=RPT_TABLE_NAME.`FIRST_RSRQ_SUM`+VALUES(`FIRST_RSRQ_SUM`),
		RPT_TABLE_NAME.`FIRST_RSRQ_CNT`=RPT_TABLE_NAME.`FIRST_RSRQ_CNT`+VALUES(`FIRST_RSRQ_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SUM`+VALUES(`CALL_SETUP_TIME_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_CNT`+VALUES(`CALL_SETUP_TIME_CNT`),
	
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_SUM`+VALUES(`CALL_SETUP_TIME_SIG_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_CNT`+VALUES(`CALL_SETUP_TIME_SIG_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_DATA_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_DATA_SUM`+VALUES(`CALL_SETUP_TIME_DATA_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_DATA_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_DATA_CNT`+VALUES(`CALL_SETUP_TIME_DATA_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_SUM`+VALUES(`CALL_SETUP_TIME_SMS_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_CNT`+VALUES(`CALL_SETUP_TIME_SMS_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_VOLTE_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_VOLTE_SUM`+VALUES(`CALL_SETUP_TIME_VOLTE_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_VOLTE_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_VOLTE_CNT`+VALUES(`CALL_SETUP_TIME_VOLTE_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_UNSP_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_UNSP_SUM`+VALUES(`CALL_SETUP_TIME_UNSP_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_UNSP_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_UNSP_CNT`+VALUES(`CALL_SETUP_TIME_UNSP_CNT`),
	
		RPT_TABLE_NAME.`SF_CNT`=RPT_TABLE_NAME.`SF_CNT`+VALUES(`SF_CNT`),
		RPT_TABLE_NAME.`SF_DATA_CNT`=RPT_TABLE_NAME.`SF_DATA_CNT`+VALUES(`SF_DATA_CNT`),
		RPT_TABLE_NAME.`SF_SIGNAL_CNT`=RPT_TABLE_NAME.`SF_SIGNAL_CNT`+VALUES(`SF_SIGNAL_CNT`),
		RPT_TABLE_NAME.`SF_SMS_CNT`=RPT_TABLE_NAME.`SF_SMS_CNT`+VALUES(`SF_SMS_CNT`),
	
		RPT_TABLE_NAME.`SF_SMS_MT_CNT`=RPT_TABLE_NAME.`SF_SMS_MT_CNT`+VALUES(`SF_SMS_MT_CNT`),
		RPT_TABLE_NAME.`SF_SMS_MO_CNT`=RPT_TABLE_NAME.`SF_SMS_MO_CNT`+VALUES(`SF_SMS_MO_CNT`),
		
		RPT_TABLE_NAME.`SF_VOLTE_CNT`=RPT_TABLE_NAME.`SF_VOLTE_CNT`+VALUES(`SF_VOLTE_CNT`),
		RPT_TABLE_NAME.`SF_UNSPECIFIED_CNT`=RPT_TABLE_NAME.`SF_UNSPECIFIED_CNT`+VALUES(`SF_UNSPECIFIED_CNT`),
		RPT_TABLE_NAME.`MT_DATA_CNT`=RPT_TABLE_NAME.`MT_DATA_CNT`+VALUES(`MT_DATA_CNT`),
		RPT_TABLE_NAME.`MO_DATA_CNT`=RPT_TABLE_NAME.`MO_DATA_CNT`+VALUES(`MO_DATA_CNT`),
		RPT_TABLE_NAME.`MT_SMS_CNT`=RPT_TABLE_NAME.`MT_SMS_CNT`+VALUES(`MT_SMS_CNT`),
		RPT_TABLE_NAME.`MO_SMS_CNT`=RPT_TABLE_NAME.`MO_SMS_CNT`+VALUES(`MO_SMS_CNT`),
		RPT_TABLE_NAME.`MT_VOLTE_CNT`=RPT_TABLE_NAME.`MT_VOLTE_CNT`+VALUES(`MT_VOLTE_CNT`),
		RPT_TABLE_NAME.`MO_VOLTE_CNT`=RPT_TABLE_NAME.`MO_VOLTE_CNT`+VALUES(`MO_VOLTE_CNT`),
		RPT_TABLE_NAME.`CSFB_SIGNAL_CNT`=RPT_TABLE_NAME.`CSFB_SIGNAL_CNT`+VALUES(`CSFB_SIGNAL_CNT`),
		RPT_TABLE_NAME.`CSFB_DATA_CNT`=RPT_TABLE_NAME.`CSFB_DATA_CNT`+VALUES(`CSFB_DATA_CNT`),
		RPT_TABLE_NAME.`CSFB_SMS_CNT`=RPT_TABLE_NAME.`CSFB_SMS_CNT`+VALUES(`CSFB_SMS_CNT`),
		RPT_TABLE_NAME.`CSFB_VOLTE_CNT`=RPT_TABLE_NAME.`CSFB_VOLTE_CNT`+VALUES(`CSFB_VOLTE_CNT`),
		RPT_TABLE_NAME.`CSFB_UNSPECIFIED_CNT`=RPT_TABLE_NAME.`CSFB_UNSPECIFIED_CNT`+VALUES(`CSFB_UNSPECIFIED_CNT`),
		RPT_TABLE_NAME.`CSFB_CNT`=RPT_TABLE_NAME.`CSFB_CNT`+VALUES(`CSFB_CNT`),
		RPT_TABLE_NAME.`LATENCY_SUM`=RPT_TABLE_NAME.`LATENCY_SUM`+VALUES(`LATENCY_SUM`),
		RPT_TABLE_NAME.`LATENCY_CNT`=RPT_TABLE_NAME.`LATENCY_CNT`+VALUES(`LATENCY_CNT`)';
			
	DECLARE GSM_IMSI_COLUMN_STR VARCHAR(1500) DEFAULT 
		'CALL_CNT,
		VOICE_MO_CNT,
		VOICE_MT_CNT,
		DATA_MO_CNT,
		DATA_MT_CNT,
		SMS_MO_CNT,
		SMS_MT_CNT,
		SIGNAL_CNT,
		CALL_DUR_SUM,
		VOICE_DUR_SUM,
		DATA_DUR_SUM,
		DROP_CNT,
		DROP_VOICE_CNT,
		DROP_GPRS_CNT,
		DROP_SMS_CNT,
		DROP_SIGNAL_CNT,
		DROP_OTHER_CNT,
		BLOCK_CNT,
		BLOCK_VOICE_CNT,
		BLOCK_GPRS_CNT,
		BLOCK_SMS_CNT,
		BLOCK_SMS_MT_CNT,
		BLOCK_SMS_MO_CNT,
		BLOCK_SIGNAL_CNT,
		BLOCK_OTHER_CNT,
		HO_ATTEMPT_CNT,
		HO_FAILURE_CNT,
		MOVING_CALL_CNT,
		INDOOR_CALL_CNT,
		FIRST_RXLEV_DL_SUM,
		FIRST_RXLEV_DL_CNT,
		FIRST_RXQUAL_DL_SUM,
		FIRST_RXQUAL_DL_CNT,
		FIRST_RXLEV_UL_SUM,
		FIRST_RXLEV_UL_CNT,
		FIRST_RXQUAL_UL_SUM,
		FIRST_RXQUAL_UL_CNT,
		CALL_SETUP_TIME_SUM,
		CALL_SETUP_TIME_CNT,
		CALL_SETUP_TIME_VOICE_SUM,
		CALL_SETUP_TIME_VOICE_CNT,
		CALL_SETUP_TIME_SIG_SUM,
		CALL_SETUP_TIME_SIG_CNT,
		CALL_SETUP_TIME_SMS_SUM,
		CALL_SETUP_TIME_SMS_CNT,
		CALL_SETUP_TIME_GPRS_SUM,
		CALL_SETUP_TIME_GPRS_CNT,	
		CALL_SETUP_TIME_OTH_SUM,
		CALL_SETUP_TIME_OTH_CNT,
		SF_VOICE_CNT,
		SF_GPRS_CNT,
		SF_SMS_CNT,
		SF_SMS_MT_CNT,
		SF_SMS_MO_CNT,
		SF_SIGNAL_CNT,
		SF_OTHER_CNT';
		  
	DECLARE GSM_IMSI_IFNULL_STR VARCHAR(3000) DEFAULT 
		'IFNULL(CALL_CNT,0) AS CALL_CNT,
		IFNULL(VOICE_MO_CNT,0) AS VOICE_MO_CNT,
		IFNULL(VOICE_MT_CNT,0) AS VOICE_MT_CNT,
		IFNULL(DATA_MO_CNT,0) AS DATA_MO_CNT,
		IFNULL(DATA_MT_CNT,0) AS DATA_MT_CNT,
		IFNULL(SMS_MO_CNT,0) AS SMS_MO_CNT,
		IFNULL(SMS_MT_CNT,0) AS SMS_MT_CNT,
		IFNULL(SIGNAL_CNT,0) AS SIGNAL_CNT,
		IFNULL(CALL_DUR_SUM,0) AS CALL_DUR_SUM,
		IFNULL(VOICE_DUR_SUM,0) AS VOICE_DUR_SUM,
		IFNULL(DATA_DUR_SUM,0) AS DATA_DUR_SUM,
		IFNULL(DROP_CNT,0) AS DROP_CNT,
		IFNULL(DROP_VOICE_CNT,0) AS DROP_VOICE_CNT,
		IFNULL(DROP_GPRS_CNT,0) AS DROP_GPRS_CNT,
		IFNULL(DROP_SMS_CNT,0) AS DROP_SMS_CNT,
		IFNULL(DROP_SIGNAL_CNT,0) AS DROP_SIGNAL_CNT,
		IFNULL(DROP_OTHER_CNT,0) AS DROP_OTHER_CNT,
		IFNULL(BLOCK_CNT,0) AS BLOCK_CNT,
		IFNULL(BLOCK_VOICE_CNT,0) AS BLOCK_VOICE_CNT,
		IFNULL(BLOCK_GPRS_CNT,0) AS BLOCK_GPRS_CNT,
		IFNULL(BLOCK_SMS_CNT,0) AS BLOCK_SMS_CNT,
	
		IFNULL(BLOCK_SMS_MT_CNT,0) AS BLOCK_SMS_MT_CNT,
		IFNULL(BLOCK_SMS_MO_CNT,0) AS BLOCK_SMS_MO_CNT,
			
		IFNULL(BLOCK_SIGNAL_CNT,0) AS BLOCK_SIGNAL_CNT,
		IFNULL(BLOCK_OTHER_CNT,0) AS BLOCK_OTHER_CNT,
		IFNULL(HO_ATTEMPT_CNT,0) AS HO_ATTEMPT_CNT,
		IFNULL(HO_FAILURE_CNT,0) AS HO_FAILURE_CNT,
		IFNULL(MOVING_CALL_CNT,0) AS MOVING_CALL_CNT,
		IFNULL(INDOOR_CALL_CNT,0) AS INDOOR_CALL_CNT,
		IFNULL(FIRST_RXLEV_DL_SUM,0) AS FIRST_RXLEV_DL_SUM,
		IFNULL(FIRST_RXLEV_DL_CNT,0) AS FIRST_RXLEV_DL_CNT,
		IFNULL(FIRST_RXQUAL_DL_SUM,0) AS FIRST_RXQUAL_DL_SUM,
		IFNULL(FIRST_RXQUAL_DL_CNT,0) AS FIRST_RXQUAL_DL_CNT,
		IFNULL(FIRST_RXLEV_UL_SUM,0) AS FIRST_RXLEV_UL_SUM,
		IFNULL(FIRST_RXLEV_UL_CNT,0) AS FIRST_RXLEV_UL_CNT,
		IFNULL(FIRST_RXQUAL_UL_SUM,0) AS FIRST_RXQUAL_UL_SUM,
		IFNULL(FIRST_RXQUAL_UL_CNT,0) AS FIRST_RXQUAL_UL_CNT,
		IFNULL(CALL_SETUP_TIME_SUM,0) AS CALL_SETUP_TIME_SUM,
		IFNULL(CALL_SETUP_TIME_CNT,0) AS CALL_SETUP_TIME_CNT,
	
		IFNULL(`CALL_SETUP_TIME_VOICE_SUM`,0) AS `CALL_SETUP_TIME_VOICE_SUM`,
		IFNULL(`CALL_SETUP_TIME_VOICE_CNT`,0) AS `CALL_SETUP_TIME_VOICE_CNT`,
		IFNULL(`CALL_SETUP_TIME_SIG_SUM`,0) AS `CALL_SETUP_TIME_SIG_SUM`,
		IFNULL(`CALL_SETUP_TIME_SIG_CNT`,0) AS `CALL_SETUP_TIME_SIG_CNT`,
		IFNULL(`CALL_SETUP_TIME_SMS_SUM`,0) AS `CALL_SETUP_TIME_SMS_SUM`,
		IFNULL(`CALL_SETUP_TIME_SMS_CNT`,0) AS `CALL_SETUP_TIME_SMS_CNT`,
		IFNULL(`CALL_SETUP_TIME_GPRS_SUM`,0) AS `CALL_SETUP_TIME_GPRS_SUM`,
		IFNULL(`CALL_SETUP_TIME_GPRS_CNT`,0) AS `CALL_SETUP_TIME_GPRS_CNT`,
		IFNULL(`CALL_SETUP_TIME_OTH_SUM`,0) AS `CALL_SETUP_TIME_OTH_SUM`,
		IFNULL(`CALL_SETUP_TIME_OTH_CNT`,0) AS `CALL_SETUP_TIME_OTH_CNT`,
	
		IFNULL(SF_VOICE_CNT,0) AS SF_VOICE_CNT,
		IFNULL(SF_GPRS_CNT,0) AS SF_GPRS_CNT,
		IFNULL(SF_SMS_CNT,0) AS SF_SMS_CNT,
	
		IFNULL(SF_SMS_MT_CNT,0) AS SF_SMS_MT_CNT,
		IFNULL(SF_SMS_MO_CNT,0) AS SF_SMS_MO_CNT,		
	
		IFNULL(SF_SIGNAL_CNT,0) AS SF_SIGNAL_CNT,
		IFNULL(SF_OTHER_CNT,0) AS SF_OTHER_CNT';
		
	DECLARE GSM_IMSI_SUM_STR VARCHAR(3500) DEFAULT 
		'SUM(IFNULL(CALL_CNT,0)) AS CALL_CNT,
		SUM(IFNULL(VOICE_MO_CNT,0)) AS VOICE_MO_CNT,
		SUM(IFNULL(VOICE_MT_CNT,0)) AS VOICE_MT_CNT,
		SUM(IFNULL(DATA_MO_CNT,0)) AS DATA_MO_CNT,
		SUM(IFNULL(DATA_MT_CNT,0)) AS DATA_MT_CNT,
		SUM(IFNULL(SMS_MO_CNT,0)) AS SMS_MO_CNT,
		SUM(IFNULL(SMS_MT_CNT,0)) AS SMS_MT_CNT,
		SUM(IFNULL(SIGNAL_CNT,0)) AS SIGNAL_CNT,
		SUM(IFNULL(CALL_DUR_SUM,0)) AS CALL_DUR_SUM,
		SUM(IFNULL(VOICE_DUR_SUM,0)) AS VOICE_DUR_SUM,
		SUM(IFNULL(DATA_DUR_SUM,0)) AS DATA_DUR_SUM,
		SUM(IFNULL(DROP_CNT,0)) AS DROP_CNT,
		SUM(IFNULL(DROP_VOICE_CNT,0)) AS DROP_VOICE_CNT,
		SUM(IFNULL(DROP_GPRS_CNT,0)) AS DROP_GPRS_CNT,
		SUM(IFNULL(DROP_SMS_CNT,0)) AS DROP_SMS_CNT,
		SUM(IFNULL(DROP_SIGNAL_CNT,0)) AS DROP_SIGNAL_CNT,
		SUM(IFNULL(DROP_OTHER_CNT,0)) AS DROP_OTHER_CNT,
		SUM(IFNULL(BLOCK_CNT,0)) AS BLOCK_CNT,
		SUM(IFNULL(BLOCK_VOICE_CNT,0)) AS BLOCK_VOICE_CNT,
		SUM(IFNULL(BLOCK_GPRS_CNT,0)) AS BLOCK_GPRS_CNT,
		SUM(IFNULL(BLOCK_SMS_CNT,0)) AS BLOCK_SMS_CNT,
	
		SUM(IFNULL(BLOCK_SMS_MT_CNT,0)) AS BLOCK_SMS_MT_CNT,
		SUM(IFNULL(BLOCK_SMS_MO_CNT,0)) AS BLOCK_SMS_MO_CNT,
	
		SUM(IFNULL(BLOCK_SIGNAL_CNT,0)) AS BLOCK_SIGNAL_CNT,
		SUM(IFNULL(BLOCK_OTHER_CNT,0)) AS BLOCK_OTHER_CNT,
		SUM(IFNULL(HO_ATTEMPT_CNT,0)) AS HO_ATTEMPT_CNT,
		SUM(IFNULL(HO_FAILURE_CNT,0)) AS HO_FAILURE_CNT,
		SUM(IFNULL(MOVING_CALL_CNT,0)) AS MOVING_CALL_CNT,
		SUM(IFNULL(INDOOR_CALL_CNT,0)) AS INDOOR_CALL_CNT,
		SUM(IFNULL(FIRST_RXLEV_DL_SUM,0)) AS FIRST_RXLEV_DL_SUM,
		SUM(IFNULL(FIRST_RXLEV_DL_CNT,0)) AS FIRST_RXLEV_DL_CNT,
		SUM(IFNULL(FIRST_RXQUAL_DL_SUM,0)) AS FIRST_RXQUAL_DL_SUM,
		SUM(IFNULL(FIRST_RXQUAL_DL_CNT,0)) AS FIRST_RXQUAL_DL_CNT,
		SUM(IFNULL(FIRST_RXLEV_UL_SUM,0)) AS FIRST_RXLEV_UL_SUM,
		SUM(IFNULL(FIRST_RXLEV_UL_CNT,0)) AS FIRST_RXLEV_UL_CNT,
		SUM(IFNULL(FIRST_RXQUAL_UL_SUM,0)) AS FIRST_RXQUAL_UL_SUM,
		SUM(IFNULL(FIRST_RXQUAL_UL_CNT,0)) AS FIRST_RXQUAL_UL_CNT,
		SUM(IFNULL(CALL_SETUP_TIME_SUM,0)) AS CALL_SETUP_TIME_SUM,
		SUM(IFNULL(CALL_SETUP_TIME_CNT,0)) AS CALL_SETUP_TIME_CNT,
	
		SUM(IFNULL(`CALL_SETUP_TIME_VOICE_SUM`,0)) AS `CALL_SETUP_TIME_VOICE_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_VOICE_CNT`,0)) AS `CALL_SETUP_TIME_VOICE_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_SIG_SUM`,0)) AS `CALL_SETUP_TIME_SIG_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_SIG_CNT`,0)) AS `CALL_SETUP_TIME_SIG_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_SMS_SUM`,0)) AS `CALL_SETUP_TIME_SMS_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_SMS_CNT`,0)) AS `CALL_SETUP_TIME_SMS_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_GPRS_SUM`,0)) AS `CALL_SETUP_TIME_GPRS_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_GPRS_CNT`,0)) AS `CALL_SETUP_TIME_GPRS_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_OTH_SUM`,0)) AS `CALL_SETUP_TIME_OTH_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_OTH_CNT`,0)) AS `CALL_SETUP_TIME_OTH_CNT`,
	
		SUM(IFNULL(SF_VOICE_CNT,0)) AS SF_VOICE_CNT,
		SUM(IFNULL(SF_GPRS_CNT,0)) AS SF_GPRS_CNT,
		SUM(IFNULL(SF_SMS_CNT,0)) AS SF_SMS_CNT,
	
		SUM(IFNULL(SF_SMS_MT_CNT,0)) AS SF_SMS_MT_CNT,
		SUM(IFNULL(SF_SMS_MO_CNT,0)) AS SF_SMS_MO_CNT,
			
		SUM(IFNULL(SF_SIGNAL_CNT,0)) AS SF_SIGNAL_CNT,
		SUM(IFNULL(SF_OTHER_CNT,0)) AS SF_OTHER_CNT';
		
	DECLARE GSM_IMSI_UDP_STR VARCHAR(10000) DEFAULT 
		'RPT_TABLE_NAME.CALL_CNT=RPT_TABLE_NAME.CALL_CNT+VALUES(CALL_CNT),
		RPT_TABLE_NAME.VOICE_MO_CNT=RPT_TABLE_NAME.VOICE_MO_CNT+VALUES(VOICE_MO_CNT),
		RPT_TABLE_NAME.VOICE_MT_CNT=RPT_TABLE_NAME.VOICE_MT_CNT+VALUES(VOICE_MT_CNT),
		RPT_TABLE_NAME.DATA_MO_CNT=RPT_TABLE_NAME.DATA_MO_CNT+VALUES(DATA_MO_CNT),
		RPT_TABLE_NAME.DATA_MT_CNT=RPT_TABLE_NAME.DATA_MT_CNT+VALUES(DATA_MT_CNT),
		RPT_TABLE_NAME.SMS_MO_CNT=RPT_TABLE_NAME.SMS_MO_CNT+VALUES(SMS_MO_CNT),
		RPT_TABLE_NAME.SMS_MT_CNT=RPT_TABLE_NAME.SMS_MT_CNT+VALUES(SMS_MT_CNT),
		RPT_TABLE_NAME.SIGNAL_CNT=RPT_TABLE_NAME.SIGNAL_CNT+VALUES(SIGNAL_CNT),
		RPT_TABLE_NAME.CALL_DUR_SUM=RPT_TABLE_NAME.CALL_DUR_SUM+VALUES(CALL_DUR_SUM),
		RPT_TABLE_NAME.VOICE_DUR_SUM=RPT_TABLE_NAME.VOICE_DUR_SUM+VALUES(VOICE_DUR_SUM),
		RPT_TABLE_NAME.DATA_DUR_SUM=RPT_TABLE_NAME.DATA_DUR_SUM+VALUES(DATA_DUR_SUM),
		RPT_TABLE_NAME.DROP_CNT=RPT_TABLE_NAME.DROP_CNT+VALUES(DROP_CNT),
		RPT_TABLE_NAME.DROP_VOICE_CNT=RPT_TABLE_NAME.DROP_VOICE_CNT+VALUES(DROP_VOICE_CNT),
		RPT_TABLE_NAME.DROP_GPRS_CNT=RPT_TABLE_NAME.DROP_GPRS_CNT+VALUES(DROP_GPRS_CNT),
		RPT_TABLE_NAME.DROP_SMS_CNT=RPT_TABLE_NAME.DROP_SMS_CNT+VALUES(DROP_SMS_CNT),
		RPT_TABLE_NAME.DROP_SIGNAL_CNT=RPT_TABLE_NAME.DROP_SIGNAL_CNT+VALUES(DROP_SIGNAL_CNT),
		RPT_TABLE_NAME.DROP_OTHER_CNT=RPT_TABLE_NAME.DROP_OTHER_CNT+VALUES(DROP_OTHER_CNT),
		RPT_TABLE_NAME.BLOCK_CNT=RPT_TABLE_NAME.BLOCK_CNT+VALUES(BLOCK_CNT),
		RPT_TABLE_NAME.BLOCK_VOICE_CNT=RPT_TABLE_NAME.BLOCK_VOICE_CNT+VALUES(BLOCK_VOICE_CNT),
		RPT_TABLE_NAME.BLOCK_GPRS_CNT=RPT_TABLE_NAME.BLOCK_GPRS_CNT+VALUES(BLOCK_GPRS_CNT),
		RPT_TABLE_NAME.BLOCK_SMS_CNT=RPT_TABLE_NAME.BLOCK_SMS_CNT+VALUES(BLOCK_SMS_CNT),
	
		RPT_TABLE_NAME.BLOCK_SMS_MT_CNT=RPT_TABLE_NAME.BLOCK_SMS_MT_CNT+VALUES(BLOCK_SMS_MT_CNT),
		RPT_TABLE_NAME.BLOCK_SMS_MO_CNT=RPT_TABLE_NAME.BLOCK_SMS_MO_CNT+VALUES(BLOCK_SMS_MO_CNT),
	
		RPT_TABLE_NAME.BLOCK_SIGNAL_CNT=RPT_TABLE_NAME.BLOCK_SIGNAL_CNT+VALUES(BLOCK_SIGNAL_CNT),
		RPT_TABLE_NAME.BLOCK_OTHER_CNT=RPT_TABLE_NAME.BLOCK_OTHER_CNT+VALUES(BLOCK_OTHER_CNT),
		RPT_TABLE_NAME.HO_ATTEMPT_CNT=RPT_TABLE_NAME.HO_ATTEMPT_CNT+VALUES(HO_ATTEMPT_CNT),
		RPT_TABLE_NAME.HO_FAILURE_CNT=RPT_TABLE_NAME.HO_FAILURE_CNT+VALUES(HO_FAILURE_CNT),
		RPT_TABLE_NAME.MOVING_CALL_CNT=RPT_TABLE_NAME.MOVING_CALL_CNT+VALUES(MOVING_CALL_CNT),
		RPT_TABLE_NAME.INDOOR_CALL_CNT=RPT_TABLE_NAME.INDOOR_CALL_CNT+VALUES(INDOOR_CALL_CNT),
		RPT_TABLE_NAME.FIRST_RXLEV_DL_SUM=RPT_TABLE_NAME.FIRST_RXLEV_DL_SUM+VALUES(FIRST_RXLEV_DL_SUM),
		RPT_TABLE_NAME.FIRST_RXLEV_DL_CNT=RPT_TABLE_NAME.FIRST_RXLEV_DL_CNT+VALUES(FIRST_RXLEV_DL_CNT),
		RPT_TABLE_NAME.FIRST_RXQUAL_DL_SUM=RPT_TABLE_NAME.FIRST_RXQUAL_DL_SUM+VALUES(FIRST_RXQUAL_DL_SUM),
		RPT_TABLE_NAME.FIRST_RXQUAL_DL_CNT=RPT_TABLE_NAME.FIRST_RXQUAL_DL_CNT+VALUES(FIRST_RXQUAL_DL_CNT),
		RPT_TABLE_NAME.FIRST_RXLEV_UL_SUM=RPT_TABLE_NAME.FIRST_RXLEV_UL_SUM+VALUES(FIRST_RXLEV_UL_SUM),
		RPT_TABLE_NAME.FIRST_RXLEV_UL_CNT=RPT_TABLE_NAME.FIRST_RXLEV_UL_CNT+VALUES(FIRST_RXLEV_UL_CNT),
		RPT_TABLE_NAME.FIRST_RXQUAL_UL_SUM=RPT_TABLE_NAME.FIRST_RXQUAL_UL_SUM+VALUES(FIRST_RXQUAL_UL_SUM),
		RPT_TABLE_NAME.FIRST_RXQUAL_UL_CNT=RPT_TABLE_NAME.FIRST_RXQUAL_UL_CNT+VALUES(FIRST_RXQUAL_UL_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_SUM+VALUES(CALL_SETUP_TIME_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_CNT+VALUES(CALL_SETUP_TIME_CNT),
	
		RPT_TABLE_NAME.`CALL_SETUP_TIME_VOICE_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_VOICE_SUM`+VALUES(`CALL_SETUP_TIME_VOICE_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_VOICE_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_VOICE_CNT`+VALUES(`CALL_SETUP_TIME_VOICE_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_SUM`+VALUES(`CALL_SETUP_TIME_SIG_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_CNT`+VALUES(`CALL_SETUP_TIME_SIG_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_SUM`+VALUES(`CALL_SETUP_TIME_SMS_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_CNT`+VALUES(`CALL_SETUP_TIME_SMS_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_GPRS_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_GPRS_SUM`+VALUES(`CALL_SETUP_TIME_GPRS_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_GPRS_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_GPRS_CNT`+VALUES(`CALL_SETUP_TIME_GPRS_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_OTH_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_OTH_SUM`+VALUES(`CALL_SETUP_TIME_OTH_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_OTH_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_OTH_CNT`+VALUES(`CALL_SETUP_TIME_OTH_CNT`),
	
		RPT_TABLE_NAME.SF_VOICE_CNT=RPT_TABLE_NAME.SF_VOICE_CNT+VALUES(SF_VOICE_CNT),
		RPT_TABLE_NAME.SF_GPRS_CNT=RPT_TABLE_NAME.SF_GPRS_CNT+VALUES(SF_GPRS_CNT),
		RPT_TABLE_NAME.SF_SMS_CNT=RPT_TABLE_NAME.SF_SMS_CNT+VALUES(SF_SMS_CNT),
	
		RPT_TABLE_NAME.SF_SMS_MT_CNT=RPT_TABLE_NAME.SF_SMS_MT_CNT+VALUES(SF_SMS_MT_CNT),
		RPT_TABLE_NAME.SF_SMS_MO_CNT=RPT_TABLE_NAME.SF_SMS_MO_CNT+VALUES(SF_SMS_MO_CNT),
	
		RPT_TABLE_NAME.SF_SIGNAL_CNT=RPT_TABLE_NAME.SF_SIGNAL_CNT+VALUES(SF_SIGNAL_CNT),
		RPT_TABLE_NAME.SF_OTHER_CNT=RPT_TABLE_NAME.SF_OTHER_CNT+VALUES(SF_OTHER_CNT)';
	DECLARE IMSI_CELL_UMTS_TMP_COLUMN_STR VARCHAR(1000) DEFAULT 	
		CASE WHEN IMSI_CELL=1 THEN ',`START_TILE_ID`,`END_TILE_ID`,`START_CELL_ID`,`START_SITE_ID`,`END_CELL_ID`,`END_SITE_ID`' ELSE '' END;
	DECLARE IMSI_CELL_LTE_TMP_COLUMN_STR VARCHAR(1000) DEFAULT 
		CASE WHEN IMSI_CELL=1 THEN ',`START_TILE_ID`,`END_TILE_ID`,`START_CELL_ID`,`START_ENODEB_ID`,`END_CELL_ID`,`END_ENODEB_ID`' ELSE '' END;
	DECLARE IMSI_CELL_GSM_TMP_COLUMN_STR VARCHAR(1000) DEFAULT 
		CASE WHEN IMSI_CELL=1 THEN ',`START_TILE_ID`,`END_TILE_ID`,`START_CELL_ID`,`START_SITE_ID`,`END_CELL_ID`,`END_SITE_ID`' ELSE '' END;
		
	DECLARE IMSI_CELL_UMTS_COLUMN_STR VARCHAR(1000) DEFAULT 
		CASE WHEN IMSI_CELL=1 THEN ',`START_CELL_ID`,`START_SITE_ID`,`START_REG_1_ID`,`START_REG_2_ID`,`START_REG_3_ID`,`END_CELL_ID`,`END_SITE_ID`,`END_REG_1_ID`,`END_REG_2_ID`,`END_REG_3_ID`' ELSE '' END;
	DECLARE IMSI_CELL_LTE_COLUMN_STR VARCHAR(1000) DEFAULT 	
		CASE WHEN IMSI_CELL=1 THEN ',`START_CELL_ID`,`START_ENODEB_ID`,`START_REG_1_ID`,`START_REG_2_ID`,`START_REG_3_ID`,`END_CELL_ID`,`END_ENODEB_ID`,`END_REG_1_ID`,`END_REG_2_ID`,`END_REG_3_ID`' ELSE '' END;
	DECLARE IMSI_CELL_GSM_COLUMN_STR VARCHAR(1000) DEFAULT 
		CASE WHEN IMSI_CELL=1 THEN ',`START_CELL_ID`,`START_SITE_ID`,`START_REG_1_ID`,`START_REG_2_ID`,`START_REG_3_ID`,`END_CELL_ID`,`END_SITE_ID`,`END_REG_1_ID`,`END_REG_2_ID`,`END_REG_3_ID`' ELSE '' END;
	
	DECLARE IMSI_CELL_UMTS_UDP_STR VARCHAR(10000) DEFAULT 
		CASE WHEN IMSI_CELL=1 THEN ',RPT_TABLE_NAME.START_CELL_ID=IF(RPT_TABLE_NAME.START_CELL_ID IS NULL,VALUES(START_CELL_ID),RPT_TABLE_NAME.START_CELL_ID),
		RPT_TABLE_NAME.START_SITE_ID=IF(RPT_TABLE_NAME.START_SITE_ID IS NULL,VALUES(START_SITE_ID),RPT_TABLE_NAME.START_SITE_ID),
		RPT_TABLE_NAME.START_REG_1_ID=IF(RPT_TABLE_NAME.START_REG_1_ID IS NULL,VALUES(START_REG_1_ID),RPT_TABLE_NAME.START_REG_1_ID),
		RPT_TABLE_NAME.START_REG_2_ID=IF(RPT_TABLE_NAME.START_REG_2_ID IS NULL,VALUES(START_REG_2_ID),RPT_TABLE_NAME.START_REG_2_ID),
		RPT_TABLE_NAME.START_REG_3_ID=IF(RPT_TABLE_NAME.START_REG_3_ID IS NULL,VALUES(START_REG_3_ID),RPT_TABLE_NAME.START_REG_3_ID),
		RPT_TABLE_NAME.END_CELL_ID=IF(RPT_TABLE_NAME.END_CELL_ID IS NULL,VALUES(END_CELL_ID),RPT_TABLE_NAME.END_CELL_ID),
		RPT_TABLE_NAME.END_SITE_ID=IF(RPT_TABLE_NAME.END_SITE_ID IS NULL,VALUES(END_SITE_ID),RPT_TABLE_NAME.END_SITE_ID),
		RPT_TABLE_NAME.END_REG_1_ID=IF(RPT_TABLE_NAME.END_REG_1_ID IS NULL,VALUES(END_REG_1_ID),RPT_TABLE_NAME.END_REG_1_ID),
		RPT_TABLE_NAME.END_REG_2_ID=IF(RPT_TABLE_NAME.END_REG_2_ID IS NULL,VALUES(END_REG_2_ID),RPT_TABLE_NAME.END_REG_2_ID),
		RPT_TABLE_NAME.END_REG_3_ID=IF(RPT_TABLE_NAME.END_REG_3_ID IS NULL,VALUES(END_REG_3_ID),RPT_TABLE_NAME.END_REG_3_ID)' ELSE '' END;
	DECLARE IMSI_CELL_LTE_UDP_STR VARCHAR(10000) DEFAULT 
		CASE WHEN IMSI_CELL=1 THEN ',RPT_TABLE_NAME.START_CELL_ID=IF(RPT_TABLE_NAME.START_CELL_ID IS NULL,VALUES(START_CELL_ID),RPT_TABLE_NAME.START_CELL_ID),
		RPT_TABLE_NAME.START_ENODEB_ID=IF(RPT_TABLE_NAME.START_ENODEB_ID IS NULL,VALUES(START_ENODEB_ID),RPT_TABLE_NAME.START_ENODEB_ID),
		RPT_TABLE_NAME.START_REG_1_ID=IF(RPT_TABLE_NAME.START_REG_1_ID IS NULL,VALUES(START_REG_1_ID),RPT_TABLE_NAME.START_REG_1_ID),
		RPT_TABLE_NAME.START_REG_2_ID=IF(RPT_TABLE_NAME.START_REG_2_ID IS NULL,VALUES(START_REG_2_ID),RPT_TABLE_NAME.START_REG_2_ID),
		RPT_TABLE_NAME.START_REG_3_ID=IF(RPT_TABLE_NAME.START_REG_3_ID IS NULL,VALUES(START_REG_3_ID),RPT_TABLE_NAME.START_REG_3_ID),
		RPT_TABLE_NAME.END_CELL_ID=IF(RPT_TABLE_NAME.END_CELL_ID IS NULL,VALUES(END_CELL_ID),RPT_TABLE_NAME.END_CELL_ID),
		RPT_TABLE_NAME.END_ENODEB_ID=IF(RPT_TABLE_NAME.END_ENODEB_ID IS NULL,VALUES(END_ENODEB_ID),RPT_TABLE_NAME.END_ENODEB_ID),
		RPT_TABLE_NAME.END_REG_1_ID=IF(RPT_TABLE_NAME.END_REG_1_ID IS NULL,VALUES(END_REG_1_ID),RPT_TABLE_NAME.END_REG_1_ID),
		RPT_TABLE_NAME.END_REG_2_ID=IF(RPT_TABLE_NAME.END_REG_2_ID IS NULL,VALUES(END_REG_2_ID),RPT_TABLE_NAME.END_REG_2_ID),
		RPT_TABLE_NAME.END_REG_3_ID=IF(RPT_TABLE_NAME.END_REG_3_ID IS NULL,VALUES(END_REG_3_ID),RPT_TABLE_NAME.END_REG_3_ID)' ELSE '' END;
		
	DECLARE IMSI_CELL_GSM_UDP_STR VARCHAR(10000) DEFAULT 
		CASE WHEN IMSI_CELL=1 THEN ',RPT_TABLE_NAME.START_CELL_ID=IF(RPT_TABLE_NAME.START_CELL_ID IS NULL,VALUES(START_CELL_ID),RPT_TABLE_NAME.START_CELL_ID),
		RPT_TABLE_NAME.START_SITE_ID=IF(RPT_TABLE_NAME.START_SITE_ID IS NULL,VALUES(START_SITE_ID),RPT_TABLE_NAME.START_SITE_ID),
		RPT_TABLE_NAME.START_REG_1_ID=IF(RPT_TABLE_NAME.START_REG_1_ID IS NULL,VALUES(START_REG_1_ID),RPT_TABLE_NAME.START_REG_1_ID),
		RPT_TABLE_NAME.START_REG_2_ID=IF(RPT_TABLE_NAME.START_REG_2_ID IS NULL,VALUES(START_REG_2_ID),RPT_TABLE_NAME.START_REG_2_ID),
		RPT_TABLE_NAME.START_REG_3_ID=IF(RPT_TABLE_NAME.START_REG_3_ID IS NULL,VALUES(START_REG_3_ID),RPT_TABLE_NAME.START_REG_3_ID),
		RPT_TABLE_NAME.END_CELL_ID=IF(RPT_TABLE_NAME.END_CELL_ID IS NULL,VALUES(END_CELL_ID),RPT_TABLE_NAME.END_CELL_ID),
		RPT_TABLE_NAME.END_SITE_ID=IF(RPT_TABLE_NAME.END_SITE_ID IS NULL,VALUES(END_SITE_ID),RPT_TABLE_NAME.END_SITE_ID),
		RPT_TABLE_NAME.END_REG_1_ID=IF(RPT_TABLE_NAME.END_REG_1_ID IS NULL,VALUES(END_REG_1_ID),RPT_TABLE_NAME.END_REG_1_ID),
		RPT_TABLE_NAME.END_REG_2_ID=IF(RPT_TABLE_NAME.END_REG_2_ID IS NULL,VALUES(END_REG_2_ID),RPT_TABLE_NAME.END_REG_2_ID),
		RPT_TABLE_NAME.END_REG_3_ID=IF(RPT_TABLE_NAME.END_REG_3_ID IS NULL,VALUES(END_REG_3_ID),RPT_TABLE_NAME.END_REG_3_ID)' ELSE '' END;
	
	DECLARE CONTINUE HANDLER FOR SQLEXCEPTION
	BEGIN
		SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS `gt_global_statistic`.`nw_error_log`
				(
				  `TABLE_NAME` VARCHAR(50) NOT NULL,
				  `SP_NAME` VARCHAR(50) DEFAULT NULL,
				  `INSERT_CMD` VARCHAR(100) DEFAULT NULL,
				  `INSERT_TIME` DATETIME DEFAULT NULL
				) ENGINE=MYISAM;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		INSERT INTO `gt_global_statistic`.`nw_error_log`(`TABLE_NAME`,`SP_NAME`,`INSERT_CMD`,`INSERT_TIME`)
		VALUES (@SOURCE_TABLE_NAME,
			'SP_Generate_Global_Statistic_Sub_imsi_Aggr',
			CONCAT('Step ',@ERROR_FLAG,' error'),
			NOW());
	
		SET @SqlCmd=CONCAT('REPAIR TABLE ',@REPAIR_TABLE_NAME,';');				
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		SET @SqlCmd=CONCAT('SELECT  GROUP_CONCAT(DISTINCT CONCAT(TABLE_NAME)) INTO @DROP_TABLE_LIST
					FROM information_schema.TABLES 
					WHERE TABLE_SCHEMA=''gt_aggregate_db''
					AND TABLE_NAME<>''tmp_dim_handset''
					AND TABLE_NAME <> ''',@tmp_imsi_gsm_hr,'''
					AND TABLE_NAME <> ''',@tmp_imsi_umts_hr,'''
					AND TABLE_NAME <> ''',@tmp_imsi_lte_hr,''';');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		
		SET @v_i=1;
		SET @Quotient_v=1;
		SET @v_R_Max=(CHAR_LENGTH(@DROP_TABLE_LIST) - CHAR_LENGTH(REPLACE(@DROP_TABLE_LIST,',','')))/(CHAR_LENGTH(','))+1;	
		WHILE @v_i <= @v_R_Max DO
		BEGIN
			SET @DROP_TABLE=gt_strtok(@DROP_TABLE_LIST,@v_i,',');
			
			SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS gt_aggregate_db.',@DROP_TABLE,' ;');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
	
		SET @v_i=@v_i+@Quotient_v;	
		END;
		END WHILE;
	
		SELECT '{tech:ALL , name:SP-NW, status:2,message_id: null, message: Nationwide imsi report aggregate failed, log_path: /data/covmo_log/SPN}' AS message;	
		
	END;	
			
 	CALL gt_gw_main.`SP_Sub_Set_Session_Param_LTE`('');
  	
	SET @global_db='gt_global_statistic';
	SET @FLAG_IMSI_HR=0;
	SET @FLAG_IMSI_DY=0;
	SET @FLAG_MAKE_HR=0;
	SET @FLAG_MAKE_DY=0;
	SET @FLAG_IMSI_WK=0;
	SET @FLAG_IMSI_MN=0;
	SET @FLAG_MAKE_WK=0;
	SET @FLAG_MAKE_MN=0;
	SET @FLAG_IMSI_LTE_HR=0;
	SET @FLAG_IMSI_LTE_DY=0;
	SET @FLAG_MAKE_LTE_HR=0;
	SET @FLAG_MAKE_LTE_DY=0;
	SET @FLAG_IMSI_LTE_WK=0;
	SET @FLAG_IMSI_LTE_MN=0;
	SET @FLAG_MAKE_LTE_WK=0;
	SET @FLAG_MAKE_LTE_MN=0;
	
	SET SHARE_IP ='127.0.0.1';
	SELECT `VARIABLE_VALUE` INTO SHARE_PORT FROM `information_schema`.`GLOBAL_VARIABLES` WHERE VARIABLE_NAME = 'port';
	SET SHARE_ACCOUNT ='covmo';
	SET SHARE_PW='covmo123';
	SET SHARE_DB='gt_aggregate_db';
	
	INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_imsi_Aggr','START', START_TIME);
	SET STEP_START_TIME := SYSDATE();
	
	IF FLAG IN (1,0) THEN 	
		SET @SqlCmd=CONCAT('SELECT GROUP_CONCAT(DISTINCT CONCAT(`DATA_DATE`,'','',`DATA_HOUR`,'','',`TECH_MASK`) SEPARATOR ''|'' ) INTO @PU_STR
					FROM ',@global_db,'.tmp_table_call_cnt_',WORKER_ID,' 
					WHERE TECH_MASK=',TECH_MASK,';');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT GROUP_CONCAT(DISTINCT `group_id` ORDER BY `group_id` SEPARATOR ''|'' ) INTO @REG_GROUP FROM ',@global_db,'.`usr_polygon_reg_3`;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;	
	
		SET @SqlCmd=CONCAT('SELECT att_value INTO @usr_def_polygon_group_id FROM gt_global_statistic.nw_config WHERE group_name= ''system'' AND att_name=''USR_DEFINE_POLYGON_GROUP_ID'';');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT att_value INTO @usr_def_polygon FROM gt_global_statistic.nw_config WHERE group_name= ''system'' AND att_name=''USR_DEFINE_POLYGON'';');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
			
		SET @v_reg_m=1;
		SET @v_reg_Max=gt_covmo_csv_count(@REG_GROUP,'|');
		WHILE @v_reg_m <= @v_reg_Max DO
		BEGIN
			SET v_group_db_name=CONCAT('gt_global_statistic_g',gt_strtok(@REG_GROUP, @v_reg_m, '|'));
					
			SET @v_i=1;
			SET @v_R_Max=gt_covmo_csv_count(@PU_STR,'|');
			
			WHILE @v_i <= @v_R_Max DO
			BEGIN	
			
			IF gt_strtok(@REG_GROUP, @v_reg_m, '|') <> @usr_def_polygon_group_id or @usr_def_polygon_group_id IS NULL THEN
	
				SET v_DATA_DATE:=gt_covmo_csv_get(gt_strtok(@PU_STR, @v_i, '|'),1);		
				SET v_DATA_HOUR:=gt_covmo_csv_get(gt_strtok(@PU_STR, @v_i, '|'),2);
				SET v_TECH_MASK:=gt_covmo_csv_get(gt_strtok(@PU_STR, @v_i, '|'),3);	
				SELECT `DAY_OF_WEEK`(v_DATA_DATE) INTO @DAY_OF_WEEK;
				SET @FIRST_DAY=gt_strtok(@DAY_OF_WEEK, 1, '|');
				SET @END_DAY=gt_strtok(@DAY_OF_WEEK, 2, '|');
				SET @DATE_WK=CONCAT(DATE_FORMAT(@FIRST_DAY,'%Y%m%d'),'_',DATE_FORMAT(@END_DAY,'%Y%m%d'));
				SET @DATE_MN=DATE_FORMAT(v_DATA_DATE,'%Y%m');
				SET @DATE_DY=DATE_FORMAT(v_DATA_DATE,'%Y%m%d');
				SET @EX_DATE=CONCAT(DATE_FORMAT(v_DATA_DATE,'%Y%m%d_'),v_DATA_HOUR,'_',WORKER_ID);
		
				SET @tmp_imsi_gsm_hr=CONCAT('tmp_imsi_gsm_hr_',@EX_DATE);
				SET @tmp_imsi_umts_hr=CONCAT('tmp_imsi_umts_hr_',@EX_DATE);
				SET @tmp_imsi_lte_hr=CONCAT('tmp_imsi_lte_hr_',@EX_DATE);
				
				SET @table_imsi_gsm_hr=CONCAT('table_imsi_gsm_hr_',@DATE_DY);		
				SET @table_handset_gsm_hr=CONCAT('table_handset_gsm_hr_',@DATE_DY);
				SET @table_imsi_gsm_dy=CONCAT('table_imsi_gsm_dy_',@DATE_DY);
				SET @table_handset_gsm_dy=CONCAT('table_handset_gsm_dy_',@DATE_DY);
				SET @table_imsi_gsm_wk=CONCAT('table_imsi_gsm_wk_',@DATE_WK);
				SET @table_handset_gsm_wk=CONCAT('table_handset_gsm_wk_',@DATE_WK);
				SET @table_imsi_gsm_mn=CONCAT('table_imsi_gsm_mn_',@DATE_MN);
				SET @table_handset_gsm_mn=CONCAT('table_handset_gsm_mn_',@DATE_MN);
							
				SET @table_imsi_umts_hr=CONCAT('table_imsi_umts_hr_',@DATE_DY);
				SET @table_handset_umts_hr=CONCAT('table_handset_umts_hr_',@DATE_DY);
				SET @table_imsi_umts_dy=CONCAT('table_imsi_umts_dy_',@DATE_DY);
				SET @table_handset_umts_dy=CONCAT('table_handset_umts_dy_',@DATE_DY);
				SET @table_imsi_umts_wk=CONCAT('table_imsi_umts_wk_',@DATE_WK);
				SET @table_handset_umts_wk=CONCAT('table_handset_umts_wk_',@DATE_WK);
				SET @table_imsi_umts_mn=CONCAT('table_imsi_umts_mn_',@DATE_MN);
				SET @table_handset_umts_mn=CONCAT('table_handset_umts_mn_',@DATE_MN);
				
				SET @table_imsi_lte_hr=CONCAT('table_imsi_lte_hr_',@DATE_DY);
				SET @table_handset_lte_hr=CONCAT('table_handset_lte_hr_',@DATE_DY);
				SET @table_imsi_lte_dy=CONCAT('table_imsi_lte_dy_',@DATE_DY);
				SET @table_handset_lte_dy=CONCAT('table_handset_lte_dy_',@DATE_DY);
				SET @table_imsi_lte_wk=CONCAT('table_imsi_lte_wk_',@DATE_WK);
				SET @table_handset_lte_wk=CONCAT('table_handset_lte_wk_',@DATE_WK);
				SET @table_imsi_lte_mn=CONCAT('table_imsi_lte_mn_',@DATE_MN);
				SET @table_handset_lte_mn=CONCAT('table_handset_lte_mn_',@DATE_MN);
	
				IF v_TECH_MASK=1 THEN  
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@tmp_imsi_gsm_hr,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
		
					SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@tmp_imsi_gsm_hr,' LIKE ',@global_db,'.tmp_imsi_gsm_',@EX_DATE,';');				
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
	
					SET @SOURCE_TABLE_NAME=@tmp_imsi_gsm_hr;
					SET @ERROR_FLAG=CONCAT(SHARE_DB,'.',@tmp_imsi_gsm_hr,' DATA_HOUR=',v_DATA_HOUR);
					SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@tmp_imsi_gsm_hr,' 
							    (`IMSI`,
							     `DATA_DATE`,
							     `DATA_HOUR`,
							     ',GSM_IMSI_COLUMN_STR,',
							     `MAKE_ID`,
							     `MODEL_ID`
							     ',IMSI_CELL_GSM_TMP_COLUMN_STR,')
							SELECT
							  `IMSI`,
							  `DATA_DATE`,
							  `DATA_HOUR`,
							  ',GSM_IMSI_SUM_STR,',
							  `MAKE_ID`,
							  `MODEL_ID`
							  ',IMSI_CELL_GSM_TMP_COLUMN_STR,'
							FROM ',@global_db,'.tmp_imsi_gsm_',@EX_DATE,' 
							GROUP BY `IMSI`,`DATA_DATE`,`DATA_HOUR`
							ORDER BY NULL;');
	
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
			
					IF IMSI_CELL=1 THEN						
						CALL gt_global_statistic.SP_Generate_Global_Statistic_Sub_Tile_Reg_Map(CONCAT(SHARE_DB,'.',@tmp_imsi_gsm_hr),WORKER_ID,1,gt_strtok(@REG_GROUP, @v_reg_m, '|'),'0','0','0');
					END IF;
			
					SET @SqlCmd=CONCAT('CREATE INDEX IX_model_id ON ',SHARE_DB,'.',@tmp_imsi_gsm_hr,' (`make_id`,`model_id`);');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@tmp_imsi_gsm_hr,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
					SET STEP_START_TIME := SYSDATE();
					
					SET @SqlCmd=CONCAT(' UPDATE ',SHARE_DB,'.',@tmp_imsi_gsm_hr,' A, 
								gt_aggregate_db.tmp_dim_handset B
								SET A.MAKE_MODEL=B.MAKE_MODEL
								WHERE A.MAKE_ID=B.MAKE_ID
								AND A.MODEL_ID=B.MODEL_ID
								;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt; 
					
					IF FLAG IN (0,1) THEN 	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_imsi_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_imsi_gsm_hr,' LIKE ',v_group_db_name,'.',@table_imsi_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_imsi_gsm_hr;		
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_imsi_gsm_hr);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_imsi_gsm_hr,' DATA_HOUR=',v_DATA_HOUR);
	
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_imsi_gsm_hr,' 
								    (`IMSI`,
								     `DATA_DATE`,
								     `DATA_HOUR`,
								     ',GSM_IMSI_COLUMN_STR,',
								     `MAKE_ID`,
								     `MODEL_ID`
								     ',IMSI_CELL_GSM_COLUMN_STR,')
								SELECT
									`IMSI`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',GSM_IMSI_IFNULL_STR,',
									`MAKE_ID`,
									`MODEL_ID`
								     ',IMSI_CELL_GSM_COLUMN_STR,'
								FROM ',SHARE_DB,'.',@tmp_imsi_gsm_hr
								,CASE PENDING_FLAG WHEN 1 THEN 
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(GSM_IMSI_UDP_STR,'RPT_TABLE_NAME',@table_imsi_gsm_hr),',
									',@table_imsi_gsm_hr,'.MAKE_ID= VALUES(MAKE_ID),
									',@table_imsi_gsm_hr,'.MODEL_ID= VALUES(MODEL_ID)
									',REPLACE(IMSI_CELL_GSM_UDP_STR,'RPT_TABLE_NAME',@table_imsi_gsm_hr))
								ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SOURCE_TABLE_NAME=CONCAT(@table_imsi_gsm_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_imsi_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						SET @FLAG_IMSI_HR=1;		
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_imsi_gsm_hr,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @SOURCE_TABLE_NAME=@table_imsi_gsm_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_imsi_gsm_dy);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_imsi_gsm_dy,' DATA_HOUR=',v_DATA_HOUR);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);			
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_imsi_gsm_dy,' 
								    (`IMSI`,
								     `DATA_DATE`,
								     ',GSM_IMSI_COLUMN_STR,',
								     `MAKE_ID`,
								     `MODEL_ID`
								     ',IMSI_CELL_GSM_COLUMN_STR,')
								SELECT
									`IMSI`,
									`DATA_DATE`,
									',GSM_IMSI_IFNULL_STR,',
									`MAKE_ID`,
									`MODEL_ID`
								     ',IMSI_CELL_GSM_COLUMN_STR,'
								FROM ',SHARE_DB,'.',@tmp_imsi_gsm_hr,
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(GSM_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_gsm_dy)),',
									',SHARE_DB,'.',@table_imsi_gsm_dy,'.MAKE_ID= VALUES(MAKE_ID),
									',SHARE_DB,'.',@table_imsi_gsm_dy,'.MODEL_ID= VALUES(MODEL_ID)
									',REPLACE(IMSI_CELL_GSM_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_gsm_dy)))
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_imsi_gsm_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
								
						SET @FLAG_IMSI_DY=1;	
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_imsi_gsm_dy,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_handset_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_handset_gsm_hr,' LIKE ',v_group_db_name,'.',@table_handset_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_handset_gsm_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_handset_gsm_hr);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_handset_gsm_hr,' DATA_HOUR=',v_DATA_HOUR);
	
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_handset_gsm_hr,' 
								    (
									`MAKE_ID`,
									`MODEL_ID`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',GSM_IMSI_COLUMN_STR,',
									`MAKE_MODEL`)
								SELECT
									`MAKE_ID`,
									`MODEL_ID`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',GSM_IMSI_SUM_STR,',
									`MAKE_MODEL`
								FROM ',SHARE_DB,'.',@tmp_imsi_gsm_hr,' 
								WHERE `MAKE_ID` IS NOT NULL AND `MODEL_ID` IS NOT NULL
								GROUP BY `MAKE_ID`,`MODEL_ID`,`DATA_DATE`,`DATA_HOUR`
								ORDER BY NULL '
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(GSM_IMSI_UDP_STR,'RPT_TABLE_NAME',@table_handset_gsm_hr),',
									',@table_handset_gsm_hr,'.MAKE_MODEL= VALUES(MAKE_MODEL)')
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_handset_gsm_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_handset_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_MAKE_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_handset_gsm_hr,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @SOURCE_TABLE_NAME=@table_handset_gsm_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_handset_gsm_dy);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_handset_gsm_dy,' DATA_HOUR=',v_DATA_HOUR);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_handset_gsm_dy,' 
								    (
									`MAKE_ID`,
									`MODEL_ID`,
									`DATA_DATE`,
									',GSM_IMSI_COLUMN_STR,',
									`MAKE_MODEL`)
								SELECT
									`MAKE_ID`,
									`MODEL_ID`,
									`DATA_DATE`,
									',GSM_IMSI_SUM_STR,',
									`MAKE_MODEL`
								FROM ',SHARE_DB,'.',@tmp_imsi_gsm_hr,' 
								WHERE `MAKE_ID` IS NOT NULL AND `MODEL_ID` IS NOT NULL
								GROUP BY `MAKE_ID`,`MODEL_ID`,`DATA_DATE`
								ORDER BY NULL ',
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(GSM_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_handset_gsm_dy)),',
									',SHARE_DB,'.',@table_handset_gsm_dy,'.MAKE_MODEL= VALUES(MAKE_MODEL)')
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_handset_gsm_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
								
						SET @FLAG_MAKE_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_handset_gsm_dy,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
					END IF;
		
					IF FLAG = 0 THEN 
						SET @SOURCE_TABLE_NAME=@table_imsi_gsm_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_imsi_gsm_wk);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_imsi_gsm_wk);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
							
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_imsi_gsm_wk,' 
								    (`IMSI`,
									',GSM_IMSI_COLUMN_STR,',
									`MAKE_ID`,
									`MODEL_ID`
								     ',IMSI_CELL_GSM_COLUMN_STR,')
								SELECT
									`IMSI`,
									',GSM_IMSI_IFNULL_STR,',
									`MAKE_ID`,
									`MODEL_ID`
								     ',IMSI_CELL_GSM_COLUMN_STR,'
								FROM ',SHARE_DB,'.',@tmp_imsi_gsm_hr,
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(GSM_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_gsm_wk)),',
									',SHARE_DB,'.',@table_imsi_gsm_wk,'.MAKE_ID= VALUES(MAKE_ID),
									',SHARE_DB,'.',@table_imsi_gsm_wk,'.MODEL_ID= VALUES(MODEL_ID)
									',REPLACE(IMSI_CELL_GSM_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_gsm_wk)))
								,';');	
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_imsi_gsm_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_IMSI_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_imsi_gsm_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_imsi_gsm_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_imsi_gsm_mn);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_imsi_gsm_mn);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_imsi_gsm_mn,' 
								    (`IMSI`,
									',GSM_IMSI_COLUMN_STR,',
									`MAKE_ID`,
									`MODEL_ID`
								     ',IMSI_CELL_GSM_COLUMN_STR,')
								SELECT
									`IMSI`,
									',GSM_IMSI_IFNULL_STR,',
									`MAKE_ID`,
									`MODEL_ID`
								     ',IMSI_CELL_GSM_COLUMN_STR,'
								FROM ',SHARE_DB,'.',@tmp_imsi_gsm_hr,
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(GSM_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_gsm_mn)),',
									',SHARE_DB,'.',@table_imsi_gsm_mn,'.MAKE_ID= VALUES(MAKE_ID),
									',SHARE_DB,'.',@table_imsi_gsm_mn,'.MODEL_ID= VALUES(MODEL_ID)
									',REPLACE(IMSI_CELL_GSM_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_gsm_mn)))
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_imsi_gsm_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_IMSI_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_imsi_gsm_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @SOURCE_TABLE_NAME=@table_handset_gsm_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_handset_gsm_wk);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_handset_gsm_wk);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_handset_gsm_wk,' 
								    (
									`MAKE_ID`,
									`MODEL_ID`,
									',GSM_IMSI_COLUMN_STR,',
									`MAKE_MODEL`)
								SELECT
									`MAKE_ID`,
									`MODEL_ID`,
									',GSM_IMSI_SUM_STR,',
									`MAKE_MODEL`
								FROM ',SHARE_DB,'.',@tmp_imsi_gsm_hr,' 
								WHERE `MAKE_ID` IS NOT NULL AND `MODEL_ID` IS NOT NULL
								GROUP BY `MAKE_ID`,`MODEL_ID`
								ORDER BY NULL ',
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(GSM_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_handset_gsm_wk)),',
									',SHARE_DB,'.',@table_handset_gsm_wk,'.MAKE_MODEL= VALUES(MAKE_MODEL)')
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_handset_gsm_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_MAKE_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_handset_gsm_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_handset_gsm_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_handset_gsm_mn);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_handset_gsm_mn);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_handset_gsm_mn,' 
									(
									`MAKE_ID`,
									`MODEL_ID`,
									',GSM_IMSI_COLUMN_STR,',
									`MAKE_MODEL`)
								SELECT
									`MAKE_ID`,
									`MODEL_ID`,
									',GSM_IMSI_SUM_STR,',
									`MAKE_MODEL`
								FROM ',SHARE_DB,'.',@tmp_imsi_gsm_hr,' 
								WHERE `MAKE_ID` IS NOT NULL AND `MODEL_ID` IS NOT NULL
								GROUP BY `MAKE_ID`,`MODEL_ID`
								ORDER BY NULL ',
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(GSM_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_handset_gsm_mn)),',
									',SHARE_DB,'.',@table_handset_gsm_mn,'.MAKE_MODEL= VALUES(MAKE_MODEL)')
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;		
						
						SET @SOURCE_TABLE_NAME=@table_handset_gsm_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_MAKE_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_handset_gsm_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
					END IF;
			
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@tmp_imsi_gsm_hr,';');					
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt; 
					
					SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.tmp_table_call_cnt_',WORKER_ID,' A
						SET 
						  A.`FLAG_IMSI_HR` = ',@FLAG_IMSI_HR,',
						  A.`FLAG_IMSI_DY` = ',@FLAG_IMSI_DY,',
						  A.`FLAG_MAKE_HR` = ',@FLAG_MAKE_HR,',
						  A.`FLAG_MAKE_DY` = ',@FLAG_MAKE_DY,',
						  A.`FLAG_IMSI_WK` = ',@FLAG_IMSI_WK,',
						  A.`FLAG_IMSI_MN` = ',@FLAG_IMSI_MN,',
						  A.`FLAG_MAKE_WK` = ',@FLAG_MAKE_WK,',
						  A.`FLAG_MAKE_MN` = ',@FLAG_MAKE_MN,'
						WHERE A.`TECH_MASK`=1 ;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT table_call_cnt_history,',WORKER_ID,' - ',gt_strtok(@REG_GROUP, @v_reg_m, '|'),' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
					SET STEP_START_TIME := SYSDATE();
				END IF;
					
				IF v_TECH_MASK=2 THEN  
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@tmp_imsi_umts_hr,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
		
					SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@tmp_imsi_umts_hr,' LIKE ',@global_db,'.tmp_imsi_umts_',@EX_DATE,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
	
					SET @SOURCE_TABLE_NAME=@tmp_imsi_umts_hr;
					SET @ERROR_FLAG=CONCAT(SHARE_DB,'.',@tmp_imsi_umts_hr,' DATA_HOUR=',v_DATA_HOUR);
	
					SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@tmp_imsi_umts_hr,' 
								(`IMSI`,
								`DATA_DATE`,
								`DATA_HOUR`,
								',UMTS_IMSI_COLUMN_STR,',
								`MAKE_ID`,
								`MODEL_ID`
								',IMSI_CELL_UMTS_TMP_COLUMN_STR,')
							SELECT
								`IMSI`,
								`DATA_DATE`,
								`DATA_HOUR`,
								',UMTS_IMSI_SUM_STR,',
								`MAKE_ID`,
								`MODEL_ID`
								',IMSI_CELL_UMTS_TMP_COLUMN_STR,'
							FROM ',@global_db,'.tmp_imsi_umts_',@EX_DATE,' 
							GROUP BY `IMSI`, `DATA_DATE`,`DATA_HOUR`
							ORDER BY NULL;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@tmp_imsi_umts_hr,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
					SET STEP_START_TIME := SYSDATE();
				
					IF IMSI_CELL=1 THEN 
						CALL gt_global_statistic.SP_Generate_Global_Statistic_Sub_Tile_Reg_Map(CONCAT(SHARE_DB,'.',@tmp_imsi_umts_hr),WORKER_ID,1,gt_strtok(@REG_GROUP, @v_reg_m, '|'),'0','0','0');
						
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('Update region ',@tmp_imsi_umts_hr,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
					END IF;
					SET @SqlCmd=CONCAT('CREATE INDEX IX_model_id ON ',SHARE_DB,'.',@tmp_imsi_umts_hr,' (`make_id`,`model_id`);');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('CREATE INDEX IX_model_id ',@tmp_imsi_umts_hr,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
					SET STEP_START_TIME := SYSDATE();
					
					SET @SqlCmd=CONCAT('UPDATE ',SHARE_DB,'.',@tmp_imsi_umts_hr,' A, 
								gt_aggregate_db.tmp_dim_handset B
								SET A.MAKE_MODEL=B.MAKE_MODEL
								WHERE A.MAKE_ID=B.MAKE_ID
								AND A.MODEL_ID=B.MODEL_ID
								;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
			
					IF FLAG IN (0,1) THEN	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_imsi_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_imsi_umts_hr,' LIKE ',v_group_db_name,'.',@table_imsi_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_imsi_umts_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_imsi_umts_hr);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_imsi_umts_hr,' DATA_HOUR=',v_DATA_HOUR);
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_imsi_umts_hr,' 
								    (`IMSI`,
								     `DATA_DATE`,
								     `DATA_HOUR`,
								     ',UMTS_IMSI_COLUMN_STR,',
								     `MAKE_ID`,
								     `MODEL_ID`
								     ',IMSI_CELL_UMTS_COLUMN_STR,')
								SELECT
									`IMSI`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',UMTS_IMSI_IFNULL_STR,',
									`MAKE_ID`,
									`MODEL_ID`
									',IMSI_CELL_UMTS_COLUMN_STR,'
								FROM ',SHARE_DB,'.',@tmp_imsi_umts_hr
								,CASE PENDING_FLAG WHEN 1 THEN 
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(UMTS_IMSI_UDP_STR,'RPT_TABLE_NAME',@table_imsi_umts_hr),',
									',@table_imsi_umts_hr,'.MAKE_ID= VALUES(MAKE_ID),
									',@table_imsi_umts_hr,'.MODEL_ID= VALUES(MODEL_ID)
									',REPLACE(IMSI_CELL_UMTS_UDP_STR,'RPT_TABLE_NAME',@table_imsi_umts_hr))
								ELSE '' END
								,';');	
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_imsi_umts_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_imsi_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
					
						SET @FLAG_IMSI_HR=1;		
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_imsi_umts_hr,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @SOURCE_TABLE_NAME=@table_imsi_umts_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_imsi_umts_dy);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_imsi_umts_dy,' DATA_HOUR=',v_DATA_HOUR);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						 
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_imsi_umts_dy,' 
								    (`IMSI`,
								     `DATA_DATE`,
								     ',UMTS_IMSI_COLUMN_STR,',
								     `MAKE_ID`,
								     `MODEL_ID`
								     ',IMSI_CELL_UMTS_COLUMN_STR,')
								SELECT
									`IMSI`,
									`DATA_DATE`,
									',UMTS_IMSI_IFNULL_STR,',
									`MAKE_ID`,
									`MODEL_ID`
								     ',IMSI_CELL_UMTS_COLUMN_STR,'
								FROM ',SHARE_DB,'.',@tmp_imsi_umts_hr,
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(UMTS_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_umts_dy)),',
									',SHARE_DB,'.',@table_imsi_umts_dy,'.MAKE_ID= VALUES(MAKE_ID),
									',SHARE_DB,'.',@table_imsi_umts_dy,'.MODEL_ID= VALUES(MODEL_ID)
									',REPLACE(IMSI_CELL_UMTS_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_umts_dy)))
								,';');	
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_imsi_umts_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
								
						SET @FLAG_IMSI_DY=1;	
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_imsi_umts_dy,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
			
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_handset_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_handset_umts_hr,' LIKE ',v_group_db_name,'.',@table_handset_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_handset_umts_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_handset_umts_hr);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_handset_umts_hr,' DATA_HOUR=',v_DATA_HOUR);
	
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_handset_umts_hr,'
								    (
									`MAKE_ID`,
									`MODEL_ID`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',UMTS_IMSI_COLUMN_STR,',
									`MAKE_MODEL`)
								SELECT
									`MAKE_ID`,
									`MODEL_ID`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',UMTS_IMSI_SUM_STR,',
									`MAKE_MODEL`
								FROM ',SHARE_DB,'.',@tmp_imsi_umts_hr,' 
								WHERE `MAKE_ID` IS NOT NULL AND `MODEL_ID` IS NOT NULL
								GROUP BY `MAKE_ID`,`MODEL_ID`,`DATA_DATE`,`DATA_HOUR`
								ORDER BY NULL '
								,CASE PENDING_FLAG WHEN 1 THEN 
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(UMTS_IMSI_UDP_STR,'RPT_TABLE_NAME',@table_handset_umts_hr),',
								',@table_handset_umts_hr,'.MAKE_MODEL= VALUES(MAKE_MODEL)')
								ELSE '' END
								,';');	
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_handset_umts_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_handset_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @FLAG_MAKE_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_handset_umts_hr,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @SOURCE_TABLE_NAME=@table_handset_umts_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_handset_umts_dy);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_handset_umts_dy,' DATA_HOUR=',v_DATA_HOUR);
	
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_handset_umts_dy,' 
								    (
									`MAKE_ID`,
									`MODEL_ID`,
									`DATA_DATE`,
									',UMTS_IMSI_COLUMN_STR,',
									`MAKE_MODEL`)
								SELECT
									`MAKE_ID`,
									`MODEL_ID`,
									`DATA_DATE`,
									',UMTS_IMSI_SUM_STR,',
									`MAKE_MODEL`
								FROM ',SHARE_DB,'.',@tmp_imsi_umts_hr,' 
								WHERE `MAKE_ID` IS NOT NULL AND `MODEL_ID` IS NOT NULL
								GROUP BY `MAKE_ID`,`MODEL_ID`,`DATA_DATE`
								ORDER BY NULL ',
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(UMTS_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_handset_umts_dy)),',
								',SHARE_DB,'.',@table_handset_umts_dy,'.MAKE_MODEL= VALUES(MAKE_MODEL)')
								,';');	
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_handset_umts_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
								
						SET @FLAG_MAKE_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_handset_umts_dy,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
					END IF;
		
					IF FLAG = 0 THEN 
						SET @SOURCE_TABLE_NAME=@table_imsi_umts_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_imsi_umts_wk);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_imsi_umts_wk);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
	
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_imsi_umts_wk,' 
								    (`IMSI`,
								     ',UMTS_IMSI_COLUMN_STR,',
								     `MAKE_ID`,
								     `MODEL_ID`
								     ',IMSI_CELL_UMTS_COLUMN_STR,')
								SELECT
									`IMSI`,
									',UMTS_IMSI_IFNULL_STR,',
									`MAKE_ID`,
									`MODEL_ID`
									',IMSI_CELL_UMTS_COLUMN_STR,'
								FROM ',SHARE_DB,'.',@tmp_imsi_umts_hr,
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(UMTS_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_umts_wk)),',
									',SHARE_DB,'.',@table_imsi_umts_wk,'.MAKE_ID= VALUES(MAKE_ID),
									',SHARE_DB,'.',@table_imsi_umts_wk,'.MODEL_ID= VALUES(MODEL_ID)
									',REPLACE(IMSI_CELL_UMTS_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_umts_wk)))
								,';');	
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_imsi_umts_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_IMSI_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_imsi_umts_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
							
						SET @SOURCE_TABLE_NAME=@table_imsi_umts_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_imsi_umts_mn);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_imsi_umts_mn);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_imsi_umts_mn,' 
								    (`IMSI`,
								     ',UMTS_IMSI_COLUMN_STR,',
								     `MAKE_ID`,
								     `MODEL_ID`
								     ',IMSI_CELL_UMTS_COLUMN_STR,')
								SELECT
									`IMSI`,
									',UMTS_IMSI_IFNULL_STR,',
									`MAKE_ID`,
									`MODEL_ID`
									',IMSI_CELL_UMTS_COLUMN_STR,'
								FROM ',SHARE_DB,'.',@tmp_imsi_umts_hr,
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(UMTS_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_umts_mn)),',
									',SHARE_DB,'.',@table_imsi_umts_mn,'.MAKE_ID= VALUES(MAKE_ID),
									',SHARE_DB,'.',@table_imsi_umts_mn,'.MODEL_ID= VALUES(MODEL_ID)
									',REPLACE(IMSI_CELL_UMTS_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_umts_mn)))
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;	
								
						SET @SOURCE_TABLE_NAME=@table_imsi_umts_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
							
						SET @FLAG_IMSI_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_imsi_umts_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_handset_umts_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_handset_umts_wk);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_handset_umts_wk);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_handset_umts_wk,' 
									(
									`MAKE_ID`,
									`MODEL_ID`,
									',UMTS_IMSI_COLUMN_STR,',
									`MAKE_MODEL`)
								SELECT
									`MAKE_ID`,
									`MODEL_ID`,
									',UMTS_IMSI_SUM_STR,',
									`MAKE_MODEL`
								FROM ',SHARE_DB,'.',@tmp_imsi_umts_hr,' 
								WHERE `MAKE_ID` IS NOT NULL AND `MODEL_ID` IS NOT NULL
								GROUP BY `MAKE_ID`,`MODEL_ID`
								ORDER BY NULL ',
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(UMTS_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_handset_umts_wk)),',
								',SHARE_DB,'.',@table_handset_umts_wk,'.MAKE_MODEL= VALUES(MAKE_MODEL)')
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_handset_umts_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_MAKE_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_handset_umts_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_handset_umts_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_handset_umts_mn);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_handset_umts_mn);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_handset_umts_mn,' 
									(
									`MAKE_ID`,
									`MODEL_ID`,
									',UMTS_IMSI_COLUMN_STR,',
									`MAKE_MODEL`)
								SELECT
									`MAKE_ID`,
									`MODEL_ID`,
									',UMTS_IMSI_SUM_STR,',
									`MAKE_MODEL`
								FROM ',SHARE_DB,'.',@tmp_imsi_umts_hr,' 
								WHERE `MAKE_ID` IS NOT NULL AND `MODEL_ID` IS NOT NULL
								GROUP BY `MAKE_ID`,`MODEL_ID`
								ORDER BY NULL ',
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(UMTS_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_handset_umts_mn)),',
									',SHARE_DB,'.',@table_handset_umts_mn,'.MAKE_MODEL= VALUES(MAKE_MODEL)')
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;	
								
						SET @SOURCE_TABLE_NAME=@table_handset_umts_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
							
						SET @FLAG_MAKE_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_handset_umts_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
					END IF;
			
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@tmp_imsi_umts_hr,';');					
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.tmp_table_call_cnt_',WORKER_ID,' A
						SET 
						  A.`FLAG_IMSI_HR` = ',@FLAG_IMSI_HR,',
						  A.`FLAG_IMSI_DY` = ',@FLAG_IMSI_DY,',
						  A.`FLAG_MAKE_HR` = ',@FLAG_MAKE_HR,',
						  A.`FLAG_MAKE_DY` = ',@FLAG_MAKE_DY,',
						  A.`FLAG_IMSI_WK` = ',@FLAG_IMSI_WK,',
						  A.`FLAG_IMSI_MN` = ',@FLAG_IMSI_MN,',
						  A.`FLAG_MAKE_WK` = ',@FLAG_MAKE_WK,',
						  A.`FLAG_MAKE_MN` = ',@FLAG_MAKE_MN,'
						WHERE A.`TECH_MASK`=2 ;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT table_call_cnt_history,',WORKER_ID,' - ',gt_strtok(@REG_GROUP, @v_reg_m, '|'),' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
					SET STEP_START_TIME := SYSDATE();
				END IF;
		
				IF v_TECH_MASK=4 THEN 
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@tmp_imsi_lte_hr,';');
	
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;	
		
					SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@tmp_imsi_lte_hr,' LIKE ',@global_db,'.tmp_imsi_lte_',@EX_DATE,';');
	
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					SET @SOURCE_TABLE_NAME=@tmp_imsi_lte_hr;
					SET @ERROR_FLAG=CONCAT(SHARE_DB,'.',@tmp_imsi_lte_hr,' DATA_HOUR=',v_DATA_HOUR);
					SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@tmp_imsi_lte_hr,' 
								(
								`IMSI`,
								`DATA_DATE`,
								`DATA_HOUR`,
								',LTE_IMSI_COLUMN_STR,',
								`MAKE_ID`,
								`MODEL_ID`
								',IMSI_CELL_LTE_TMP_COLUMN_STR,'
								)
								SELECT
								`IMSI`,
								`DATA_DATE`,
								`DATA_HOUR`,
								',LTE_IMSI_SUM_STR,',
								`MAKE_ID`,
								`MODEL_ID`
								',IMSI_CELL_LTE_TMP_COLUMN_STR,'
								FROM ',@global_db,'.tmp_imsi_lte_',@EX_DATE,' 
								GROUP BY `IMSI`, `DATA_DATE`,`DATA_HOUR`
								ORDER BY NULL;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					IF IMSI_CELL=1 THEN 						
						CALL gt_global_statistic.SP_Generate_Global_Statistic_Sub_Tile_Reg_Map(CONCAT(SHARE_DB,'.',@tmp_imsi_lte_hr),WORKER_ID,1,gt_strtok(@REG_GROUP, @v_reg_m, '|'),'0','0','0');
					END IF;
					
					SET @SqlCmd=CONCAT('CREATE INDEX IX_model_id ON ',SHARE_DB,'.',@tmp_imsi_lte_hr,' (`make_id`,`model_id`);');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;	
					INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@tmp_imsi_umts_hr,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
					SET STEP_START_TIME := SYSDATE();
					
					SET @SqlCmd=CONCAT(' UPDATE ',SHARE_DB,'.',@tmp_imsi_lte_hr,' A, 
								gt_aggregate_db.tmp_dim_handset B
								SET A.MAKE_MODEL=B.MAKE_MODEL
								WHERE A.MAKE_ID=B.MAKE_ID
								AND A.MODEL_ID=B.MODEL_ID
								;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt; 			
					
					IF FLAG IN (0,1) THEN 
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_imsi_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_imsi_lte_hr,' LIKE ',v_group_db_name,'.',@table_imsi_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_imsi_lte_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_imsi_lte_hr);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_imsi_lte_hr,' DATA_HOUR=',v_DATA_HOUR);
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_imsi_lte_hr,'
								(
								`IMSI`,
								`DATA_DATE`,
								`DATA_HOUR`,
								',LTE_IMSI_COLUMN_STR,',
								`MAKE_ID`,
								`MODEL_ID`
								',IMSI_CELL_LTE_COLUMN_STR,'
								)
							SELECT
								`IMSI`,
								`DATA_DATE`,
								`DATA_HOUR`,
								',LTE_IMSI_IFNULL_STR,',
								`MAKE_ID`,
								`MODEL_ID`
								',IMSI_CELL_LTE_COLUMN_STR,'
							FROM ',SHARE_DB,'.',@tmp_imsi_lte_hr
							,CASE PENDING_FLAG WHEN 1 THEN 
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(LTE_IMSI_UDP_STR,'RPT_TABLE_NAME',@table_imsi_lte_hr),',
									',@table_imsi_lte_hr,'.MAKE_ID= VALUES(MAKE_ID),
									',@table_imsi_lte_hr,'.MODEL_ID= VALUES(MODEL_ID)
									',REPLACE(IMSI_CELL_LTE_UDP_STR,'RPT_TABLE_NAME',@table_imsi_lte_hr))
								ELSE '' END
							,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=CONCAT(@table_imsi_lte_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_imsi_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
									
						SET @FLAG_IMSI_LTE_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_imsi_lte_hr,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @SOURCE_TABLE_NAME=@table_imsi_lte_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_imsi_lte_dy);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_imsi_lte_dy,' DATA_HOUR=',v_DATA_HOUR);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_imsi_lte_dy,' 
									(
									`IMSI`,
									`DATA_DATE`,
									',LTE_IMSI_COLUMN_STR,',
									`MAKE_ID`,
									`MODEL_ID`
									',IMSI_CELL_LTE_COLUMN_STR,'
									)
								SELECT
									`IMSI`,
									`DATA_DATE`,
									',LTE_IMSI_IFNULL_STR,',
									`MAKE_ID`,
									`MODEL_ID`
									',IMSI_CELL_LTE_COLUMN_STR,'
								FROM ',SHARE_DB,'.',@tmp_imsi_lte_hr,
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(LTE_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_lte_dy)),',
									',SHARE_DB,'.',@table_imsi_lte_dy,'.MAKE_ID= VALUES(MAKE_ID),
									',SHARE_DB,'.',@table_imsi_lte_dy,'.MODEL_ID= VALUES(MODEL_ID)
									',REPLACE(IMSI_CELL_LTE_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_lte_dy)))
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_imsi_lte_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
								
						SET @FLAG_IMSI_LTE_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_imsi_lte_dy,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_handset_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_handset_lte_hr,' LIKE ',v_group_db_name,'.',@table_handset_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_handset_lte_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_handset_lte_hr);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_handset_lte_hr,' DATA_HOUR=',v_DATA_HOUR);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_handset_lte_hr,'
									(
									`MAKE_ID`,
									`MODEL_ID`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',LTE_IMSI_COLUMN_STR,',
									`MAKE_MODEL`
									)
								SELECT
									`MAKE_ID`,
									`MODEL_ID`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',LTE_IMSI_SUM_STR,',
									`MAKE_MODEL` 
								FROM ',SHARE_DB,'.',@tmp_imsi_lte_hr,' 
								WHERE `MAKE_ID` IS NOT NULL AND `MODEL_ID` IS NOT NULL
								GROUP BY `MAKE_ID`,`MODEL_ID`,`DATA_DATE`,`DATA_HOUR`
								ORDER BY NULL '
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(LTE_IMSI_UDP_STR,'RPT_TABLE_NAME',@table_handset_lte_hr),',
									',@table_handset_lte_hr,'.MAKE_MODEL= VALUES(MAKE_MODEL)')
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_handset_lte_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_handset_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_MAKE_LTE_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_handset_lte_hr,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @SOURCE_TABLE_NAME=@table_handset_lte_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_handset_lte_dy);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_handset_lte_dy,' DATA_HOUR=',v_DATA_HOUR);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_handset_lte_dy,' 
									(
									`MAKE_ID`,
									`MODEL_ID`,
									`DATA_DATE`,
									',LTE_IMSI_COLUMN_STR,',
									`MAKE_MODEL`
									)
								SELECT
									`MAKE_ID`,
									`MODEL_ID`,
									`DATA_DATE`,
									',LTE_IMSI_SUM_STR,',
									`MAKE_MODEL` 
								FROM ',SHARE_DB,'.',@tmp_imsi_lte_hr,' 
								WHERE `MAKE_ID` IS NOT NULL AND `MODEL_ID` IS NOT NULL
								GROUP BY `MAKE_ID`,`MODEL_ID`,`DATA_DATE`
								ORDER BY NULL ',
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(LTE_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_handset_lte_dy)),',
								',SHARE_DB,'.',@table_handset_lte_dy,'.MAKE_MODEL= VALUES(MAKE_MODEL)')
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_handset_lte_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
								
						SET @FLAG_MAKE_LTE_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_handset_lte_dy,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
					END IF;
		
					IF FLAG = 0 THEN 
						SET @SOURCE_TABLE_NAME=@table_imsi_lte_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_imsi_lte_wk);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_imsi_lte_wk);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						 			
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_imsi_lte_wk,' 
									(
									`IMSI`,
									',LTE_IMSI_COLUMN_STR,',
									`MAKE_ID`,
									`MODEL_ID`
									',IMSI_CELL_LTE_COLUMN_STR,'
									)
								SELECT
									`IMSI`,
									',LTE_IMSI_IFNULL_STR,',
									`MAKE_ID`,
									`MODEL_ID`
									',IMSI_CELL_LTE_COLUMN_STR,'
								FROM ',SHARE_DB,'.',@tmp_imsi_lte_hr,
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(LTE_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_lte_wk)),',
									',SHARE_DB,'.',@table_imsi_lte_wk,'.MAKE_ID= VALUES(MAKE_ID),
									',SHARE_DB,'.',@table_imsi_lte_wk,'.MODEL_ID= VALUES(MODEL_ID)
									',REPLACE(IMSI_CELL_LTE_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_lte_wk)))
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;	
						
						SET @SOURCE_TABLE_NAME=@table_imsi_lte_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
							
						SET @FLAG_IMSI_LTE_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_imsi_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_handset_lte_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_handset_lte_wk);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_handset_lte_wk);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_handset_lte_wk,' 
									(
									`MAKE_ID`,
									`MODEL_ID`,
									',LTE_IMSI_COLUMN_STR,',
									`MAKE_MODEL` 
									)
								SELECT
									`MAKE_ID`,
									`MODEL_ID`,
									',LTE_IMSI_SUM_STR,' ,
									`MAKE_MODEL` 
								FROM ',SHARE_DB,'.',@tmp_imsi_lte_hr,' 
								WHERE `MAKE_ID` IS NOT NULL AND `MODEL_ID` IS NOT NULL
								GROUP BY `MAKE_ID`,`MODEL_ID`
								ORDER BY NULL ',
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(LTE_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_handset_lte_wk)),',
								',SHARE_DB,'.',@table_handset_lte_wk,'.MAKE_MODEL= VALUES(MAKE_MODEL)')
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;	
								
						SET @SOURCE_TABLE_NAME=@table_handset_lte_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
							
						SET @FLAG_MAKE_LTE_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_handset_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_imsi_lte_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_imsi_lte_mn);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_imsi_lte_mn);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_imsi_lte_mn,' 
									(
									`IMSI`,
									',LTE_IMSI_COLUMN_STR,',
									`MAKE_ID`,
									`MODEL_ID`
									',IMSI_CELL_LTE_COLUMN_STR,'
									)
								SELECT
									`IMSI`,
									',LTE_IMSI_IFNULL_STR,',
									`MAKE_ID`,
									`MODEL_ID`
									',IMSI_CELL_LTE_COLUMN_STR,'
								FROM ',SHARE_DB,'.',@tmp_imsi_lte_hr, 
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(LTE_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_lte_mn)),',
									',SHARE_DB,'.',@table_imsi_lte_mn,'.MAKE_ID= VALUES(MAKE_ID),
									',SHARE_DB,'.',@table_imsi_lte_mn,'.MODEL_ID= VALUES(MODEL_ID)
									',REPLACE(IMSI_CELL_LTE_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_lte_mn)))
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;		
								
						SET @SOURCE_TABLE_NAME=@table_imsi_lte_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_IMSI_lte_mn=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_imsi_lte_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_handset_lte_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_handset_lte_mn);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_handset_lte_mn);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_handset_lte_mn,' 
									(
									`MAKE_ID`,
									`MODEL_ID`,
									',LTE_IMSI_COLUMN_STR,',
									`MAKE_MODEL` 
									)
								SELECT
									`MAKE_ID`,
									`MODEL_ID`,
									',LTE_IMSI_SUM_STR,',
									`MAKE_MODEL`  
								FROM ',SHARE_DB,'.',@tmp_imsi_lte_hr,' 
								WHERE `MAKE_ID` IS NOT NULL AND `MODEL_ID` IS NOT NULL
								GROUP BY `MAKE_ID`,`MODEL_ID`
								ORDER BY NULL ',
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(LTE_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_handset_lte_mn)),',
								',SHARE_DB,'.',@table_handset_lte_mn,'.MAKE_MODEL= VALUES(MAKE_MODEL)')
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;	
								
						SET @SOURCE_TABLE_NAME=@table_handset_lte_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
							
						SET @FLAG_MAKE_lte_mn=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_handset_lte_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
					END IF;
					
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@tmp_imsi_lte_hr,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
									
					SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.tmp_table_call_cnt_',WORKER_ID,' A
						SET 
						  A.`FLAG_IMSI_HR` = ',@FLAG_IMSI_LTE_HR,',
						  A.`FLAG_IMSI_DY` = ',@FLAG_IMSI_LTE_DY,',
						  A.`FLAG_MAKE_HR` = ',@FLAG_MAKE_LTE_HR,',
						  A.`FLAG_MAKE_DY` = ',@FLAG_MAKE_LTE_DY,',
						  A.`FLAG_IMSI_WK` = ',@FLAG_IMSI_LTE_WK,',
						  A.`FLAG_IMSI_MN` = ',@FLAG_IMSI_LTE_MN,',
						  A.`FLAG_MAKE_WK` = ',@FLAG_MAKE_LTE_WK,',
						  A.`FLAG_MAKE_MN` = ',@FLAG_MAKE_LTE_MN,'
						WHERE A.`TECH_MASK`=4;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
						
					INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('LTE UPDATE table_call_cnt_',WORKER_ID,' - ',gt_strtok(@REG_GROUP, @v_reg_m, '|'),' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
					SET STEP_START_TIME := SYSDATE();
				END IF;
			ELSE 
				SELECT 'No need aggregation.' AS IsSuccess;
			END IF;
				SET @v_i=@v_i+1;
			END;
			END WHILE;
			SET @v_reg_m=@v_reg_m+1;
		END;
		END WHILE;
	
		IF v_TECH_MASK=1 THEN 
			SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',@global_db,'.tmp_imsi_gsm_',@EX_DATE,';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('GSM DROP ',@global_db,'.tmp_imsi_gsm_',@EX_DATE,' ',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
			SET STEP_START_TIME := SYSDATE();
		END IF;
		
		IF v_TECH_MASK=2 THEN 		
			SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',@global_db,'.tmp_imsi_umts_',@EX_DATE,';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('UMTS DROP',@global_db,'.tmp_imsi_umts_',@EX_DATE,'',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
			SET STEP_START_TIME := SYSDATE();
		END IF;
		
		IF v_TECH_MASK=4 THEN 	
			SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',@global_db,'.tmp_imsi_lte_',@EX_DATE,';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('UMTS DROP',@global_db,'.tmp_imsi_lte_',@EX_DATE,'',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
			SET STEP_START_TIME := SYSDATE();
		END IF;
		INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT(v_DATA_DATE,',',v_DATA_HOUR,',',v_TECH_MASK,',',WORKER_ID,' Done: ',TIMESTAMPDIFF(SECOND,START_TIME,SYSDATE()),' seconds.'), NOW());
	END IF;	
	
	IF FLAG=2 THEN 
		IF exDate IS NOT NULL THEN 
			SET @v_DATA_DATE=CAST(exDate AS DATE);
		ELSE 
			SET @v_DATA_DATE=DATE(DATE_ADD(START_TIME,INTERVAL -1 DAY));
		END IF;
		SELECT `DAY_OF_WEEK`(@v_DATA_DATE) INTO @DAY_OF_WEEK;
		SET @FIRST_DAY=gt_strtok(@DAY_OF_WEEK, 1, '|');
		SET @END_DAY=gt_strtok(@DAY_OF_WEEK, 2, '|');
		SET @DATE_WK=CONCAT(DATE_FORMAT(@FIRST_DAY,'%Y%m%d'),'_',DATE_FORMAT(@END_DAY,'%Y%m%d'));
		SET @DATE_MN=DATE_FORMAT(@v_DATA_DATE,'%Y%m');
		SET @EX_DATE=CONCAT(DATE_FORMAT(@v_DATA_DATE,'%Y%m%d_'),WORKER_ID);
		SET @SR_DATE=CONCAT(DATE_FORMAT(@v_DATA_DATE,'%Y%m%d'));
		
		SET @SqlCmd=CONCAT('SELECT GROUP_CONCAT(DISTINCT `group_id` ORDER BY `group_id` SEPARATOR ''|'' ) INTO @REG_GROUP FROM ',@global_db,'.`usr_polygon_reg_3`;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;	
			
		SET @SqlCmd=CONCAT('SELECT att_value INTO @usr_def_polygon_group_id FROM gt_global_statistic.nw_config WHERE group_name= ''system'' AND att_name=''USR_DEFINE_POLYGON_GROUP_ID'';');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT att_value INTO @usr_def_polygon FROM gt_global_statistic.nw_config WHERE group_name= ''system'' AND att_name=''USR_DEFINE_POLYGON'';');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
			
		SET @v_reg_m=1;
		SET @v_reg_Max=gt_covmo_csv_count(@REG_GROUP,'|');
		WHILE @v_reg_m <= @v_reg_Max DO
		BEGIN			
	
		IF gt_strtok(@REG_GROUP, @v_reg_m, '|') <> @usr_def_polygon_group_id THEN
	
			SET v_group_db_name=CONCAT('gt_global_statistic_g',gt_strtok(@REG_GROUP, @v_reg_m, '|'));
			IF TECH_MASK=2 THEN 
				SET @table_imsi_umts_dy=CONCAT('table_imsi_umts_dy_',@SR_DATE);
				SET @table_imsi_umts_wk=CONCAT('table_imsi_umts_wk_',@DATE_WK);
				SET @table_imsi_umts_mn=CONCAT('table_imsi_umts_mn_',@DATE_MN);
				SET @table_handset_umts_wk=CONCAT('table_handset_umts_wk_',@DATE_WK);
				SET @table_handset_umts_mn=CONCAT('table_handset_umts_mn_',@DATE_MN);
				SET @SOURCE_TABLE_NAME=CONCAT(@table_imsi_umts_dy,',',@table_imsi_umts_wk);
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
								
				SET @SqlCmd=CONCAT('ALTER TABLE ',SHARE_DB,'.',@table_imsi_umts_dy,' ADD COLUMN `MAKE_MODEL` VARCHAR(200) DEFAULT NULL;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			
				SET @SqlCmd=CONCAT(' UPDATE ',SHARE_DB,'.',@table_imsi_umts_dy,' A, 
							gt_aggregate_db.tmp_dim_handset B
							SET A.MAKE_MODEL=B.MAKE_MODEL
							WHERE A.MAKE_ID=B.MAKE_ID
							AND A.MODEL_ID=B.MODEL_ID
							;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
	
				SET @SOURCE_TABLE_NAME=@table_imsi_umts_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_imsi_umts_wk);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_imsi_umts_wk);
						
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_imsi_umts_wk,' 
						    (
							`IMSI`,
							',UMTS_IMSI_COLUMN_STR,',
							`MAKE_ID`,
							`MODEL_ID`
							',IMSI_CELL_UMTS_COLUMN_STR,')
						SELECT
							`IMSI`,
							',UMTS_IMSI_IFNULL_STR,',
							`MAKE_ID`,
							`MODEL_ID`
							',IMSI_CELL_UMTS_COLUMN_STR,'
						FROM ',SHARE_DB,'.',@table_imsi_umts_dy,
						CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(UMTS_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_umts_wk)),',
							',SHARE_DB,'.',@table_imsi_umts_wk,'.MAKE_ID= VALUES(MAKE_ID),
							',SHARE_DB,'.',@table_imsi_umts_wk,'.MODEL_ID= VALUES(MODEL_ID)
							',REPLACE(IMSI_CELL_UMTS_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_umts_wk)))
						,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				SET @SOURCE_TABLE_NAME=@table_imsi_umts_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_IMSI_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_imsi_umts_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
			
				SET @SOURCE_TABLE_NAME=@table_imsi_umts_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_imsi_umts_mn);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_imsi_umts_mn);
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
			
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_imsi_umts_mn,' 
						    (
							`IMSI`,
							',UMTS_IMSI_COLUMN_STR,',
							`MAKE_ID`,
							`MODEL_ID`
							',IMSI_CELL_UMTS_COLUMN_STR,')
						SELECT
							`IMSI`,
							',UMTS_IMSI_IFNULL_STR,',
							`MAKE_ID`,
							`MODEL_ID`
							',IMSI_CELL_UMTS_COLUMN_STR,'
						FROM ',SHARE_DB,'.',@table_imsi_umts_dy,
						CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(UMTS_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_umts_mn)),',
							',SHARE_DB,'.',@table_imsi_umts_mn,'.MAKE_ID= VALUES(MAKE_ID),
							',SHARE_DB,'.',@table_imsi_umts_mn,'.MODEL_ID= VALUES(MODEL_ID)
							',REPLACE(IMSI_CELL_UMTS_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_umts_mn)))
						,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_imsi_umts_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
					
				SET @FLAG_IMSI_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_imsi_umts_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_handset_umts_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_handset_umts_wk);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_handset_umts_wk);
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_handset_umts_wk,' 
						    (
							`MAKE_ID`,
							`MODEL_ID`,
							',UMTS_IMSI_COLUMN_STR,',
							`MAKE_MODEL` )
						SELECT
							`MAKE_ID`,
							`MODEL_ID`,
							',UMTS_IMSI_SUM_STR,',
							`MAKE_MODEL` 
						FROM ',SHARE_DB,'.',@table_imsi_umts_dy,' 
						WHERE `MAKE_ID` IS NOT NULL AND `MODEL_ID` IS NOT NULL
						GROUP BY `MAKE_ID`,`MODEL_ID`
						ORDER BY NULL ',
						CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(UMTS_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_handset_umts_wk)),',
						',SHARE_DB,'.',@table_handset_umts_wk,'.MAKE_MODEL= VALUES(MAKE_MODEL)')
						,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_handset_umts_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_MAKE_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_handset_umts_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_handset_umts_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_handset_umts_mn);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_handset_umts_mn);
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_handset_umts_mn,' 
						    (
							`MAKE_ID`,
							`MODEL_ID`,
							',UMTS_IMSI_COLUMN_STR,',
							`MAKE_MODEL` )
						SELECT
							`MAKE_ID`,
							`MODEL_ID`,
							',UMTS_IMSI_SUM_STR,',
							`MAKE_MODEL` 
						FROM ',SHARE_DB,'.',@table_imsi_umts_dy,' 
						WHERE `MAKE_ID` IS NOT NULL AND `MODEL_ID` IS NOT NULL
						GROUP BY `MAKE_ID`,`MODEL_ID`
						ORDER BY NULL ',
						CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(UMTS_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_handset_umts_mn)),',
						',SHARE_DB,'.',@table_handset_umts_mn,'.MAKE_MODEL= VALUES(MAKE_MODEL)')
						,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_handset_umts_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
				SET @FLAG_MAKE_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_handset_umts_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
		
				SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_imsi_umts_dy,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.`table_call_cnt_history` A
							SET 
							  A.`FLAG_IMSI_WK` = ',@FLAG_IMSI_WK,',
							  A.`FLAG_IMSI_MN` = ',@FLAG_IMSI_MN,',
							  A.`FLAG_MAKE_WK` = ',@FLAG_MAKE_WK,',
							  A.`FLAG_MAKE_MN` = ',@FLAG_MAKE_MN,'
							WHERE A.`DATA_DATE`=''',@v_DATA_DATE,''' AND `TECH_MASK`=2
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('UMTS SELECT COUNT(*),TRUE,',WORKER_ID,' - ',gt_strtok(@REG_GROUP, @v_reg_m, '|'),' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
			END IF;
		
			IF TECH_MASK=4 THEN
				SET @table_imsi_lte_dy=CONCAT('table_imsi_lte_dy_',@SR_DATE);
				SET @table_imsi_lte_wk=CONCAT('table_imsi_lte_wk_',@DATE_WK);
				SET @table_imsi_lte_mn=CONCAT('table_imsi_lte_mn_',@DATE_MN);
				SET @table_handset_lte_wk=CONCAT('table_handset_lte_wk_',@DATE_WK);
				SET @table_handset_lte_mn=CONCAT('table_handset_lte_mn_',@DATE_MN);
				
				SET @SOURCE_TABLE_NAME=CONCAT(@table_imsi_lte_dy,',',@table_imsi_lte_wk);
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_imsi_lte_wk);
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('ALTER TABLE ',SHARE_DB,'.',@table_imsi_lte_dy,' ADD COLUMN `MAKE_MODEL` VARCHAR(200) DEFAULT NULL;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SqlCmd=CONCAT(' UPDATE ',SHARE_DB,'.',@table_imsi_lte_dy,' A, 
							gt_aggregate_db.tmp_dim_handset B
							SET A.MAKE_MODEL=B.MAKE_MODEL
							WHERE A.MAKE_ID=B.MAKE_ID
							AND A.MODEL_ID=B.MODEL_ID
							;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
	
				SET @SOURCE_TABLE_NAME=@table_imsi_lte_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_imsi_lte_wk);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_imsi_lte_wk);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_imsi_lte_wk,' 
						(
							`IMSI`,
							',LTE_IMSI_COLUMN_STR,',
							`MAKE_ID`,
							`MODEL_ID`
							',IMSI_CELL_LTE_COLUMN_STR,'
						)
						SELECT
							`IMSI`,
							',LTE_IMSI_IFNULL_STR,',
							`MAKE_ID`,
							`MODEL_ID`
							',IMSI_CELL_LTE_COLUMN_STR,'
						FROM ',SHARE_DB,'.',@table_imsi_lte_dy,
						CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(LTE_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_lte_wk)),',
							',SHARE_DB,'.',@table_imsi_lte_wk,'.MAKE_ID= VALUES(MAKE_ID),
							',SHARE_DB,'.',@table_imsi_lte_wk,'.MODEL_ID= VALUES(MODEL_ID)
							',REPLACE(IMSI_CELL_LTE_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_lte_wk)))
						,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_imsi_lte_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
				SET @FLAG_IMSI_LTE_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_imsi_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_handset_lte_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_handset_lte_wk);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_handset_lte_wk);
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_handset_lte_wk,' 
							(
							`MAKE_ID`,
							`MODEL_ID`,
							',LTE_IMSI_COLUMN_STR,',
							`MAKE_MODEL` 
							)
						SELECT
							`MAKE_ID`,
							`MODEL_ID`,
							',LTE_IMSI_SUM_STR,',
							`MAKE_MODEL` 
						FROM ',SHARE_DB,'.',@table_imsi_lte_dy,' 
						WHERE `MAKE_ID` IS NOT NULL AND `MODEL_ID` IS NOT NULL
						GROUP BY `MAKE_ID`,`MODEL_ID`
						ORDER BY NULL ',
						CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(LTE_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_handset_lte_wk)),',
						',SHARE_DB,'.',@table_handset_lte_wk,'.MAKE_MODEL= VALUES(MAKE_MODEL)')
						,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_handset_lte_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
				SET @FLAG_MAKE_LTE_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_handset_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_imsi_lte_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_imsi_lte_mn);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_imsi_lte_mn);
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_imsi_lte_mn,' 
							(
							`IMSI`,
							',LTE_IMSI_COLUMN_STR,',
							`MAKE_ID`,
							`MODEL_ID`
							',IMSI_CELL_LTE_COLUMN_STR,'
							)
						SELECT
							`IMSI`,
							',LTE_IMSI_IFNULL_STR,',
							`MAKE_ID`,
							`MODEL_ID`
							',IMSI_CELL_LTE_COLUMN_STR,'
						FROM ',SHARE_DB,'.',@table_imsi_lte_dy,
						CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(LTE_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_lte_mn)),',
							',SHARE_DB,'.',@table_imsi_lte_mn,'.MAKE_ID= VALUES(MAKE_ID),
							',SHARE_DB,'.',@table_imsi_lte_mn,'.MODEL_ID= VALUES(MODEL_ID)
							',REPLACE(IMSI_CELL_LTE_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_lte_mn)))
						,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_imsi_lte_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
				SET @FLAG_IMSI_lte_mn=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_imsi_lte_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_handset_lte_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_handset_lte_mn);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_handset_lte_mn);
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_handset_lte_mn,' 
							(
							`MAKE_ID`,
							`MODEL_ID`,
							',LTE_IMSI_COLUMN_STR,',
							`MAKE_MODEL` 
							)
						SELECT
							`MAKE_ID`,
							`MODEL_ID`,
							',LTE_IMSI_SUM_STR,',
							`MAKE_MODEL`  
						FROM ',SHARE_DB,'.',@table_imsi_lte_dy,' 
						WHERE `MAKE_ID` IS NOT NULL AND `MODEL_ID` IS NOT NULL
						GROUP BY `MAKE_ID`,`MODEL_ID`
						ORDER BY NULL ',
						CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(LTE_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_handset_lte_mn)),',
						',SHARE_DB,'.',@table_handset_lte_mn,'.MAKE_MODEL= VALUES(MAKE_MODEL)')
						,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_handset_lte_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
					
				SET @FLAG_MAKE_lte_mn=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_handset_lte_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
		
				SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_imsi_lte_dy,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
		
				SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.`table_call_cnt_history` A
							SET 
							  A.`FLAG_IMSI_WK` = ',@FLAG_IMSI_LTE_WK,',
							  A.`FLAG_IMSI_MN` = ',@FLAG_IMSI_LTE_MN,',
							  A.`FLAG_MAKE_WK` = ',@FLAG_MAKE_LTE_WK,',
							  A.`FLAG_MAKE_MN` = ',@FLAG_MAKE_LTE_MN,'
							WHERE A.`DATA_DATE`=''',@v_DATA_DATE,''' AND `TECH_MASK`=4
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('LTE UPDATE table_call_cnt_history ,',WORKER_ID,' - ',gt_strtok(@REG_GROUP, @v_reg_m, '|'),' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
			END IF;
			
			IF TECH_MASK=1 THEN 			
				SET @table_imsi_gsm_dy=CONCAT('table_imsi_gsm_dy_',@SR_DATE);
				SET @table_imsi_gsm_wk=CONCAT('table_imsi_gsm_wk_',@DATE_WK);
				SET @table_imsi_gsm_mn=CONCAT('table_imsi_gsm_mn_',@DATE_MN);
				SET @table_handset_gsm_wk=CONCAT('table_handset_gsm_wk_',@DATE_WK);
				SET @table_handset_gsm_mn=CONCAT('table_handset_gsm_mn_',@DATE_MN);
				
				SET @SOURCE_TABLE_NAME=CONCAT(@table_imsi_gsm_dy,',',@table_imsi_gsm_wk);
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_imsi_gsm_wk);
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('ALTER TABLE ',SHARE_DB,'.',@table_imsi_gsm_dy,' ADD COLUMN `MAKE_MODEL` VARCHAR(200) DEFAULT NULL;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SqlCmd=CONCAT(' UPDATE ',SHARE_DB,'.',@table_imsi_gsm_dy,' A, 
							gt_aggregate_db.tmp_dim_handset B
							SET A.MAKE_MODEL=B.MAKE_MODEL
							WHERE A.MAKE_ID=B.MAKE_ID
							AND A.MODEL_ID=B.MODEL_ID
							;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			
				SET @SOURCE_TABLE_NAME=@table_imsi_gsm_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_imsi_gsm_wk);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_imsi_gsm_wk);
						
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_imsi_gsm_wk,' 
						    (
							`IMSI`,
							',GSM_IMSI_COLUMN_STR,',
							`MAKE_ID`,
							`MODEL_ID`
							',IMSI_CELL_GSM_COLUMN_STR,')
						SELECT
							`IMSI`,
							',GSM_IMSI_IFNULL_STR,',
							`MAKE_ID`,
							`MODEL_ID`
							',IMSI_CELL_GSM_COLUMN_STR,'
						FROM ',SHARE_DB,'.',@table_imsi_gsm_dy,
						CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(GSM_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_gsm_wk)),',
							',SHARE_DB,'.',@table_imsi_gsm_wk,'.MAKE_ID= VALUES(MAKE_ID),
							',SHARE_DB,'.',@table_imsi_gsm_wk,'.MODEL_ID= VALUES(MODEL_ID)
							',REPLACE(IMSI_CELL_GSM_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_gsm_wk)))
						,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_imsi_gsm_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_IMSI_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_imsi_gsm_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_imsi_gsm_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_imsi_gsm_mn);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_imsi_gsm_mn);
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_imsi_gsm_mn,' 
						    (
							`IMSI`,
							',GSM_IMSI_COLUMN_STR,',
							`MAKE_ID`,
							`MODEL_ID`
							',IMSI_CELL_GSM_COLUMN_STR,')
						SELECT
							`IMSI`,
							',GSM_IMSI_IFNULL_STR,',
							`MAKE_ID`,
							`MODEL_ID`
							',IMSI_CELL_GSM_COLUMN_STR,'
						FROM ',SHARE_DB,'.',@table_imsi_gsm_dy,
						CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(GSM_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_gsm_mn)),',
							',SHARE_DB,'.',@table_imsi_gsm_mn,'.MAKE_ID= VALUES(MAKE_ID),
							',SHARE_DB,'.',@table_imsi_gsm_mn,'.MODEL_ID= VALUES(MODEL_ID)
							',REPLACE(IMSI_CELL_GSM_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_imsi_gsm_mn)))
						,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_imsi_gsm_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
				SET @FLAG_IMSI_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_imsi_gsm_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_handset_gsm_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_handset_gsm_wk);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_handset_gsm_wk);
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_handset_gsm_wk,' 
							(
							`MAKE_ID`,
							`MODEL_ID`,
							',GSM_IMSI_COLUMN_STR,',
							`MAKE_MODEL` )
						SELECT
							`MAKE_ID`,
							`MODEL_ID`,
							',GSM_IMSI_SUM_STR,',
							`MAKE_MODEL` 
						FROM ',SHARE_DB,'.',@table_imsi_gsm_dy,' 
						WHERE `MAKE_ID` IS NOT NULL AND `MODEL_ID` IS NOT NULL
						GROUP BY `MAKE_ID`,`MODEL_ID`
						ORDER BY NULL ',
						CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(GSM_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_handset_gsm_wk)),',
						',SHARE_DB,'.',@table_handset_gsm_wk,'.MAKE_MODEL= VALUES(MAKE_MODEL)')
						,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_handset_gsm_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_MAKE_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_handset_gsm_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_handset_gsm_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_handset_gsm_mn);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_handset_gsm_mn);
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_handset_gsm_mn,' 
						    (
							`MAKE_ID`,
							`MODEL_ID`,
							',GSM_IMSI_COLUMN_STR,',
							`MAKE_MODEL` )
						SELECT
							`MAKE_ID`,
							`MODEL_ID`,
							',GSM_IMSI_SUM_STR,',
							`MAKE_MODEL` 
						FROM ',SHARE_DB,'.',@table_imsi_gsm_dy,' 
						WHERE `MAKE_ID` IS NOT NULL AND `MODEL_ID` IS NOT NULL
						GROUP BY `MAKE_ID`,`MODEL_ID`
						ORDER BY NULL ',
						CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(GSM_IMSI_UDP_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_handset_gsm_mn)),',
						',SHARE_DB,'.',@table_handset_gsm_mn,'.MAKE_MODEL= VALUES(MAKE_MODEL)')
						,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_handset_gsm_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
				SET @FLAG_MAKE_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('INSERT INTO ',@table_handset_gsm_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
		
				SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_imsi_gsm_dy,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.`table_call_cnt_history` A
							SET 
							  A.`FLAG_IMSI_WK` = ',@FLAG_IMSI_WK,',
							  A.`FLAG_IMSI_MN` = ',@FLAG_IMSI_MN,',
							  A.`FLAG_MAKE_WK` = ',@FLAG_MAKE_WK,',
							  A.`FLAG_MAKE_MN` = ',@FLAG_MAKE_MN,'
							WHERE A.`DATA_DATE`=''',@v_DATA_DATE,''' AND `TECH_MASK`=1
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('GSM SELECT COUNT(*),TRUE,',WORKER_ID,' - ',gt_strtok(@REG_GROUP, @v_reg_m, '|'),' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
			END IF;	
		ELSE 
			SELECT 'No need aggregation.' AS IsSuccess;
		END IF;
			SET @v_reg_m=@v_reg_m+1;
		END;
		END WHILE;	
	END IF;
					
	
	INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_imsi_Aggr',CONCAT('Done cost:',TIMESTAMPDIFF(SECOND,START_TIME,SYSDATE()),' sec.'), NOW());

CREATE DEFINER=`covmo`@`%` PROCEDURE `SP_Qlikview_report_export`(IN gt_global_statistic VARCHAR(100),IN gt_global_statistic_g1 VARCHAR(100),IN gt_global_statistic_g2 VARCHAR(100),IN DATA_DATE VARCHAR(100),IN FOLDER_PATH VARCHAR(100))
a_label:
BEGIN
	
	DECLARE START_TIME DATETIME DEFAULT SYSDATE();
	
	INSERT INTO gt_gw_main.SP_LOG VALUES(gt_global_statistic,'SP_Qlikview_report_export','Start', START_TIME);
	
	SET @SqlCmd=CONCAT('REPAIR TABLE ',gt_global_statistic_g1,'.table_cell_agg_gsm_dy_',DATA_DATE,';');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.TMP_table_cell_agg_gsm;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	SET @SqlCmd=CONCAT('CREATE TEMPORARY TABLE ',gt_global_statistic,'.TMP_table_cell_agg_gsm AS
				SELECT A.DATA_DATE,A.CELL_ID,A.SITE_ID,A.BSC_ID,BCCH_ARFCN,A.BANDINDEX,A.VOICE_CNT,A.SIGNAL_CNT,A.SMS_CNT,A.GPRS_CNT,A.OTHER_CNT,A.BLOCK_VOICE_CNT,A.BLOCK_GPRS_CNT,
						A.BLOCK_SMS_CNT,A.BLOCK_SIGNAL_CNT,A.BLOCK_OTHER_CNT,A.DROP_VOICE_CNT,A.DROP_SIGNAL_CNT,A.DROP_SMS_CNT,A.DROP_GPRS_CNT,A.DROP_OTHER_CNT,A.NON_BLOCK_VOICE_CNT,
						A.NON_BLOCK_SIGNAL_CNT,A.NON_BLOCK_SMS_CNT,A.NON_BLOCK_GPRS_CNT,A.NON_BLOCK_OTHER_CNT,A.RXLEV_SUM,RXLEV_CNT,A.RXQUAL_SUM,A.RXQUAL_CNT,
						A.CALL_SETUP_TIME_SUM,A.CALL_SETUP_TIME_CNT,A.SF_VOICE_CNT,A.SF_DATA_CNT,A.SF_SMS_CNT,A.SF_SIGNAL_CNT,A.SF_OTHER_CNT,A.CALL_DUR_SUM,A.VOICE_DUR_SUM,A.DATA_DUR_SUM,
						B.ID AS `REG_ID_578`,A.INIT_CALL_CNT,A.END_CALL_CNT,
						A.END_VOICE_CNT,A.END_SIGNAL_CNT,
						A.END_SMS_CNT,A.END_GPRS_CNT,
						A.END_OTHER_CNT
				FROM ',gt_global_statistic_g1,'.table_cell_agg_gsm_dy_',DATA_DATE,' A,gt_global_statistic.table_cell_polygon_g1 B
				WHERE b.TECHNOLOGY=''2g''
				AND a.BSC_id=b.NETWORK_ELEMENT
				AND a.site_id=b.site_id
				AND a.cell_id=b.cell_id');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	
	
	SET @SqlCmd=CONCAT('SELECT ''DATA_DATE'',''CELL_ID'',''SITE_ID'',''BSC_ID'',''BCCH_ARFCN'',
						''BANDINDEX'',''VOICE_CNT'',''SIGNAL_CNT'',''SMS_CNT'',
						''GPRS_CNT'',''OTHER_CNT'',''BLOCK_VOICE_CNT'',
						''BLOCK_GPRS_CNT'',''BLOCK_SMS_CNT'',''BLOCK_SIGNAL_CNT'',
						''BLOCK_OTHER_CNT'',''DROP_VOICE_CNT'',''DROP_SIGNAL_CNT'',
						''DROP_SMS_CNT'',''DROP_GPRS_CNT'',''DROP_OTHER_CNT'',
						''NON_BLOCK_VOICE_CNT'',''NON_BLOCK_SIGNAL_CNT'',
						''NON_BLOCK_SMS_CNT'',''NON_BLOCK_GPRS_CNT'',
						''NON_BLOCK_OTHER_CNT'',''RXLEV_SUM'',''RXLEV_CNT'',
						''RXQUAL_SUM'',''RXQUAL_CNT'',''CALL_SETUP_TIME_SUM'',
						''CALL_SETUP_TIME_CNT'',''SF_VOICE_CNT'',
						''SF_DATA_CNT'',''SF_SMS_CNT'',''SF_SIGNAL_CNT'',''SF_OTHER_CNT'',
						''CALL_DUR_SUM'',''VOICE_DUR_SUM'',''DATA_DUR_SUM'',''REG_ID_578'',''REG_ID_85'',
						''INIT_CALL_CNT'',''END_CALL_CNT'',''END_VOICE_CNT'',''END_SIGNAL_CNT'',''END_SMS_CNT'',
						''END_GPRS_CNT'',''END_OTHER_CNT''
										
					UNION
					SELECT  A.DATA_DATE,A.CELL_ID,A.SITE_ID,A.BSC_ID,BCCH_ARFCN,A.BANDINDEX,A.VOICE_CNT,A.SIGNAL_CNT,A.SMS_CNT,A.GPRS_CNT,A.OTHER_CNT,A.BLOCK_VOICE_CNT,A.BLOCK_GPRS_CNT,
						A.BLOCK_SMS_CNT,A.BLOCK_SIGNAL_CNT,A.BLOCK_OTHER_CNT,A.DROP_VOICE_CNT,A.DROP_SIGNAL_CNT,A.DROP_SMS_CNT,A.DROP_GPRS_CNT,A.DROP_OTHER_CNT,A.NON_BLOCK_VOICE_CNT,
						A.NON_BLOCK_SIGNAL_CNT,A.NON_BLOCK_SMS_CNT,A.NON_BLOCK_GPRS_CNT,A.NON_BLOCK_OTHER_CNT,A.RXLEV_SUM,RXLEV_CNT,A.RXQUAL_SUM,A.RXQUAL_CNT,
						A.CALL_SETUP_TIME_SUM,A.CALL_SETUP_TIME_CNT,A.SF_VOICE_CNT,A.SF_DATA_CNT,A.SF_SMS_CNT,A.SF_SIGNAL_CNT,A.SF_OTHER_CNT,A.CALL_DUR_SUM,A.VOICE_DUR_SUM,A.DATA_DUR_SUM,
						A.`REG_ID_578`,B.ID AS `REG_ID_85`,A.INIT_CALL_CNT,A.END_CALL_CNT,
						A.END_VOICE_CNT,A.END_SIGNAL_CNT,A.END_SMS_CNT,A.END_GPRS_CNT,A.END_OTHER_CNT
					FROM ',gt_global_statistic,'.TMP_table_cell_agg_gsm A,gt_global_statistic.table_cell_polygon_g2 B
					WHERE b.TECHNOLOGY=''2g''
					AND a.bsc_id=b.NETWORK_ELEMENT
					AND a.site_id=b.site_id
					AND a.cell_id=b.cell_id
					INTO OUTFILE "',FOLDER_PATH,'table_cell_agg_gsm_dy_',DATA_DATE,'.csv"
					FIELDS TERMINATED BY ''\t''
					OPTIONALLY ENCLOSED BY ''''
					LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('REPAIR TABLE ',gt_global_statistic_g1,'.table_cell_agg_umts_dy_',DATA_DATE,';');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.TMP_table_cell_agg_umts;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	SET @SqlCmd=CONCAT('CREATE TEMPORARY TABLE ',gt_global_statistic,'.TMP_table_cell_agg_umts AS
				SELECT A.DATA_DATE,A.CELL_ID,A.SITE_ID,A.CLUSTER_ID,A.RNC_ID,
						A.FREQUENCY,A.UARFCN,VOICE_CNT,A.VIDEO_CNT,
						A.PS_R99_CNT,A.PS_HSPA_CNT,A.M_RAB_CNT,
						A.SIGNAL_CNT,A.SMS_CNT,A.PS_OTHER_CNT,
						A.DROP_VOICE_CNT,A.DROP_VIDEO_CNT,A.DROP_PS_R99_CNT,
						A.DROP_PS_HSPA_CNT,A.DROP_M_RAB_CNT,A.DROP_SIGNAL_CNT,
						A.DROP_SMS_CNT,A.DROP_PS_OTHER_CNT,A.NON_BLOCK_VOICE_CNT,
						A.NON_BLOCK_VIDEO_CNT,A.NON_BLOCK_PS_R99_CNT,
						A.NON_BLOCK_PS_HSPA_CNT,A.NON_BLOCK_M_RAB_CNT,A.NON_BLOCK_SIGNAL_CNT,
						A.NON_BLOCK_SMS_CNT,A.NON_BLOCK_PS_OTHER_CNT,A.BLOCK_VOICE_CNT,
						A.BLOCK_VEDIO_CNT,A.BLOCK_R99_CNT,A.BLOCK_HSPA_CNT,A.BLOCK_MRAB_CNT,
						A.BLOCK_SIGNAL_CNT,A.BLOCK_SMS_CNT,A.BLOCK_PS_OTHER_CNT,A.RSCP_SUM,
						A.RSCP_CNT,A.ECN0_SUM,A.ECN0_CNT,A.UL_VOLUME_SUM,A.DL_VOLUME_SUM,
						A.UL_THROUPUT_MAX,A.DL_THROUPUT_MAX,A.UL_THROUPUT_SUM,A.UL_THROUPUT_CNT,
						A.DL_THROUPUT_SUM,A.DL_THROUPUT_CNT,A.FP_RSCP_1,A.FP_ECN0_1,A.BEST_CNT,
						A.CALL_SETUP_TIME_SUM,A.CALL_SETUP_TIME_CNT,A.SF_VOICE_CNT,A.SF_VEDIO_CNT,
						A.SF_R99_CNT,A.SF_HSPA_CNT,A.SF_MRAB_CNT,A.SF_OTHER_CNT,A.SF_SMS_CNT,
						A.SF_SIGNAL_CNT,A.CALL_DUR_SUM,A.VOICE_DUR_SUM,A.VIDEO_DUR_SUM,
						A.R99_DUR_SUM,A.HSPA_DUR_SUM,A.MRAB_DUR_SUM,
						B.ID AS `REG_ID_578`,
						A.INIT_CALL_CNT,A.END_CALL_CNT,
						A.END_VOICE_CNT,A.END_VIDEO_CNT,
						A.END_PS_R99_CNT,A.END_PS_HSPA_CNT,
						A.END_M_RAB_CNT,A.END_SIGNAL_CNT,
						A.END_SMS_CNT,A.END_PS_OTHER_CNT
				FROM ',gt_global_statistic_g1,'.table_cell_agg_umts_dy_',DATA_DATE,' A,gt_global_statistic.table_cell_polygon_g1 B
				WHERE b.TECHNOLOGY=''3g''
				AND a.rnc_id=b.NETWORK_ELEMENT
				AND a.site_id=b.site_id
				AND a.cell_id=b.cell_id');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('SELECT ''DATA_DATE'',''CELL_ID'',''SITE_ID'',''CLUSTER_ID'',''RNC_ID'',
						''FREQUENCY'',''UARFCN'',''VOICE_CNT'',''VIDEO_CNT'',
						''PS_R99_CNT'',''PS_HSPA_CNT'',''M_RAB_CNT'',
						''SIGNAL_CNT'',''SMS_CNT'',''PS_OTHER_CNT'',
						''DROP_VOICE_CNT'',''DROP_VIDEO_CNT'',''DROP_PS_R99_CNT'',
						''DROP_PS_HSPA_CNT'',''DROP_M_RAB_CNT'',''DROP_SIGNAL_CNT'',
						''DROP_SMS_CNT'',''DROP_PS_OTHER_CNT'',''NON_BLOCK_VOICE_CNT'',
						''NON_BLOCK_VIDEO_CNT'',''NON_BLOCK_PS_R99_CNT'',
						''NON_BLOCK_PS_HSPA_CNT'',''NON_BLOCK_M_RAB_CNT'',''NON_BLOCK_SIGNAL_CNT'',
						''NON_BLOCK_SMS_CNT'',''NON_BLOCK_PS_OTHER_CNT'',''BLOCK_VOICE_CNT'',
						''BLOCK_VEDIO_CNT'',''BLOCK_R99_CNT'',''BLOCK_HSPA_CNT'',''BLOCK_MRAB_CNT'',
						''BLOCK_SIGNAL_CNT'',''BLOCK_SMS_CNT'',''BLOCK_PS_OTHER_CNT'',''RSCP_SUM'',
						''RSCP_CNT'',''ECN0_SUM'',''ECN0_CNT'',''UL_VOLUME_SUM'',''DL_VOLUME_SUM'',
						''UL_THROUPUT_MAX'',''DL_THROUPUT_MAX'',''UL_THROUPUT_SUM'',''UL_THROUPUT_CNT'',
						''DL_THROUPUT_SUM'',''DL_THROUPUT_CNT'',''FP_RSCP_1'',''FP_ECN0_1'',''BEST_CNT'',
						''CALL_SETUP_TIME_SUM'',''CALL_SETUP_TIME_CNT'',''SF_VOICE_CNT'',''SF_VEDIO_CNT'',
						''SF_R99_CNT'',''SF_HSPA_CNT'',''SF_MRAB_CNT'',''SF_OTHER_CNT'',''SF_SMS_CNT'',
						''SF_SIGNAL_CNT'',''CALL_DUR_SUM'',''VOICE_DUR_SUM'',''VIDEO_DUR_SUM'',''R99_DUR_SUM'',
						''HSPA_DUR_SUM'',''MRAB_DUR_SUM'',''REG_ID_578'',''REG_ID_85'',
						''INIT_CALL_CNT'',''END_CALL_CNT'',
						''END_VOICE_CNT'',''END_VIDEO_CNT'',''END_PS_R99_CNT'',''END_PS_HSPA_CNT'',
						''END_M_RAB_CNT'',''END_SIGNAL_CNT'',''END_SMS_CNT'',''END_PS_OTHER_CNT''
						
					UNION
					SELECT A.DATA_DATE,A.CELL_ID,A.SITE_ID,A.CLUSTER_ID,A.RNC_ID,
						A.FREQUENCY,A.UARFCN,VOICE_CNT,A.VIDEO_CNT,
						A.PS_R99_CNT,A.PS_HSPA_CNT,A.M_RAB_CNT,
						A.SIGNAL_CNT,A.SMS_CNT,A.PS_OTHER_CNT,
						A.DROP_VOICE_CNT,A.DROP_VIDEO_CNT,A.DROP_PS_R99_CNT,
						A.DROP_PS_HSPA_CNT,A.DROP_M_RAB_CNT,A.DROP_SIGNAL_CNT,
						A.DROP_SMS_CNT,A.DROP_PS_OTHER_CNT,A.NON_BLOCK_VOICE_CNT,
						A.NON_BLOCK_VIDEO_CNT,A.NON_BLOCK_PS_R99_CNT,
						A.NON_BLOCK_PS_HSPA_CNT,A.NON_BLOCK_M_RAB_CNT,A.NON_BLOCK_SIGNAL_CNT,
						A.NON_BLOCK_SMS_CNT,A.NON_BLOCK_PS_OTHER_CNT,A.BLOCK_VOICE_CNT,
						A.BLOCK_VEDIO_CNT,A.BLOCK_R99_CNT,A.BLOCK_HSPA_CNT,A.BLOCK_MRAB_CNT,
						A.BLOCK_SIGNAL_CNT,A.BLOCK_SMS_CNT,A.BLOCK_PS_OTHER_CNT,A.RSCP_SUM,
						A.RSCP_CNT,A.ECN0_SUM,A.ECN0_CNT,A.UL_VOLUME_SUM,A.DL_VOLUME_SUM,
						A.UL_THROUPUT_MAX,A.DL_THROUPUT_MAX,A.UL_THROUPUT_SUM,A.UL_THROUPUT_CNT,
						A.DL_THROUPUT_SUM,A.DL_THROUPUT_CNT,A.FP_RSCP_1,A.FP_ECN0_1,A.BEST_CNT,
						A.CALL_SETUP_TIME_SUM,A.CALL_SETUP_TIME_CNT,A.SF_VOICE_CNT,A.SF_VEDIO_CNT,
						A.SF_R99_CNT,A.SF_HSPA_CNT,A.SF_MRAB_CNT,A.SF_OTHER_CNT,A.SF_SMS_CNT,
						A.SF_SIGNAL_CNT,A.CALL_DUR_SUM,A.VOICE_DUR_SUM,A.VIDEO_DUR_SUM,
						A.R99_DUR_SUM,A.HSPA_DUR_SUM,A.MRAB_DUR_SUM,
						A.`REG_ID_578`,B.ID AS `REG_ID_85`,
						A.INIT_CALL_CNT,A.END_CALL_CNT,
						A.END_VOICE_CNT,A.END_VIDEO_CNT,A.END_PS_R99_CNT,A.END_PS_HSPA_CNT,
						A.END_M_RAB_CNT,A.END_SIGNAL_CNT,A.END_SMS_CNT,A.END_PS_OTHER_CNT
					FROM ',gt_global_statistic,'.TMP_table_cell_agg_umts A,gt_global_statistic.table_cell_polygon_g2 B
					WHERE b.TECHNOLOGY=''3g''
					AND a.rnc_id=b.NETWORK_ELEMENT
					AND a.site_id=b.site_id
					AND a.cell_id=b.cell_id
					INTO OUTFILE "',FOLDER_PATH,'table_cell_agg_umts_dy_',DATA_DATE,'.csv"
					FIELDS TERMINATED BY ''\t''
					OPTIONALLY ENCLOSED BY ''''
					LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('REPAIR TABLE ',gt_global_statistic_g1,'.table_cell_agg_lte_dy_',DATA_DATE,';');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
		
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.TMP_table_cell_agg_lte;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	SET @SqlCmd=CONCAT('CREATE TEMPORARY TABLE ',gt_global_statistic,'.TMP_table_cell_agg_lte AS
				SELECT A.DATA_DATE,A.CELL_ID,A.ENODEB_ID,A.PU_ID,A.EARFCN,
						A.EUTRABAND,A.SIGNAL_CNT,A.DATA_CNT,A.SMS_CNT,
						A.VOLTE_CNT,A.UNSPECIFIED_CNT,A.DROP_SIGNAL_CNT,
						A.DROP_DATA_CNT,A.DROP_SMS_CNT,A.DROP_VOLTE_CNT,
						A.DROP_UNSPECIFIED_CNT,A.BLOCK_SIGNAL_CNT,A.BLOCK_DATA_CNT,
						A.BLOCK_SMS_CNT,A.BLOCK_VOLTE_CNT,A.BLOCK_UNSPECIFIED_CNT,
						A.CSFB_SIGNAL_CNT,A.CSFB_DATA_CNT,A.CSFB_SMS_CNT,
						A.CSFB_VOLTE_CNT,A.CSFB_UNSPECIFIED_CNT,
						A.NON_BLOCK_SIGNAL_CNT,A.NON_BLOCK_DATA_CNT,A.NON_BLOCK_SMS_CNT,
						A.NON_BLOCK_VOLTE_CNT,A.NON_BLOCK_UNSPECIFIED_CNT,A.RSRP_SUM,
						A.RSRP_CNT,A.RSRQ_SUM,A.RSRQ_CNT,A.UL_VOLUME_SUM,
						A.DL_VOLUME_SUM,A.UL_THROUPUT_MAX,A.DL_THROUPUT_MAX,A.UL_THROUPUT_SUM,
						A.UL_THROUPUT_CNT,A.DL_THROUPUT_SUM,A.DL_THROUPUT_CNT,A.INTER_FREQ_ATTEMPT_CNT,A.INTER_FREQ_FAILURE_CNT,
						A.INTRA_FREQ_ATTEMPT_CNT,A.INTRA_FREQ_FAILURE_CNT,A.4G_3G_ATTEMPT_CNT,A.4G_3G_FAILURE_CNT,
						A.4G_2G_ATTEMPT_CNT,A.4G_2G_FAILURE_CNT,A.MR_4G_RSRP_SERVING_SUM,A.MR_4G_RSRP_SERVING_CNT,A.MR_4G_RSRQ_SERVING_SUM,
						A.MR_4G_RSRQ_SERVING_CNT,A.CALL_SETUP_TIME_SUM,A.CALL_SETUP_TIME_CNT,A.SF_SIGNAL_CNT,
						A.SF_DATA_CNT,A.SF_SMS_CNT,A.SF_VOLTE_CNT,A.SF_UNSPECIFIED_CNT,A.SRVCC_ATTEMPT_CNT,A.SRVCC_FAILURE_CNT,
						A.S1_HO_ATTEMPT,A.S1_HO_FAILURE,A.X2_HO_ATTEMPT,A.X2_HO_FAILURE,A.LATENCY_SUM,A.LATENCY_CNT,
						B.ID AS `REG_ID_578`,A.INIT_CALL_CNT,A.END_CALL_CNT,
						A.END_SIGNAL_CNT,A.END_DATA_CNT,A.END_SMS_CNT,
						A.END_VOLTE_CNT,A.END_UNSPECIFIED_CNT
				FROM ',gt_global_statistic_g1,'.table_cell_agg_lte_dy_',DATA_DATE,' A,gt_global_statistic.table_cell_polygon_g1 B
				WHERE b.TECHNOLOGY=''4g''
				AND a.pu_id=b.NETWORK_ELEMENT
				AND a.ENODEB_ID=b.site_id
				AND a.cell_id=b.cell_id');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	
	SET @SqlCmd=CONCAT('SELECT ''DATA_DATE'',''CELL_ID'',''ENODEB_ID'',''PU_ID'',''EARFCN'',
						''EUTRABAND'',''SIGNAL_CNT'',''DATA_CNT'',''SMS_CNT'',
						''VOLTE_CNT'',''UNSPECIFIED_CNT'',''DROP_SIGNAL_CNT'',
						''DROP_DATA_CNT'',''DROP_SMS_CNT'',''DROP_VOLTE_CNT'',
						''DROP_UNSPECIFIED_CNT'',''BLOCK_SIGNAL_CNT'',''BLOCK_DATA_CNT'',
						''BLOCK_SMS_CNT'',''BLOCK_VOLTE_CNT'',''BLOCK_UNSPECIFIED_CNT'',
						''CSFB_SIGNAL_CNT'',''CSFB_DATA_CNT'',''CSFB_SMS_CNT'',
						''CSFB_VOLTE_CNT'',''CSFB_UNSPECIFIED_CNT'',
						''NON_BLOCK_SIGNAL_CNT'',''NON_BLOCK_DATA_CNT'',''NON_BLOCK_SMS_CNT'',
						''NON_BLOCK_VOLTE_CNT'',''NON_BLOCK_UNSPECIFIED_CNT'',''RSRP_SUM'',
						''RSRP_CNT'',''RSRQ_SUM'',''RSRQ_CNT'',''UL_VOLUME_SUM'',
						''DL_VOLUME_SUM'',''UL_THROUPUT_MAX'',''DL_THROUPUT_MAX'',''UL_THROUPUT_SUM'',
						''UL_THROUPUT_CNT'',''DL_THROUPUT_SUM'',''DL_THROUPUT_CNT'',''INTER_FREQ_ATTEMPT_CNT'',''INTER_FREQ_FAILURE_CNT'',
						''INTRA_FREQ_ATTEMPT_CNT'',''INTRA_FREQ_FAILURE_CNT'',''4G_3G_ATTEMPT_CNT'',''4G_3G_FAILURE_CNT'',
						''4G_2G_ATTEMPT_CNT'',''4G_2G_FAILURE_CNT'',''MR_4G_RSRP_SERVING_SUM'',''MR_4G_RSRP_SERVING_CNT'',''MR_4G_RSRQ_SERVING_SUM'',
						''MR_4G_RSRQ_SERVING_CNT'',''CALL_SETUP_TIME_SUM'',''CALL_SETUP_TIME_CNT'',''SF_SIGNAL_CNT'',
						''SF_DATA_CNT'',''SF_SMS_CNT'',''SF_VOLTE_CNT'',''SF_UNSPECIFIED_CNT'',''SRVCC_ATTEMPT_CNT'',''SRVCC_FAILURE_CNT'',
						''S1_HO_ATTEMPT'',''S1_HO_FAILURE'',''X2_HO_ATTEMPT'',''X2_HO_FAILURE'',''LATENCY_SUM'',''LATENCY_CNT'',
						''REG_ID_578'',''REG_ID_85'',''INIT_CALL_CNT'',''END_CALL_CNT'',
						''END_SIGNAL_CNT'',''END_DATA_CNT'',''END_SMS_CNT'',''END_VOLTE_CNT'',''END_UNSPECIFIED_CNT''
						
					UNION
					SELECT A.DATA_DATE,A.CELL_ID,A.ENODEB_ID,A.PU_ID,A.EARFCN,
						A.EUTRABAND,A.SIGNAL_CNT,A.DATA_CNT,A.SMS_CNT,
						A.VOLTE_CNT,A.UNSPECIFIED_CNT,A.DROP_SIGNAL_CNT,
						A.DROP_DATA_CNT,A.DROP_SMS_CNT,A.DROP_VOLTE_CNT,
						A.DROP_UNSPECIFIED_CNT,A.BLOCK_SIGNAL_CNT,A.BLOCK_DATA_CNT,
						A.BLOCK_SMS_CNT,A.BLOCK_VOLTE_CNT,A.BLOCK_UNSPECIFIED_CNT,
						A.CSFB_SIGNAL_CNT,A.CSFB_DATA_CNT,A.CSFB_SMS_CNT,
						A.CSFB_VOLTE_CNT,A.CSFB_UNSPECIFIED_CNT,
						A.NON_BLOCK_SIGNAL_CNT,A.NON_BLOCK_DATA_CNT,A.NON_BLOCK_SMS_CNT,
						A.NON_BLOCK_VOLTE_CNT,A.NON_BLOCK_UNSPECIFIED_CNT,A.RSRP_SUM,
						A.RSRP_CNT,A.RSRQ_SUM,A.RSRQ_CNT,A.UL_VOLUME_SUM,
						A.DL_VOLUME_SUM,A.UL_THROUPUT_MAX,A.DL_THROUPUT_MAX,A.UL_THROUPUT_SUM,
						A.UL_THROUPUT_CNT,A.DL_THROUPUT_SUM,A.DL_THROUPUT_CNT,A.INTER_FREQ_ATTEMPT_CNT,A.INTER_FREQ_FAILURE_CNT,
						A.INTRA_FREQ_ATTEMPT_CNT,A.INTRA_FREQ_FAILURE_CNT,A.4G_3G_ATTEMPT_CNT,A.4G_3G_FAILURE_CNT,
						A.4G_2G_ATTEMPT_CNT,A.4G_2G_FAILURE_CNT,A.MR_4G_RSRP_SERVING_SUM,A.MR_4G_RSRP_SERVING_CNT,A.MR_4G_RSRQ_SERVING_SUM,
						A.MR_4G_RSRQ_SERVING_CNT,A.CALL_SETUP_TIME_SUM,A.CALL_SETUP_TIME_CNT,A.SF_SIGNAL_CNT,
						A.SF_DATA_CNT,A.SF_SMS_CNT,A.SF_VOLTE_CNT,A.SF_UNSPECIFIED_CNT,A.SRVCC_ATTEMPT_CNT,A.SRVCC_FAILURE_CNT,
						A.S1_HO_ATTEMPT,A.S1_HO_FAILURE,A.X2_HO_ATTEMPT,A.X2_HO_FAILURE,A.LATENCY_SUM,A.LATENCY_CNT,
						A.`REG_ID_578`,B.ID AS `REG_ID_85`,A.INIT_CALL_CNT,A.END_CALL_CNT,
						A.END_SIGNAL_CNT,A.END_DATA_CNT,A.END_SMS_CNT,A.END_VOLTE_CNT,A.END_UNSPECIFIED_CNT
					FROM ',gt_global_statistic,'.TMP_table_cell_agg_lte A,gt_global_statistic.table_cell_polygon_g2 B
					WHERE b.TECHNOLOGY=''4g''
					AND a.pu_id=b.NETWORK_ELEMENT
					AND a.ENODEB_ID=b.site_id
					AND a.cell_id=b.cell_id
					INTO OUTFILE "',FOLDER_PATH,'table_cell_agg_lte_dy_',DATA_DATE,'.csv"
					FIELDS TERMINATED BY ''\t''
					OPTIONALLY ENCLOSED BY ''''
					LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;	
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('REPAIR TABLE ',gt_global_statistic_g1,'.table_failcause_umts_dy_',DATA_DATE,';');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP  TABLE  IF EXISTS ',gt_global_statistic,'.TMP_failurecause_umts_578');
	PREPARE stmt FROM @sqlcmd;
	EXECUTE stmt;
	DEALLOCATE PREPARE stmt;
	
	
	
	SET @SqlCmd=CONCAT('CREATE  TABLE ',gt_global_statistic,'.TMP_failurecause_umts_578 
				SELECT A.DATA_DATE,A.TILE_ID,A.RNC_ID,A.SITE_ID,A.CELL_ID,A.IMSI,A.IMEI,
				A.EVENT_ID,A.FAILURE_EVENT_ID,A.FAILURE_EVENT_CAUSE,A.FAILURE_CNT,
				B.manufacturer,B.model
				FROM ',gt_global_statistic_g1,'.table_failcause_umts_dy_',DATA_DATE,' A LEFT JOIN gt_covmo.dim_handset B
				ON LEFT(A.IMEI,8)=B.TAC
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	
	SET @SqlCmd=CONCAT('ALTER  TABLE ',gt_global_statistic,'.TMP_failurecause_umts_578 
				ADD COLUMN REG_ID VARCHAR(20);
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `key_tile` ON ',gt_global_statistic,'.TMP_failurecause_umts_578 (tile_id);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	
	CALL GT_GW_MAIN.`SP_Qlikview_Tile_Reg_Map`('gt_global_statistic.TMP_failurecause_umts_578','1','1');
	
	SET @SqlCmd=CONCAT('ALTER  TABLE ',gt_global_statistic,'.TMP_failurecause_umts_578 
				ADD PROTOCOL_ID TINYINT(4),
				ADD PROTOCOL_NAME VARCHAR(32)AFTER PROTOCOL_ID,
				ADD CAUSE_NAME VARCHAR(150) AFTER PROTOCOL_NAME;
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `key_protocol_id` ON ',gt_global_statistic,'.TMP_failurecause_umts_578 (PROTOCOL_ID);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `key_failure_cause_id` ON ',gt_global_statistic,'.TMP_failurecause_umts_578 (FAILURE_EVENT_CAUSE);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('UPDATE ',gt_global_statistic,'.TMP_failurecause_umts_578 A, GT_COVMO.dim_failure_event B
				SET A.PROTOCOL_ID= B.PROTOCOL
				WHERE A.FAILURE_EVENT_ID=B.EVENT_ID;
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('UPDATE ',gt_global_statistic,'.TMP_failurecause_umts_578 
			SET PROTOCOL_NAME=(
			  CASE PROTOCOL_ID
			  WHEN 1 THEN ''UMTS RRC''
			  WHEN 2 THEN ''UMTS RNSAP''
			  WHEN 3 THEN ''UMTS RANAP''
			  WHEN 4 THEN ''UMTS NBAP''
			  WHEN 5 THEN ''UMTS NAS_CAUSE_CC''
			  WHEN 6 THEN ''UMTS NAS_CAUSE_SM''
			  ELSE NULL END);');			
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('UPDATE ',gt_global_statistic,'.TMP_failurecause_umts_578 A, GT_COVMO.dim_failure_cause B
				SET A.CAUSE_NAME= B.CAUSE_NAME
				WHERE A.PROTOCOL_ID=B.PROTOCOL
				AND A.FAILURE_EVENT_CAUSE=B.CAUSE_ID;
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('SELECT ''DATA_DATE'',''TILE_ID'',''RNC_ID'',''SITE_ID'',''CELL_ID'',''IMSI'',''IMEI'',
				''EVENT_ID'',''FAILURE_EVENT_ID'',''FAILURE_EVENT_CAUSE'',''FAILURE_CNT'',
				''MANUFACTURER'',''MODEL'',''REG_ID'',''REG_NAME'',''PROTOCOL_ID'',''PROTOCOL_NAME'',''CAUSE_NAME''
				UNION 
				SELECT 
				A.DATA_DATE,A.TILE_ID,A.RNC_ID,A.SITE_ID,A.CELL_ID,A.IMSI,A.IMEI,
				A.EVENT_ID,A.FAILURE_EVENT_ID,A.FAILURE_EVENT_CAUSE,A.FAILURE_CNT,
				A.manufacturer,A.model,A.REG_ID,B.name,a.PROTOCOL_ID,a.PROTOCOL_NAME,a.CAUSE_NAME
				
				FROM ',gt_global_statistic,'.TMP_failurecause_umts_578 A LEFT JOIN ',gt_global_statistic,'.usr_polygon_reg_3_v4 B
				ON A.REG_ID=B.id
				WHERE A.FAILURE_EVENT_CAUSE <> 0 AND A.FAILURE_EVENT_CAUSE <> 1004099 
				AND A.PROTOCOL_NAME IS NOT NULL
				AND A.CAUSE_NAME IS NOT NULL
				AND A.PROTOCOL_ID IN(1,3,4)		
				AND ((A.PROTOCOL_ID=4 AND A.FAILURE_EVENT_CAUSE<> 1010000)
				OR (A.PROTOCOL_ID=3 AND A.FAILURE_EVENT_CAUSE<> 1029000))
				INTO OUTFILE "',FOLDER_PATH,'table_failcause_umts_dy_',DATA_DATE,'_578.csv"
				FIELDS TERMINATED BY ''\t''
				OPTIONALLY ENCLOSED BY ''''
				LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP  TABLE  IF EXISTS ',gt_global_statistic,'.TMP_failurecause_umts_578');
	PREPARE stmt FROM @sqlcmd;
	EXECUTE stmt;
	DEALLOCATE PREPARE stmt;
	
	SET @SqlCmd=CONCAT('DROP  TABLE  IF EXISTS ',gt_global_statistic,'.TMP_failurecause_lte_578');
	PREPARE stmt FROM @sqlcmd;
	EXECUTE stmt;
	DEALLOCATE PREPARE stmt;
	
	SET @SqlCmd=CONCAT('CREATE  TABLE ',gt_global_statistic,'.TMP_failurecause_lte_578 
				SELECT A.DATA_DATE,A.TILE_ID,A.PU_ID,A.ENODEB_ID,A.CELL_ID,A.IMSI,A.IMEI,
				A.EVENT_ID,A.FAILURE_EVENT_ID,A.FAILURE_EVENT_CAUSE,A.FAILURE_CNT,
				B.manufacturer,B.model 
				FROM ',gt_global_statistic_g1,'.table_failcause_lte_dy_',DATA_DATE,' A LEFT JOIN gt_covmo.dim_handset B
				ON LEFT(A.IMEI,8)=B.TAC
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	
	SET @SqlCmd=CONCAT('ALTER  TABLE ',gt_global_statistic,'.TMP_failurecause_lte_578 
				ADD COLUMN REG_ID VARCHAR(20) ;
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `key_tile` ON ',gt_global_statistic,'.TMP_failurecause_lte_578 (tile_id);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	
	CALL GT_GW_MAIN.`SP_Qlikview_Tile_Reg_Map`('gt_global_statistic.TMP_failurecause_lte_578','1','1');
	
	SET @SqlCmd=CONCAT('ALTER  TABLE ',gt_global_statistic,'.TMP_failurecause_lte_578 
				ADD PROTOCOL_ID TINYINT(4),
				ADD PROTOCOL_NAME VARCHAR(32)AFTER PROTOCOL_ID,
				ADD CAUSE_NAME VARCHAR(150) AFTER PROTOCOL_NAME;
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `key_protocol_id` ON ',gt_global_statistic,'.TMP_failurecause_lte_578 (PROTOCOL_ID);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `key_failure_cause_id` ON ',gt_global_statistic,'.TMP_failurecause_lte_578 (FAILURE_EVENT_CAUSE);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('UPDATE ',gt_global_statistic,'.TMP_failurecause_lte_578 A, GT_COVMO.dim_failure_event_lte B
				SET A.PROTOCOL_ID= B.PROTOCOL
				WHERE A.FAILURE_EVENT_ID=B.EVENT_ID;
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('UPDATE ',gt_global_statistic,'.TMP_failurecause_lte_578 
				SET PROTOCOL_NAME = (
				  CASE PROTOCOL_ID
				  WHEN 1 THEN ''LTE RRC''
				  WHEN 2 THEN ''LTE S1AP''
				  WHEN 3 THEN ''LTE X2AP''
				  ELSE NULL END);');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
		
	SET @SqlCmd=CONCAT('UPDATE  ',gt_global_statistic,'.TMP_failurecause_lte_578 A, GT_COVMO.dim_failure_cause_lte B
				SET A.CAUSE_NAME= B.CAUSE_NAME
				WHERE A.PROTOCOL_ID=B.PROTOCOL
				AND A.FAILURE_EVENT_CAUSE=B.CAUSE_ID;
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	
	SET @SqlCmd=CONCAT('SELECT ''DATA_DATE'',''TILE_ID'',''PU_ID'',''ENODEB_ID'',''CELL_ID'',''IMSI'',''IMEI'',
				''EVENT_ID'',''FAILURE_EVENT_ID'',''FAILURE_EVENT_CAUSE'',''FAILURE_CNT'',
				''MANUFACTURER'',''MODEL'',''REG_ID'',''REG_NAME'',''PROTOCOL_ID'',''PROTOCOL_NAME'',''CAUSE_NAME''
				UNION 
				SELECT 
				A.DATA_DATE,A.TILE_ID,A.PU_ID,A.ENODEB_ID,A.CELL_ID,A.IMSI,A.IMEI,
				A.EVENT_ID,A.FAILURE_EVENT_ID,A.FAILURE_EVENT_CAUSE,A.FAILURE_CNT,
				A.manufacturer,A.model,A.REG_ID,B.name,a.PROTOCOL_ID,a.PROTOCOL_NAME,a.CAUSE_NAME
				
				FROM ',gt_global_statistic,'.TMP_failurecause_lte_578 A LEFT JOIN ',gt_global_statistic,'.usr_polygon_reg_3_v4 B
				ON A.REG_ID=B.id
				WHERE A.FAILURE_EVENT_CAUSE <> -1
				AND a.PROTOCOL_NAME IS NOT NULL
				AND a.CAUSE_NAME IS NOT NULL
				INTO OUTFILE "',FOLDER_PATH,'table_failcause_lte_dy_',DATA_DATE,'_578.csv"
				FIELDS TERMINATED BY ''\t''
				OPTIONALLY ENCLOSED BY ''''
				LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP  TABLE  IF EXISTS ',gt_global_statistic,'.TMP_failurecause_lte_578');
	PREPARE stmt FROM @sqlcmd;
	EXECUTE stmt;
	DEALLOCATE PREPARE stmt;
	
	SET @SqlCmd=CONCAT('REPAIR TABLE ',gt_global_statistic_g1,'.table_imsi_gsm_dy_',DATA_DATE,';');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
				
	SET @SqlCmd=CONCAT('SELECT ''IMSI'',''DATA_DATE'',''CALL_CNT'',''VOICE_MO_CNT'',''VOICE_MT_CNT'',
						''DATA_MO_CNT'',''DATA_MT_CNT'',''SMS_MO_CNT'',''SMS_MT_CNT'',
						''SIGNAL_CNT'',''CALL_DUR_SUM'',''VOICE_DUR_SUM'',
						''DATA_DUR_SUM'',''DROP_CNT'',''BLOCK_CNT'',
						''DROP_VOICE_CNT'',''DROP_GPRS_CNT'',''DROP_SMS_CNT'',
						''DROP_SIGNAL_CNT'',''DROP_OTHER_CNT'',''BLOCK_VOICE_CNT'',
						''BLOCK_GPRS_CNT'',''BLOCK_SMS_CNT'',''BLOCK_SIGNAL_CNT''
						''BLOCK_OTHER_CNT'',''HO_ATTEMPT_CNT'',
						''HO_FAILURE_CNT'',''MOVING_CALL_CNT'',''INDOOR_CALL_CNT'',
						''FIRST_RXLEV_DL_SUM'',''FIRST_RXLEV_DL_CNT'',''FIRST_RXQUAL_DL_SUM'',
						''FIRST_RXQUAL_DL_CNT'',''FIRST_RXLEV_UL_SUM'',''FIRST_RXLEV_UL_CNT'',''FIRST_RXQUAL_UL_SUM'',
						''FIRST_RXQUAL_UL_CNT'',''CALL_SETUP_TIME_SUM'',''CALL_SETUP_TIME_CNT'',''SF_VOICE_CNT'',
						''SF_GPRS_CNT'',''SF_SMS_CNT'',''SF_SIGNAL_CNT'',''SF_OTHER_CNT'',''MAKE_ID'',''MODEL_ID'',
						''START_CELL_ID'',''START_SITE_ID'',''START_REG_1_ID'',''START_REG_2_ID'',''START_REG_3_ID'',
						''END_CELL_ID'',''END_SITE_ID'',''END_REG_1_ID'',''END_REG_2_ID'',''END_REG_3_ID''
					UNION
					SELECT IMSI,DATA_DATE,CALL_CNT,VOICE_MO_CNT,VOICE_MT_CNT,
						DATA_MO_CNT,DATA_MT_CNT,SMS_MO_CNT,SMS_MT_CNT,
						SIGNAL_CNT,CALL_DUR_SUM,VOICE_DUR_SUM,
						DATA_DUR_SUM,DROP_CNT,BLOCK_CNT,
						DROP_VOICE_CNT,DROP_GPRS_CNT,DROP_SMS_CNT,
						DROP_SIGNAL_CNT,DROP_OTHER_CNT,BLOCK_VOICE_CNT,
						BLOCK_GPRS_CNT,BLOCK_SMS_CNT,BLOCK_SIGNAL_CNT
						BLOCK_OTHER_CNT,HO_ATTEMPT_CNT,
						HO_FAILURE_CNT,MOVING_CALL_CNT,INDOOR_CALL_CNT,
						FIRST_RXLEV_DL_SUM,FIRST_RXLEV_DL_CNT,FIRST_RXQUAL_DL_SUM,
						FIRST_RXQUAL_DL_CNT,FIRST_RXLEV_UL_SUM,FIRST_RXLEV_UL_CNT,FIRST_RXQUAL_UL_SUM,
						FIRST_RXQUAL_UL_CNT,CALL_SETUP_TIME_SUM,CALL_SETUP_TIME_CNT,SF_VOICE_CNT,
						SF_GPRS_CNT,SF_SMS_CNT,SF_SIGNAL_CNT,SF_OTHER_CNT,MAKE_ID,MODEL_ID,
						START_CELL_ID,START_SITE_ID,START_REG_1_ID,START_REG_2_ID,START_REG_3_ID,
						END_CELL_ID,END_SITE_ID,END_REG_1_ID,END_REG_2_ID,END_REG_3_ID
					FROM ',gt_global_statistic_g1,'.table_imsi_gsm_dy_',DATA_DATE,'
					INTO OUTFILE "',FOLDER_PATH,'table_imsi_gsm_dy_',DATA_DATE,'_578.csv"
					FIELDS TERMINATED BY ''\t''
					OPTIONALLY ENCLOSED BY ''''
					LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('REPAIR TABLE ',gt_global_statistic_g1,'.table_imsi_umts_dy_',DATA_DATE,';');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
		
	SET @SqlCmd=CONCAT('SELECT ''IMSI'',''DATA_DATE'',''CALL_CNT'',''VOICE_MO_CNT'',''VOICE_MT_CNT'',
						''VIDEO_MO_CNT'',''VIDEO_MT_CNT'',''R99_MO_CNT'',''R99_MT_CNT'',
						''HSPA_MO_CNT'',''HSPA_MT_CNT'',''MRAB_MO_CNT'',
						''MRAB_MT_CNT'',''SIGNAL_MO_CNT'',''SIGNAL_MT_CNT'',
						''SMS_MO_CNT'',''SMS_MT_CNT'',''PS_OTHER_CNT'',
						''CALL_DUR_SUM'',''VOICE_DUR_SUM'',''VIDEO_DUR_SUM'',
						''R99_DUR_SUM'',''HSPA_DUR_SUM'',''MRAB_DUR_SUM'',
						''DROP_CNT'',''DROP_VOICE_CNT'',''DROP_VEDIO_CNT'',
						''DROP_R99_CNT'',''DROP_HSPA_CNT'',''DROP_MRAB_CNT'',
						''DROP_SMS_CNT'',''DROP_SIGNAL_CNT'',''DROP_PS_OTHER_CNT'',
						''DROP_RF_CNT'',''DROP_CONG_CNT'',''DROP_TRANS_CNT'',''DROP_SHO_CNT'',
						''DROP_HHO_CNT'',''DROP_IRAT_CNT'',''BLOCK_CNT'',''BLOCK_VOICE_CNT'',
						''BLOCK_VEDIO_CNT'',''BLOCK_R99_CNT'',''BLOCK_HSPA_CNT'',''BLOCK_MRAB_CNT'',''BLOCK_SMS_CNT'',
						''BLOCK_SIGNAL_CNT'',''BLOCK_PS_OTHER_CNT'',''SHO_ATTEMPT_CNT'',''SHO_FAILURE_CNT'',
						''HHO_ATTEMPT_CNT'',''HHO_FAILURE_CNT'',''IRAT_ATTEMPT_CNT'',''IRAT_FAILURE_CNT'',''MOVING_CALL_CNT'',
						''INDOOR_CALL_CNT'',''PS_UL_VOLUME_SUM'',''PS_DL_VOLUME_SUM'',''PS_UL_SPEED_MAX'',''PS_DL_SPEED_MAX'',
						''FIRST_RSCP_SUM'',''FIRST_RSCP_CNT'',''FIRST_ECNO_SUM'',''FIRST_ECNO_CNT'',''CALL_SETUP_TIME_SUM'',''CALL_SETUP_TIME_CNT'',
						''SF_CNT'',''SF_VOICE_CNT'',''SF_VEDIO_CNT'',''SF_R99_CNT'',''SF_HSPA_CNT'',''SF_MRAB_CNT'',''SF_SMS_CNT'',
						''SF_SIGNAL_CNT'',''SF_PS_OTHER_CNT'',''PDP_ACTIVATION_REQUEST'',''PDP_ACTIVATION_ACCEPT'',''PDP_DEACTIVATION_REQUEST'',''PDP_DEACTIVATION_ACCEPT'',
						''AUTH_REQUEST'',''AUTH_RESPONSE'',''AUTH_CIPH_REQUEST'',''AUTH_CIPH_RESPONSE'',''SECURITY_MODE_ATT'',''SECURITY_MODE_SUCCESS'',
						''LU_REQUEST'',''LU_ACCEPT'',''RAU_REQUEST'',''RAU_ACCEPT'',''MAKE_ID'',''MODEL_ID'',
						''START_CELL_ID'',''START_SITE_ID'',''START_REG_1_ID'',''START_REG_2_ID'',''START_REG_3_ID'',
						''END_CELL_ID'',''END_SITE_ID'',''END_REG_1_ID'',''END_REG_2_ID'',''END_REG_3_ID''
						
					UNION
					SELECT IMSI,DATA_DATE,CALL_CNT,VOICE_MO_CNT,VOICE_MT_CNT,
						VIDEO_MO_CNT,VIDEO_MT_CNT,R99_MO_CNT,R99_MT_CNT,
						HSPA_MO_CNT,HSPA_MT_CNT,MRAB_MO_CNT,
						MRAB_MT_CNT,SIGNAL_MO_CNT,SIGNAL_MT_CNT,
						SMS_MO_CNT,SMS_MT_CNT,PS_OTHER_CNT,
						CALL_DUR_SUM,VOICE_DUR_SUM,VIDEO_DUR_SUM,
						R99_DUR_SUM,HSPA_DUR_SUM,MRAB_DUR_SUM,
						DROP_CNT,DROP_VOICE_CNT,DROP_VEDIO_CNT,
						DROP_R99_CNT,DROP_HSPA_CNT,DROP_MRAB_CNT,
						DROP_SMS_CNT,DROP_SIGNAL_CNT,DROP_PS_OTHER_CNT,
						DROP_RF_CNT,DROP_CONG_CNT,DROP_TRANS_CNT,DROP_SHO_CNT,
						DROP_HHO_CNT,DROP_IRAT_CNT,BLOCK_CNT,BLOCK_VOICE_CNT,
						BLOCK_VEDIO_CNT,BLOCK_R99_CNT,BLOCK_HSPA_CNT,BLOCK_MRAB_CNT,BLOCK_SMS_CNT,
						BLOCK_SIGNAL_CNT,BLOCK_PS_OTHER_CNT,SHO_ATTEMPT_CNT,SHO_FAILURE_CNT,
						HHO_ATTEMPT_CNT,HHO_FAILURE_CNT,IRAT_ATTEMPT_CNT,IRAT_FAILURE_CNT,MOVING_CALL_CNT,
						INDOOR_CALL_CNT,PS_UL_VOLUME_SUM,PS_DL_VOLUME_SUM,PS_UL_SPEED_MAX,PS_DL_SPEED_MAX,
						FIRST_RSCP_SUM,FIRST_RSCP_CNT,FIRST_ECNO_SUM,FIRST_ECNO_CNT,CALL_SETUP_TIME_SUM,CALL_SETUP_TIME_CNT,
						SF_CNT,SF_VOICE_CNT,SF_VEDIO_CNT,SF_R99_CNT,SF_HSPA_CNT,SF_MRAB_CNT,SF_SMS_CNT,
						SF_SIGNAL_CNT,SF_PS_OTHER_CNT,PDP_ACTIVATION_REQUEST,PDP_ACTIVATION_ACCEPT,PDP_DEACTIVATION_REQUEST,PDP_DEACTIVATION_ACCEPT,
						AUTH_REQUEST,AUTH_RESPONSE,AUTH_CIPH_REQUEST,AUTH_CIPH_RESPONSE,SECURITY_MODE_ATT,SECURITY_MODE_SUCCESS,
						LU_REQUEST,LU_ACCEPT,RAU_REQUEST,RAU_ACCEPT,MAKE_ID,MODEL_ID,
						START_CELL_ID,START_SITE_ID,START_REG_1_ID,START_REG_2_ID,START_REG_3_ID,
						END_CELL_ID,END_SITE_ID,END_REG_1_ID,END_REG_2_ID,END_REG_3_ID
					FROM ',gt_global_statistic_g1,'.table_imsi_umts_dy_',DATA_DATE,'
					INTO OUTFILE "',FOLDER_PATH,'table_imsi_umts_dy_',DATA_DATE,'_578.csv"
					FIELDS TERMINATED BY ''\t''
					OPTIONALLY ENCLOSED BY ''''
					LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('REPAIR TABLE ',gt_global_statistic_g1,'.table_imsi_lte_dy_',DATA_DATE,';');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
		
	SET @SqlCmd=CONCAT('SELECT ''IMSI'',''DATA_DATE'',''CALL_CNT'',''DATA_CNT'',''SIGNAL_CNT'',
						''SMS_CNT'',''VOLTE_CNT'',''UNSPECIFIED_CNT'',''CALL_DUR_SUM'',
						''DATA_DUR_SUM'',''SIGNAL_DUR_SUM'',''DROP_CNT'',
						''DROP_DATA_CNT'',''DROP_SIGNAL_CNT'',''DROP_SMS_CNT'',
						''DROP_VOLTE_CNT'',''DROP_UNSPECIFIED_CNT'',''BLOCK_CNT'',
						''BLOCK_DATA_CNT'',''BLOCK_SIGNAL_CNT'',''BLOCK_SMS_CNT'',
						''BLOCK_VOLTE_CNT'',''BLOCK_UNSPECIFIED_CNT'',''DROP_RDO_NW_CNT'',
						''DROP_TRANS_CNT'',''DROP_NAS_CNT'',''DROP_MISC_CNT'',
						''DROP_PROTOCOL_CNT'',''INTER_FREQ_ATTEMPT_CNT'',''INTER_FREQ_FAILURE_CNT'',
						''INTRA_FREQ_ATTEMPT_CNT'',''INTRA_FREQ_FAILURE_CNT'',''4G_3G_ATTEMPT_CNT'',
						''4G_3G_FAILURE_CNT'',''4G_2G_ATTEMPT_CNT'',''4G_2G_FAILURE_CNT'',''MOVING_CALL_CNT'',
						''INDOOR_CALL_CNT'',''PS_UL_VOLUME_SUM'',''PS_DL_VOLUME_SUM'',''PS_UL_SPEED_MAX'',
						''PS_DL_SPEED_MAX'',''FIRST_RSRP_SUM'',''FIRST_RSRP_CNT'',''FIRST_RSRQ_SUM'',''FIRST_RSRQ_CNT'',
						''CALL_SETUP_TIME_SUM'',''CALL_SETUP_TIME_CNT'',''SF_CNT'',''SF_DATA_CNT'',
						''SF_SIGNAL_CNT'',''SF_SMS_CNT'',''SF_VOLTE_CNT'',''SF_UNSPECIFIED_CNT'',''MT_DATA_CNT'',
						''MO_DATA_CNT'',''MT_SMS_CNT'',''MO_SMS_CNT'',''MT_VOLTE_CNT'',''MO_VOLTE_CNT'',
						''CSFB_SIGNAL_CNT'',''CSFB_DATA_CNT'',''CSFB_SMS_CNT'',''CSFB_VOLTE_CNT'',''CSFB_UNSPECIFIED_CNT'',
						''CSFB_CNT'',''LATENCY_SUM'',''LATENCY_CNT'',
						''MAKE_ID'',''MODEL_ID'',
						''START_CELL_ID'',''START_ENODEB_ID'',''START_REG_1_ID'',''START_REG_2_ID'',''START_REG_3_ID'',
						''END_CELL_ID'',''END_ENODEB_ID'',''END_REG_1_ID'',''END_REG_2_ID'',''END_REG_3_ID''
						
					UNION
					SELECT IMSI,DATA_DATE,CALL_CNT,DATA_CNT,SIGNAL_CNT,
						SMS_CNT,VOLTE_CNT,UNSPECIFIED_CNT,CALL_DUR_SUM,
						DATA_DUR_SUM,SIGNAL_DUR_SUM,DROP_CNT,
						DROP_DATA_CNT,DROP_SIGNAL_CNT,DROP_SMS_CNT,
						DROP_VOLTE_CNT,DROP_UNSPECIFIED_CNT,BLOCK_CNT,
						BLOCK_DATA_CNT,BLOCK_SIGNAL_CNT,BLOCK_SMS_CNT,
						BLOCK_VOLTE_CNT,BLOCK_UNSPECIFIED_CNT,DROP_RDO_NW_CNT,
						DROP_TRANS_CNT,DROP_NAS_CNT,DROP_MISC_CNT,
						DROP_PROTOCOL_CNT,INTER_FREQ_ATTEMPT_CNT,INTER_FREQ_FAILURE_CNT,
						INTRA_FREQ_ATTEMPT_CNT,INTRA_FREQ_FAILURE_CNT,4G_3G_ATTEMPT_CNT,
						4G_3G_FAILURE_CNT,4G_2G_ATTEMPT_CNT,4G_2G_FAILURE_CNT,MOVING_CALL_CNT,
						INDOOR_CALL_CNT,PS_UL_VOLUME_SUM,PS_DL_VOLUME_SUM,PS_UL_SPEED_MAX,
						PS_DL_SPEED_MAX,FIRST_RSRP_SUM,FIRST_RSRP_CNT,FIRST_RSRQ_SUM,FIRST_RSRQ_CNT,
						CALL_SETUP_TIME_SUM,CALL_SETUP_TIME_CNT,SF_CNT,SF_DATA_CNT,
						SF_SIGNAL_CNT,SF_SMS_CNT,SF_VOLTE_CNT,SF_UNSPECIFIED_CNT,MT_DATA_CNT,
						MO_DATA_CNT,MT_SMS_CNT,MO_SMS_CNT,MT_VOLTE_CNT,MO_VOLTE_CNT,
						CSFB_SIGNAL_CNT,CSFB_DATA_CNT,CSFB_SMS_CNT,CSFB_VOLTE_CNT,CSFB_UNSPECIFIED_CNT,CSFB_CNT,LATENCY_SUM,LATENCY_CNT,
						MAKE_ID,MODEL_ID,
						START_CELL_ID,START_ENODEB_ID,START_REG_1_ID,START_REG_2_ID,START_REG_3_ID,
						END_CELL_ID,END_ENODEB_ID,END_REG_1_ID,END_REG_2_ID,END_REG_3_ID
					FROM ',gt_global_statistic_g1,'.table_imsi_lte_dy_',DATA_DATE,'
					INTO OUTFILE "',FOLDER_PATH,'table_imsi_lte_dy_',DATA_DATE,'_578.csv"
					FIELDS TERMINATED BY ''\t''
					OPTIONALLY ENCLOSED BY ''''
					LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('REPAIR TABLE ',gt_global_statistic_g1,'.table_romer_reg_3_gsm_dy_',DATA_DATE,';');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('SELECT ''REG_ID'',''MCC'',''MNC'',''FREQUENCY'',''DATA_DATE'',''INIT_CALL_CNT'',''END_CALL_CNT'',''VOICE_CNT'',''SIGNAL_CNT'',''SMS_CNT'',
					''GPRS_CNT'',''OTHER_CNT'',''BLOCK_CNT'',''DROP_VOICE_CNT'',''DROP_SIGNAL_CNT'',''DROP_SMS_CNT'',''DROP_GPRS_CNT'',''DROP_OTHER_CNT'',
					''NON_BLOCK_VOICE_CNT'',''NON_BLOCK_SIGNAL_CNT'',''NON_BLOCK_SMS_CNT'',''NON_BLOCK_GPRS_CNT'',''NON_BLOCK_OTHER_CNT'',''CALL_DUR_SUM'',
					''CALL_SETUP_TIME_SUM'',''CALL_SETUP_TIME_CNT''
					UNION
					SELECT REG_ID,MCC,MNC,FREQUENCY,DATA_DATE,INIT_CALL_CNT,END_CALL_CNT,VOICE_CNT,SIGNAL_CNT,SMS_CNT,
						GPRS_CNT,OTHER_CNT,BLOCK_CNT,DROP_VOICE_CNT,DROP_SIGNAL_CNT,DROP_SMS_CNT,DROP_GPRS_CNT,DROP_OTHER_CNT,
						NON_BLOCK_VOICE_CNT,NON_BLOCK_SIGNAL_CNT,NON_BLOCK_SMS_CNT,NON_BLOCK_GPRS_CNT,NON_BLOCK_OTHER_CNT,CALL_DUR_SUM,
						CALL_SETUP_TIME_SUM,CALL_SETUP_TIME_CNT
					FROM ',gt_global_statistic_g1,'.table_romer_reg_3_gsm_dy_',DATA_DATE,'
					
					INTO OUTFILE "',FOLDER_PATH,'table_romer_reg_3_gsm_dy_',DATA_DATE,'_578.csv"
					FIELDS TERMINATED BY ''\t''
					OPTIONALLY ENCLOSED BY ''''
					LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('REPAIR TABLE ',gt_global_statistic_g1,'.table_romer_reg_3_umts_dy_',DATA_DATE,';');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
		
	SET @SqlCmd=CONCAT('SELECT ''REG_ID'',''MCC'',''MNC'',''FREQUENCY'',''DATA_DATE'',''INIT_CALL_CNT'',''END_CALL_CNT'',''VOICE_CNT'',''VIDEO_CNT'',
				''PS_R99_CNT'',''PS_HSPA_CNT'',''M_RAB_CNT'',''SIGNAL_CNT'',''SMS_CNT'',''PS_OTHER_CNT'',''CALL_DUR_SUM'',''CS_DUR_SUM'',
				''DROP_CNT'',''BLOCK_CNT'',''DROP_VOICE_CNT'',''DROP_VIDEO_CNT'',''DROP_PS_R99_CNT'',''DROP_PS_HSPA_CNT'',
				''DROP_M_RAB_CNT'',''DROP_SIGNAL_CNT'',''DROP_SMS_CNT'',''DROP_PS_OTHER_CNT'',''PS_UL_VOLUME_SUM'',''PS_DL_VOLUME_SUM'',
				''PS_UL_SPEED_MAX'',''PS_DL_SPEED_MAX'',''UL_THROUPUT_SUM'',''UL_THROUPUT_CNT'',''DL_THROUPUT_SUM'',''DL_THROUPUT_CNT'',
				''NON_BLOCK_VOICE_CNT'',''NON_BLOCK_VIDEO_CNT'',''NON_BLOCK_PS_R99_CNT'',''NON_BLOCK_PS_HSPA_CNT'',''NON_BLOCK_M_RAB_CNT'',
				''NON_BLOCK_SIGNAL_CNT'',''NON_BLOCK_SMS_CNT'',''NON_BLOCK_PS_OTHER_CNT'',''PS_CNT'',''DROP_PS_CNT'',''CALL_SETUP_TIME_SUM'',''CALL_SETUP_TIME_CNT''	
					UNION
					SELECT REG_ID,MCC,MNC,FREQUENCY,DATA_DATE,INIT_CALL_CNT,END_CALL_CNT,VOICE_CNT,VIDEO_CNT,
						PS_R99_CNT,PS_HSPA_CNT,M_RAB_CNT,SIGNAL_CNT,SMS_CNT,PS_OTHER_CNT,CALL_DUR_SUM,CS_DUR_SUM,
						DROP_CNT,BLOCK_CNT,DROP_VOICE_CNT,DROP_VIDEO_CNT,DROP_PS_R99_CNT,DROP_PS_HSPA_CNT,
						DROP_M_RAB_CNT,DROP_SIGNAL_CNT,DROP_SMS_CNT,DROP_PS_OTHER_CNT,PS_UL_VOLUME_SUM,PS_DL_VOLUME_SUM,
						PS_UL_SPEED_MAX,PS_DL_SPEED_MAX,UL_THROUPUT_SUM,UL_THROUPUT_CNT,DL_THROUPUT_SUM,DL_THROUPUT_CNT,
						NON_BLOCK_VOICE_CNT,NON_BLOCK_VIDEO_CNT,NON_BLOCK_PS_R99_CNT,NON_BLOCK_PS_HSPA_CNT,NON_BLOCK_M_RAB_CNT,
						NON_BLOCK_SIGNAL_CNT,NON_BLOCK_SMS_CNT,NON_BLOCK_PS_OTHER_CNT,PS_CNT,DROP_PS_CNT,CALL_SETUP_TIME_SUM,CALL_SETUP_TIME_CNT
					FROM ',gt_global_statistic_g1,'.table_romer_reg_3_umts_dy_',DATA_DATE,'
					
					INTO OUTFILE "',FOLDER_PATH,'table_romer_reg_3_umts_dy_',DATA_DATE,'_578.csv"
					FIELDS TERMINATED BY ''\t''
					OPTIONALLY ENCLOSED BY ''''
					LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('REPAIR TABLE ',gt_global_statistic_g1,'.table_romer_reg_3_lte_dy_',DATA_DATE,';');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
		
	SET @SqlCmd=CONCAT('SELECT ''REG_ID'',''MCC'',''MNC'',''EARFCN'',''EUTRABAND'',''DATA_DATE'',''INIT_CALL_CNT'',''END_CALL_CNT'',''SIGNAL_CNT'',
				''DATA_CNT'',''UNSPECIFIED_CNT'',''CALL_DUR_SUM'',''BLOCK_CNT'',''DROP_CNT'',''CSFB_CNT'',''PS_UL_VOLUME_SUM'',
				''PS_DL_VOLUME_SUM'',''PS_UL_SPEED_MAX'',''PS_DL_SPEED_MAX'',''DROP_SIGNAL_CNT'',''DROP_DATA_CNT'',
				''END_NON_BLOCK_CALL_CNT'',''UL_THROUPUT_SUM'',''UL_THROUPUT_CNT'',''DL_THROUPUT_SUM'',
				''DL_THROUPUT_CNT'',''END_NON_BLOCK_SIGNAL_CNT'',''END_NON_BLOCK_DATA_CNT'',''CALL_SETUP_TIME_SUM'',''CALL_SETUP_TIME_CNT''	
					UNION
					SELECT REG_ID,MCC,MNC,EARFCN,EUTRABAND,DATA_DATE,INIT_CALL_CNT,END_CALL_CNT,SIGNAL_CNT,
						DATA_CNT,UNSPECIFIED_CNT,CALL_DUR_SUM,BLOCK_CNT,DROP_CNT,CSFB_CNT,PS_UL_VOLUME_SUM,
						PS_DL_VOLUME_SUM,PS_UL_SPEED_MAX,PS_DL_SPEED_MAX,DROP_SIGNAL_CNT,DROP_DATA_CNT,
						END_NON_BLOCK_CALL_CNT,UL_THROUPUT_SUM,UL_THROUPUT_CNT,DL_THROUPUT_SUM,
						DL_THROUPUT_CNT,END_NON_BLOCK_SIGNAL_CNT,END_NON_BLOCK_DATA_CNT,CALL_SETUP_TIME_SUM,CALL_SETUP_TIME_CNT
					FROM ',gt_global_statistic_g1,'.table_romer_reg_3_lte_dy_',DATA_DATE,'
					
					INTO OUTFILE "',FOLDER_PATH,'table_romer_reg_3_lte_dy_',DATA_DATE,'_578.csv"
					FIELDS TERMINATED BY ''\t''
					OPTIONALLY ENCLOSED BY ''''
					LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('REPAIR TABLE ',gt_global_statistic_g1,'.table_reg_3_ds_dy_',DATA_DATE,';');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('SELECT ''REG_ID'',''DATA_DATE'',''RSRP_SUM'',''RSRP_CNT'',''RSCP_SUM'',''RSCP_CNT'',
				''RXLEV_SUM'',''RXLEV_CNT'',''RSRQ_SUM'',''RSRQ_CNT'',''ECNO_SUM'',''ECNO_CNT'',
				''RXQUAL_SUM'',''RXQUAL_CNT'',''GSM_CS_CALL_CNT'',''GSM_PS_CALL_CNT'',
				''GSM_VOICE_DROP_CNT'',''GSM_GPRS_DROP_CNT'',''GSM_SMS_DROP_CNT'',''GSM_CS_BLOCK_CNT'',
				''GSM_PS_BLOCK_CNT'',''GSM_CS_CALL_DURATION'',''GSM_CALL_SETUP_TIME_SUM'',''GSM_CALL_SETUP_TIME_CNT'',
				''GSM_CS_SETUP_FAILURE_CNT'',''GSM_PS_SETUP_FAILURE_CNT'',''UMTS_CS_CALL_CNT'',''UMTS_PS_CALL_CNT'',
				''UMTS_VOICE_DROP_CNT'',''UMTS_PS_DROP_CNT'',''UMTS_CS_CALL_DURATION'',''UMTS_CS_BLOCK_CNT'',
				''UMTS_PS_BLOCK_CNT'',''UMTS_UL_VOLUME'',''UMTS_DL_VOLUME'',''UMTS_UL_THROUPUT_SUM'',
				''UMTS_UL_THROUPUT_CNT'',''UMTS_DL_THROUPUT_SUM'',''UMTS_DL_THROUPUT_CNT'',''UMTS_CALL_SETUP_TIME_SUM'',
				''UMTS_CALL_SETUP_TIME_CNT'',''UMTS_CS_SETUP_FAILURE_CNT'',''UMTS_PS_SETUP_FAILURE_CNT'',
				''LTE_CALL_CNT'',''LTE_DROP_CNT'',''LTE_BLOCK_CNT'',''LTE_UL_VOLUME'',''LTE_DL_VOLUME'',''LTE_UL_THROUPUT_SUM'',
				''LTE_UL_THROUPUT_CNT'',''LTE_DL_THROUPUT_SUM'',''LTE_DL_THROUPUT_CNT'',''LATENCY_SUM'',''LATENCY_CNT'',''LTE_CALL_SETUP_TIME_SUM'',
				''LTE_CALL_SETUP_TIME_CNT'',''LTE_SETUP_FAILURE_CNT'',''SRVCC_ATTEMPT_CNT'',''SRVCC_FAILURE_CNT'',''S1_HO_ATTEMPT'',''S1_HO_FAILURE'',
				''X2_HO_ATTEMPT'',''X2_HO_FAILURE'',
				''UMTS_MAX_UL_THROUPUT'',''UMTS_MAX_DL_THROUPUT'',''LTE_MAX_UL_THROUPUT'',''LTE_MAX_DL_THROUPUT'',''COMPLETED_PU_CNT'',''TOTAL_PU_CNT''
					UNION
					SELECT REG_ID,DATA_DATE,RSRP_SUM,RSRP_CNT,RSCP_SUM,RSCP_CNT,
						RXLEV_SUM,RXLEV_CNT,RSRQ_SUM,RSRQ_CNT,ECNO_SUM,ECNO_CNT,
						RXQUAL_SUM,RXQUAL_CNT,GSM_CS_CALL_CNT,GSM_PS_CALL_CNT,
						GSM_VOICE_DROP_CNT,GSM_GPRS_DROP_CNT,GSM_SMS_DROP_CNT,GSM_CS_BLOCK_CNT,
						GSM_PS_BLOCK_CNT,GSM_CS_CALL_DURATION,GSM_CALL_SETUP_TIME_SUM,GSM_CALL_SETUP_TIME_CNT,
						GSM_CS_SETUP_FAILURE_CNT,GSM_PS_SETUP_FAILURE_CNT,UMTS_CS_CALL_CNT,UMTS_PS_CALL_CNT,
						UMTS_VOICE_DROP_CNT,UMTS_PS_DROP_CNT,UMTS_CS_CALL_DURATION,UMTS_CS_BLOCK_CNT,
						UMTS_PS_BLOCK_CNT,UMTS_UL_VOLUME,UMTS_DL_VOLUME,UMTS_UL_THROUPUT_SUM,
						UMTS_UL_THROUPUT_CNT,UMTS_DL_THROUPUT_SUM,UMTS_DL_THROUPUT_CNT,UMTS_CALL_SETUP_TIME_SUM,
						UMTS_CALL_SETUP_TIME_CNT,UMTS_CS_SETUP_FAILURE_CNT,UMTS_PS_SETUP_FAILURE_CNT,
						LTE_CALL_CNT,LTE_DROP_CNT,LTE_BLOCK_CNT,LTE_UL_VOLUME,LTE_DL_VOLUME,LTE_UL_THROUPUT_SUM,
						LTE_UL_THROUPUT_CNT,LTE_DL_THROUPUT_SUM,LTE_DL_THROUPUT_CNT,LATENCY_SUM,LATENCY_CNT,LTE_CALL_SETUP_TIME_SUM,
						LTE_CALL_SETUP_TIME_CNT,LTE_SETUP_FAILURE_CNT,SRVCC_ATTEMPT_CNT,SRVCC_FAILURE_CNT,S1_HO_ATTEMPT,S1_HO_FAILURE,
						X2_HO_ATTEMPT,X2_HO_FAILURE,UMTS_MAX_UL_THROUPUT,UMTS_MAX_DL_THROUPUT,LTE_MAX_UL_THROUPUT,LTE_MAX_DL_THROUPUT,COMPLETED_PU_CNT,TOTAL_PU_CNT
					FROM ',gt_global_statistic_g1,'.table_reg_3_ds_dy_',DATA_DATE,'
					
					INTO OUTFILE "',FOLDER_PATH,'table_reg_3_ds_dy_',DATA_DATE,'_578.csv"					
					FIELDS TERMINATED BY ''\t''
					OPTIONALLY ENCLOSED BY ''''
					LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
		
	INSERT INTO gt_gw_main.SP_LOG VALUES('gt_global_statistic','Cell_Reg_Map_578','START',START_TIME);
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.`tmp_cell_3_',DATA_DATE,'`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	SET @SqlCmd=CONCAT('CREATE TEMPORARY TABLE ',gt_global_statistic,'.`tmp_cell_3_',DATA_DATE,'` (
				`technology` VARCHAR(10) NOT NULL,
				 `network_element` BIGINT(20) NOT NULL,
				 `site_id` VARCHAR(20) NOT NULL,
				  `cell_id` VARCHAR(20) NOT NULL,
				  `lon_lat` VARCHAR(70) DEFAULT NULL,
				  PRIMARY KEY (`technology`,`network_element`,`site_id`,`cell_id`)
			) ENGINE=MYISAM DEFAULT CHARSET=latin1;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.`tmp_nt_cell_current_gsm_',DATA_DATE,'`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	SET @SqlCmd=CONCAT('CREATE TEMPORARY TABLE ',gt_global_statistic,'.`tmp_nt_cell_current_gsm_',DATA_DATE,'` (
				SELECT ''2G'' AS `technology`,BSC_ID,SITE_ID,CELL_ID,LONGITUDE,LATITUDE 
				FROM gt_nt_',DATA_DATE,'.nt_cell_current_gsm
				WHERE BSC_ID NOT IN(1,2,3,4,5,6,7,8,9,10,11,12));');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `TMP_GSM` ON ',gt_global_statistic,'.`tmp_nt_cell_current_gsm_',DATA_DATE,'` (technology,BSC_ID,SITE_ID,CELL_ID);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	
	SET @SqlCmd=CONCAT('INSERT IGNORE INTO ',gt_global_statistic,'.`tmp_cell_3_',DATA_DATE,'`  
				(`technology`,`network_element` , `site_id`,`cell_id`,`lon_lat` )
				SELECT ''2G'',BSC_ID,SITE_ID,CELL_ID,CONCAT(''POINT'',''('',LONGITUDE,'' '',LATITUDE,'')'') AS lon_lat 
				FROM 
				',gt_global_statistic,'.`tmp_nt_cell_current_gsm_',DATA_DATE,'` a
				WHERE  NOT EXISTS (SELECT NULL FROM gt_global_statistic.table_cell_polygon_g1 b
							WHERE b.technology=a.technology
							AND b.NETWORK_ELEMENT=a.BSC_ID
							AND b.SITE_ID=a.SITE_ID
							AND b.cell_id=a.cell_id);
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.`tmp_nt_cell_current_umts_',DATA_DATE,'`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	SET @SqlCmd=CONCAT('CREATE TEMPORARY TABLE ',gt_global_statistic,'.`tmp_nt_cell_current_umts_',DATA_DATE,'` (
				SELECT ''3G'' AS `technology`,RNC_ID,SITE_ID,CELL_ID,LONGITUDE,LATITUDE 
				FROM gt_nt_',DATA_DATE,'.nt_current
				WHERE rnc_ID NOT IN(241,242,250));');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `TMP_UMTS` ON ',gt_global_statistic,'.`tmp_nt_cell_current_umts_',DATA_DATE,'` (technology,RNC_ID,SITE_ID,CELL_ID);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `TMP_UMTS_technology` ON ',gt_global_statistic,'.`tmp_nt_cell_current_umts_',DATA_DATE,'` (technology);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `TMP_UMTS_RNC_ID` ON ',gt_global_statistic,'.`tmp_nt_cell_current_umts_',DATA_DATE,'` (RNC_ID);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `TMP_UMTS_SITE_ID` ON ',gt_global_statistic,'.`tmp_nt_cell_current_umts_',DATA_DATE,'` (SITE_ID);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `TMP_UMTS_CELL_ID` ON ',gt_global_statistic,'.`tmp_nt_cell_current_umts_',DATA_DATE,'` (CELL_ID);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('INSERT IGNORE INTO ',gt_global_statistic,'.`tmp_cell_3_',DATA_DATE,'` 
				(`technology`,`network_element` , `site_id`,`cell_id`,`lon_lat` )
				SELECT ''3G'',RNC_ID,SITE_ID,CELL_ID,CONCAT(''POINT'',''('',LONGITUDE,'' '',LATITUDE,'')'') AS lon_lat 
				FROM 
				',gt_global_statistic,'.`tmp_nt_cell_current_umts_',DATA_DATE,'` a
				WHERE  NOT EXISTS (SELECT NULL FROM gt_global_statistic.table_cell_polygon_g1 b
							WHERE b.technology=a.technology
							AND b.NETWORK_ELEMENT=a.RNC_ID
							AND b.SITE_ID=a.SITE_ID
							AND b.cell_id=a.cell_id);
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
		
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.`tmp_nt_cell_current_lte_',DATA_DATE,'`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	SET @SqlCmd=CONCAT('CREATE TEMPORARY TABLE ',gt_global_statistic,'.`tmp_nt_cell_current_lte_',DATA_DATE,'` (
				SELECT ''4G'' AS `technology`,a.pu_ID,a.ENODEB_ID,a.CELL_ID,b.LONGITUDE,b.LATITUDE 
				FROM
				gt_nt_',DATA_DATE,'.nt_cell_current_lte a join gt_nt_',DATA_DATE,'.nt_antenna_current_lte b
				on a.ENODEB_ID=b.ENODEB_ID
				AND a. cell_id=b.cell_id
				AND a.PU_ID <> 200)');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `TMP_LTE` ON ',gt_global_statistic,'.`tmp_nt_cell_current_LTE_',DATA_DATE,'` (technology,PU_ID,ENODEB_ID,CELL_ID);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
		
	SET @SqlCmd=CONCAT('INSERT IGNORE INTO ',gt_global_statistic,'.`tmp_cell_3_',DATA_DATE,'`  
				(`technology`,`network_element` , `site_id`,`cell_id`,`lon_lat` )
				SELECT ''4G'',a.PU_ID,a.ENODEB_ID,a.CELL_ID,CONCAT(''POINT'',''('',LONGITUDE,'' '',LATITUDE,'')'') AS lon_lat 
					FROM ',gt_global_statistic,'.`tmp_nt_cell_current_lte_',DATA_DATE,'`  a
					WHERE  NOT EXISTS (SELECT NULL FROM ',gt_global_statistic,'.table_cell_polygon_g1 b
							WHERE b.technology=a.technology
							AND b.NETWORK_ELEMENT=a.PU_ID
							AND b.SITE_ID=a.ENODEB_ID
							AND b.cell_id=a.cell_id);
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd =CONCAT('INSERT IGNORE  INTO ',gt_global_statistic,'.table_cell_polygon_g1 
						    (`technology`,
						     `network_element`,
						     `site_id`,
						     `cell_id`,
						     `id`,
						     `polygon_name`
						    )
						SELECT a.`technology`,
							a.`network_element`,
							`site_id` ,
							`cell_id` ,
							b.`id`,
							b.`name`
						FROM ',gt_global_statistic,'.`tmp_cell_3_',DATA_DATE,'`  a
						,',gt_global_statistic,'.`usr_polygon_reg_3_v4` b
						WHERE b.group_id=1 and gt_covmo_pointinpoly(
								ASWKB(GEOMFROMTEXT(A.`lon_lat`)),
								ASWKB(GEOMFROMTEXT(B.`polygon_str`)))=1 
					;') ;
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd =CONCAT('INSERT IGNORE  INTO ',gt_global_statistic,'.table_cell_polygon_g1
						    (`technology`,
						     `network_element`,
						     `site_id`,
						     `cell_id`,
						     `id`,
						     `polygon_name`
						    )
						SELECT a.`technology`,
							a.`network_element`,
							`site_id` ,
							`cell_id` ,
							424000002000,
							null as `polygon_name`
						FROM ',gt_global_statistic,'.`tmp_cell_3_',DATA_DATE,'`  a
						
						WHERE NOT EXISTS 
						(
						SELECT NULL FROM gt_global_statistic.table_cell_polygon_g1 c 
						WHERE c.`technology`=a.`technology` AND
							c.`NETWORK_ELEMENT`=a.`network_element`
							AND c.`SITE_ID`=a.`SITE_ID`
							AND c.`cell_id`=a.`cell_id`);
						
					;') ;
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('SELECT ''TECHNOLOGY'',''NETWORK_ELEMENT'',''SITE_ID'',''CELL_ID '',''ID'',''polygon_name''
				
					UNION
					SELECT technology,network_element,site_id,cell_id,id,polygon_name
					FROM ',gt_global_statistic,'.table_cell_polygon_g1 
					
					INTO OUTFILE "',FOLDER_PATH,'table_cell_reg_map_578.csv"
					FIELDS TERMINATED BY ''\t''
					OPTIONALLY ENCLOSED BY ''''
					LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.`tmp_nt_cell_current_gsm_',DATA_DATE,'`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.`tmp_nt_cell_current_umts_',DATA_DATE,'`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.`tmp_nt_cell_current_lte_',DATA_DATE,'`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.`tmp_cell_3_',DATA_DATE,'`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	SET @SqlCmd=CONCAT('REPAIR TABLE ',gt_global_statistic_g2,'.table_failcause_umts_dy_',DATA_DATE,';');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP  TABLE  IF EXISTS ',gt_global_statistic,'.TMP_failurecause_umts_85');
	PREPARE stmt FROM @sqlcmd;
	EXECUTE stmt;
	DEALLOCATE PREPARE stmt;
	
	
	
	SET @SqlCmd=CONCAT('CREATE  TABLE ',gt_global_statistic,'.TMP_failurecause_umts_85 
				SELECT A.DATA_DATE,A.TILE_ID,A.RNC_ID,A.SITE_ID,A.CELL_ID,A.IMSI,A.IMEI,
				A.EVENT_ID,A.FAILURE_EVENT_ID,A.FAILURE_EVENT_CAUSE,A.FAILURE_CNT,
				B.manufacturer,B.model
				FROM ',gt_global_statistic_g1,'.table_failcause_umts_dy_',DATA_DATE,' A LEFT JOIN gt_covmo.dim_handset B
				ON LEFT(A.IMEI,8)=B.TAC
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	
	SET @SqlCmd=CONCAT('ALTER  TABLE ',gt_global_statistic,'.TMP_failurecause_umts_85 
				ADD COLUMN REG_ID VARCHAR(20);
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `key_tile` ON ',gt_global_statistic,'.TMP_failurecause_umts_85 (tile_id);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	
	CALL GT_GW_MAIN.`SP_Qlikview_Tile_Reg_Map`('gt_global_statistic.TMP_failurecause_umts_85','1','1');
	
	SET @SqlCmd=CONCAT('ALTER  TABLE ',gt_global_statistic,'.TMP_failurecause_umts_85 
				ADD PROTOCOL_ID TINYINT(4),
				ADD PROTOCOL_NAME VARCHAR(32)AFTER PROTOCOL_ID,
				ADD CAUSE_NAME VARCHAR(150) AFTER PROTOCOL_NAME;
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `key_protocol_id` ON ',gt_global_statistic,'.TMP_failurecause_umts_85 (PROTOCOL_ID);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `key_failure_cause_id` ON ',gt_global_statistic,'.TMP_failurecause_umts_85 (FAILURE_EVENT_CAUSE);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('UPDATE ',gt_global_statistic,'.TMP_failurecause_umts_85 A, GT_COVMO.dim_failure_event B
				SET A.PROTOCOL_ID= B.PROTOCOL
				WHERE A.FAILURE_EVENT_ID=B.EVENT_ID;
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('UPDATE ',gt_global_statistic,'.TMP_failurecause_umts_85 
			SET PROTOCOL_NAME=(
			  CASE PROTOCOL_ID
			  WHEN 1 THEN ''UMTS RRC''
			  WHEN 2 THEN ''UMTS RNSAP''
			  WHEN 3 THEN ''UMTS RANAP''
			  WHEN 4 THEN ''UMTS NBAP''
			  WHEN 5 THEN ''UMTS NAS_CAUSE_CC''
			  WHEN 6 THEN ''UMTS NAS_CAUSE_SM''
			  ELSE NULL END);');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('UPDATE ',gt_global_statistic,'.TMP_failurecause_umts_85 A, GT_COVMO.dim_failure_cause B
				SET A.CAUSE_NAME= B.CAUSE_NAME
				WHERE A.PROTOCOL_ID=B.PROTOCOL
				AND A.FAILURE_EVENT_CAUSE=B.CAUSE_ID;
				');
	
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('SELECT ''DATA_DATE'',''TILE_ID'',''RNC_ID'',''SITE_ID'',''CELL_ID'',''IMSI'',''IMEI'',
				''EVENT_ID'',''FAILURE_EVENT_ID'',''FAILURE_EVENT_CAUSE'',''FAILURE_CNT'',
				''MANUFACTURER'',''MODEL'',''REG_ID'',''REG_NAME'',''PROTOCOL_ID'',''PROTOCOL_NAME'',''CAUSE_NAME''
				UNION 
				SELECT 
				A.DATA_DATE,A.TILE_ID,A.RNC_ID,A.SITE_ID,A.CELL_ID,A.IMSI,A.IMEI,
				A.EVENT_ID,A.FAILURE_EVENT_ID,A.FAILURE_EVENT_CAUSE,A.FAILURE_CNT,
				A.manufacturer,A.model,A.REG_ID,B.name,a.PROTOCOL_ID,a.PROTOCOL_NAME,a.CAUSE_NAME
				
				FROM ',gt_global_statistic,'.TMP_failurecause_umts_85 A LEFT JOIN ',gt_global_statistic,'.usr_polygon_reg_3_v4 B
				ON A.REG_ID=B.id
				WHERE A.FAILURE_EVENT_CAUSE <> 0 AND A.FAILURE_EVENT_CAUSE <> 1004099 
				AND A.PROTOCOL_NAME IS NOT NULL
				AND A.CAUSE_NAME IS NOT NULL
				AND A.PROTOCOL_ID IN(1,3,4)		
				AND ((A.PROTOCOL_ID=4 AND A.FAILURE_EVENT_CAUSE<> 1010000)
				OR (A.PROTOCOL_ID=3 AND A.FAILURE_EVENT_CAUSE<> 1029000))
				INTO OUTFILE "',FOLDER_PATH,'table_failcause_umts_dy_',DATA_DATE,'_85.csv"
				FIELDS TERMINATED BY ''\t''
				OPTIONALLY ENCLOSED BY ''''
				LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP  TABLE  IF EXISTS ',gt_global_statistic,'.TMP_failurecause_umts_85');
	PREPARE stmt FROM @sqlcmd;
	EXECUTE stmt;
	DEALLOCATE PREPARE stmt;
	
	SET @SqlCmd=CONCAT('REPAIR TABLE ',gt_global_statistic_g2,'.table_failcause_umts_dy_',DATA_DATE,';');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP  TABLE  IF EXISTS ',gt_global_statistic,'.TMP_failurecause_lte_85');
	PREPARE stmt FROM @sqlcmd;
	EXECUTE stmt;
	DEALLOCATE PREPARE stmt;
	
	SET @SqlCmd=CONCAT('CREATE  TABLE ',gt_global_statistic,'.TMP_failurecause_lte_85 
				SELECT A.DATA_DATE,A.TILE_ID,A.PU_ID,A.ENODEB_ID,A.CELL_ID,A.IMSI,A.IMEI,
				A.EVENT_ID,A.FAILURE_EVENT_ID,A.FAILURE_EVENT_CAUSE,A.FAILURE_CNT,
				B.manufacturer,B.model 
				FROM ',gt_global_statistic_g1,'.table_failcause_lte_dy_',DATA_DATE,' A LEFT JOIN gt_covmo.dim_handset B
				ON LEFT(A.IMEI,8)=B.TAC
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	
	SET @SqlCmd=CONCAT('ALTER  TABLE ',gt_global_statistic,'.TMP_failurecause_lte_85 
				ADD COLUMN REG_ID VARCHAR(20) ;
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `key_tile` ON ',gt_global_statistic,'.TMP_failurecause_lte_85 (tile_id);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	
	CALL GT_GW_MAIN.`SP_Qlikview_Tile_Reg_Map`('gt_global_statistic.TMP_failurecause_lte_85','1','1');
	
	SET @SqlCmd=CONCAT('ALTER  TABLE ',gt_global_statistic,'.TMP_failurecause_lte_85 
				ADD PROTOCOL_ID TINYINT(4),
				ADD PROTOCOL_NAME VARCHAR(32)AFTER PROTOCOL_ID,
				ADD CAUSE_NAME VARCHAR(150) AFTER PROTOCOL_NAME;
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `key_protocol_id` ON ',gt_global_statistic,'.TMP_failurecause_lte_85 (PROTOCOL_ID);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `key_failure_cause_id` ON ',gt_global_statistic,'.TMP_failurecause_lte_85 (FAILURE_EVENT_CAUSE);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('UPDATE ',gt_global_statistic,'.TMP_failurecause_lte_85 A, GT_COVMO.dim_failure_event_lte B
				SET A.PROTOCOL_ID= B.PROTOCOL
				WHERE A.FAILURE_EVENT_ID=B.EVENT_ID;
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('UPDATE ',gt_global_statistic,'.TMP_failurecause_lte_85 
				SET PROTOCOL_NAME = (
				  CASE PROTOCOL_ID
				  WHEN 1 THEN ''LTE RRC''
				  WHEN 2 THEN ''LTE S1AP''
				  WHEN 3 THEN ''LTE X2AP''
				  ELSE NULL END);');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
		
	
	SET @SqlCmd=CONCAT('UPDATE  ',gt_global_statistic,'.TMP_failurecause_lte_85 A, GT_COVMO.dim_failure_cause_lte B
				SET A.CAUSE_NAME= B.CAUSE_NAME
				WHERE A.PROTOCOL_ID=B.PROTOCOL
				AND A.FAILURE_EVENT_CAUSE=B.CAUSE_ID;
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	
	SET @SqlCmd=CONCAT('SELECT ''DATA_DATE'',''TILE_ID'',''PU_ID'',''ENODEB_ID'',''CELL_ID'',''IMSI'',''IMEI'',
				''EVENT_ID'',''FAILURE_EVENT_ID'',''FAILURE_EVENT_CAUSE'',''FAILURE_CNT'',
				''MANUFACTURER'',''MODEL'',''REG_ID'',''REG_NAME'',''PROTOCOL_ID'',''PROTOCOL_NAME'',''CAUSE_NAME''
				UNION 
				SELECT 
				A.DATA_DATE,A.TILE_ID,A.PU_ID,A.ENODEB_ID,A.CELL_ID,A.IMSI,A.IMEI,
				A.EVENT_ID,A.FAILURE_EVENT_ID,A.FAILURE_EVENT_CAUSE,A.FAILURE_CNT,
				A.manufacturer,A.model,A.REG_ID,B.name,a.PROTOCOL_ID,a.PROTOCOL_NAME,a.CAUSE_NAME
				
				FROM ',gt_global_statistic,'.TMP_failurecause_lte_85 A LEFT JOIN ',gt_global_statistic,'.usr_polygon_reg_3_v4 B
				ON A.REG_ID=B.id
				WHERE A.FAILURE_EVENT_CAUSE <> -1
				AND a.PROTOCOL_NAME IS NOT NULL
				AND a.CAUSE_NAME IS NOT NULL
				INTO OUTFILE "',FOLDER_PATH,'table_failcause_lte_dy_',DATA_DATE,'_85.csv"
				FIELDS TERMINATED BY ''\t''
				OPTIONALLY ENCLOSED BY ''''
				LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP  TABLE  IF EXISTS ',gt_global_statistic,'.TMP_failurecause_lte_85');
	PREPARE stmt FROM @sqlcmd;
	EXECUTE stmt;
	DEALLOCATE PREPARE stmt;
	
	SET @SqlCmd=CONCAT('REPAIR TABLE ',gt_global_statistic_g2,'.table_imsi_gsm_dy_',DATA_DATE,';');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
		
	SET @SqlCmd=CONCAT('SELECT ''IMSI'',''DATA_DATE'',''CALL_CNT'',''VOICE_MO_CNT'',''VOICE_MT_CNT'',
						''DATA_MO_CNT'',''DATA_MT_CNT'',''SMS_MO_CNT'',''SMS_MT_CNT'',
						''SIGNAL_CNT'',''CALL_DUR_SUM'',''VOICE_DUR_SUM'',
						''DATA_DUR_SUM'',''DROP_CNT'',''BLOCK_CNT'',
						''DROP_VOICE_CNT'',''DROP_GPRS_CNT'',''DROP_SMS_CNT'',
						''DROP_SIGNAL_CNT'',''DROP_OTHER_CNT'',''BLOCK_VOICE_CNT'',
						''BLOCK_GPRS_CNT'',''BLOCK_SMS_CNT'',''BLOCK_SIGNAL_CNT''
						''BLOCK_OTHER_CNT'',''HO_ATTEMPT_CNT'',
						''HO_FAILURE_CNT'',''MOVING_CALL_CNT'',''INDOOR_CALL_CNT'',
						''FIRST_RXLEV_DL_SUM'',''FIRST_RXLEV_DL_CNT'',''FIRST_RXQUAL_DL_SUM'',
						''FIRST_RXQUAL_DL_CNT'',''FIRST_RXLEV_UL_SUM'',''FIRST_RXLEV_UL_CNT'',''FIRST_RXQUAL_UL_SUM'',
						''FIRST_RXQUAL_UL_CNT'',''CALL_SETUP_TIME_SUM'',''CALL_SETUP_TIME_CNT'',''SF_VOICE_CNT'',
						''SF_GPRS_CNT'',''SF_SMS_CNT'',''SF_SIGNAL_CNT'',''SF_OTHER_CNT'',''MAKE_ID'',''MODEL_ID'',
						''START_CELL_ID'',''START_SITE_ID'',''START_REG_1_ID'',''START_REG_2_ID'',''START_REG_3_ID'',
						''END_CELL_ID'',''END_SITE_ID'',''END_REG_1_ID'',''END_REG_2_ID'',''END_REG_3_ID''
					UNION
					SELECT IMSI,DATA_DATE,CALL_CNT,VOICE_MO_CNT,VOICE_MT_CNT,
						DATA_MO_CNT,DATA_MT_CNT,SMS_MO_CNT,SMS_MT_CNT,
						SIGNAL_CNT,CALL_DUR_SUM,VOICE_DUR_SUM,
						DATA_DUR_SUM,DROP_CNT,BLOCK_CNT,
						DROP_VOICE_CNT,DROP_GPRS_CNT,DROP_SMS_CNT,
						DROP_SIGNAL_CNT,DROP_OTHER_CNT,BLOCK_VOICE_CNT,
						BLOCK_GPRS_CNT,BLOCK_SMS_CNT,BLOCK_SIGNAL_CNT
						BLOCK_OTHER_CNT,HO_ATTEMPT_CNT,
						HO_FAILURE_CNT,MOVING_CALL_CNT,INDOOR_CALL_CNT,
						FIRST_RXLEV_DL_SUM,FIRST_RXLEV_DL_CNT,FIRST_RXQUAL_DL_SUM,
						FIRST_RXQUAL_DL_CNT,FIRST_RXLEV_UL_SUM,FIRST_RXLEV_UL_CNT,FIRST_RXQUAL_UL_SUM,
						FIRST_RXQUAL_UL_CNT,CALL_SETUP_TIME_SUM,CALL_SETUP_TIME_CNT,SF_VOICE_CNT,
						SF_GPRS_CNT,SF_SMS_CNT,SF_SIGNAL_CNT,SF_OTHER_CNT,MAKE_ID,MODEL_ID,
						START_CELL_ID,START_SITE_ID,START_REG_1_ID,START_REG_2_ID,START_REG_3_ID,
						END_CELL_ID,END_SITE_ID,END_REG_1_ID,END_REG_2_ID,END_REG_3_ID
					FROM ',gt_global_statistic_g2,'.table_imsi_gsm_dy_',DATA_DATE,'
					INTO OUTFILE "',FOLDER_PATH,'table_imsi_gsm_dy_',DATA_DATE,'_85.csv"
					FIELDS TERMINATED BY ''\t''
					OPTIONALLY ENCLOSED BY ''''
					LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('REPAIR TABLE ',gt_global_statistic_g2,'.table_imsi_umts_dy_',DATA_DATE,';');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
		
	SET @SqlCmd=CONCAT('SELECT ''IMSI'',''DATA_DATE'',''CALL_CNT'',''VOICE_MO_CNT'',''VOICE_MT_CNT'',
						''VIDEO_MO_CNT'',''VIDEO_MT_CNT'',''R99_MO_CNT'',''R99_MT_CNT'',
						''HSPA_MO_CNT'',''HSPA_MT_CNT'',''MRAB_MO_CNT'',
						''MRAB_MT_CNT'',''SIGNAL_MO_CNT'',''SIGNAL_MT_CNT'',
						''SMS_MO_CNT'',''SMS_MT_CNT'',''PS_OTHER_CNT'',
						''CALL_DUR_SUM'',''VOICE_DUR_SUM'',''VIDEO_DUR_SUM'',
						''R99_DUR_SUM'',''HSPA_DUR_SUM'',''MRAB_DUR_SUM'',
						''DROP_CNT'',''DROP_VOICE_CNT'',''DROP_VEDIO_CNT'',
						''DROP_R99_CNT'',''DROP_HSPA_CNT'',''DROP_MRAB_CNT'',
						''DROP_SMS_CNT'',''DROP_SIGNAL_CNT'',''DROP_PS_OTHER_CNT'',
						''DROP_RF_CNT'',''DROP_CONG_CNT'',''DROP_TRANS_CNT'',''DROP_SHO_CNT'',
						''DROP_HHO_CNT'',''DROP_IRAT_CNT'',''BLOCK_CNT'',''BLOCK_VOICE_CNT'',
						''BLOCK_VEDIO_CNT'',''BLOCK_R99_CNT'',''BLOCK_HSPA_CNT'',''BLOCK_MRAB_CNT'',''BLOCK_SMS_CNT'',
						''BLOCK_SIGNAL_CNT'',''BLOCK_PS_OTHER_CNT'',''SHO_ATTEMPT_CNT'',''SHO_FAILURE_CNT'',
						''HHO_ATTEMPT_CNT'',''HHO_FAILURE_CNT'',''IRAT_ATTEMPT_CNT'',''IRAT_FAILURE_CNT'',''MOVING_CALL_CNT'',
						''INDOOR_CALL_CNT'',''PS_UL_VOLUME_SUM'',''PS_DL_VOLUME_SUM'',''PS_UL_SPEED_MAX'',''PS_DL_SPEED_MAX'',
						''FIRST_RSCP_SUM'',''FIRST_RSCP_CNT'',''FIRST_ECNO_SUM'',''FIRST_ECNO_CNT'',''CALL_SETUP_TIME_SUM'',''CALL_SETUP_TIME_CNT'',
						''SF_CNT'',''SF_VOICE_CNT'',''SF_VEDIO_CNT'',''SF_R99_CNT'',''SF_HSPA_CNT'',''SF_MRAB_CNT'',''SF_SMS_CNT'',
						''SF_SIGNAL_CNT'',''SF_PS_OTHER_CNT'',''PDP_ACTIVATION_REQUEST'',''PDP_ACTIVATION_ACCEPT'',''PDP_DEACTIVATION_REQUEST'',''PDP_DEACTIVATION_ACCEPT'',
						''AUTH_REQUEST'',''AUTH_RESPONSE'',''AUTH_CIPH_REQUEST'',''AUTH_CIPH_RESPONSE'',''SECURITY_MODE_ATT'',''SECURITY_MODE_SUCCESS'',
						''LU_REQUEST'',''LU_ACCEPT'',''RAU_REQUEST'',''RAU_ACCEPT'',''MAKE_ID'',''MODEL_ID'',
						''START_CELL_ID'',''START_SITE_ID'',''START_REG_1_ID'',''START_REG_2_ID'',''START_REG_3_ID'',
						''END_CELL_ID'',''END_SITE_ID'',''END_REG_1_ID'',''END_REG_2_ID'',''END_REG_3_ID''
						
					UNION
					SELECT IMSI,DATA_DATE,CALL_CNT,VOICE_MO_CNT,VOICE_MT_CNT,
						VIDEO_MO_CNT,VIDEO_MT_CNT,R99_MO_CNT,R99_MT_CNT,
						HSPA_MO_CNT,HSPA_MT_CNT,MRAB_MO_CNT,
						MRAB_MT_CNT,SIGNAL_MO_CNT,SIGNAL_MT_CNT,
						SMS_MO_CNT,SMS_MT_CNT,PS_OTHER_CNT,
						CALL_DUR_SUM,VOICE_DUR_SUM,VIDEO_DUR_SUM,
						R99_DUR_SUM,HSPA_DUR_SUM,MRAB_DUR_SUM,
						DROP_CNT,DROP_VOICE_CNT,DROP_VEDIO_CNT,
						DROP_R99_CNT,DROP_HSPA_CNT,DROP_MRAB_CNT,
						DROP_SMS_CNT,DROP_SIGNAL_CNT,DROP_PS_OTHER_CNT,
						DROP_RF_CNT,DROP_CONG_CNT,DROP_TRANS_CNT,DROP_SHO_CNT,
						DROP_HHO_CNT,DROP_IRAT_CNT,BLOCK_CNT,BLOCK_VOICE_CNT,
						BLOCK_VEDIO_CNT,BLOCK_R99_CNT,BLOCK_HSPA_CNT,BLOCK_MRAB_CNT,BLOCK_SMS_CNT,
						BLOCK_SIGNAL_CNT,BLOCK_PS_OTHER_CNT,SHO_ATTEMPT_CNT,SHO_FAILURE_CNT,
						HHO_ATTEMPT_CNT,HHO_FAILURE_CNT,IRAT_ATTEMPT_CNT,IRAT_FAILURE_CNT,MOVING_CALL_CNT,
						INDOOR_CALL_CNT,PS_UL_VOLUME_SUM,PS_DL_VOLUME_SUM,PS_UL_SPEED_MAX,PS_DL_SPEED_MAX,
						FIRST_RSCP_SUM,FIRST_RSCP_CNT,FIRST_ECNO_SUM,FIRST_ECNO_CNT,CALL_SETUP_TIME_SUM,CALL_SETUP_TIME_CNT,
						SF_CNT,SF_VOICE_CNT,SF_VEDIO_CNT,SF_R99_CNT,SF_HSPA_CNT,SF_MRAB_CNT,SF_SMS_CNT,
						SF_SIGNAL_CNT,SF_PS_OTHER_CNT,PDP_ACTIVATION_REQUEST,PDP_ACTIVATION_ACCEPT,PDP_DEACTIVATION_REQUEST,PDP_DEACTIVATION_ACCEPT,
						AUTH_REQUEST,AUTH_RESPONSE,AUTH_CIPH_REQUEST,AUTH_CIPH_RESPONSE,SECURITY_MODE_ATT,SECURITY_MODE_SUCCESS,
						LU_REQUEST,LU_ACCEPT,RAU_REQUEST,RAU_ACCEPT,MAKE_ID,MODEL_ID,
						START_CELL_ID,START_SITE_ID,START_REG_1_ID,START_REG_2_ID,START_REG_3_ID,
						END_CELL_ID,END_SITE_ID,END_REG_1_ID,END_REG_2_ID,END_REG_3_ID
					FROM ',gt_global_statistic_g2,'.table_imsi_umts_dy_',DATA_DATE,'
					INTO OUTFILE "',FOLDER_PATH,'table_imsi_umts_dy_',DATA_DATE,'_85.csv"
					FIELDS TERMINATED BY ''\t''
					OPTIONALLY ENCLOSED BY ''''
					LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('REPAIR TABLE ',gt_global_statistic_g2,'.table_imsi_lte_dy_',DATA_DATE,';');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
		
	SET @SqlCmd=CONCAT('SELECT ''IMSI'',''DATA_DATE'',''CALL_CNT'',''DATA_CNT'',''SIGNAL_CNT'',
						''SMS_CNT'',''VOLTE_CNT'',''UNSPECIFIED_CNT'',''CALL_DUR_SUM'',
						''DATA_DUR_SUM'',''SIGNAL_DUR_SUM'',''DROP_CNT'',
						''DROP_DATA_CNT'',''DROP_SIGNAL_CNT'',''DROP_SMS_CNT'',
						''DROP_VOLTE_CNT'',''DROP_UNSPECIFIED_CNT'',''BLOCK_CNT'',
						''BLOCK_DATA_CNT'',''BLOCK_SIGNAL_CNT'',''BLOCK_SMS_CNT'',
						''BLOCK_VOLTE_CNT'',''BLOCK_UNSPECIFIED_CNT'',''DROP_RDO_NW_CNT'',
						''DROP_TRANS_CNT'',''DROP_NAS_CNT'',''DROP_MISC_CNT'',
						''DROP_PROTOCOL_CNT'',''INTER_FREQ_ATTEMPT_CNT'',''INTER_FREQ_FAILURE_CNT'',
						''INTRA_FREQ_ATTEMPT_CNT'',''INTRA_FREQ_FAILURE_CNT'',''4G_3G_ATTEMPT_CNT'',
						''4G_3G_FAILURE_CNT'',''4G_2G_ATTEMPT_CNT'',''4G_2G_FAILURE_CNT'',''MOVING_CALL_CNT'',
						''INDOOR_CALL_CNT'',''PS_UL_VOLUME_SUM'',''PS_DL_VOLUME_SUM'',''PS_UL_SPEED_MAX'',
						''PS_DL_SPEED_MAX'',''FIRST_RSRP_SUM'',''FIRST_RSRP_CNT'',''FIRST_RSRQ_SUM'',''FIRST_RSRQ_CNT'',
						''CALL_SETUP_TIME_SUM'',''CALL_SETUP_TIME_CNT'',''SF_CNT'',''SF_DATA_CNT'',
						''SF_SIGNAL_CNT'',''SF_SMS_CNT'',''SF_VOLTE_CNT'',''SF_UNSPECIFIED_CNT'',''MT_DATA_CNT'',
						''MO_DATA_CNT'',''MT_SMS_CNT'',''MO_SMS_CNT'',''MT_VOLTE_CNT'',''MO_VOLTE_CNT'',
						''CSFB_SIGNAL_CNT'',''CSFB_DATA_CNT'',''CSFB_SMS_CNT'',''CSFB_VOLTE_CNT'',''CSFB_UNSPECIFIED_CNT'',
						''CSFB_CNT'',''LATENCY_SUM'',''LATENCY_CNT'',
						''MAKE_ID'',''MODEL_ID'',
						''START_CELL_ID'',''START_ENODEB_ID'',''START_REG_1_ID'',''START_REG_2_ID'',''START_REG_3_ID'',
						''END_CELL_ID'',''END_ENODEB_ID'',''END_REG_1_ID'',''END_REG_2_ID'',''END_REG_3_ID''
						
					UNION
					SELECT IMSI,DATA_DATE,CALL_CNT,DATA_CNT,SIGNAL_CNT,
						SMS_CNT,VOLTE_CNT,UNSPECIFIED_CNT,CALL_DUR_SUM,
						DATA_DUR_SUM,SIGNAL_DUR_SUM,DROP_CNT,
						DROP_DATA_CNT,DROP_SIGNAL_CNT,DROP_SMS_CNT,
						DROP_VOLTE_CNT,DROP_UNSPECIFIED_CNT,BLOCK_CNT,
						BLOCK_DATA_CNT,BLOCK_SIGNAL_CNT,BLOCK_SMS_CNT,
						BLOCK_VOLTE_CNT,BLOCK_UNSPECIFIED_CNT,DROP_RDO_NW_CNT,
						DROP_TRANS_CNT,DROP_NAS_CNT,DROP_MISC_CNT,
						DROP_PROTOCOL_CNT,INTER_FREQ_ATTEMPT_CNT,INTER_FREQ_FAILURE_CNT,
						INTRA_FREQ_ATTEMPT_CNT,INTRA_FREQ_FAILURE_CNT,4G_3G_ATTEMPT_CNT,
						4G_3G_FAILURE_CNT,4G_2G_ATTEMPT_CNT,4G_2G_FAILURE_CNT,MOVING_CALL_CNT,
						INDOOR_CALL_CNT,PS_UL_VOLUME_SUM,PS_DL_VOLUME_SUM,PS_UL_SPEED_MAX,
						PS_DL_SPEED_MAX,FIRST_RSRP_SUM,FIRST_RSRP_CNT,FIRST_RSRQ_SUM,FIRST_RSRQ_CNT,
						CALL_SETUP_TIME_SUM,CALL_SETUP_TIME_CNT,SF_CNT,SF_DATA_CNT,
						SF_SIGNAL_CNT,SF_SMS_CNT,SF_VOLTE_CNT,SF_UNSPECIFIED_CNT,MT_DATA_CNT,
						MO_DATA_CNT,MT_SMS_CNT,MO_SMS_CNT,MT_VOLTE_CNT,MO_VOLTE_CNT,
						CSFB_SIGNAL_CNT,CSFB_DATA_CNT,CSFB_SMS_CNT,CSFB_VOLTE_CNT,CSFB_UNSPECIFIED_CNT,CSFB_CNT,LATENCY_SUM,LATENCY_CNT,
						MAKE_ID,MODEL_ID,
						START_CELL_ID,START_ENODEB_ID,START_REG_1_ID,START_REG_2_ID,START_REG_3_ID,
						END_CELL_ID,END_ENODEB_ID,END_REG_1_ID,END_REG_2_ID,END_REG_3_ID
					FROM ',gt_global_statistic_g2,'.table_imsi_lte_dy_',DATA_DATE,'
					INTO OUTFILE "',FOLDER_PATH,'table_imsi_lte_dy_',DATA_DATE,'_85.csv"
					FIELDS TERMINATED BY ''\t''
					OPTIONALLY ENCLOSED BY ''''
					LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('REPAIR TABLE ',gt_global_statistic_g2,'.table_romer_reg_3_gsm_dy_',DATA_DATE,';');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('SELECT ''REG_ID'',''MCC'',''MNC'',''FREQUENCY'',''DATA_DATE'',''INIT_CALL_CNT'',''END_CALL_CNT'',''VOICE_CNT'',''SIGNAL_CNT'',''SMS_CNT'',
					''GPRS_CNT'',''OTHER_CNT'',''BLOCK_CNT'',''DROP_VOICE_CNT'',''DROP_SIGNAL_CNT'',''DROP_SMS_CNT'',''DROP_GPRS_CNT'',''DROP_OTHER_CNT'',
					''NON_BLOCK_VOICE_CNT'',''NON_BLOCK_SIGNAL_CNT'',''NON_BLOCK_SMS_CNT'',''NON_BLOCK_GPRS_CNT'',''NON_BLOCK_OTHER_CNT'',''CALL_DUR_SUM'',
					''CALL_SETUP_TIME_SUM'',''CALL_SETUP_TIME_CNT''
					UNION
					SELECT REG_ID,MCC,MNC,FREQUENCY,DATA_DATE,INIT_CALL_CNT,END_CALL_CNT,VOICE_CNT,SIGNAL_CNT,SMS_CNT,
						GPRS_CNT,OTHER_CNT,BLOCK_CNT,DROP_VOICE_CNT,DROP_SIGNAL_CNT,DROP_SMS_CNT,DROP_GPRS_CNT,DROP_OTHER_CNT,
						NON_BLOCK_VOICE_CNT,NON_BLOCK_SIGNAL_CNT,NON_BLOCK_SMS_CNT,NON_BLOCK_GPRS_CNT,NON_BLOCK_OTHER_CNT,CALL_DUR_SUM,
						CALL_SETUP_TIME_SUM,CALL_SETUP_TIME_CNT
					FROM ',gt_global_statistic_g2,'.table_romer_reg_3_gsm_dy_',DATA_DATE,'
					
					INTO OUTFILE "',FOLDER_PATH,'table_romer_reg_3_gsm_dy_',DATA_DATE,'_85.csv"
					FIELDS TERMINATED BY ''\t''
					OPTIONALLY ENCLOSED BY ''''
					LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('REPAIR TABLE ',gt_global_statistic_g2,'.table_romer_reg_3_umts_dy_',DATA_DATE,';');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
		
	SET @SqlCmd=CONCAT('SELECT ''REG_ID'',''MCC'',''MNC'',''FREQUENCY'',''DATA_DATE'',''INIT_CALL_CNT'',''END_CALL_CNT'',''VOICE_CNT'',''VIDEO_CNT'',
				''PS_R99_CNT'',''PS_HSPA_CNT'',''M_RAB_CNT'',''SIGNAL_CNT'',''SMS_CNT'',''PS_OTHER_CNT'',''CALL_DUR_SUM'',''CS_DUR_SUM'',
				''DROP_CNT'',''BLOCK_CNT'',''DROP_VOICE_CNT'',''DROP_VIDEO_CNT'',''DROP_PS_R99_CNT'',''DROP_PS_HSPA_CNT'',
				''DROP_M_RAB_CNT'',''DROP_SIGNAL_CNT'',''DROP_SMS_CNT'',''DROP_PS_OTHER_CNT'',''PS_UL_VOLUME_SUM'',''PS_DL_VOLUME_SUM'',
				''PS_UL_SPEED_MAX'',''PS_DL_SPEED_MAX'',''UL_THROUPUT_SUM'',''UL_THROUPUT_CNT'',''DL_THROUPUT_SUM'',''DL_THROUPUT_CNT'',
				''NON_BLOCK_VOICE_CNT'',''NON_BLOCK_VIDEO_CNT'',''NON_BLOCK_PS_R99_CNT'',''NON_BLOCK_PS_HSPA_CNT'',''NON_BLOCK_M_RAB_CNT'',
				''NON_BLOCK_SIGNAL_CNT'',''NON_BLOCK_SMS_CNT'',''NON_BLOCK_PS_OTHER_CNT'',''PS_CNT'',''DROP_PS_CNT'',''CALL_SETUP_TIME_SUM'',''CALL_SETUP_TIME_CNT''	
					UNION
					SELECT REG_ID,MCC,MNC,FREQUENCY,DATA_DATE,INIT_CALL_CNT,END_CALL_CNT,VOICE_CNT,VIDEO_CNT,
						PS_R99_CNT,PS_HSPA_CNT,M_RAB_CNT,SIGNAL_CNT,SMS_CNT,PS_OTHER_CNT,CALL_DUR_SUM,CS_DUR_SUM,
						DROP_CNT,BLOCK_CNT,DROP_VOICE_CNT,DROP_VIDEO_CNT,DROP_PS_R99_CNT,DROP_PS_HSPA_CNT,
						DROP_M_RAB_CNT,DROP_SIGNAL_CNT,DROP_SMS_CNT,DROP_PS_OTHER_CNT,PS_UL_VOLUME_SUM,PS_DL_VOLUME_SUM,
						PS_UL_SPEED_MAX,PS_DL_SPEED_MAX,UL_THROUPUT_SUM,UL_THROUPUT_CNT,DL_THROUPUT_SUM,DL_THROUPUT_CNT,
						NON_BLOCK_VOICE_CNT,NON_BLOCK_VIDEO_CNT,NON_BLOCK_PS_R99_CNT,NON_BLOCK_PS_HSPA_CNT,NON_BLOCK_M_RAB_CNT,
						NON_BLOCK_SIGNAL_CNT,NON_BLOCK_SMS_CNT,NON_BLOCK_PS_OTHER_CNT,PS_CNT,DROP_PS_CNT,CALL_SETUP_TIME_SUM,CALL_SETUP_TIME_CNT
					FROM ',gt_global_statistic_g2,'.table_romer_reg_3_umts_dy_',DATA_DATE,'
					
					INTO OUTFILE "',FOLDER_PATH,'table_romer_reg_3_umts_dy_',DATA_DATE,'_85.csv"
					FIELDS TERMINATED BY ''\t''
					OPTIONALLY ENCLOSED BY ''''
					LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('REPAIR TABLE ',gt_global_statistic_g2,'.table_romer_reg_3_lte_dy_',DATA_DATE,';');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
		
	SET @SqlCmd=CONCAT('SELECT ''REG_ID'',''MCC'',''MNC'',''EARFCN'',''EUTRABAND'',''DATA_DATE'',''INIT_CALL_CNT'',''END_CALL_CNT'',''SIGNAL_CNT'',
				''DATA_CNT'',''UNSPECIFIED_CNT'',''CALL_DUR_SUM'',''BLOCK_CNT'',''DROP_CNT'',''CSFB_CNT'',''PS_UL_VOLUME_SUM'',
				''PS_DL_VOLUME_SUM'',''PS_UL_SPEED_MAX'',''PS_DL_SPEED_MAX'',''DROP_SIGNAL_CNT'',''DROP_DATA_CNT'',
				''END_NON_BLOCK_CALL_CNT'',''UL_THROUPUT_SUM'',''UL_THROUPUT_CNT'',''DL_THROUPUT_SUM'',
				''DL_THROUPUT_CNT'',''END_NON_BLOCK_SIGNAL_CNT'',''END_NON_BLOCK_DATA_CNT'',''CALL_SETUP_TIME_SUM'',''CALL_SETUP_TIME_CNT''	
					UNION
					SELECT REG_ID,MCC,MNC,EARFCN,EUTRABAND,DATA_DATE,INIT_CALL_CNT,END_CALL_CNT,SIGNAL_CNT,
						DATA_CNT,UNSPECIFIED_CNT,CALL_DUR_SUM,BLOCK_CNT,DROP_CNT,CSFB_CNT,PS_UL_VOLUME_SUM,
						PS_DL_VOLUME_SUM,PS_UL_SPEED_MAX,PS_DL_SPEED_MAX,DROP_SIGNAL_CNT,DROP_DATA_CNT,
						END_NON_BLOCK_CALL_CNT,UL_THROUPUT_SUM,UL_THROUPUT_CNT,DL_THROUPUT_SUM,
						DL_THROUPUT_CNT,END_NON_BLOCK_SIGNAL_CNT,END_NON_BLOCK_DATA_CNT,CALL_SETUP_TIME_SUM,CALL_SETUP_TIME_CNT
					FROM ',gt_global_statistic_g2,'.table_romer_reg_3_lte_dy_',DATA_DATE,'
					
					INTO OUTFILE "',FOLDER_PATH,'table_romer_reg_3_lte_dy_',DATA_DATE,'_85.csv"
					FIELDS TERMINATED BY ''\t''
					OPTIONALLY ENCLOSED BY ''''
					LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('REPAIR TABLE ',gt_global_statistic_g2,'.table_reg_3_ds_dy_',DATA_DATE,';');				
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('SELECT ''REG_ID'',''DATA_DATE'',''RSRP_SUM'',''RSRP_CNT'',''RSCP_SUM'',''RSCP_CNT'',
				''RXLEV_SUM'',''RXLEV_CNT'',''RSRQ_SUM'',''RSRQ_CNT'',''ECNO_SUM'',''ECNO_CNT'',
				''RXQUAL_SUM'',''RXQUAL_CNT'',''GSM_CS_CALL_CNT'',''GSM_PS_CALL_CNT'',
				''GSM_VOICE_DROP_CNT'',''GSM_GPRS_DROP_CNT'',''GSM_SMS_DROP_CNT'',''GSM_CS_BLOCK_CNT'',
				''GSM_PS_BLOCK_CNT'',''GSM_CS_CALL_DURATION'',''GSM_CALL_SETUP_TIME_SUM'',''GSM_CALL_SETUP_TIME_CNT'',
				''GSM_CS_SETUP_FAILURE_CNT'',''GSM_PS_SETUP_FAILURE_CNT'',''UMTS_CS_CALL_CNT'',''UMTS_PS_CALL_CNT'',
				''UMTS_VOICE_DROP_CNT'',''UMTS_PS_DROP_CNT'',''UMTS_CS_CALL_DURATION'',''UMTS_CS_BLOCK_CNT'',
				''UMTS_PS_BLOCK_CNT'',''UMTS_UL_VOLUME'',''UMTS_DL_VOLUME'',''UMTS_UL_THROUPUT_SUM'',
				''UMTS_UL_THROUPUT_CNT'',''UMTS_DL_THROUPUT_SUM'',''UMTS_DL_THROUPUT_CNT'',''UMTS_CALL_SETUP_TIME_SUM'',
				''UMTS_CALL_SETUP_TIME_CNT'',''UMTS_CS_SETUP_FAILURE_CNT'',''UMTS_PS_SETUP_FAILURE_CNT'',
				''LTE_CALL_CNT'',''LTE_DROP_CNT'',''LTE_BLOCK_CNT'',''LTE_UL_VOLUME'',''LTE_DL_VOLUME'',''LTE_UL_THROUPUT_SUM'',
				''LTE_UL_THROUPUT_CNT'',''LTE_DL_THROUPUT_SUM'',''LTE_DL_THROUPUT_CNT'',''LATENCY_SUM'',''LATENCY_CNT'',''LTE_CALL_SETUP_TIME_SUM'',
				''LTE_CALL_SETUP_TIME_CNT'',''LTE_SETUP_FAILURE_CNT'',''SRVCC_ATTEMPT_CNT'',''SRVCC_FAILURE_CNT'',''S1_HO_ATTEMPT'',''S1_HO_FAILURE'',
				''X2_HO_ATTEMPT'',''X2_HO_FAILURE'',
				''UMTS_MAX_UL_THROUPUT'',''UMTS_MAX_DL_THROUPUT'',''LTE_MAX_UL_THROUPUT'',''LTE_MAX_DL_THROUPUT'',''COMPLETED_PU_CNT'',''TOTAL_PU_CNT''
					UNION
					SELECT REG_ID,DATA_DATE,RSRP_SUM,RSRP_CNT,RSCP_SUM,RSCP_CNT,
						RXLEV_SUM,RXLEV_CNT,RSRQ_SUM,RSRQ_CNT,ECNO_SUM,ECNO_CNT,
						RXQUAL_SUM,RXQUAL_CNT,GSM_CS_CALL_CNT,GSM_PS_CALL_CNT,
						GSM_VOICE_DROP_CNT,GSM_GPRS_DROP_CNT,GSM_SMS_DROP_CNT,GSM_CS_BLOCK_CNT,
						GSM_PS_BLOCK_CNT,GSM_CS_CALL_DURATION,GSM_CALL_SETUP_TIME_SUM,GSM_CALL_SETUP_TIME_CNT,
						GSM_CS_SETUP_FAILURE_CNT,GSM_PS_SETUP_FAILURE_CNT,UMTS_CS_CALL_CNT,UMTS_PS_CALL_CNT,
						UMTS_VOICE_DROP_CNT,UMTS_PS_DROP_CNT,UMTS_CS_CALL_DURATION,UMTS_CS_BLOCK_CNT,
						UMTS_PS_BLOCK_CNT,UMTS_UL_VOLUME,UMTS_DL_VOLUME,UMTS_UL_THROUPUT_SUM,
						UMTS_UL_THROUPUT_CNT,UMTS_DL_THROUPUT_SUM,UMTS_DL_THROUPUT_CNT,UMTS_CALL_SETUP_TIME_SUM,
						UMTS_CALL_SETUP_TIME_CNT,UMTS_CS_SETUP_FAILURE_CNT,UMTS_PS_SETUP_FAILURE_CNT,
						LTE_CALL_CNT,LTE_DROP_CNT,LTE_BLOCK_CNT,LTE_UL_VOLUME,LTE_DL_VOLUME,LTE_UL_THROUPUT_SUM,
						LTE_UL_THROUPUT_CNT,LTE_DL_THROUPUT_SUM,LTE_DL_THROUPUT_CNT,LATENCY_SUM,LATENCY_CNT,LTE_CALL_SETUP_TIME_SUM,
						LTE_CALL_SETUP_TIME_CNT,LTE_SETUP_FAILURE_CNT,SRVCC_ATTEMPT_CNT,SRVCC_FAILURE_CNT,S1_HO_ATTEMPT,S1_HO_FAILURE,
						X2_HO_ATTEMPT,X2_HO_FAILURE,UMTS_MAX_UL_THROUPUT,UMTS_MAX_DL_THROUPUT,LTE_MAX_UL_THROUPUT,LTE_MAX_DL_THROUPUT,COMPLETED_PU_CNT,TOTAL_PU_CNT
					FROM ',gt_global_statistic_g2,'.table_reg_3_ds_dy_',DATA_DATE,'
					
					INTO OUTFILE "',FOLDER_PATH,'table_reg_3_ds_dy_',DATA_DATE,'_85.csv"					
					FIELDS TERMINATED BY ''\t''
					OPTIONALLY ENCLOSED BY ''''
					LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
		
	INSERT INTO gt_gw_main.SP_LOG VALUES('gt_global_statistic','Cell_Reg_Map_85','START',START_TIME);
	
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.`tmp_cell_3_',DATA_DATE,'`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	SET @SqlCmd=CONCAT('CREATE TEMPORARY TABLE ',gt_global_statistic,'.`tmp_cell_3_',DATA_DATE,'` (
				`technology` VARCHAR(10) DEFAULT NULL,
				 `network_element` bigint(20) NOT NULL,
				 `site_id` VARCHAR(20) NOT NULL,
				  `cell_id` VARCHAR(20) NOT NULL,
				  `lon_lat` VARCHAR(70) DEFAULT NULL,
				  PRIMARY KEY (`technology`,`network_element`,`site_id`,`cell_id`)
			) ENGINE=MYISAM DEFAULT CHARSET=latin1;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.`tmp_nt_cell_current_gsm_',DATA_DATE,'`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	SET @SqlCmd=CONCAT('CREATE TEMPORARY TABLE ',gt_global_statistic,'.`tmp_nt_cell_current_gsm_',DATA_DATE,'` (
				SELECT ''2G'' AS `technology`,BSC_ID,SITE_ID,CELL_ID,LONGITUDE,LATITUDE 
				FROM gt_nt_',DATA_DATE,'.nt_cell_current_gsm
				WHERE BSC_ID NOT IN(1,2,3,4,5,6,7,8,9,10,11,12));');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `TMP_GSM` ON ',gt_global_statistic,'.`tmp_nt_cell_current_gsm_',DATA_DATE,'` (technology,BSC_ID,SITE_ID,CELL_ID);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	
	SET @SqlCmd=CONCAT('INSERT IGNORE INTO ',gt_global_statistic,'.`tmp_cell_3_',DATA_DATE,'`  
				(`technology`,`network_element` , `site_id`,`cell_id`,`lon_lat` )
				SELECT ''2G'',BSC_ID,SITE_ID,CELL_ID,CONCAT(''POINT'',''('',LONGITUDE,'' '',LATITUDE,'')'') AS lon_lat 
				FROM 
				',gt_global_statistic,'.`tmp_nt_cell_current_gsm_',DATA_DATE,'` a
				WHERE  NOT EXISTS (SELECT NULL FROM gt_global_statistic.table_cell_polygon_g2 b
							WHERE b.`technology`=a.`technology`
							AND b.`NETWORK_ELEMENT`=a.`BSC_ID`
							AND b.`SITE_ID`=a.`SITE_ID`
							AND b.`cell_id`=a.`cell_id`);
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.`tmp_nt_cell_current_umts_',DATA_DATE,'`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	SET @SqlCmd=CONCAT('CREATE TEMPORARY TABLE ',gt_global_statistic,'.`tmp_nt_cell_current_umts_',DATA_DATE,'` (
				SELECT ''3G'' AS `technology`,RNC_ID,SITE_ID,CELL_ID,LONGITUDE,LATITUDE 
				FROM gt_nt_',DATA_DATE,'.nt_current
				WHERE RNC_ID NOT IN(241,242,250));');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `TMP_UMTS` ON ',gt_global_statistic,'.`tmp_nt_cell_current_umts_',DATA_DATE,'` (technology,RNC_ID,SITE_ID,CELL_ID);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `TMP_UMTS_technology` ON ',gt_global_statistic,'.`tmp_nt_cell_current_umts_',DATA_DATE,'` (technology);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `TMP_UMTS_RNC_ID` ON ',gt_global_statistic,'.`tmp_nt_cell_current_umts_',DATA_DATE,'` (RNC_ID);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `TMP_UMTS_SITE_ID` ON ',gt_global_statistic,'.`tmp_nt_cell_current_umts_',DATA_DATE,'` (SITE_ID);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `TMP_UMTS_CELL_ID` ON ',gt_global_statistic,'.`tmp_nt_cell_current_umts_',DATA_DATE,'` (CELL_ID);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('INSERT IGNORE INTO ',gt_global_statistic,'.`tmp_cell_3_',DATA_DATE,'` 
				(`technology`,`network_element` , `site_id`,`cell_id`,`lon_lat` )
				SELECT ''3G'',RNC_ID,SITE_ID,CELL_ID,CONCAT(''POINT'',''('',LONGITUDE,'' '',LATITUDE,'')'') AS lon_lat 
				FROM 
				',gt_global_statistic,'.`tmp_nt_cell_current_umts_',DATA_DATE,'` a
				WHERE  NOT EXISTS (SELECT NULL FROM gt_global_statistic.table_cell_polygon_g2 b
							WHERE b.technology=a.technology
							AND b.`NETWORK_ELEMENT`=a.`RNC_ID`
							AND b.`SITE_ID`=a.`SITE_ID`
							AND b.`cell_id`=a.`cell_id`);
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
		
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.`tmp_nt_cell_current_lte_',DATA_DATE,'`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	SET @SqlCmd=CONCAT('CREATE TEMPORARY TABLE ',gt_global_statistic,'.`tmp_nt_cell_current_lte_',DATA_DATE,'` (
				SELECT ''4G'' AS `technology`,a.pu_ID,a.ENODEB_ID,a.CELL_ID,b.LONGITUDE,b.LATITUDE 
				FROM
				gt_nt_',DATA_DATE,'.nt_cell_current_lte a join gt_nt_',DATA_DATE,'.nt_antenna_current_lte b
				on a.ENODEB_ID=b.ENODEB_ID
				AND a. cell_id=b.cell_id
				AND A.PU_ID <>200)');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE INDEX `TMP_LTE` ON ',gt_global_statistic,'.`tmp_nt_cell_current_LTE_',DATA_DATE,'` (technology,PU_ID,ENODEB_ID,CELL_ID);');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
		
	SET @SqlCmd=CONCAT('INSERT IGNORE INTO ',gt_global_statistic,'.`tmp_cell_3_',DATA_DATE,'`  
				(`technology`,`network_element` , `site_id`,`cell_id`,`lon_lat` )
				SELECT ''4G'',a.PU_ID,a.ENODEB_ID,a.CELL_ID,CONCAT(''POINT'',''('',LONGITUDE,'' '',LATITUDE,'')'') AS lon_lat 
					FROM ',gt_global_statistic,'.`tmp_nt_cell_current_lte_',DATA_DATE,'`  a
					WHERE  NOT EXISTS (SELECT NULL FROM ',gt_global_statistic,'.table_cell_polygon_g2 b
							WHERE b.`technology`=a.`technology`
							AND b.`NETWORK_ELEMENT`=a.`PU_ID`
							AND b.`SITE_ID`=a.`ENODEB_ID`
							AND b.`cell_id`=a.`cell_id`);
				');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd =CONCAT('INSERT IGNORE  INTO ',gt_global_statistic,'.table_cell_polygon_g2 
						    (`technology`,
						     `network_element`,
						     `site_id`,
						     `cell_id`,
						     `id`,
						     `polygon_name`
						    )
						SELECT a.`technology`,
							a.`network_element`,
							`site_id` ,
							`cell_id` ,
							b.`id`,
							b.`name`
						FROM ',gt_global_statistic,'.`tmp_cell_3_',DATA_DATE,'`  a
						,',gt_global_statistic,'.`usr_polygon_reg_3_v4` b
						WHERE b.group_id=2 and gt_covmo_pointinpoly(
								ASWKB(GEOMFROMTEXT(A.`lon_lat`)),
								ASWKB(GEOMFROMTEXT(B.`polygon_str`)))=1 
					;') ;
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd =CONCAT('INSERT IGNORE  INTO ',gt_global_statistic,'.table_cell_polygon_g2
						    (`technology`,
						     `network_element`,
						     `site_id`,
						     `cell_id`,
						     `id`,
						     `polygon_name`
						    )
						SELECT a.`technology`,
							a.`network_element`,
							`site_id` ,
							`cell_id` ,
							424000001000,
							null as `polygon_name`
						FROM ',gt_global_statistic,'.`tmp_cell_3_',DATA_DATE,'`  a
						
						WHERE NOT EXISTS 
						(
						SELECT NULL FROM gt_global_statistic.table_cell_polygon_g2 c 
						WHERE c.`technology`=a.`technology` AND
							c.`NETWORK_ELEMENT`=a.`network_element`
							AND c.`SITE_ID`=a.`SITE_ID`
							AND c.`cell_id`=a.`cell_id`);
						
					;') ;
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('SELECT ''TECHNOLOGY'',''NETWORK_ELEMENT'',''SITE_ID'',''CELL_ID '',''ID'',''polygon_name''
				
					UNION
					SELECT technology,network_element,site_id,cell_id,id,polygon_name
					FROM ',gt_global_statistic,'.table_cell_polygon_g2 
					
					INTO OUTFILE "',FOLDER_PATH,'table_cell_reg_map_85.csv"
					FIELDS TERMINATED BY ''\t''
					OPTIONALLY ENCLOSED BY ''''
					LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.`tmp_nt_cell_current_gsm_',DATA_DATE,'`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.`tmp_nt_cell_current_umts_',DATA_DATE,'`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.`tmp_nt_cell_current_lte_',DATA_DATE,'`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.`tmp_cell_3_',DATA_DATE,'`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	SET @SqlCmd=CONCAT('SELECT ''tac'',''manufacturer'',''model'',''source'',''make_id'',''model_id''
					UNION
					SELECT tac,manufacturer,model,source,make_id,model_id
					FROM gt_covmo.`dim_handset`					
				INTO OUTFILE "',FOLDER_PATH,'dim_handset.csv"
				FIELDS TERMINATED BY ''\t''
				OPTIONALLY ENCLOSED BY ''''
				LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.`imsi_group`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	SET @SqlCmd=CONCAT('CREATE TEMPORARY TABLE ',gt_global_statistic,'.`imsi_group`
				SELECT NICKNAME as `GROUP_NAME`,IMSI
				FROM gt_covmo.dim_imsi ;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	SET @SqlCmd=CONCAT('INSERT INTO ',gt_global_statistic,'.`imsi_group`(IMSI,GROUP_NAME)
				SELECT IMSI,''PRESTIGE'' FROM gt_covmo.dim_imsi_200k_copy ;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	SET @SqlCmd=CONCAT('SELECT ''IMSI'',''GROUP_NAME''
					UNION
					SELECT IMSI,GROUP_NAME
					FROM ',gt_global_statistic,'.`imsi_group`
					WHERE IMSI<>''Pre-defined-imsis_1''
				INTO OUTFILE "',FOLDER_PATH,'IMSI_group.csv"
				FIELDS TERMINATED BY ''\t''
				OPTIONALLY ENCLOSED BY ''''
				LINES TERMINATED BY ''\n'';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.`imsi_group`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	INSERT INTO gt_gw_main.SP_LOG VALUES(gt_global_statistic,'SP_Qlikview_report_export',CONCAT('Done: ',TIMESTAMPDIFF(SECOND,START_TIME,SYSDATE()),' seconds.'), NOW());

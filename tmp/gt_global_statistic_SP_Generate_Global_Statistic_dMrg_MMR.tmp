CREATE DEFINER=`covmo`@`%` PROCEDURE `SP_Generate_Global_Statistic_dMrg_MMR`(IN TECH_MASK TINYINT(2),IN WORKER_ID VARCHAR(10),IN DS_FLAG TINYINT(2),IN FIRST_DAY DATETIME,IN END_DAY DATETIME,IN KIND CHAR(2),GROUP_DB_NAME VARCHAR(100),IN IMSI_CELL TINYINT(2))
BEGIN	
	DECLARE done INT DEFAULT 0;  
	DECLARE UNION_STR_IMSI_UMTS VARCHAR(2000) DEFAULT '';
	DECLARE UNION_STR_HS_UMTS VARCHAR(2000) DEFAULT '';
	DECLARE UNION_STR_IMSI_LTE VARCHAR(2000) DEFAULT '';
	DECLARE UNION_STR_HS_LTE VARCHAR(2000) DEFAULT '';
	DECLARE UNION_STR_IMSI_GSM VARCHAR(2000) DEFAULT '';
	DECLARE UNION_STR_HS_GSM VARCHAR(2000) DEFAULT '';
	
	DECLARE v_finished_d INTEGER DEFAULT 0;
	DECLARE v_DATA_DATE_d VARCHAR(10) DEFAULT NULL;
		 
	DECLARE IMSI_UMTS_COLUMN_STR VARCHAR(6000) DEFAULT 
		'`CALL_CNT` int(11) DEFAULT NULL,
		`VOICE_MO_CNT` int(11) DEFAULT NULL,
		`VOICE_MT_CNT` int(11) DEFAULT NULL,
		`VIDEO_MO_CNT` int(11) DEFAULT NULL,
		`VIDEO_MT_CNT` int(11) DEFAULT NULL,
		`R99_MO_CNT` int(11) DEFAULT NULL,
		`R99_MT_CNT` int(11) DEFAULT NULL,
		`HSPA_MO_CNT` int(11) DEFAULT NULL,
		`HSPA_MT_CNT` int(11) DEFAULT NULL,
		`MRAB_MO_CNT` int(11) DEFAULT NULL,
		`MRAB_MT_CNT` int(11) DEFAULT NULL,
		`SIGNAL_MO_CNT` int(11) DEFAULT NULL,
		`SIGNAL_MT_CNT` int(11) DEFAULT NULL,
		`SMS_MO_CNT` int(11) DEFAULT NULL,
		`SMS_MT_CNT` int(11) DEFAULT NULL,
		`PS_OTHER_CNT` int(11) DEFAULT NULL,
		`CALL_DUR_SUM` double DEFAULT NULL,
		`VOICE_DUR_SUM` double DEFAULT NULL,
		`VIDEO_DUR_SUM` double DEFAULT NULL,
		`R99_DUR_SUM` double DEFAULT NULL,
		`HSPA_DUR_SUM` double DEFAULT NULL,
		`MRAB_DUR_SUM` double DEFAULT NULL,
		`DROP_CNT` int(11) DEFAULT NULL,
		`DROP_VOICE_CNT` int(11) DEFAULT NULL,
		`DROP_VEDIO_CNT` int(11) DEFAULT NULL,
		`DROP_R99_CNT` int(11) DEFAULT NULL,
		`DROP_HSPA_CNT` int(11) DEFAULT NULL,
		`DROP_MRAB_CNT` int(11) DEFAULT NULL,
		`DROP_SMS_CNT` int(11) DEFAULT NULL,
		`DROP_SIGNAL_CNT` int(11) DEFAULT NULL,
		`DROP_PS_OTHER_CNT` int(11) DEFAULT NULL,
		`DROP_RF_CNT` int(11) DEFAULT NULL,
		`DROP_CONG_CNT` int(11) DEFAULT NULL,
		`DROP_TRANS_CNT` int(11) DEFAULT NULL,
		`DROP_SHO_CNT` int(11) DEFAULT NULL,
		`DROP_HHO_CNT` int(11) DEFAULT NULL,
		`DROP_IRAT_CNT` int(11) DEFAULT NULL,
		`BLOCK_CNT` int(11) DEFAULT NULL,
		`BLOCK_VOICE_CNT` int(11) DEFAULT NULL,
		`BLOCK_VEDIO_CNT` int(11) DEFAULT NULL,
		`BLOCK_R99_CNT` int(11) DEFAULT NULL,
		`BLOCK_HSPA_CNT` int(11) DEFAULT NULL,
		`BLOCK_MRAB_CNT` int(11) DEFAULT NULL,
		`BLOCK_SMS_CNT` int(11) DEFAULT NULL,
	
		`BLOCK_SMS_MO_CNT` int(11) DEFAULT NULL,
		`BLOCK_SMS_MT_CNT` int(11) DEFAULT NULL,
	
		`BLOCK_SIGNAL_CNT` int(11) DEFAULT NULL,
		`BLOCK_PS_OTHER_CNT` int(11) DEFAULT NULL,
		`SHO_ATTEMPT_CNT` int(11) DEFAULT NULL,
		`SHO_FAILURE_CNT` int(11) DEFAULT NULL,
		`HHO_ATTEMPT_CNT` int(11) DEFAULT NULL,
		`HHO_FAILURE_CNT` int(11) DEFAULT NULL,
		`IRAT_ATTEMPT_CNT` int(11) DEFAULT NULL,
		`IRAT_FAILURE_CNT` int(11) DEFAULT NULL,
		`MOVING_CALL_CNT` int(11) DEFAULT NULL,
		`INDOOR_CALL_CNT` int(11) DEFAULT NULL,
		`PS_UL_VOLUME_SUM` double DEFAULT NULL,
		`PS_DL_VOLUME_SUM` double DEFAULT NULL,
		`PS_UL_SPEED_MAX` double DEFAULT NULL,
		`PS_DL_SPEED_MAX` double DEFAULT NULL,
		`FIRST_RSCP_SUM` double DEFAULT NULL,
		`FIRST_RSCP_CNT` int(11) DEFAULT NULL,
		`FIRST_ECNO_SUM` double DEFAULT NULL,
		`FIRST_ECNO_CNT` int(11) DEFAULT NULL,
		`CALL_SETUP_TIME_SUM` int(11) DEFAULT NULL,
		`CALL_SETUP_TIME_CNT` int(11) DEFAULT NULL,
	
		`CALL_SETUP_TIME_VOICE_SUM` int(11) DEFAULT NULL,
		`CALL_SETUP_TIME_VOICE_CNT` int(11) DEFAULT NULL,
		`CALL_SETUP_TIME_VEDIO_SUM` int(11) DEFAULT NULL,
		`CALL_SETUP_TIME_VEDIO_CNT` int(11) DEFAULT NULL,
		`CALL_SETUP_TIME_R99_SUM` int(11) DEFAULT NULL,
		`CALL_SETUP_TIME_R99_CNT` int(11) DEFAULT NULL,
		`CALL_SETUP_TIME_HSPA_SUM` int(11) DEFAULT NULL,
		`CALL_SETUP_TIME_HSPA_CNT` int(11) DEFAULT NULL,
		`CALL_SETUP_TIME_MRAB_SUM` int(11) DEFAULT NULL,
		`CALL_SETUP_TIME_MRAB_CNT` int(11) DEFAULT NULL,
		`CALL_SETUP_TIME_SIG_SUM` int(11) DEFAULT NULL,
		`CALL_SETUP_TIME_SIG_CNT` int(11) DEFAULT NULL,
		`CALL_SETUP_TIME_OTH_SUM` int(11) DEFAULT NULL,
		`CALL_SETUP_TIME_OTH_CNT` int(11) DEFAULT NULL,
		`CALL_SETUP_TIME_SMS_SUM` int(11) DEFAULT NULL,
		`CALL_SETUP_TIME_SMS_CNT` int(11) DEFAULT NULL,
	
		`SF_CNT` int(11) DEFAULT NULL,
		`SF_VOICE_CNT` int(11) DEFAULT NULL,
		`SF_VEDIO_CNT` int(11) DEFAULT NULL,
		`SF_R99_CNT` int(11) DEFAULT NULL,
		`SF_HSPA_CNT` int(11) DEFAULT NULL,
		`SF_MRAB_CNT` int(11) DEFAULT NULL,
		`SF_SMS_CNT` int(11) DEFAULT NULL,
	
		`SF_SMS_MO_CNT` int(11) DEFAULT NULL,
		`SF_SMS_MT_CNT` int(11) DEFAULT NULL,
	
		`SF_SIGNAL_CNT` int(11) DEFAULT NULL,
		`SF_PS_OTHER_CNT` int(11) DEFAULT NULL,
		`PDP_ACTIVATION_REQUEST` int(11) DEFAULT NULL,
		`PDP_ACTIVATION_ACCEPT` int(11) DEFAULT NULL,
		`PDP_DEACTIVATION_REQUEST` int(11) DEFAULT NULL,
		`PDP_DEACTIVATION_ACCEPT` int(11) DEFAULT NULL,
		`AUTH_REQUEST` int(11) DEFAULT NULL,
		`AUTH_RESPONSE` int(11) DEFAULT NULL,
		`AUTH_CIPH_REQUEST` int(11) DEFAULT NULL,
		`AUTH_CIPH_RESPONSE` int(11) DEFAULT NULL,
		`SECURITY_MODE_ATT` int(11) DEFAULT NULL,
		`SECURITY_MODE_SUCCESS` int(11) DEFAULT NULL,
		`LU_REQUEST` int(11) DEFAULT NULL,
		`LU_ACCEPT` int(11) DEFAULT NULL,
		`RAU_REQUEST` int(11) DEFAULT NULL,
		`RAU_ACCEPT` int(11) DEFAULT NULL,';
		
	DECLARE TILE_UMTS_COLUMN_STR VARCHAR(3000) DEFAULT 
		'`INIT_CALL_CNT` INT(11) DEFAULT NULL,
		  `END_CALL_CNT` INT(11) DEFAULT NULL,
		  `VOICE_CNT` INT(11) DEFAULT NULL,
		  `VIDEO_CNT` INT(11) DEFAULT NULL,
		  `PS_R99_CNT` INT(11) DEFAULT NULL,
		  `PS_HSPA_CNT` INT(11) DEFAULT NULL,
		  `M_RAB_CNT` INT(11) DEFAULT NULL, 
		  `SIGNAL_CNT` INT(11) DEFAULT NULL,
		  `SMS_CNT` INT(11) DEFAULT NULL,
		  `PS_OTHER_CNT` INT(11) DEFAULT NULL,
		  `CALL_DUR_SUM` DOUBLE DEFAULT NULL,
		  `CS_DUR_SUM` DOUBLE DEFAULT NULL,
		  `DROP_CNT` INT(11) DEFAULT NULL,
		  `BLOCK_CNT` INT(11) DEFAULT NULL,
		  `DROP_VOICE_CNT` INT(11) DEFAULT NULL,
		  `DROP_VIDEO_CNT` INT(11) DEFAULT NULL,
		  `DROP_PS_R99_CNT` INT(11) DEFAULT NULL,
		  `DROP_PS_HSPA_CNT` INT(11) DEFAULT NULL,
		  `DROP_M_RAB_CNT` INT(11) DEFAULT NULL,
		  `DROP_SIGNAL_CNT` INT(11) DEFAULT NULL,
		  `DROP_SMS_CNT` INT(11) DEFAULT NULL,
		  `DROP_PS_OTHER_CNT` INT(11) DEFAULT NULL,
		  `SHO_ATTEMPT_CNT` INT(11) DEFAULT NULL,
		  `SHO_FAILURE_CNT` INT(11) DEFAULT NULL,
		  `IFHO_ATTEMPT_CNT` INT(11) DEFAULT NULL,
		  `IFHO_FAILURE_CNT` INT(11) DEFAULT NULL,
		  `IRAT_ATTEMPT_CNT` INT(11) DEFAULT NULL,
		  `IRAT_FAILURE_CNT` INT(11) DEFAULT NULL,
		  `PS_UL_VOLUME_SUM` DOUBLE DEFAULT NULL,
		  `PS_DL_VOLUME_SUM` DOUBLE DEFAULT NULL,
		  `PS_UL_SPEED_MAX` DOUBLE DEFAULT NULL,
		  `PS_DL_SPEED_MAX` DOUBLE DEFAULT NULL,
		  `RSCP_SUM` DOUBLE DEFAULT NULL,
		  `RSCP_CNT` INT(11) DEFAULT NULL,
		  `ECNO_SUM` DOUBLE DEFAULT NULL,
		  `ECNO_CNT` INT(11) DEFAULT NULL,
		  `ACTIVE_SET_SUM` DOUBLE DEFAULT NULL,
		  `ACTIVE_SET_CNT` INT(11) DEFAULT NULL,
		  `POLLUTED_PILOT_CNT` INT(11) DEFAULT NULL,
		  `PILOT_DOM_SUM` DOUBLE DEFAULT NULL,
		  `PILOT_CNT` INT(11) DEFAULT NULL,
		  `T19_CNT` INT(11) DEFAULT NULL,
		  `UL_THROUPUT_SUM` DOUBLE DEFAULT NULL,
		  `UL_THROUPUT_CNT` INT(11) DEFAULT NULL,
		  `DL_THROUPUT_SUM` DOUBLE DEFAULT NULL,
		  `DL_THROUPUT_CNT` INT(11) DEFAULT NULL,
		  `NON_BLOCK_VOICE_CNT` INT(11) DEFAULT NULL,
		  `NON_BLOCK_VIDEO_CNT` INT(11) DEFAULT NULL,
		  `NON_BLOCK_PS_R99_CNT` INT(11) DEFAULT NULL,
		  `NON_BLOCK_PS_HSPA_CNT` INT(11) DEFAULT NULL,
		  `NON_BLOCK_M_RAB_CNT` INT(11) DEFAULT NULL,
		  `NON_BLOCK_SIGNAL_CNT` INT(11) DEFAULT NULL,
		  `NON_BLOCK_SMS_CNT` INT(11) DEFAULT NULL,
		  `NON_BLOCK_PS_OTHER_CNT` INT(11) DEFAULT NULL,
		  `PS_CNT` INT(11) DEFAULT NULL,
		  `DROP_PS_CNT` int(11) DEFAULT NULL,';
		  
	DECLARE IMSI_LTE_COLUMN_STR VARCHAR(3500) DEFAULT 
		'`CALL_CNT` int(11) DEFAULT NULL,
		`DATA_CNT` int(11) DEFAULT NULL,
		`SIGNAL_CNT` int(11) DEFAULT NULL,
		`SMS_CNT` int(11) DEFAULT NULL,
		`VOLTE_CNT` int(11) DEFAULT NULL,
		`UNSPECIFIED_CNT` int(11) DEFAULT NULL,
		`CALL_DUR_SUM` double DEFAULT NULL,
		`DATA_DUR_SUM` double DEFAULT NULL,
		`SIGNAL_DUR_SUM` double DEFAULT NULL,
		`DROP_CNT` int(11) DEFAULT NULL,
		`DROP_DATA_CNT` int(11) DEFAULT NULL,
		`DROP_SIGNAL_CNT` int(11) DEFAULT NULL,
		`DROP_SMS_CNT` int(11) DEFAULT NULL,
		`DROP_VOLTE_CNT` int(11) DEFAULT NULL,
		`DROP_UNSPECIFIED_CNT` int(11) DEFAULT NULL,
		`BLOCK_CNT` int(11) DEFAULT NULL,
		`BLOCK_DATA_CNT` int(11) DEFAULT NULL,
		`BLOCK_SIGNAL_CNT` int(11) DEFAULT NULL,
		`BLOCK_SMS_CNT` int(11) DEFAULT NULL,
	
		`BLOCK_SMS_MT_CNT` int(11) DEFAULT NULL,
		`BLOCK_SMS_MO_CNT` int(11) DEFAULT NULL,
	
		`BLOCK_VOLTE_CNT` int(11) DEFAULT NULL,
		`BLOCK_UNSPECIFIED_CNT` int(11) DEFAULT NULL,
		`DROP_RDO_NW_CNT` int(11) DEFAULT NULL,
		`DROP_TRANS_CNT` int(11) DEFAULT NULL,
		`DROP_NAS_CNT` int(11) DEFAULT NULL,
		`DROP_MISC_CNT` int(11) DEFAULT NULL,
		`DROP_PROTOCOL_CNT` int(11) DEFAULT NULL,
		`INTER_FREQ_ATTEMPT_CNT` int(11) DEFAULT NULL,
		`INTER_FREQ_FAILURE_CNT` int(11) DEFAULT NULL,
		`INTRA_FREQ_ATTEMPT_CNT` int(11) DEFAULT NULL,
		`INTRA_FREQ_FAILURE_CNT` int(11) DEFAULT NULL,
		`4G_3G_ATTEMPT_CNT` int(11) DEFAULT NULL,
		`4G_3G_FAILURE_CNT` int(11) DEFAULT NULL,
		`4G_2G_ATTEMPT_CNT` int(11) DEFAULT NULL,
		`4G_2G_FAILURE_CNT` int(11) DEFAULT NULL,
		`MOVING_CALL_CNT` int(11) DEFAULT NULL,
		`INDOOR_CALL_CNT` int(11) DEFAULT NULL,
		`PS_UL_VOLUME_SUM` double DEFAULT NULL,
		`PS_DL_VOLUME_SUM` double DEFAULT NULL,
		`PS_UL_SPEED_MAX` double DEFAULT NULL,
		`PS_DL_SPEED_MAX` double DEFAULT NULL,
		`FIRST_RSRP_SUM` double DEFAULT NULL,
		`FIRST_RSRP_CNT` int(11) DEFAULT NULL,
		`FIRST_RSRQ_SUM` double DEFAULT NULL,
		`FIRST_RSRQ_CNT` int(11) DEFAULT NULL,
		`CALL_SETUP_TIME_SUM` int(11) DEFAULT NULL,
		`CALL_SETUP_TIME_CNT` int(11) DEFAULT NULL,
	
		`CALL_SETUP_TIME_SIG_SUM` INT(11) DEFAULT NULL,
		`CALL_SETUP_TIME_SIG_CNT` INT(11) DEFAULT NULL,
		`CALL_SETUP_TIME_DATA_SUM` INT(11) DEFAULT NULL,
		`CALL_SETUP_TIME_DATA_CNT` INT(11) DEFAULT NULL,
		`CALL_SETUP_TIME_SMS_SUM` INT(11) DEFAULT NULL,
		`CALL_SETUP_TIME_SMS_CNT` INT(11) DEFAULT NULL,
		`CALL_SETUP_TIME_VOLTE_SUM` INT(11) DEFAULT NULL,
		`CALL_SETUP_TIME_VOLTE_CNT` INT(11) DEFAULT NULL,
		`CALL_SETUP_TIME_UNSP_SUM` INT(11) DEFAULT NULL,
		`CALL_SETUP_TIME_UNSP_CNT` INT(11) DEFAULT NULL,
	
		`SF_CNT` int(11) DEFAULT NULL,
		`SF_DATA_CNT` int(11) DEFAULT NULL,
		`SF_SIGNAL_CNT` int(11) DEFAULT NULL,
		`SF_SMS_CNT` int(11) DEFAULT NULL,
	
		`SF_SMS_MT_CNT` int(11) DEFAULT NULL,
		`SF_SMS_MO_CNT` int(11) DEFAULT NULL,
	
		`SF_VOLTE_CNT` int(11) DEFAULT NULL,
		`SF_UNSPECIFIED_CNT` int(11) DEFAULT NULL,
		`MT_DATA_CNT` int(11) DEFAULT NULL,
		`MO_DATA_CNT` int(11) DEFAULT NULL,
		`MT_SMS_CNT` int(11) DEFAULT NULL,
		`MO_SMS_CNT` int(11) DEFAULT NULL,
		`MT_VOLTE_CNT` int(11) DEFAULT NULL,
		`MO_VOLTE_CNT` int(11) DEFAULT NULL,
		`CSFB_SIGNAL_CNT` INT(11) DEFAULT NULL,
		`CSFB_DATA_CNT` INT(11) DEFAULT NULL,
		`CSFB_SMS_CNT` INT(11) DEFAULT NULL,
		`CSFB_VOLTE_CNT` INT(11) DEFAULT NULL,
		`CSFB_UNSPECIFIED_CNT` INT(11) DEFAULT NULL,
		`CSFB_CNT` INT(11) DEFAULT NULL,
		`LATENCY_SUM` DOUBLE DEFAULT NULL,
		`LATENCY_CNT` INT(11) DEFAULT NULL,';
		
	DECLARE TILE_LTE_COLUMN_STR VARCHAR(2000) DEFAULT 
		'`INIT_CALL_CNT` int(11) DEFAULT NULL,
		  `END_CALL_CNT` int(11) DEFAULT NULL,
		  `SIGNAL_CNT` int(11) DEFAULT NULL,
		  `DATA_CNT` int(11) DEFAULT NULL,
		  `UNSPECIFIED_CNT` int(11) DEFAULT NULL,
		  `CALL_DUR_SUM` double DEFAULT NULL,
		  `BLOCK_CNT` int(11) DEFAULT NULL,
		  `DROP_CNT` int(11) DEFAULT NULL,
		  `CSFB_CNT` int(11) DEFAULT NULL,
		  `INTER_FREQ_ATTEMPT_CNT` int(11) DEFAULT NULL,
		  `INTER_FREQ_FAILURE_CNT` int(11) DEFAULT NULL,
		  `INTRA_FREQ_ATTEMPT_CNT` int(11) DEFAULT NULL,
		  `INTRA_FREQ_FAILURE_CNT` int(11) DEFAULT NULL,
		  `4G_3G_ATTEMPT_CNT` int(11) DEFAULT NULL,
		  `4G_3G_FAILURE_CNT` int(11) DEFAULT NULL,
		  `4G_2G_ATTEMPT_CNT` int(11) DEFAULT NULL,
		  `4G_2G_FAILURE_CNT` int(11) DEFAULT NULL,
		  `PS_UL_VOLUME_SUM` double DEFAULT NULL,
		  `PS_DL_VOLUME_SUM` double DEFAULT NULL,
		  `PS_UL_SPEED_MAX` double DEFAULT NULL,
		  `PS_DL_SPEED_MAX` double DEFAULT NULL,
		  `RSRP_SUM` double DEFAULT NULL,
		  `RSRP_CNT` int(11) DEFAULT NULL,
		  `RSRQ_SUM` double DEFAULT NULL,
		  `RSRQ_CNT` int(11) DEFAULT NULL,
		  `PILOT_DOMINANCE_SUM` int(11) DEFAULT NULL,
		  `PILOT_DOMINANCE_CNT` int(11) DEFAULT NULL,
		  `DROP_SIGNAL_CNT` int(11) DEFAULT NULL,
		  `DROP_DATA_CNT` int(11) DEFAULT NULL,
		  `END_NON_BLOCK_CALL_CNT` int(11) DEFAULT NULL,
		  `UL_THROUPUT_SUM` double DEFAULT NULL,
		  `UL_THROUPUT_CNT` int(11) DEFAULT NULL,
		  `DL_THROUPUT_SUM` double DEFAULT NULL,
		  `DL_THROUPUT_CNT` int(11) DEFAULT NULL,
		  `BLIND_REDIR_4G_3G`  MEDIUMINT(8)  DEFAULT NULL,
		  `BLIND_REDIR_4G_2G` MEDIUMINT(8)  DEFAULT NULL,';
		  
	DECLARE CELL_LTE_COLUMN_STR VARCHAR(2000) DEFAULT '
		`RRC_CONN_SETUP_ATTEMPT` MEDIUMINT(8) DEFAULT NULL,
		`RRC_CONN_SETUP_REJECT` MEDIUMINT(8) DEFAULT NULL,
		`RRC_CONN_SETUP_MISSING_COMPLETE` MEDIUMINT(8) DEFAULT NULL,
		`RRC_CONN_SETUP_PROC_TIME` MEDIUMINT(8) DEFAULT NULL,
		`RRC_CONN_SETUP_ACCS_DELAY` MEDIUMINT(8) DEFAULT NULL,
		`ERAB_SETUP_ATTEMPT` MEDIUMINT(8) DEFAULT NULL,
		`ERAB_SETUP_REJECT` MEDIUMINT(8) DEFAULT NULL,
		`ERAB_SETUP_ACCS_DELAY` MEDIUMINT(8) DEFAULT NULL,
		`UE_CNXT_DROP_SETUP` MEDIUMINT(8) DEFAULT NULL,
		`UE_CNXT_DROP_DROP` MEDIUMINT(8) DEFAULT NULL,
		`RRC_RE_ESTABLISHMENT_ATTEMPT` MEDIUMINT(8) DEFAULT NULL,
		`RRC_RE_ESTABLISHMENT_FAILURE` MEDIUMINT(8) DEFAULT NULL,
		`MIMO_USAGE_RATIO_NUM` MEDIUMINT(8) DEFAULT NULL,
		`MIMO_USAGE_RATIO_DEN` MEDIUMINT(8) DEFAULT NULL,
		`SUBSC_PET_CELL_PER_HR` FLOAT DEFAULT NULL,
		`CALL_DURATION_SUM` MEDIUMINT(8) DEFAULT NULL,	
		`CALL_DURATION_CNT` MEDIUMINT(8) DEFAULT NULL,	
		`COVMO_DATA_AVAILABILITY` MEDIUMINT(8) DEFAULT ''1'',
		`4G_4G_HO_ATTEMPT` MEDIUMINT(8) DEFAULT NULL,
		`4G_4G_HO_FAILURE` MEDIUMINT(8) DEFAULT NULL,
		`RRC_RECONFIGURATION_ATTEMPT` MEDIUMINT(8) DEFAULT NULL,
		`RRC_RECONFIGURATION_FAILURE` MEDIUMINT(8) DEFAULT NULL,
		`CSFB_EXECUTIONS` MEDIUMINT(8) DEFAULT NULL,
		`UE_CNXT_REL_TOT` MEDIUMINT(8) DEFAULT NULL,
		`IRAT_PING_PONG` MEDIUMINT(8) DEFAULT NULL,
		`IRAT_AVG_RSRP` FLOAT DEFAULT NULL,
		`IRAT_AVG_RSRQ` FLOAT DEFAULT NULL,
		`IRAT_AVG_TA` FLOAT DEFAULT NULL,
		`IRAT_AVG_RSCP` FLOAT DEFAULT NULL,
		`IRAT_AVG_ECN0` FLOAT DEFAULT NULL,
		`IRAT_AVG_RSSI` FLOAT DEFAULT NULL,
		`4G_3G_HO_ATTEMPT` MEDIUMINT(8) DEFAULT NULL,
		`4G_3G_HO_FAILURE` MEDIUMINT(8) DEFAULT NULL,
		`4G_2G_HO_ATTEMPT` MEDIUMINT(8) DEFAULT NULL,
		`4G_2G_HO_FAILURE` MEDIUMINT(8)  DEFAULT NULL,
		`BLIND_REDIR_4G_3G`  MEDIUMINT(8)  DEFAULT NULL,
		`BLIND_REDIR_4G_2G` MEDIUMINT(8)  DEFAULT NULL,';
		  
	DECLARE IMSI_GSM_COLUMN_STR VARCHAR(3000) DEFAULT 
		'CALL_CNT int(11) DEFAULT NULL,
		  VOICE_MO_CNT int(11) DEFAULT NULL,
		  VOICE_MT_CNT int(11) DEFAULT NULL,
		  DATA_MO_CNT int(11) DEFAULT NULL,
		  DATA_MT_CNT int(11) DEFAULT NULL,
		  SMS_MO_CNT int(11) DEFAULT NULL,
		  SMS_MT_CNT int(11) DEFAULT NULL,
		  SIGNAL_CNT int(11) DEFAULT NULL,
		  CALL_DUR_SUM int(11) DEFAULT NULL,
		  VOICE_DUR_SUM int(11) DEFAULT NULL,
		  DATA_DUR_SUM int(11) DEFAULT NULL,
		  DROP_CNT int(11) DEFAULT NULL,
		  BLOCK_CNT int(11) DEFAULT NULL,
		  DROP_VOICE_CNT int(11) DEFAULT NULL,
		  DROP_GPRS_CNT int(11) DEFAULT NULL,
		  DROP_SMS_CNT int(11) DEFAULT NULL,
		  DROP_SIGNAL_CNT int(11) DEFAULT NULL,
		  DROP_OTHER_CNT int(11) DEFAULT NULL,
		  BLOCK_VOICE_CNT int(11) DEFAULT NULL,
		  BLOCK_GPRS_CNT int(11) DEFAULT NULL,
		  BLOCK_SMS_CNT int(11) DEFAULT NULL,
	
		  BLOCK_SMS_MT_CNT int(11) DEFAULT NULL,
		  BLOCK_SMS_MO_CNT int(11) DEFAULT NULL,
		
		  BLOCK_SIGNAL_CNT int(11) DEFAULT NULL,
		  BLOCK_OTHER_CNT int(11) DEFAULT NULL,
		  HO_ATTEMPT_CNT int(11) DEFAULT NULL,
		  HO_FAILURE_CNT int(11) DEFAULT NULL,
		  MOVING_CALL_CNT int(11) DEFAULT NULL,
		  INDOOR_CALL_CNT int(11) DEFAULT NULL,
		  FIRST_RXLEV_DL_SUM double DEFAULT NULL,
		  FIRST_RXLEV_DL_CNT int(11) DEFAULT NULL,
		  FIRST_RXQUAL_DL_SUM double DEFAULT NULL,
		  FIRST_RXQUAL_DL_CNT int(11) DEFAULT NULL,
		  FIRST_RXLEV_UL_SUM double DEFAULT NULL,
		  FIRST_RXLEV_UL_CNT int(11) DEFAULT NULL,
		  FIRST_RXQUAL_UL_SUM double DEFAULT NULL,
		  FIRST_RXQUAL_UL_CNT int(11) DEFAULT NULL,
		  CALL_SETUP_TIME_SUM int(11) DEFAULT NULL,
		  CALL_SETUP_TIME_CNT int(11) DEFAULT NULL,
	
		  CALL_SETUP_TIME_VOICE_SUM int(11) DEFAULT NULL,
		  CALL_SETUP_TIME_VOICE_CNT int(11) DEFAULT NULL,
		  CALL_SETUP_TIME_SIG_SUM int(11) DEFAULT NULL,
		  CALL_SETUP_TIME_SIG_CNT int(11) DEFAULT NULL,
		  CALL_SETUP_TIME_SMS_SUM int(11) DEFAULT NULL,
		  CALL_SETUP_TIME_SMS_CNT int(11) DEFAULT NULL,
		  CALL_SETUP_TIME_GPRS_SUM int(11) DEFAULT NULL,
		  CALL_SETUP_TIME_GPRS_CNT int(11) DEFAULT NULL,
		  CALL_SETUP_TIME_OTH_SUM int(11) DEFAULT NULL,
		  CALL_SETUP_TIME_OTH_CNT int(11) DEFAULT NULL,
	
		  SF_VOICE_CNT int(11) DEFAULT NULL,
		  SF_GPRS_CNT int(11) DEFAULT NULL,
		  SF_SMS_CNT int(11) DEFAULT NULL,
		  SF_SMS_MT_CNT int(11) DEFAULT NULL,
		  SF_SMS_MO_CNT int(11) DEFAULT NULL,
		  SF_SIGNAL_CNT int(11) DEFAULT NULL,
		  SF_OTHER_CNT int(11) DEFAULT NULL,';
		
	DECLARE TILE_GSM_COLUMN_STR VARCHAR(2000) DEFAULT 
		'INIT_CALL_CNT int(11) DEFAULT NULL, 
		  END_CALL_CNT int(11) DEFAULT NULL,
		  VOICE_CNT int(11) DEFAULT NULL,
		  SIGNAL_CNT int(11) DEFAULT NULL,
		  SMS_CNT int(11) DEFAULT NULL,
		  GPRS_CNT int(11) DEFAULT NULL,
		  OTHER_CNT int(11) DEFAULT NULL,
		  BLOCK_CNT int(11) DEFAULT NULL,
		  DROP_VOICE_CNT int(11) DEFAULT NULL,
		  DROP_SIGNAL_CNT int(11) DEFAULT NULL,
		  DROP_SMS_CNT int(11) DEFAULT NULL,
		  DROP_GPRS_CNT int(11) DEFAULT NULL,
		  DROP_OTHER_CNT int(11) DEFAULT NULL,
		  NON_BLOCK_VOICE_CNT int(11) DEFAULT NULL,
		  NON_BLOCK_SIGNAL_CNT int(11) DEFAULT NULL,
		  NON_BLOCK_SMS_CNT int(11) DEFAULT NULL,
		  NON_BLOCK_GPRS_CNT int(11) DEFAULT NULL,
		  NON_BLOCK_OTHER_CNT int(11) DEFAULT NULL,
		  CALL_DUR_SUM double DEFAULT NULL,
		  RXLAV_SUM double DEFAULT NULL,
		  RXLAV_CNT int(11) DEFAULT NULL,
		  RXQUAL_SUM double DEFAULT NULL,
		  RXQUAL_CNT int(11) DEFAULT NULL,';
	DECLARE IMSI_CELL_UMTS_COLUMN_STR VARCHAR(1000) DEFAULT 
		'`START_CELL_ID` MEDIUMINT(9) NOT NULL,
		  `START_SITE_ID` VARCHAR(20) DEFAULT NULL,
		  `START_REG_1_ID` BIGINT(20) DEFAULT NULL,
		  `START_REG_2_ID` BIGINT(20) DEFAULT NULL,
		  `START_REG_3_ID` BIGINT(20) DEFAULT NULL,
		  `END_CELL_ID` MEDIUMINT(9) NOT NULL,
		  `END_SITE_ID` VARCHAR(20) DEFAULT NULL,
		  `END_REG_1_ID` BIGINT(20) DEFAULT NULL,
		  `END_REG_2_ID` BIGINT(20) DEFAULT NULL,
		  `END_REG_3_ID` BIGINT(20) DEFAULT NULL,';
	DECLARE IMSI_CELL_LTE_COLUMN_STR VARCHAR(1000) DEFAULT 
		'`START_CELL_ID` TINYINT(4) UNSIGNED NOT NULL DEFAULT ''0'',
		`START_ENODEB_ID` MEDIUMINT(9) NOT NULL DEFAULT ''0'',
		`START_REG_1_ID` BIGINT(20) DEFAULT NULL,
		`START_REG_2_ID` BIGINT(20) DEFAULT NULL,
		`START_REG_3_ID` BIGINT(20) DEFAULT NULL,
		`END_CELL_ID` TINYINT(4) UNSIGNED NOT NULL DEFAULT ''0'',
		`END_ENODEB_ID` MEDIUMINT(9) NOT NULL DEFAULT ''0'',
		`END_REG_1_ID` BIGINT(20) DEFAULT NULL,
		`END_REG_2_ID` BIGINT(20) DEFAULT NULL,
		`END_REG_3_ID` BIGINT(20) DEFAULT NULL,';
	DECLARE IMSI_CELL_GSM_COLUMN_STR VARCHAR(1000) DEFAULT 
		'`START_CELL_ID` MEDIUMINT(9) NOT NULL,
		`START_SITE_ID` VARCHAR(20) DEFAULT NULL,
		`START_REG_1_ID` BIGINT(20) DEFAULT NULL,
		`START_REG_2_ID` BIGINT(20) DEFAULT NULL,
		`START_REG_3_ID` BIGINT(20) DEFAULT NULL,
		`END_CELL_ID` MEDIUMINT(9) NOT NULL,
		`END_SITE_ID` VARCHAR(20) DEFAULT NULL,
		`END_REG_1_ID` BIGINT(20) DEFAULT NULL,
		`END_REG_2_ID` BIGINT(20) DEFAULT NULL,
		`END_REG_3_ID` BIGINT(20) DEFAULT NULL,';	  
		
	IF KIND='MN' THEN 
 		SET @END_DAY=DATE_ADD(END_DAY,INTERVAL -1 DAY);
		SET @SqlCmd=CONCAT('SELECT DATEDIFF(''',@END_DAY,''',''',FIRST_DAY,''') INTO @DiffDate ;');
		SET @DATE_MN=DATE_FORMAT(FIRST_DAY,'%Y%m');
	ELSE 
		SET @SqlCmd=CONCAT('SELECT DATEDIFF(''',END_DAY,''',''',FIRST_DAY,''') INTO @DiffDate ;');
		SET @DATE_WK=CONCAT(DATE_FORMAT(FIRST_DAY,'%Y%m%d'),'_',DATE_FORMAT(END_DAY,'%Y%m%d'));
	END IF;
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @v_i=1;
	SET @v_R_Max=@DiffDate+1;
	SET @DIS_DATE:=FIRST_DAY;
	
	WHILE @v_i <= @v_R_Max DO
	BEGIN
		SET v_DATA_DATE_d:=@DIS_DATE;	
		SET @DATE_DY_MRG=DATE_FORMAT(v_DATA_DATE_d,'%Y%m%d');
		IF (TECH_MASK=2 OR TECH_MASK =0) THEN 
			SET @SqlCmd=CONCAT('SELECT COUNT(*) INTO @V_EXIST_DY FROM information_schema.`TABLES`
						WHERE TABLE_SCHEMA=''',group_db_name ,''' 
						AND TABLE_NAME=''table_imsi_umts_dy_',@DATE_DY_MRG,''';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			
			IF @V_EXIST_DY=0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE ',group_db_name,'.table_imsi_umts_dy_',@DATE_DY_MRG,' 
							(
							  `IMSI` varchar(20) NOT NULL,
							  `DATA_DATE` DATETIME NOT NULL,
							  ',IMSI_UMTS_COLUMN_STR,'
							  `MAKE_ID` int(11) DEFAULT NULL,
							  `MODEL_ID` int(11) DEFAULT NULL,
							  ',CASE WHEN IMSI_CELL=1 THEN IMSI_CELL_UMTS_COLUMN_STR ELSE '' END,'
							  PRIMARY KEY (`IMSI`,`DATA_DATE`)
							) ENGINE=MyISAM DEFAULT CHARSET=latin1 DELAY_KEY_WRITE=1;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				INSERT IGNORE INTO `gt_global_statistic`.`table_created_history` VALUES(v_DATA_DATE_d,NULL,2,NOW(),2,CONCAT('table_imsi_umts_dy_',@DATE_DY_MRG));
			END IF;	
			
			SET @SqlCmd=CONCAT('SELECT COUNT(*) INTO @V_EXIST_H_DY FROM information_schema.`TABLES`
						WHERE TABLE_SCHEMA=''',group_db_name ,'''
						AND TABLE_NAME=''table_handset_umts_dy_',@DATE_DY_MRG,''';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			
			IF @V_EXIST_H_DY=0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE ',group_db_name,'.table_handset_umts_dy_',@DATE_DY_MRG,' 
							(
							  `MAKE_ID` int(11) DEFAULT NULL,
							  `MODEL_ID` int(11) DEFAULT NULL,
							  `DATA_DATE` DATETIME NOT NULL,
							  ',IMSI_UMTS_COLUMN_STR,'
							  `MAKE_MODEL` varchar(200) DEFAULT NULL,
							  PRIMARY KEY (`MAKE_ID`,`MODEL_ID`,`DATA_DATE`)
							) ENGINE=MyISAM DEFAULT CHARSET=latin1 DELAY_KEY_WRITE=1;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				INSERT IGNORE INTO `gt_global_statistic`.`table_created_history` VALUES(v_DATA_DATE_d,NULL,2,NOW(),2,CONCAT('table_handset_umts_dy_',@DATE_DY_MRG));
			END IF;
		
			IF @v_i=1 THEN 
				SET UNION_STR_IMSI_UMTS:=CONCAT(group_db_name,'.table_imsi_umts_dy_',@DATE_DY_MRG,',');
				SET UNION_STR_HS_UMTS:=CONCAT(group_db_name,'.table_handset_umts_dy_',@DATE_DY_MRG,',');
			ELSE 
				SET UNION_STR_IMSI_UMTS:=CONCAT(UNION_STR_IMSI_UMTS,group_db_name,'.table_imsi_umts_dy_',@DATE_DY_MRG,',');
				SET UNION_STR_HS_UMTS:=CONCAT(UNION_STR_HS_UMTS,group_db_name,'.table_handset_umts_dy_',@DATE_DY_MRG,',');
			END IF;
		END IF;	
		
		IF (TECH_MASK =4 OR TECH_MASK =0) THEN
			SET @SqlCmd=CONCAT('SELECT COUNT(*) INTO @V_EXIST_DY FROM information_schema.`TABLES`
						WHERE TABLE_SCHEMA=''',group_db_name ,'''
						AND TABLE_NAME=''table_imsi_lte_dy_',@DATE_DY_MRG,''';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			
			IF @V_EXIST_DY=0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE ',group_db_name,'.table_imsi_lte_dy_',@DATE_DY_MRG,' 
							(
								`IMSI` varchar(20) NOT NULL,
								`DATA_DATE` DATETIME NOT NULL,
								',IMSI_LTE_COLUMN_STR,'  
								`MAKE_ID` int(11) DEFAULT NULL,
								`MODEL_ID` int(11) DEFAULT NULL,
								',CASE WHEN IMSI_CELL=1 THEN IMSI_CELL_LTE_COLUMN_STR ELSE '' END,'
								PRIMARY KEY (`IMSI`,`DATA_DATE`)
							) ENGINE=MyISAM DEFAULT CHARSET=latin1 DELAY_KEY_WRITE=1;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				INSERT IGNORE INTO `gt_global_statistic`.`table_created_history` VALUES(v_DATA_DATE_d,NULL,4,NOW(),2,CONCAT('table_imsi_lte_dy_',@DATE_DY_MRG));
			END IF;	
			
			SET @SqlCmd=CONCAT('SELECT COUNT(*) INTO @V_EXIST_DY FROM information_schema.`TABLES`
						WHERE TABLE_SCHEMA=''',group_db_name ,'''
						AND TABLE_NAME=''table_handset_lte_dy_',@DATE_DY_MRG,''';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			
			IF @V_EXIST_DY=0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE ',group_db_name,'.table_handset_lte_dy_',@DATE_DY_MRG,' 
							(
								`MAKE_ID` int(11) DEFAULT NULL,
								`MODEL_ID` int(11) DEFAULT NULL,
								`DATA_DATE` DATETIME NOT NULL,
								',IMSI_LTE_COLUMN_STR,' 
								`MAKE_MODEL` varchar(200) DEFAULT NULL, 
								PRIMARY KEY (`MAKE_ID`,`MODEL_ID`,`DATA_DATE`)
							) ENGINE=MyISAM DEFAULT CHARSET=latin1 DELAY_KEY_WRITE=1;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				INSERT IGNORE INTO `gt_global_statistic`.`table_created_history` VALUES(v_DATA_DATE_d,NULL,4,NOW(),2,CONCAT('table_handset_lte_dy_',@DATE_DY_MRG));
			END IF;
		
			IF @v_i=1 THEN 
				SET UNION_STR_IMSI_LTE:=CONCAT(group_db_name,'.table_imsi_lte_dy_',@DATE_DY_MRG,',');
				SET UNION_STR_HS_LTE:=CONCAT(group_db_name,'.table_handset_lte_dy_',@DATE_DY_MRG,',');
			ELSE 
				SET UNION_STR_IMSI_LTE:=CONCAT(UNION_STR_IMSI_LTE,group_db_name,'.table_imsi_lte_dy_',@DATE_DY_MRG,',');
				SET UNION_STR_HS_LTE:=CONCAT(UNION_STR_HS_LTE,group_db_name,'.table_handset_lte_dy_',@DATE_DY_MRG,',');
			END IF;
		END IF;	
		IF (TECH_MASK=1 OR TECH_MASK =0) THEN 
			SET @SqlCmd=CONCAT('SELECT COUNT(*) INTO @V_EXIST_DY FROM information_schema.`TABLES`
						WHERE TABLE_SCHEMA=''',group_db_name ,'''
						AND TABLE_NAME=''table_imsi_gsm_dy_',@DATE_DY_MRG,''';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			
			IF @V_EXIST_DY=0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE ',group_db_name,'.table_imsi_gsm_dy_',@DATE_DY_MRG,' 
							(
							  `IMSI` varchar(20) NOT NULL,
							  `DATA_DATE` DATETIME NOT NULL,
							  ',IMSI_GSM_COLUMN_STR,'
							  `MAKE_ID` int(11) DEFAULT NULL,
							  `MODEL_ID` int(11) DEFAULT NULL,
							  ',CASE WHEN IMSI_CELL=1 THEN IMSI_CELL_GSM_COLUMN_STR ELSE '' END,'
							  PRIMARY KEY (`IMSI`,`DATA_DATE`)
							) ENGINE=MyISAM DEFAULT CHARSET=latin1 DELAY_KEY_WRITE=1;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				INSERT IGNORE INTO `gt_global_statistic`.`table_created_history` VALUES(v_DATA_DATE_d,NULL,1,NOW(),2,CONCAT('table_imsi_gsm_dy_',@DATE_DY_MRG));
			END IF;	
			
			SET @SqlCmd=CONCAT('SELECT COUNT(*) INTO @V_EXIST_H_DY FROM information_schema.`TABLES`
						WHERE TABLE_SCHEMA=''',group_db_name ,'''
						AND TABLE_NAME=''table_handset_gsm_dy_',@DATE_DY_MRG,''';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			
			IF @V_EXIST_H_DY=0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE ',group_db_name,'.table_handset_gsm_dy_',@DATE_DY_MRG,' 
							(
							  `MAKE_ID` int(11) DEFAULT NULL,
							  `MODEL_ID` int(11) DEFAULT NULL,
							  `DATA_DATE` DATETIME NOT NULL,
							  ',IMSI_GSM_COLUMN_STR,'
							  `MAKE_MODEL` varchar(200) DEFAULT NULL,
							  PRIMARY KEY (`MAKE_ID`,`MODEL_ID`,`DATA_DATE`)
							) ENGINE=MyISAM DEFAULT CHARSET=latin1 DELAY_KEY_WRITE=1;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				INSERT IGNORE INTO `gt_global_statistic`.`table_created_history` VALUES(v_DATA_DATE_d,NULL,1,NOW(),2,CONCAT('table_handset_gsm_dy_',@DATE_DY_MRG));
			END IF;
		
			IF @v_i=1 THEN 
				SET UNION_STR_IMSI_GSM:=CONCAT(group_db_name,'.table_imsi_gsm_dy_',@DATE_DY_MRG,',');
				SET UNION_STR_HS_GSM:=CONCAT(group_db_name,'.table_handset_gsm_dy_',@DATE_DY_MRG,',');
			ELSE 
				SET UNION_STR_IMSI_GSM:=CONCAT(UNION_STR_IMSI_GSM,group_db_name,'.table_imsi_gsm_dy_',@DATE_DY_MRG,',');
				SET UNION_STR_HS_GSM:=CONCAT(UNION_STR_HS_GSM,group_db_name,'.table_handset_gsm_dy_',@DATE_DY_MRG,',');
			END IF;
		END IF;			
		
		SET @v_i=@v_i+1;
		SET @DIS_DATE=DATE_ADD(@DIS_DATE,INTERVAL 1 DAY);
	END;
	END WHILE;
	SET UNION_STR_IMSI_UMTS =LEFT(UNION_STR_IMSI_UMTS,LENGTH(UNION_STR_IMSI_UMTS)-1);
	SET UNION_STR_HS_UMTS =LEFT(UNION_STR_HS_UMTS,LENGTH(UNION_STR_HS_UMTS)-1);
	SET UNION_STR_IMSI_LTE =LEFT(UNION_STR_IMSI_LTE,LENGTH(UNION_STR_IMSI_LTE)-1);
	SET UNION_STR_HS_LTE =LEFT(UNION_STR_HS_LTE,LENGTH(UNION_STR_HS_LTE)-1);
	SET UNION_STR_IMSI_GSM =LEFT(UNION_STR_IMSI_GSM,LENGTH(UNION_STR_IMSI_GSM)-1);
	SET UNION_STR_HS_GSM =LEFT(UNION_STR_HS_GSM,LENGTH(UNION_STR_HS_GSM)-1);
 	IF (TECH_MASK=2 OR TECH_MASK =0) THEN 
		IF KIND='WK' THEN 
			SET @SqlCmd=CONCAT('SELECT COUNT(*) INTO @V_EXIST_WK FROM information_schema.`TABLES`
						WHERE TABLE_SCHEMA=''',group_db_name ,'''
						AND TABLE_NAME=''table_imsi_umts_wk_',@DATE_WK,'_d'';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			
			IF @V_EXIST_WK=0 THEN 		
				SET @SqlCmd=CONCAT('CREATE TABLE ',group_db_name,'.table_imsi_umts_wk_',@DATE_WK,'_d 
							(`IMSI` varchar(20) NOT NULL,				  
							  `DATA_DATE` DATETIME NOT NULL,
							  ',IMSI_UMTS_COLUMN_STR,'
							  `MAKE_ID` int(11) DEFAULT NULL,
							  `MODEL_ID` int(11) DEFAULT NULL,
							  ',CASE WHEN IMSI_CELL=1 THEN IMSI_CELL_UMTS_COLUMN_STR ELSE '' END,'
							  PRIMARY KEY (`IMSI`,`DATA_DATE`)
							) ENGINE=MRG_MYISAM DEFAULT CHARSET=latin1 INSERT_METHOD=FIRST UNION=(',UNION_STR_IMSI_UMTS,')');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;
			
			SET @SqlCmd=CONCAT('SELECT COUNT(*) INTO @V_EXIST_H_WK FROM information_schema.`TABLES`
						WHERE TABLE_SCHEMA=''',group_db_name ,'''
						AND TABLE_NAME=''table_handset_umts_wk_',@DATE_WK,'_d'';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			
			IF @V_EXIST_H_WK=0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE ',group_db_name,'.table_handset_umts_wk_',@DATE_WK,'_d 
							( `MAKE_ID` int(11) DEFAULT NULL,
							  `MODEL_ID` int(11) DEFAULT NULL,
							  `DATA_DATE` DATETIME NOT NULL,
							   ',IMSI_UMTS_COLUMN_STR,'
							  `MAKE_MODEL` varchar(200) DEFAULT NULL,
							  PRIMARY KEY (`MAKE_ID`,`MODEL_ID`,`DATA_DATE`)
							) ENGINE=MRG_MYISAM DEFAULT CHARSET=latin1 INSERT_METHOD=FIRST UNION=(',UNION_STR_HS_UMTS,')');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;
		END IF;
		
		IF KIND='MN' THEN 
			SET @SqlCmd=CONCAT('SELECT COUNT(*) INTO @V_EXIST_MN FROM information_schema.`TABLES`
						WHERE TABLE_SCHEMA=''',group_db_name ,'''
						AND TABLE_NAME=''table_imsi_umts_mn_',@DATE_MN,'_d'';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			
			IF @V_EXIST_MN=0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE ',group_db_name,'.table_imsi_umts_mn_',@DATE_MN,'_d 
							( `IMSI` varchar(20) NOT NULL,				  
							  `DATA_DATE` DATETIME NOT NULL,
							  ',IMSI_UMTS_COLUMN_STR,'
							  `MAKE_ID` int(11) DEFAULT NULL,
							  `MODEL_ID` int(11) DEFAULT NULL,
							  ',CASE WHEN IMSI_CELL=1 THEN IMSI_CELL_UMTS_COLUMN_STR ELSE '' END,'
							  PRIMARY KEY (`IMSI`,`DATA_DATE`)
							) ENGINE=MRG_MYISAM DEFAULT CHARSET=latin1 INSERT_METHOD=FIRST UNION=(',UNION_STR_IMSI_UMTS,')');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;
			
			SET @SqlCmd=CONCAT('SELECT COUNT(*) INTO @V_EXIST_H_MN FROM information_schema.`TABLES`
						WHERE TABLE_SCHEMA=''',group_db_name ,'''
						AND TABLE_NAME=''table_handset_umts_mn_',@DATE_MN,'_d'';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			
			IF @V_EXIST_H_MN=0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE ',group_db_name,'.table_handset_umts_mn_',@DATE_MN,'_d 
							( `MAKE_ID` int(11) DEFAULT NULL,
							  `MODEL_ID` int(11) DEFAULT NULL,
							  `DATA_DATE` DATETIME NOT NULL,
							  ',IMSI_UMTS_COLUMN_STR,'
							  `MAKE_MODEL` varchar(200) DEFAULT NULL,
							  PRIMARY KEY (`MAKE_ID`,`MODEL_ID`,`DATA_DATE`)
							) ENGINE=MRG_MYISAM DEFAULT CHARSET=latin1 INSERT_METHOD=FIRST UNION=(',UNION_STR_HS_UMTS,')');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;	
		END IF;
				
	END IF;		
	IF (TECH_MASK =4 OR TECH_MASK =0) THEN
		IF KIND='WK' THEN 
			SET @SqlCmd=CONCAT('SELECT COUNT(*) INTO @V_EXIST_WK_IMSI_LTE FROM information_schema.`TABLES`
						WHERE TABLE_SCHEMA=''',group_db_name ,'''
						AND TABLE_NAME=''table_imsi_lte_wk_',@DATE_WK,'_d'';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			
			IF @V_EXIST_WK_IMSI_LTE=0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE ',group_db_name,'.table_imsi_lte_wk_',@DATE_WK,'_d 
							(	`IMSI` varchar(20) NOT NULL,
								`DATA_DATE` DATETIME NOT NULL,
								',IMSI_LTE_COLUMN_STR,'  
								`MAKE_ID` int(11) DEFAULT NULL,
								`MODEL_ID` int(11) DEFAULT NULL,
								',CASE WHEN IMSI_CELL=1 THEN IMSI_CELL_LTE_COLUMN_STR ELSE '' END,'
								PRIMARY KEY (`IMSI`,`DATA_DATE`)
							) ENGINE=MRG_MYISAM DEFAULT CHARSET=latin1 INSERT_METHOD=FIRST UNION=(',UNION_STR_IMSI_LTE,')');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;	
			
			SET @SqlCmd=CONCAT('SELECT COUNT(*) INTO @V_EXIST_WK_HANDSET_LTE FROM information_schema.`TABLES`
						WHERE TABLE_SCHEMA=''',group_db_name ,'''
						AND TABLE_NAME=''table_handset_lte_wk_',@DATE_WK,'_d'';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			
			IF @V_EXIST_WK_HANDSET_LTE=0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE ',group_db_name,'.table_handset_lte_wk_',@DATE_WK,'_d 
							( 	`MAKE_ID` int(11) DEFAULT NULL,
								`MODEL_ID` int(11) DEFAULT NULL,
								`DATA_DATE` DATETIME NOT NULL,
								',IMSI_LTE_COLUMN_STR,'  
								`MAKE_MODEL` varchar(200) DEFAULT NULL,
								PRIMARY KEY (`MAKE_ID`,`MODEL_ID`,`DATA_DATE`)
							) ENGINE=MRG_MYISAM DEFAULT CHARSET=latin1 INSERT_METHOD=FIRST UNION=(',UNION_STR_HS_LTE,')');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;	
		END IF;	
			
		IF KIND='MN' THEN 
			SET @SqlCmd=CONCAT('SELECT COUNT(*) INTO @V_EXIST_MN_IMSI_LTE FROM information_schema.`TABLES`
						WHERE TABLE_SCHEMA=''',group_db_name ,'''
						AND TABLE_NAME=''table_imsi_lte_mn_',@DATE_MN,'_d'';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			IF @V_EXIST_MN_IMSI_LTE=0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE ',group_db_name,'.table_imsi_lte_mn_',@DATE_MN,'_d 
							(	`IMSI` varchar(20) NOT NULL,
								`DATA_DATE` DATETIME NOT NULL,
								',IMSI_LTE_COLUMN_STR,'  
								`MAKE_ID` int(11) DEFAULT NULL,
								`MODEL_ID` int(11) DEFAULT NULL,
								',CASE WHEN IMSI_CELL=1 THEN IMSI_CELL_LTE_COLUMN_STR ELSE '' END,'
								PRIMARY KEY (`IMSI`,`DATA_DATE`)
							) ENGINE=MRG_MYISAM DEFAULT CHARSET=latin1 INSERT_METHOD=FIRST UNION=(',UNION_STR_IMSI_LTE,')');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;	
			
			SET @SqlCmd=CONCAT('SELECT COUNT(*) INTO @V_EXIST_MN_HANDSET_LTE FROM information_schema.`TABLES`
						WHERE TABLE_SCHEMA=''',group_db_name ,'''
						AND TABLE_NAME=''table_handset_lte_mn_',@DATE_MN,'_d'';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			
			IF @V_EXIST_MN_HANDSET_LTE=0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE ',group_db_name,'.table_handset_lte_mn_',@DATE_MN,'_d 
							(	`MAKE_ID` int(11) DEFAULT NULL,
								`MODEL_ID` int(11) DEFAULT NULL,
								`DATA_DATE` DATETIME NOT NULL,
								',IMSI_LTE_COLUMN_STR,'  
								`MAKE_MODEL` varchar(200) DEFAULT NULL,
								PRIMARY KEY (`MAKE_ID`,`MODEL_ID`,`DATA_DATE`)
							) ENGINE=MRG_MYISAM DEFAULT CHARSET=latin1 INSERT_METHOD=FIRST UNION=(',UNION_STR_HS_LTE,')');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;	
		END IF;	
	END IF;
 	IF (TECH_MASK=1 OR TECH_MASK =0) THEN 
		IF KIND='WK' THEN 
			SET @SqlCmd=CONCAT('SELECT COUNT(*) INTO @V_EXIST_WK FROM information_schema.`TABLES`
						WHERE TABLE_SCHEMA=''',group_db_name ,'''
						AND TABLE_NAME=''table_imsi_gsm_wk_',@DATE_WK,'_d'';');
			
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			
			IF @V_EXIST_WK=0 THEN 		
				SET @SqlCmd=CONCAT('CREATE TABLE ',group_db_name,'.table_imsi_gsm_wk_',@DATE_WK,'_d 
							(`IMSI` varchar(20) NOT NULL,				  
							  `DATA_DATE` DATETIME NOT NULL,
							  ',IMSI_GSM_COLUMN_STR,'
							  `MAKE_ID` int(11) DEFAULT NULL,
							  `MODEL_ID` int(11) DEFAULT NULL,
							  ',CASE WHEN IMSI_CELL=1 THEN IMSI_CELL_GSM_COLUMN_STR ELSE '' END,'
							  PRIMARY KEY (`IMSI`,`DATA_DATE`)
							) ENGINE=MRG_MYISAM DEFAULT CHARSET=latin1 INSERT_METHOD=FIRST UNION=(',UNION_STR_IMSI_GSM,')');
 				
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;
			
			SET @SqlCmd=CONCAT('SELECT COUNT(*) INTO @V_EXIST_H_WK FROM information_schema.`TABLES`
						WHERE TABLE_SCHEMA=''',group_db_name ,'''
						AND TABLE_NAME=''table_handset_gsm_wk_',@DATE_WK,'_d'';');
			
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			
			IF @V_EXIST_H_WK=0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE ',group_db_name,'.table_handset_gsm_wk_',@DATE_WK,'_d 
							( `MAKE_ID` int(11) DEFAULT NULL,
							  `MODEL_ID` int(11) DEFAULT NULL,
							  `DATA_DATE` DATETIME NOT NULL,
							   ',IMSI_GSM_COLUMN_STR,'
							  `MAKE_MODEL` varchar(200) DEFAULT NULL,
							  PRIMARY KEY (`MAKE_ID`,`MODEL_ID`,`DATA_DATE`)
							) ENGINE=MRG_MYISAM DEFAULT CHARSET=latin1 INSERT_METHOD=FIRST UNION=(',UNION_STR_HS_GSM,')');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;
		END IF;
		
		IF KIND='MN' THEN 
			SET @SqlCmd=CONCAT('SELECT COUNT(*) INTO @V_EXIST_MN FROM information_schema.`TABLES`
						WHERE TABLE_SCHEMA=''',group_db_name ,'''
						AND TABLE_NAME=''table_imsi_gsm_mn_',@DATE_MN,'_d'';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			
			IF @V_EXIST_MN=0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE ',group_db_name,'.table_imsi_gsm_mn_',@DATE_MN,'_d 
							( `IMSI` varchar(20) NOT NULL,				  
							  `DATA_DATE` DATETIME NOT NULL,
							  ',IMSI_GSM_COLUMN_STR,'
							  `MAKE_ID` int(11) DEFAULT NULL,
							  `MODEL_ID` int(11) DEFAULT NULL,
							  ',CASE WHEN IMSI_CELL=1 THEN IMSI_CELL_GSM_COLUMN_STR ELSE '' END,'
							  PRIMARY KEY (`IMSI`,`DATA_DATE`)
							) ENGINE=MRG_MYISAM DEFAULT CHARSET=latin1 INSERT_METHOD=FIRST UNION=(',UNION_STR_IMSI_GSM,')');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;
			
			SET @SqlCmd=CONCAT('SELECT COUNT(*) INTO @V_EXIST_H_MN FROM information_schema.`TABLES`
						WHERE TABLE_SCHEMA=''',group_db_name ,'''
						AND TABLE_NAME=''table_handset_gsm_mn_',@DATE_MN,'_d'';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			
			IF @V_EXIST_H_MN=0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE ',group_db_name,'.table_handset_gsm_mn_',@DATE_MN,'_d 
							( `MAKE_ID` int(11) DEFAULT NULL,
							  `MODEL_ID` int(11) DEFAULT NULL,
							  `DATA_DATE` DATETIME NOT NULL,
							  ',IMSI_GSM_COLUMN_STR,'
							  `MAKE_MODEL` varchar(200) DEFAULT NULL,
							  PRIMARY KEY (`MAKE_ID`,`MODEL_ID`,`DATA_DATE`)
							) ENGINE=MRG_MYISAM DEFAULT CHARSET=latin1 INSERT_METHOD=FIRST UNION=(',UNION_STR_HS_GSM,')');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;	
		END IF;
	END IF;		
	
END
utf8
utf8_general_ci
latin1_swedish_ci

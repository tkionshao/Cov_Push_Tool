CREATE DEFINER=`covmo`@`%` PROCEDURE `SP_Delete_GtCovmo_NT`(IN NT_DATE VARCHAR(100),IN GT_COVMO VARCHAR(100))
BEGIN
	DECLARE START_TIME DATETIME DEFAULT SYSDATE();
	
	
	INSERT INTO gt_gw_main.sp_log VALUES('GT_COVMO','SP_Delete_GtCovmo_NT','DELETE NT START', NOW());
	SET @SqlCmd=CONCAT('DELETE FROM ',GT_COVMO,'.nt_antenna_all WHERE NT_DATE = ''',NT_DATE,''';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DELETE FROM ',GT_COVMO,'.nt_all WHERE NT_DATE = ''',NT_DATE,''';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DELETE FROM ',GT_COVMO,'.nt_cell_all_gsm WHERE NT_DATE = ''',NT_DATE,''';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DELETE FROM ',GT_COVMO,'.nt_neighbor_all WHERE NT_DATE = ''',NT_DATE,''';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DELETE FROM ',GT_COVMO,'.nt_rnc_all WHERE NT_DATE = ''',NT_DATE,''';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	INSERT INTO gt_gw_main.SP_LOG VALUES('GT_COVMO','SP_Delete_GtCovmo_NT',CONCAT('Done: ',TIMESTAMPDIFF(SECOND,START_TIME,SYSDATE()),' seconds.'), NOW());
	
END
utf8
utf8_general_ci
latin1_swedish_ci

CREATE DEFINER=`covmo`@`%` PROCEDURE `SP_Generate_Global_Statistic_Sub_TmpTbl_Crt`(IN WORKER_ID VARCHAR(10),IN RPT_TYPE TINYINT(2),IN IMSI_CELL TINYINT(2),IN TileResolution VARCHAR(10))
BEGIN
	DECLARE START_TIME DATETIME DEFAULT SYSDATE();
	DECLARE STEP_START_TIME DATETIME DEFAULT SYSDATE();
	DECLARE SP_Process VARCHAR(100) DEFAULT NULL;
	DECLARE KPI_ERROR CONDITION FOR SQLSTATE '99999' ;
	DECLARE FIRSTDAY_OF_WEEK TINYINT(4) DEFAULT 6;
	DECLARE v_DATA_DATE VARCHAR(10) DEFAULT NULL;
	DECLARE v_DATA_HOUR TINYINT(2) DEFAULT NULL;
	DECLARE v_PU_ID MEDIUMINT(9) DEFAULT NULL;
	DECLARE v_TECH_MASK TINYINT(2) DEFAULT NULL;
	DECLARE EX_DATE VARCHAR(100) DEFAULT NULL;
	
	SET @global_db='gt_global_statistic';	
	SET @TILE_ID_LVL1 = CONCAT('TILE_ID_',gt_covmo_csv_get(TileResolution,1));
	SET @TILE_ID_LVL2 = CONCAT('TILE_ID_',gt_covmo_csv_get(TileResolution,2));
	
	SET @SqlCmd=CONCAT('SELECT GROUP_CONCAT(DISTINCT CONCAT(`DATA_DATE`,'','',`DATA_HOUR`,'','',`TECH_MASK`) SEPARATOR ''|'' ) INTO @DIS_DATE
				FROM gt_global_statistic.tmp_table_call_cnt_',WORKER_ID,' a;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
        	
	SET @v_i=1;
	SET @v_R_Max=gt_covmo_csv_count(@DIS_DATE,'|');
	
	WHILE @v_i <= @v_R_Max DO
	BEGIN	  			
		SET SESSION group_concat_max_len=102400; 
		
		SET v_DATA_DATE:=gt_covmo_csv_get(gt_strtok(@DIS_DATE, @v_i, '|'),1);		
		SET v_DATA_HOUR:=gt_covmo_csv_get(gt_strtok(@DIS_DATE, @v_i, '|'),2);
		SET v_TECH_MASK:=gt_covmo_csv_get(gt_strtok(@DIS_DATE, @v_i, '|'),3);
		SET EX_DATE=CONCAT(DATE_FORMAT(v_DATA_DATE,'%Y%m%d_'),v_DATA_HOUR,'_',WORKER_ID);
		
		IF v_TECH_MASK=2 THEN
			IF (RPT_TYPE & 4)>0 THEN  
				SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',@global_db,'.tmp_cell_agg_umts_',EX_DATE,' 
							(
							`DATA_DATE` datetime NOT NULL,
							`DATA_HOUR` tinyint(4) NOT NULL,
							`CELL_ID` mediumint(9) NOT NULL,
							`SITE_ID` varchar(20) DEFAULT NULL,
							`CLUSTER_ID` mediumint(9) DEFAULT NULL,
							`RNC_ID` mediumint(9) NOT NULL,
							`FREQUENCY` smallint(6) DEFAULT NULL,
							`UARFCN` smallint(6) DEFAULT NULL,
							`INIT_CALL_CNT` INT(11) DEFAULT NULL,
							`END_CALL_CNT` INT(11) DEFAULT NULL,
							`VOICE_CNT` INT(11) DEFAULT NULL,
							`VIDEO_CNT` INT(11) DEFAULT NULL,
							`PS_R99_CNT` INT(11) DEFAULT NULL,
							`PS_HSPA_CNT` INT(11) DEFAULT NULL,
							`M_RAB_CNT` INT(11) DEFAULT NULL,
							`SIGNAL_CNT` INT(11) DEFAULT NULL,
							`SMS_CNT` INT(11) DEFAULT NULL,
							`PS_OTHER_CNT` INT(11) DEFAULT NULL,
							`END_VOICE_CNT` INT(11) DEFAULT NULL,
							`END_VIDEO_CNT` INT(11) DEFAULT NULL,
							`END_PS_R99_CNT` INT(11) DEFAULT NULL,
							`END_PS_HSPA_CNT` INT(11) DEFAULT NULL,
							`END_M_RAB_CNT` INT(11) DEFAULT NULL,
							`END_SIGNAL_CNT` INT(11) DEFAULT NULL,
							`END_SMS_CNT` INT(11) DEFAULT NULL,
							`END_PS_OTHER_CNT` INT(11) DEFAULT NULL,
							`DROP_VOICE_CNT` INT(11) DEFAULT NULL,
							`DROP_VIDEO_CNT` INT(11) DEFAULT NULL,
							`DROP_PS_R99_CNT` INT(11) DEFAULT NULL,
							`DROP_PS_HSPA_CNT` INT(11) DEFAULT NULL,
							`DROP_M_RAB_CNT` INT(11) DEFAULT NULL,
							`DROP_SIGNAL_CNT` INT(11) DEFAULT NULL,
							`DROP_SMS_CNT` INT(11) DEFAULT NULL,
							`DROP_PS_OTHER_CNT` INT(11) DEFAULT NULL,
							`NON_BLOCK_VOICE_CNT` INT(11) DEFAULT NULL,
							`NON_BLOCK_VIDEO_CNT` INT(11) DEFAULT NULL,
							`NON_BLOCK_PS_R99_CNT` INT(11) DEFAULT NULL,
							`NON_BLOCK_PS_HSPA_CNT` INT(11) DEFAULT NULL,
							`NON_BLOCK_M_RAB_CNT` INT(11) DEFAULT NULL,
							`NON_BLOCK_SIGNAL_CNT` INT(11) DEFAULT NULL,
							`NON_BLOCK_SMS_CNT` INT(11) DEFAULT NULL,
							`NON_BLOCK_PS_OTHER_CNT` INT(11) DEFAULT NULL,
							`BLOCK_VOICE_CNT` INT(11) DEFAULT NULL,
							`BLOCK_VEDIO_CNT` INT(11) DEFAULT NULL,
							`BLOCK_R99_CNT` INT(11) DEFAULT NULL,
							`BLOCK_HSPA_CNT` INT(11) DEFAULT NULL,
							`BLOCK_MRAB_CNT` INT(11) DEFAULT NULL,
							`BLOCK_SIGNAL_CNT` INT(11) DEFAULT NULL,
							`BLOCK_SMS_CNT` INT(11) DEFAULT NULL,
							`BLOCK_PS_OTHER_CNT` INT(11) DEFAULT NULL,
							`RSCP_SUM` DOUBLE DEFAULT NULL,
							`RSCP_CNT` INT(11) DEFAULT NULL,
							`ECN0_SUM` DOUBLE DEFAULT NULL,
							`ECN0_CNT` INT(11) DEFAULT NULL,
							`UL_VOLUME_SUM` DOUBLE DEFAULT NULL,
							`DL_VOLUME_SUM` DOUBLE DEFAULT NULL,
							`UL_THROUPUT_MAX` DOUBLE DEFAULT NULL,
							`DL_THROUPUT_MAX` DOUBLE DEFAULT NULL,
							`UL_THROUPUT_SUM` DOUBLE DEFAULT NULL,
							`UL_THROUPUT_CNT` INT(11) DEFAULT NULL,
							`DL_THROUPUT_SUM` DOUBLE DEFAULT NULL,
							`DL_THROUPUT_CNT` INT(11) DEFAULT NULL,
							`FP_RSCP_1` double DEFAULT NULL,
							`FP_ECN0_1` double DEFAULT NULL,
							`BEST_CNT` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_VOICE_SUM` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_VOICE_CNT` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_VEDIO_SUM` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_VEDIO_CNT` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_R99_SUM` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_R99_CNT` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_HSPA_SUM` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_HSPA_CNT` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_MRAB_SUM` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_MRAB_CNT` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_SIG_SUM` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_SIG_CNT` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_OTH_SUM` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_OTH_CNT` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_SMS_SUM` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_SMS_CNT` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_SUM` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_CNT` int(11) DEFAULT NULL,
							`SF_VOICE_CNT` int(11) DEFAULT NULL,
							`SF_VEDIO_CNT` int(11) DEFAULT NULL,
							`SF_R99_CNT` int(11) DEFAULT NULL,
							`SF_HSPA_CNT` int(11) DEFAULT NULL,
							`SF_MRAB_CNT` int(11) DEFAULT NULL,
							`SF_OTHER_CNT` int(11) DEFAULT NULL,
							`SF_SMS_CNT` int(11) DEFAULT NULL,
							`SF_SIGNAL_CNT` int(11) DEFAULT NULL,
							`CALL_DUR_SUM` DOUBLE DEFAULT NULL,
							`VOICE_DUR_SUM` DOUBLE DEFAULT NULL,
							`VIDEO_DUR_SUM` DOUBLE DEFAULT NULL,
							`R99_DUR_SUM` DOUBLE DEFAULT NULL,
							`HSPA_DUR_SUM` DOUBLE DEFAULT NULL,
							`MRAB_DUR_SUM` DOUBLE DEFAULT NULL
							) ENGINE=MYISAM DEFAULT CHARSET=latin1;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;			
			END IF;
			IF (RPT_TYPE & 2)>0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',@global_db,'.tmp_imsi_umts_',EX_DATE,' (
							`IMSI` VARCHAR(20) NOT NULL,
							`DATA_DATE` DATETIME NOT NULL,
							`DATA_HOUR` TINYINT(2) NOT NULL,
							`CALL_CNT` int(11) DEFAULT NULL,
							`VOICE_MO_CNT` int(11) DEFAULT NULL,
							`VOICE_MT_CNT` int(11) DEFAULT NULL,
							`VIDEO_MO_CNT` int(11) DEFAULT NULL,
							`VIDEO_MT_CNT` int(11) DEFAULT NULL,
							`R99_MO_CNT` int(11) DEFAULT NULL,
							`R99_MT_CNT` int(11) DEFAULT NULL,
							`HSPA_MO_CNT` int(11) DEFAULT NULL,
							`HSPA_MT_CNT` int(11) DEFAULT NULL,
							`MRAB_MO_CNT` int(11) DEFAULT NULL,
							`MRAB_MT_CNT` int(11) DEFAULT NULL,
							`SIGNAL_MO_CNT` int(11) DEFAULT NULL,
							`SIGNAL_MT_CNT` int(11) DEFAULT NULL,
							`SMS_MO_CNT` int(11) DEFAULT NULL,
							`SMS_MT_CNT` int(11) DEFAULT NULL,
							`PS_OTHER_CNT` int(11) DEFAULT NULL,
							`CALL_DUR_SUM` double DEFAULT NULL,
							`VOICE_DUR_SUM` double DEFAULT NULL,
							`VIDEO_DUR_SUM` double DEFAULT NULL,
							`R99_DUR_SUM` double DEFAULT NULL,
							`HSPA_DUR_SUM` double DEFAULT NULL,
							`MRAB_DUR_SUM` double DEFAULT NULL,
							`DROP_CNT` int(11) DEFAULT NULL,
							`DROP_VOICE_CNT` int(11) DEFAULT NULL,
							`DROP_VEDIO_CNT` int(11) DEFAULT NULL,
							`DROP_R99_CNT` int(11) DEFAULT NULL,
							`DROP_HSPA_CNT` int(11) DEFAULT NULL,
							`DROP_MRAB_CNT` int(11) DEFAULT NULL,
							`DROP_SMS_CNT` int(11) DEFAULT NULL,
							`DROP_SIGNAL_CNT` int(11) DEFAULT NULL,
							`DROP_PS_OTHER_CNT` int(11) DEFAULT NULL,
							`DROP_RF_CNT` int(11) DEFAULT NULL,
							`DROP_CONG_CNT` int(11) DEFAULT NULL,
							`DROP_TRANS_CNT` int(11) DEFAULT NULL,
							`DROP_SHO_CNT` int(11) DEFAULT NULL,
							`DROP_HHO_CNT` int(11) DEFAULT NULL,
							`DROP_IRAT_CNT` int(11) DEFAULT NULL,
							`BLOCK_CNT` int(11) DEFAULT NULL,
							`BLOCK_VOICE_CNT` int(11) DEFAULT NULL,
							`BLOCK_VEDIO_CNT` int(11) DEFAULT NULL,
							`BLOCK_R99_CNT` int(11) DEFAULT NULL,
							`BLOCK_HSPA_CNT` int(11) DEFAULT NULL,
							`BLOCK_MRAB_CNT` int(11) DEFAULT NULL,
							`BLOCK_SMS_CNT` int(11) DEFAULT NULL,
							`BLOCK_SMS_MT_CNT` int(11) DEFAULT NULL,
							`BLOCK_SMS_MO_CNT` int(11) DEFAULT NULL,
							`BLOCK_SIGNAL_CNT` int(11) DEFAULT NULL,
							`BLOCK_PS_OTHER_CNT` int(11) DEFAULT NULL,
							`SHO_ATTEMPT_CNT` int(11) DEFAULT NULL,
							`SHO_FAILURE_CNT` int(11) DEFAULT NULL,
							`HHO_ATTEMPT_CNT` int(11) DEFAULT NULL,
							`HHO_FAILURE_CNT` int(11) DEFAULT NULL,
							`IRAT_ATTEMPT_CNT` int(11) DEFAULT NULL,
							`IRAT_FAILURE_CNT` int(11) DEFAULT NULL,
							`MOVING_CALL_CNT` int(11) DEFAULT NULL,
							`INDOOR_CALL_CNT` int(11) DEFAULT NULL,
							`PS_UL_VOLUME_SUM` double DEFAULT NULL,
							`PS_DL_VOLUME_SUM` double DEFAULT NULL,
							`PS_UL_SPEED_MAX` double DEFAULT NULL,
							`PS_DL_SPEED_MAX` double DEFAULT NULL,
							`FIRST_RSCP_SUM` double DEFAULT NULL,
							`FIRST_RSCP_CNT` int(11) DEFAULT NULL,
							`FIRST_ECNO_SUM` double DEFAULT NULL,
							`FIRST_ECNO_CNT` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_SUM` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_CNT` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_VOICE_SUM` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_VOICE_CNT` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_VEDIO_SUM` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_VEDIO_CNT` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_R99_SUM` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_R99_CNT` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_HSPA_SUM` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_HSPA_CNT` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_MRAB_SUM` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_MRAB_CNT` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_SIG_SUM` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_SIG_CNT` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_OTH_SUM` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_OTH_CNT` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_SMS_SUM` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_SMS_CNT` int(11) DEFAULT NULL,
							`SF_CNT` int(11) DEFAULT NULL,
							`SF_VOICE_CNT` int(11) DEFAULT NULL,
							`SF_VEDIO_CNT` int(11) DEFAULT NULL,
							`SF_R99_CNT` int(11) DEFAULT NULL,
							`SF_HSPA_CNT` int(11) DEFAULT NULL,
							`SF_MRAB_CNT` int(11) DEFAULT NULL,
							`SF_SMS_CNT` int(11) DEFAULT NULL,
							`SF_SMS_MT_CNT` int(11) DEFAULT NULL,
							`SF_SMS_MO_CNT` int(11) DEFAULT NULL,
							`SF_SIGNAL_CNT` int(11) DEFAULT NULL,
							`SF_PS_OTHER_CNT` int(11) DEFAULT NULL,
							`PDP_ACTIVATION_REQUEST` int(11) DEFAULT NULL,
							`PDP_ACTIVATION_ACCEPT` int(11) DEFAULT NULL,
							`PDP_DEACTIVATION_REQUEST` int(11) DEFAULT NULL,
							`PDP_DEACTIVATION_ACCEPT` int(11) DEFAULT NULL,
							`AUTH_REQUEST` int(11) DEFAULT NULL,
							`AUTH_RESPONSE` int(11) DEFAULT NULL,
							`AUTH_CIPH_REQUEST` int(11) DEFAULT NULL,
							`AUTH_CIPH_RESPONSE` int(11) DEFAULT NULL,
							`SECURITY_MODE_ATT` int(11) DEFAULT NULL,
							`SECURITY_MODE_SUCCESS` int(11) DEFAULT NULL,
							`LU_REQUEST` int(11) DEFAULT NULL,
							`LU_ACCEPT` int(11) DEFAULT NULL,
							`RAU_REQUEST` int(11) DEFAULT NULL,
							`RAU_ACCEPT` int(11) DEFAULT NULL,
							`MAKE_ID` INT(11) DEFAULT NULL,
							`MODEL_ID` INT(11) DEFAULT NULL,
							',CASE WHEN IMSI_CELL=1 THEN 
							'`START_TILE_ID` BIGINT(20) DEFAULT NULL,
							`END_TILE_ID` BIGINT(20) DEFAULT NULL,
							`START_CELL_ID` MEDIUMINT(9) DEFAULT NULL,
							`START_SITE_ID` VARCHAR(20) DEFAULT NULL,
							`START_REG_1_ID` BIGINT(20) DEFAULT NULL,
							`START_REG_2_ID` BIGINT(20) DEFAULT NULL,
							`START_REG_3_ID` BIGINT(20) DEFAULT NULL,
							`END_CELL_ID` MEDIUMINT(9) DEFAULT NULL,
							`END_SITE_ID` VARCHAR(20) DEFAULT NULL,
							`END_REG_1_ID` BIGINT(20) DEFAULT NULL,
							`END_REG_2_ID` BIGINT(20) DEFAULT NULL,
							`END_REG_3_ID` BIGINT(20) DEFAULT NULL,' ELSE '' END,'
							`MAKE_MODEL` varchar(200) DEFAULT NULL
							) ENGINE=MYISAM DEFAULT CHARSET=latin1;');
			
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;
			IF (RPT_TYPE & 1)>0 THEN 				
				SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',@global_db,'.tmp_tile_umts_',EX_DATE,' (
							  `TILE_ID` BIGINT(20) NOT NULL,
							  `FREQUENCY` SMALLINT(6) NOT NULL,
							  `UARFCN` SMALLINT(6) DEFAULT NULL,
							  `DATA_DATE` DATETIME NOT NULL,
							  `DATA_HOUR` TINYINT(2) NOT NULL,
							  `',@TILE_ID_LVL2,'` BIGINT(20) DEFAULT NULL,
							  `',@TILE_ID_LVL1,'` BIGINT(20) DEFAULT NULL,
							  `INIT_CALL_CNT` INT(11) DEFAULT NULL,
							  `END_CALL_CNT` INT(11) DEFAULT NULL,
							  `VOICE_CNT` INT(11) DEFAULT NULL,
							  `VIDEO_CNT` INT(11) DEFAULT NULL,
							  `PS_R99_CNT` INT(11) DEFAULT NULL,
							  `PS_HSPA_CNT` INT(11) DEFAULT NULL,
							  `M_RAB_CNT` INT(11) DEFAULT NULL, 
							  `SIGNAL_CNT` INT(11) DEFAULT NULL,
							  `SMS_CNT` INT(11) DEFAULT NULL,
							  `PS_OTHER_CNT` INT(11) DEFAULT NULL,
							  `CALL_DUR_SUM` DOUBLE DEFAULT NULL,
							  `CS_DUR_SUM` DOUBLE DEFAULT NULL,
							  `DROP_CNT` INT(11) DEFAULT NULL,
							  `BLOCK_CNT` INT(11) DEFAULT NULL,
							  `DROP_VOICE_CNT` INT(11) DEFAULT NULL,
							  `DROP_VIDEO_CNT` INT(11) DEFAULT NULL,
							  `DROP_PS_R99_CNT` INT(11) DEFAULT NULL,
							  `DROP_PS_HSPA_CNT` INT(11) DEFAULT NULL,
							  `DROP_M_RAB_CNT` INT(11) DEFAULT NULL,
							  `DROP_SIGNAL_CNT` INT(11) DEFAULT NULL,
							  `DROP_SMS_CNT` INT(11) DEFAULT NULL,
							  `DROP_PS_OTHER_CNT` INT(11) DEFAULT NULL,
							  `SHO_ATTEMPT_CNT` INT(11) DEFAULT NULL,
							  `SHO_FAILURE_CNT` INT(11) DEFAULT NULL,
							  `IFHO_ATTEMPT_CNT` INT(11) DEFAULT NULL,
							  `IFHO_FAILURE_CNT` INT(11) DEFAULT NULL,
							  `IRAT_ATTEMPT_CNT` INT(11) DEFAULT NULL,
							  `IRAT_FAILURE_CNT` INT(11) DEFAULT NULL,
							  `PS_UL_VOLUME_SUM` DOUBLE DEFAULT NULL,
							  `PS_DL_VOLUME_SUM` DOUBLE DEFAULT NULL,
							  `PS_UL_SPEED_MAX` DOUBLE DEFAULT NULL,
							  `PS_DL_SPEED_MAX` DOUBLE DEFAULT NULL,
							  `RSCP_SUM` DOUBLE DEFAULT NULL,
							  `RSCP_CNT` INT(11) DEFAULT NULL,
							  `ECNO_SUM` DOUBLE DEFAULT NULL,
							  `ECNO_CNT` INT(11) DEFAULT NULL,
							  `ACTIVE_SET_SUM` DOUBLE DEFAULT NULL,
							  `ACTIVE_SET_CNT` INT(11) DEFAULT NULL,
							  `POLLUTED_PILOT_CNT` INT(11) DEFAULT NULL,
							  `PILOT_DOM_SUM` DOUBLE DEFAULT NULL,
							  `PILOT_CNT` INT(11) DEFAULT NULL,
							  `T19_CNT` INT(11) DEFAULT NULL,
							  `UL_THROUPUT_SUM` DOUBLE DEFAULT NULL,
							  `UL_THROUPUT_CNT` INT(11) DEFAULT NULL,
							  `DL_THROUPUT_SUM` DOUBLE DEFAULT NULL,
							  `DL_THROUPUT_CNT` INT(11) DEFAULT NULL,
							  `NON_BLOCK_VOICE_CNT` INT(11) DEFAULT NULL,
							  `NON_BLOCK_VIDEO_CNT` INT(11) DEFAULT NULL,
							  `NON_BLOCK_PS_R99_CNT` INT(11) DEFAULT NULL,
							  `NON_BLOCK_PS_HSPA_CNT` INT(11) DEFAULT NULL,
							  `NON_BLOCK_M_RAB_CNT` INT(11) DEFAULT NULL,
							  `NON_BLOCK_SIGNAL_CNT` INT(11) DEFAULT NULL,
							  `NON_BLOCK_SMS_CNT` INT(11) DEFAULT NULL,
							  `NON_BLOCK_PS_OTHER_CNT` INT(11) DEFAULT NULL,
							  `PS_CNT` INT(11) DEFAULT NULL,
							  `DROP_PS_CNT` INT(11) DEFAULT NULL,
							  `FP_RSCP_1` double DEFAULT NULL,
							  `FP_ECN0_1` double DEFAULT NULL,
							  `BEST_CNT` INT(11) DEFAULT NULL,
							  `UL_THROUPUT_MAX` DOUBLE DEFAULT NULL,
							  `DL_THROUPUT_MAX` DOUBLE DEFAULT NULL,					  
							  `REG_1_ID` BIGINT(20) DEFAULT NULL,
							  `REG_2_ID` BIGINT(20) DEFAULT NULL,
							  `REG_3_ID` BIGINT(20) DEFAULT NULL
							) ENGINE=MYISAM DEFAULT CHARSET=latin1;');
		
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
								
				SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',@global_db,'.tmp_tile_pu_umts_',EX_DATE,' (
							  `TILE_ID` BIGINT(20) NOT NULL,
							  `PU_ID` MEDIUMINT(6) NOT NULL,
							  `DATA_DATE` DATETIME NOT NULL
							) ENGINE=MYISAM DEFAULT CHARSET=latin1;');
		
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;
			IF (RPT_TYPE & 8)>0 THEN 				
				SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',@global_db,'.tmp_romer_tile_umts_',EX_DATE,' (
							  `TILE_ID` BIGINT(20) NOT NULL,
							  `MCC` char(3) DEFAULT NULL,
							  `MNC` varchar(3) DEFAULT NULL,
							  `FREQUENCY` SMALLINT(6) NOT NULL,
							  `UARFCN` SMALLINT(6) DEFAULT NULL,
							  `DATA_DATE` DATETIME NOT NULL,
							  `DATA_HOUR` TINYINT(2) NOT NULL,
							  `',@TILE_ID_LVL2,'` BIGINT(20) DEFAULT NULL,
							  `',@TILE_ID_LVL1,'` BIGINT(20) DEFAULT NULL,
							  `INIT_CALL_CNT` INT(11) DEFAULT NULL,
							  `END_CALL_CNT` INT(11) DEFAULT NULL,
							  `VOICE_CNT` INT(11) DEFAULT NULL,
							  `VIDEO_CNT` INT(11) DEFAULT NULL,
							  `PS_R99_CNT` INT(11) DEFAULT NULL,
							  `PS_HSPA_CNT` INT(11) DEFAULT NULL,
							  `M_RAB_CNT` INT(11) DEFAULT NULL, 
							  `SIGNAL_CNT` INT(11) DEFAULT NULL,
							  `SMS_CNT` INT(11) DEFAULT NULL,
							  `PS_OTHER_CNT` INT(11) DEFAULT NULL,
							  `CALL_DUR_SUM` DOUBLE DEFAULT NULL,
							  `CS_DUR_SUM` DOUBLE DEFAULT NULL,
							  `DROP_CNT` INT(11) DEFAULT NULL,
							  `BLOCK_CNT` INT(11) DEFAULT NULL,
							  `DROP_VOICE_CNT` INT(11) DEFAULT NULL,
							  `DROP_VIDEO_CNT` INT(11) DEFAULT NULL,
							  `DROP_PS_R99_CNT` INT(11) DEFAULT NULL,
							  `DROP_PS_HSPA_CNT` INT(11) DEFAULT NULL,
							  `DROP_M_RAB_CNT` INT(11) DEFAULT NULL,
							  `DROP_SIGNAL_CNT` INT(11) DEFAULT NULL,
							  `DROP_SMS_CNT` INT(11) DEFAULT NULL,
							  `DROP_PS_OTHER_CNT` INT(11) DEFAULT NULL,
							  `PS_UL_VOLUME_SUM` DOUBLE DEFAULT NULL,
							  `PS_DL_VOLUME_SUM` DOUBLE DEFAULT NULL,
							  `PS_UL_SPEED_MAX` DOUBLE DEFAULT NULL,
							  `PS_DL_SPEED_MAX` DOUBLE DEFAULT NULL,
							  `UL_THROUPUT_SUM` DOUBLE DEFAULT NULL,
							  `UL_THROUPUT_CNT` INT(11) DEFAULT NULL,
							  `DL_THROUPUT_SUM` DOUBLE DEFAULT NULL,
							  `DL_THROUPUT_CNT` INT(11) DEFAULT NULL,
							  `NON_BLOCK_VOICE_CNT` INT(11) DEFAULT NULL,
							  `NON_BLOCK_VIDEO_CNT` INT(11) DEFAULT NULL,
							  `NON_BLOCK_PS_R99_CNT` INT(11) DEFAULT NULL,
							  `NON_BLOCK_PS_HSPA_CNT` INT(11) DEFAULT NULL,
							  `NON_BLOCK_M_RAB_CNT` INT(11) DEFAULT NULL,
							  `NON_BLOCK_SIGNAL_CNT` INT(11) DEFAULT NULL,
							  `NON_BLOCK_SMS_CNT` INT(11) DEFAULT NULL,
							  `NON_BLOCK_PS_OTHER_CNT` INT(11) DEFAULT NULL,
							  `PS_CNT` INT(11) DEFAULT NULL,
							  `DROP_PS_CNT` INT(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_SUM` int(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_CNT` int(11) DEFAULT NULL,
	
							  `CALL_SETUP_TIME_VOICE_SUM` int(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_VOICE_CNT` int(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_VEDIO_SUM` int(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_VEDIO_CNT` int(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_R99_SUM` int(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_R99_CNT` int(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_HSPA_SUM` int(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_HSPA_CNT` int(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_MRAB_SUM` int(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_MRAB_CNT` int(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_SIG_SUM` int(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_SIG_CNT` int(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_OTH_SUM` int(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_OTH_CNT` int(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_SMS_SUM` int(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_SMS_CNT` int(11) DEFAULT NULL,
							  `REG_1_ID` BIGINT(20) DEFAULT NULL,
							  `REG_2_ID` BIGINT(20) DEFAULT NULL,
							  `REG_3_ID` BIGINT(20) DEFAULT NULL
							) ENGINE=MYISAM DEFAULT CHARSET=latin1;');
		
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;			
			
			IF (RPT_TYPE & 16)>0 THEN  
				SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',@global_db,'.tmp_failcause_umts_',EX_DATE,' (
							  `DATA_DATE` date NOT NULL,
							  `TILE_ID` bigint(20) NOT NULL,
							  `RNC_ID` mediumint(9) NOT NULL,
							  `SITE_ID` varchar(20) NOT NULL,
							  `CELL_ID` mediumint(9) NOT NULL,
							  `IMSI` varchar(20) NOT NULL,
							  `IMEI` varchar(20) NOT NULL,
							  `EVENT_ID` smallint(6) NOT NULL,
							  `FAILURE_EVENT_ID` mediumint(9) NOT NULL,
							  `FAILURE_EVENT_CAUSE` mediumint(9) NOT NULL,
							  `FAILURE_CNT` mediumint(9) DEFAULT ''0''
							) ENGINE=MYISAM DEFAULT CHARSET=latin1;');		  
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;		
	
			IF (RPT_TYPE & 32)>0 THEN  
				SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',@global_db,'.tmp_subscriber_umts_',EX_DATE,' (
							 `DATA_DATE` date DEFAULT NULL,
							 `END_TIME` DATETIME DEFAULT NULL,							
							 `DURATION` MEDIUMINT(9) DEFAULT NULL,
							 `IMSI` varchar(20) DEFAULT NULL,							 
							 `CELL_ID` VARCHAR(50) DEFAULT NULL,
							 `DROP_REASON` MEDIUMINT(9) DEFAULT NULL,
							 `LAST_RSCP` DOUBLE DEFAULT NULL,
							 `LAST_ECN0` DOUBLE DEFAULT NULL,
							 `FREQ_BAND` SMALLINT(6) DEFAULT NULL,
							 `TILE_ID` BIGINT(20) DEFAULT NULL							
							) ENGINE=MYISAM DEFAULT CHARSET=latin1;');		  
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;	
			INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_TmpTbl_Crt',CONCAT('tmp_lte_',EX_DATE,' CREATE tmp_umts_tables cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());		
		ELSEIF v_TECH_MASK=1 THEN
			IF (RPT_TYPE & 4)>0 THEN  
				SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',@global_db,'.tmp_cell_agg_gsm_',EX_DATE,' 
							(
								`DATA_DATE` datetime NOT NULL,
								`DATA_HOUR` tinyint(4) NOT NULL,
								`CELL_ID` mediumint(9) NOT NULL,
								`SITE_ID` varchar(20) DEFAULT NULL,
								`BSC_ID` mediumint(9) NOT NULL,
								`BCCH_ARFCN` smallint(5) unsigned DEFAULT NULL,
								`BANDINDEX` varchar(10) DEFAULT NULL,
								`INIT_CALL_CNT` INT(11) DEFAULT NULL,
								`END_CALL_CNT` INT(11) DEFAULT NULL,
								`VOICE_CNT` int(11) DEFAULT NULL,
								`SIGNAL_CNT` int(11) DEFAULT NULL,
								`SMS_CNT` int(11) DEFAULT NULL,
								`GPRS_CNT` int(11) DEFAULT NULL,
								`OTHER_CNT` int(11) DEFAULT NULL,
								`END_VOICE_CNT` int(11) DEFAULT NULL,
								`END_SIGNAL_CNT` int(11) DEFAULT NULL,
								`END_SMS_CNT` int(11) DEFAULT NULL,
								`END_GPRS_CNT` int(11) DEFAULT NULL,
								`END_OTHER_CNT` int(11) DEFAULT NULL,
								`BLOCK_VOICE_CNT` int(11) DEFAULT NULL,
								`BLOCK_GPRS_CNT` int(11) DEFAULT NULL,
								`BLOCK_SMS_CNT` int(11) DEFAULT NULL,
								`BLOCK_SIGNAL_CNT` int(11) DEFAULT NULL,
								`BLOCK_OTHER_CNT` int(11) DEFAULT NULL,
								`DROP_VOICE_CNT` int(11) DEFAULT NULL,
								`DROP_SIGNAL_CNT` int(11) DEFAULT NULL,
								`DROP_SMS_CNT` int(11) DEFAULT NULL,
								`DROP_GPRS_CNT` int(11) DEFAULT NULL,
								`DROP_OTHER_CNT` int(11) DEFAULT NULL,
								`NON_BLOCK_VOICE_CNT` int(11) DEFAULT NULL,
								`NON_BLOCK_SIGNAL_CNT` int(11) DEFAULT NULL,
								`NON_BLOCK_SMS_CNT` int(11) DEFAULT NULL,
								`NON_BLOCK_GPRS_CNT` int(11) DEFAULT NULL,
								`NON_BLOCK_OTHER_CNT` int(11) DEFAULT NULL,
								`RXLEV_SUM` double DEFAULT NULL,
								`RXLEV_CNT` int(11) DEFAULT NULL,
								`RXQUAL_SUM` double DEFAULT NULL,
								`RXQUAL_CNT` int(11) DEFAULT NULL,
								`CALL_SETUP_TIME_SUM` int(11) DEFAULT NULL,
								`CALL_SETUP_TIME_CNT` int(11) DEFAULT NULL,
								`CALL_SETUP_TIME_VOICE_SUM` int(11) DEFAULT NULL,
								`CALL_SETUP_TIME_VOICE_CNT` int(11) DEFAULT NULL,
								`CALL_SETUP_TIME_SIG_SUM` int(11) DEFAULT NULL,
								`CALL_SETUP_TIME_SIG_CNT` int(11) DEFAULT NULL,
								`CALL_SETUP_TIME_SMS_SUM` int(11) DEFAULT NULL,
								`CALL_SETUP_TIME_SMS_CNT` int(11) DEFAULT NULL,
								`CALL_SETUP_TIME_GPRS_SUM` int(11) DEFAULT NULL,
								`CALL_SETUP_TIME_GPRS_CNT` int(11) DEFAULT NULL,
								`CALL_SETUP_TIME_OTH_SUM` int(11) DEFAULT NULL,
								`CALL_SETUP_TIME_OTH_CNT` int(11) DEFAULT NULL,
								`SF_VOICE_CNT` int(11) DEFAULT NULL,
								`SF_DATA_CNT` int(11) DEFAULT NULL,
								`SF_SMS_CNT` int(11) DEFAULT NULL,
								`SF_SIGNAL_CNT` int(11) DEFAULT NULL,
								`SF_OTHER_CNT` int(11) DEFAULT NULL,
								`CALL_DUR_SUM` double DEFAULT NULL,
								`VOICE_DUR_SUM` double DEFAULT NULL,
								`DATA_DUR_SUM` double DEFAULT NULL
							) ENGINE=MYISAM DEFAULT CHARSET=latin1;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;
			IF (RPT_TYPE & 2)>0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',@global_db,'.tmp_imsi_gsm_',EX_DATE,' (
							`IMSI` VARCHAR(20) NOT NULL,
							`DATA_DATE` DATETIME NOT NULL,
							`DATA_HOUR` TINYINT(2) NOT NULL,
							CALL_CNT int(11) DEFAULT NULL,
							VOICE_MO_CNT int(11) DEFAULT NULL,
							VOICE_MT_CNT int(11) DEFAULT NULL,
							DATA_MO_CNT int(11) DEFAULT NULL,
							DATA_MT_CNT int(11) DEFAULT NULL,
							SMS_MO_CNT int(11) DEFAULT NULL,
							SMS_MT_CNT int(11) DEFAULT NULL,
							SIGNAL_CNT int(11) DEFAULT NULL,
							CALL_DUR_SUM int(11) DEFAULT NULL,
							VOICE_DUR_SUM int(11) DEFAULT NULL,
							DATA_DUR_SUM int(11) DEFAULT NULL,
							DROP_CNT int(11) DEFAULT NULL,
							BLOCK_CNT int(11) DEFAULT NULL,
							DROP_VOICE_CNT int(11) DEFAULT NULL,
							DROP_GPRS_CNT int(11) DEFAULT NULL,
							DROP_SMS_CNT int(11) DEFAULT NULL,
							DROP_SIGNAL_CNT int(11) DEFAULT NULL,
							DROP_OTHER_CNT int(11) DEFAULT NULL,
							BLOCK_VOICE_CNT int(11) DEFAULT NULL,
							BLOCK_GPRS_CNT int(11) DEFAULT NULL,
							BLOCK_SMS_CNT int(11) DEFAULT NULL,
							BLOCK_SMS_MT_CNT int(11) DEFAULT NULL,
							BLOCK_SMS_MO_CNT int(11) DEFAULT NULL,
							BLOCK_SIGNAL_CNT int(11) DEFAULT NULL,
							BLOCK_OTHER_CNT int(11) DEFAULT NULL,
							HO_ATTEMPT_CNT int(11) DEFAULT NULL,
							HO_FAILURE_CNT int(11) DEFAULT NULL,
							MOVING_CALL_CNT int(11) DEFAULT NULL,
							INDOOR_CALL_CNT int(11) DEFAULT NULL,
							FIRST_RXLEV_DL_SUM double DEFAULT NULL,
							FIRST_RXLEV_DL_CNT int(11) DEFAULT NULL,
							FIRST_RXQUAL_DL_SUM double DEFAULT NULL,
							FIRST_RXQUAL_DL_CNT int(11) DEFAULT NULL,
							FIRST_RXLEV_UL_SUM double DEFAULT NULL,
							FIRST_RXLEV_UL_CNT int(11) DEFAULT NULL,
							FIRST_RXQUAL_UL_SUM double DEFAULT NULL,
							FIRST_RXQUAL_UL_CNT int(11) DEFAULT NULL,
							CALL_SETUP_TIME_SUM int(11) DEFAULT NULL,
							CALL_SETUP_TIME_CNT int(11) DEFAULT NULL,
							CALL_SETUP_TIME_VOICE_SUM int(11) DEFAULT NULL,
							CALL_SETUP_TIME_VOICE_CNT int(11) DEFAULT NULL,
							CALL_SETUP_TIME_SIG_SUM int(11) DEFAULT NULL,
							CALL_SETUP_TIME_SIG_CNT int(11) DEFAULT NULL,
							CALL_SETUP_TIME_SMS_SUM int(11) DEFAULT NULL,
							CALL_SETUP_TIME_SMS_CNT int(11) DEFAULT NULL,
							CALL_SETUP_TIME_GPRS_SUM int(11) DEFAULT NULL,
							CALL_SETUP_TIME_GPRS_CNT int(11) DEFAULT NULL,
							CALL_SETUP_TIME_OTH_SUM int(11) DEFAULT NULL,
							CALL_SETUP_TIME_OTH_CNT int(11) DEFAULT NULL,
							SF_VOICE_CNT int(11) DEFAULT NULL,
							SF_GPRS_CNT int(11) DEFAULT NULL,
							SF_SMS_CNT int(11) DEFAULT NULL,
							SF_SMS_MT_CNT int(11) DEFAULT NULL,
							SF_SMS_MO_CNT int(11) DEFAULT NULL,
							SF_SIGNAL_CNT int(11) DEFAULT NULL,
							SF_OTHER_CNT int(11) DEFAULT NULL,
							`MAKE_ID` INT(11) DEFAULT NULL,
							`MODEL_ID` INT(11) DEFAULT NULL,
							',CASE WHEN IMSI_CELL=1 THEN 
							'`START_TILE_ID` BIGINT(20) DEFAULT NULL,
							`END_TILE_ID` BIGINT(20) DEFAULT NULL,
							`START_CELL_ID` MEDIUMINT(9) DEFAULT NULL,
							`START_SITE_ID` VARCHAR(20) DEFAULT NULL,
							`START_REG_1_ID` BIGINT(20) DEFAULT NULL,
							`START_REG_2_ID` BIGINT(20) DEFAULT NULL,
							`START_REG_3_ID` BIGINT(20) DEFAULT NULL,
							`END_CELL_ID` MEDIUMINT(9) DEFAULT NULL,
							`END_SITE_ID` VARCHAR(20) DEFAULT NULL,
							`END_REG_1_ID` BIGINT(20) DEFAULT NULL,
							`END_REG_2_ID` BIGINT(20) DEFAULT NULL,
							`END_REG_3_ID` BIGINT(20) DEFAULT NULL,' ELSE '' END,'
							`MAKE_MODEL` varchar(200) DEFAULT NULL
							) ENGINE=MYISAM DEFAULT CHARSET=latin1;');
			
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;
			IF (RPT_TYPE & 1)>0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',@global_db,'.tmp_tile_gsm_',EX_DATE,' (
							  `TILE_ID` BIGINT(20) NOT NULL,
							  `FREQUENCY` SMALLINT(6) NOT NULL,
							  `BCCH_ARFCN` varchar(10) DEFAULT NULL,
							  `DATA_DATE` DATETIME NOT NULL,
							  `DATA_HOUR` TINYINT(2) NOT NULL,
							  `',@TILE_ID_LVL2,'` BIGINT(20) DEFAULT NULL,
							  `',@TILE_ID_LVL1,'` BIGINT(20) DEFAULT NULL,
							  INIT_CALL_CNT int(11) DEFAULT NULL, 
							  END_CALL_CNT int(11) DEFAULT NULL,
							  VOICE_CNT int(11) DEFAULT NULL,
							  SIGNAL_CNT int(11) DEFAULT NULL,
							  SMS_CNT int(11) DEFAULT NULL,
							  GPRS_CNT int(11) DEFAULT NULL,
							  OTHER_CNT int(11) DEFAULT NULL,
							  BLOCK_CNT int(11) DEFAULT NULL,
							  DROP_VOICE_CNT int(11) DEFAULT NULL,
							  DROP_SIGNAL_CNT int(11) DEFAULT NULL,
							  DROP_SMS_CNT int(11) DEFAULT NULL,
							  DROP_GPRS_CNT int(11) DEFAULT NULL,
							  DROP_OTHER_CNT int(11) DEFAULT NULL,
							  NON_BLOCK_VOICE_CNT int(11) DEFAULT NULL,
							  NON_BLOCK_SIGNAL_CNT int(11) DEFAULT NULL,
							  NON_BLOCK_SMS_CNT int(11) DEFAULT NULL,
							  NON_BLOCK_GPRS_CNT int(11) DEFAULT NULL,
							  NON_BLOCK_OTHER_CNT int(11) DEFAULT NULL,
							  CALL_DUR_SUM double DEFAULT NULL,
							  RXLEV_SUM double DEFAULT NULL,
							  RXLEV_CNT int(11) DEFAULT NULL,
							  RXQUAL_SUM double DEFAULT NULL,
							  RXQUAL_CNT int(11) DEFAULT NULL,
							  `REG_1_ID` BIGINT(20) DEFAULT NULL,
							  `REG_2_ID` BIGINT(20) DEFAULT NULL,
							  `REG_3_ID` BIGINT(20) DEFAULT NULL
							) ENGINE=MYISAM DEFAULT CHARSET=latin1;');
		
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
								
				SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',@global_db,'.tmp_tile_pu_gsm_',EX_DATE,' (
							  `TILE_ID` BIGINT(20) NOT NULL,
							  `PU_ID` MEDIUMINT(6) NOT NULL,
							  `DATA_DATE` DATETIME NOT NULL
							) ENGINE=MYISAM DEFAULT CHARSET=latin1;');
		
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			
			END IF;
			IF (RPT_TYPE & 8)>0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',@global_db,'.tmp_romer_tile_gsm_',EX_DATE,' (
							  `TILE_ID` BIGINT(20) NOT NULL,
							  `MCC` char(3) DEFAULT NULL,
							  `MNC` varchar(3) DEFAULT NULL,
							  `FREQUENCY` SMALLINT(6) NOT NULL,
							  `BCCH_ARFCN` varchar(10) DEFAULT NULL,
							  `DATA_DATE` DATETIME NOT NULL,
							  `DATA_HOUR` TINYINT(2) NOT NULL,
							  `',@TILE_ID_LVL2,'` BIGINT(20) DEFAULT NULL,
							  `',@TILE_ID_LVL1,'` BIGINT(20) DEFAULT NULL,
							  INIT_CALL_CNT int(11) DEFAULT NULL, 
							  END_CALL_CNT int(11) DEFAULT NULL,
							  VOICE_CNT int(11) DEFAULT NULL,
							  SIGNAL_CNT int(11) DEFAULT NULL,
							  SMS_CNT int(11) DEFAULT NULL,
							  GPRS_CNT int(11) DEFAULT NULL,
							  OTHER_CNT int(11) DEFAULT NULL,
							  BLOCK_CNT int(11) DEFAULT NULL,
							  DROP_VOICE_CNT int(11) DEFAULT NULL,
							  DROP_SIGNAL_CNT int(11) DEFAULT NULL,
							  DROP_SMS_CNT int(11) DEFAULT NULL,
							  DROP_GPRS_CNT int(11) DEFAULT NULL,
							  DROP_OTHER_CNT int(11) DEFAULT NULL,
							  NON_BLOCK_VOICE_CNT int(11) DEFAULT NULL,
							  NON_BLOCK_SIGNAL_CNT int(11) DEFAULT NULL,
							  NON_BLOCK_SMS_CNT int(11) DEFAULT NULL,
							  NON_BLOCK_GPRS_CNT int(11) DEFAULT NULL,
							  NON_BLOCK_OTHER_CNT int(11) DEFAULT NULL,
							  CALL_DUR_SUM double DEFAULT NULL,
							  CALL_SETUP_TIME_SUM double DEFAULT NULL,
							  CALL_SETUP_TIME_CNT int(11) DEFAULT NULL,				
							  CALL_SETUP_TIME_VOICE_SUM int(11) DEFAULT NULL,
							  CALL_SETUP_TIME_VOICE_CNT int(11) DEFAULT NULL,
							  CALL_SETUP_TIME_SIG_SUM int(11) DEFAULT NULL,
							  CALL_SETUP_TIME_SIG_CNT int(11) DEFAULT NULL,
							  CALL_SETUP_TIME_SMS_SUM int(11) DEFAULT NULL,
							  CALL_SETUP_TIME_SMS_CNT int(11) DEFAULT NULL,
							  CALL_SETUP_TIME_GPRS_SUM int(11) DEFAULT NULL,
							  CALL_SETUP_TIME_GPRS_CNT int(11) DEFAULT NULL,
							  CALL_SETUP_TIME_OTH_SUM int(11) DEFAULT NULL,
							  CALL_SETUP_TIME_OTH_CNT int(11) DEFAULT NULL,
							  `REG_1_ID` BIGINT(20) DEFAULT NULL,
							  `REG_2_ID` BIGINT(20) DEFAULT NULL,
							  `REG_3_ID` BIGINT(20) DEFAULT NULL
							) ENGINE=MYISAM DEFAULT CHARSET=latin1;');
		
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;			
			END IF;
			INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_TmpTbl_Crt',CONCAT('tmp_lte_',EX_DATE,' CREATE tmp_gsm_tables cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());		
		ELSEIF v_TECH_MASK=4 THEN
			IF (RPT_TYPE & 2)>0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',@global_db,'.tmp_imsi_lte_',EX_DATE,' 
							(
							`IMSI` VARCHAR(20) NOT NULL,
							`DATA_DATE` DATETIME NOT NULL,
							`DATA_HOUR` TINYINT(2) NOT NULL,
							`CALL_CNT` int(11) DEFAULT NULL,
							`DATA_CNT` int(11) DEFAULT NULL,
							`SIGNAL_CNT` int(11) DEFAULT NULL,
							`SMS_CNT` int(11) DEFAULT NULL,
							`VOLTE_CNT` int(11) DEFAULT NULL,
							`UNSPECIFIED_CNT` int(11) DEFAULT NULL,
							`CALL_DUR_SUM` double DEFAULT NULL,
							`DATA_DUR_SUM` double DEFAULT NULL,
							`SIGNAL_DUR_SUM` double DEFAULT NULL,
							`DROP_CNT` int(11) DEFAULT NULL,
							`DROP_DATA_CNT` int(11) DEFAULT NULL,
							`DROP_SIGNAL_CNT` int(11) DEFAULT NULL,
							`DROP_SMS_CNT` int(11) DEFAULT NULL,
							`DROP_VOLTE_CNT` int(11) DEFAULT NULL,
							`DROP_UNSPECIFIED_CNT` int(11) DEFAULT NULL,
							`BLOCK_CNT` int(11) DEFAULT NULL,
							`BLOCK_DATA_CNT` int(11) DEFAULT NULL,
							`BLOCK_SIGNAL_CNT` int(11) DEFAULT NULL,
							`BLOCK_SMS_CNT` int(11) DEFAULT NULL,
							`BLOCK_SMS_MT_CNT` int(11) DEFAULT NULL,
							`BLOCK_SMS_MO_CNT` int(11) DEFAULT NULL,
							`BLOCK_VOLTE_CNT` int(11) DEFAULT NULL,
							`BLOCK_UNSPECIFIED_CNT` int(11) DEFAULT NULL,
							`DROP_RDO_NW_CNT` int(11) DEFAULT NULL,
							`DROP_TRANS_CNT` int(11) DEFAULT NULL,
							`DROP_NAS_CNT` int(11) DEFAULT NULL,
							`DROP_MISC_CNT` int(11) DEFAULT NULL,
							`DROP_PROTOCOL_CNT` int(11) DEFAULT NULL,
							`INTER_FREQ_ATTEMPT_CNT` int(11) DEFAULT NULL,
							`INTER_FREQ_FAILURE_CNT` int(11) DEFAULT NULL,
							`INTRA_FREQ_ATTEMPT_CNT` int(11) DEFAULT NULL,
							`INTRA_FREQ_FAILURE_CNT` int(11) DEFAULT NULL,
							`4G_3G_ATTEMPT_CNT` int(11) DEFAULT NULL,
							`4G_3G_FAILURE_CNT` int(11) DEFAULT NULL,
							`4G_2G_ATTEMPT_CNT` int(11) DEFAULT NULL,
							`4G_2G_FAILURE_CNT` int(11) DEFAULT NULL,
							`MOVING_CALL_CNT` int(11) DEFAULT NULL,
							`INDOOR_CALL_CNT` int(11) DEFAULT NULL,
							`PS_UL_VOLUME_SUM` double DEFAULT NULL,
							`PS_DL_VOLUME_SUM` double DEFAULT NULL,
							`PS_UL_SPEED_MAX` double DEFAULT NULL,
							`PS_DL_SPEED_MAX` double DEFAULT NULL,
							`FIRST_RSRP_SUM` double DEFAULT NULL,
							`FIRST_RSRP_CNT` int(11) DEFAULT NULL,
							`FIRST_RSRQ_SUM` double DEFAULT NULL,
							`FIRST_RSRQ_CNT` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_SUM` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_CNT` int(11) DEFAULT NULL,
							`CALL_SETUP_TIME_SIG_SUM` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_SIG_CNT` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_DATA_SUM` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_DATA_CNT` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_SMS_SUM` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_SMS_CNT` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_VOLTE_SUM` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_VOLTE_CNT` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_UNSP_SUM` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_UNSP_CNT` INT(11) DEFAULT NULL,
							`SF_CNT` int(11) DEFAULT NULL,
							`SF_DATA_CNT` int(11) DEFAULT NULL,
							`SF_SIGNAL_CNT` int(11) DEFAULT NULL,
							`SF_SMS_CNT` int(11) DEFAULT NULL,
							`SF_SMS_MT_CNT` int(11) DEFAULT NULL,
							`SF_SMS_MO_CNT` int(11) DEFAULT NULL,
							`SF_VOLTE_CNT` int(11) DEFAULT NULL,
							`SF_UNSPECIFIED_CNT` int(11) DEFAULT NULL,
							`MT_DATA_CNT` int(11) DEFAULT NULL,
							`MO_DATA_CNT` int(11) DEFAULT NULL,
							`MT_SMS_CNT` int(11) DEFAULT NULL,
							`MO_SMS_CNT` int(11) DEFAULT NULL,
							`MT_VOLTE_CNT` int(11) DEFAULT NULL,
							`MO_VOLTE_CNT` int(11) DEFAULT NULL,
							`CSFB_SIGNAL_CNT` INT(11) DEFAULT NULL,
							`CSFB_DATA_CNT` INT(11) DEFAULT NULL,
							`CSFB_SMS_CNT` INT(11) DEFAULT NULL,
							`CSFB_VOLTE_CNT` INT(11) DEFAULT NULL,
							`CSFB_UNSPECIFIED_CNT` INT(11) DEFAULT NULL,
							`CSFB_CNT` INT(11) DEFAULT NULL,
							`LATENCY_SUM` DOUBLE DEFAULT NULL,
							`LATENCY_CNT` INT(11) DEFAULT NULL,
							`MAKE_ID` INT(11) DEFAULT NULL,
							`MODEL_ID` INT(11) DEFAULT NULL,							
							',CASE WHEN IMSI_CELL=1 THEN 
							'`START_TILE_ID` BIGINT(20) DEFAULT NULL,
							`END_TILE_ID` BIGINT(20) DEFAULT NULL,
							`START_CELL_ID` TINYINT(4) UNSIGNED DEFAULT NULL,
							`START_ENODEB_ID` MEDIUMINT(9) DEFAULT NULL,
							`START_REG_1_ID` BIGINT(20) DEFAULT NULL,
							`START_REG_2_ID` BIGINT(20) DEFAULT NULL,
							`START_REG_3_ID` BIGINT(20) DEFAULT NULL,
							`END_CELL_ID` TINYINT(4) UNSIGNED DEFAULT NULL,
							`END_ENODEB_ID` MEDIUMINT(9) DEFAULT NULL,
							`END_REG_1_ID` BIGINT(20) DEFAULT NULL,
							`END_REG_2_ID` BIGINT(20) DEFAULT NULL,
							`END_REG_3_ID` BIGINT(20) DEFAULT NULL,' ELSE '' END,'
							`MAKE_MODEL` varchar(200) DEFAULT NULL
							) ENGINE=MYISAM DEFAULT CHARSET=latin1;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;
			IF (RPT_TYPE & 1)>0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',@global_db,'.tmp_tile_lte_',EX_DATE,' 
							(
							  `TILE_ID` BIGINT(20) NOT NULL,
							  `',@TILE_ID_LVL2,'` BIGINT(20)  NULL,
							  `',@TILE_ID_LVL1,'` BIGINT(20)  NULL,
							  `EARFCN` MEDIUMINT(9) NOT NULL,
							  `EUTRABAND` SMALLINT(6) NOT NULL,
							  `DATA_DATE` DATETIME NOT NULL,
							  `DATA_HOUR` TINYINT(4) NOT NULL,
							  `INIT_CALL_CNT` INT(11) DEFAULT NULL,
							  `END_CALL_CNT` INT(11) DEFAULT NULL,
							  `SIGNAL_CNT` INT(11) DEFAULT NULL,
							  `DATA_CNT` INT(11) DEFAULT NULL,
							  `UNSPECIFIED_CNT` INT(11) DEFAULT NULL,
							  `CALL_DUR_SUM` DOUBLE DEFAULT NULL,
							  `BLOCK_CNT` INT(11) DEFAULT NULL,
							  `DROP_CNT` INT(11) DEFAULT NULL,
							  `CSFB_CNT` INT(11) DEFAULT NULL,
							  `INTER_FREQ_ATTEMPT_CNT` INT(11) DEFAULT NULL,
							  `INTER_FREQ_FAILURE_CNT` INT(11) DEFAULT NULL,
							  `INTRA_FREQ_ATTEMPT_CNT` INT(11) DEFAULT NULL,
							  `INTRA_FREQ_FAILURE_CNT` INT(11) DEFAULT NULL,
							  `4G_3G_ATTEMPT_CNT` INT(11) DEFAULT NULL,
							  `4G_3G_FAILURE_CNT` INT(11) DEFAULT NULL,
							  `4G_2G_ATTEMPT_CNT` INT(11) DEFAULT NULL,
							  `4G_2G_FAILURE_CNT` INT(11) DEFAULT NULL,
							  `PS_UL_VOLUME_SUM` DOUBLE DEFAULT NULL,
							  `PS_DL_VOLUME_SUM` DOUBLE DEFAULT NULL,
							  `PS_UL_SPEED_MAX` DOUBLE DEFAULT NULL,
							  `PS_DL_SPEED_MAX` DOUBLE DEFAULT NULL,
							  `RSRP_SUM` DOUBLE DEFAULT NULL,
							  `RSRP_CNT` INT(11) DEFAULT NULL,
							  `RSRQ_SUM` DOUBLE DEFAULT NULL,
							  `RSRQ_CNT` INT(11) DEFAULT NULL,
							  `PILOT_DOMINANCE_SUM` INT(11) DEFAULT NULL,
							  `PILOT_DOMINANCE_CNT` INT(11) DEFAULT NULL,
							  `DROP_SIGNAL_CNT` INT(11) DEFAULT NULL,
							  `DROP_DATA_CNT` INT(11) DEFAULT NULL,
							  `DROP_SMS_CNT` INT(11) DEFAULT NULL,
							  `DROP_VOLTE_CNT` INT(11) DEFAULT NULL,
							  `DROP_UNSPECIFIED_CNT` INT(11) DEFAULT NULL,
							  `END_NON_BLOCK_CALL_CNT` INT(11) DEFAULT NULL,
							  `REG_1_ID` BIGINT(20) DEFAULT NULL,
							  `REG_2_ID` BIGINT(20) DEFAULT NULL,
							  `REG_3_ID` BIGINT(20) DEFAULT NULL,
							  `UL_THROUPUT_SUM` DOUBLE DEFAULT NULL,
							  `UL_THROUPUT_CNT` INT(11) DEFAULT NULL,
							  `DL_THROUPUT_SUM` DOUBLE DEFAULT NULL,
							  `DL_THROUPUT_CNT` INT(11) DEFAULT NULL,
							  `END_NON_BLOCK_SIGNAL_CNT` INT(11) DEFAULT NULL,
							  `END_NON_BLOCK_DATA_CNT` INT(11) DEFAULT NULL,
							  `MR_4G_RSRP_SERVING_SUM` DOUBLE DEFAULT NULL,
							  `MR_4G_RSRP_SERVING_CNT` INT(11) DEFAULT NULL,
							  `MR_4G_RSRQ_SERVING_SUM` DOUBLE DEFAULT NULL,
							  `MR_4G_RSRQ_SERVING_CNT` INT(11) DEFAULT NULL,
							KEY `IX_TILE` (`TILE_ID`)
							) ENGINE=MYISAM DEFAULT CHARSET=latin1;');
		
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
								
				SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',@global_db,'.tmp_tile_pu_lte_',EX_DATE,' (
							  `TILE_ID` BIGINT(20) NOT NULL,
							  `PU_ID` MEDIUMINT(6) NOT NULL,
							  `DATA_DATE` DATETIME NOT NULL
							) ENGINE=MYISAM DEFAULT CHARSET=latin1;');
		
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;
			IF (RPT_TYPE & 4)>0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',@global_db,'.tmp_cell_lte_',EX_DATE,' (
									`DATA_DATE` DATE NOT NULL DEFAULT ''0000-00-00'',
									`DATA_HOUR` TINYINT(4) NOT NULL DEFAULT ''0'',
									`PU_ID` MEDIUMINT(9) NOT NULL DEFAULT ''0'',
									`ENODEB_ID` MEDIUMINT(9) NOT NULL DEFAULT ''0'',
									`CELL_ID` MEDIUMINT(9) NOT NULL DEFAULT ''0'',
									`CELL_NAME` VARCHAR(50) CHARACTER SET utf8 DEFAULT NULL COMMENT ''lookup'',
									`SUB_REGION_ID` MEDIUMINT(9) NOT NULL DEFAULT ''0'',
									`EUTRABAND` SMALLINT(6) DEFAULT NULL,
									`EARFCN` MEDIUMINT(9) DEFAULT NULL,
									`CELL_OSS_NODE_ID` INT(20) DEFAULT NULL,
									`RRC_CONN_SETUP_ATTEMPT` MEDIUMINT(8) DEFAULT ''0'',
									`RRC_CONN_SETUP_REJECT` MEDIUMINT(8) DEFAULT ''0'',
									`RRC_CONN_SETUP_MISSING_COMPLETE` MEDIUMINT(8) DEFAULT ''0'',
									`ERAB_SETUP_ATTEMPT` MEDIUMINT(8) DEFAULT ''0'',
									`ERAB_SETUP_REJECT` MEDIUMINT(8) DEFAULT ''0'',
									`ERAB_SETUP_ACCS_DELAY` MEDIUMINT(8) DEFAULT ''0'',
									`UE_CNXT_DROP_SETUP` MEDIUMINT(8) DEFAULT ''0'',
									`UE_CNXT_DROP_DROP` MEDIUMINT(8) DEFAULT ''0'',
									`RRC_RE_ESTABLISHMENT_ATTEMPT` MEDIUMINT(8) DEFAULT ''0'',
									`RRC_RE_ESTABLISHMENT_FAILURE` MEDIUMINT(8) DEFAULT ''0'',
									`MIMO_USAGE_RATIO_NUM` MEDIUMINT(8) DEFAULT NULL,
									`MIMO_USAGE_RATIO_DEN` MEDIUMINT(8) DEFAULT NULL,
									`SUBSC_PET_CELL_PER_HR` FLOAT DEFAULT NULL,
									`CALL_DURATION_SUM` MEDIUMINT(8) DEFAULT ''0'',
									`CALL_DURATION_CNT` MEDIUMINT(8) DEFAULT ''0'',
									`4G_4G_HO_ATTEMPT` MEDIUMINT(8) DEFAULT ''0'',
									`4G_4G_HO_FAILURE` MEDIUMINT(8) DEFAULT ''0'',
									`RRC_RECONFIGURATION_ATTEMPT` MEDIUMINT(8) DEFAULT ''0'',
									`RRC_RECONFIGURATION_FAILURE` MEDIUMINT(8) DEFAULT ''0'',
									`CSFB_EXECUTIONS` MEDIUMINT(8) DEFAULT ''0'',
									`UE_CNXT_REL_TOT` MEDIUMINT(8) DEFAULT ''0'',
									`IRAT_PING_PONG` float DEFAULT NULL,
									`IRAT_RSRP` float DEFAULT NULL,
									`IRAT_RSRQ` float DEFAULT NULL,
									`IRAT_TA` float DEFAULT NULL,
									`IRAT_RSCP` float DEFAULT NULL,
									`IRAT_ECN0` float DEFAULT NULL,
									`IRAT_RSSI` float DEFAULT NULL,
									`4G_3G_HO_ATTEMPT` MEDIUMINT(8) DEFAULT ''0'',
									`4G_3G_HO_FAILURE` MEDIUMINT(8) DEFAULT ''0'',
									`4G_2G_HO_ATTEMPT` MEDIUMINT(8) DEFAULT ''0'',
									`4G_2G_HO_FAILURE` MEDIUMINT(8)  DEFAULT ''0'',
									`BLIND_REDIR_4G_3G` MEDIUMINT(8)  DEFAULT ''0'',
									`BLIND_REDIR_4G_2G` MEDIUMINT(8)  DEFAULT ''0'',
									`4G_3G_CSFB_HO_ATT`  MEDIUMINT(8)  DEFAULT ''0'',
									`4G_3G_CSFB_HO_SUCC` MEDIUMINT(8)  DEFAULT ''0'',
									`4G_3G_CSFB_HO_FAILURE` MEDIUMINT(8)  DEFAULT ''0'',
									`VOLTE_ATTEMPT`  MEDIUMINT(8)  DEFAULT ''0'',
									`VOLTE_SUCCESS` MEDIUMINT(8)  DEFAULT ''0'',
									`VOLTE_FAILURE` MEDIUMINT(8)  DEFAULT ''0'',
									`PROCEDURE_TIME_SUM` MEDIUMINT(8)  DEFAULT ''0'',
									`PROCEDURE_TIME_CNT` MEDIUMINT(8)  DEFAULT ''0'',
									`ACCESSIBILITY_TIME_SUM` MEDIUMINT(8)  DEFAULT ''0'',
									`ACCESSIBILITY_TIME_CNT` MEDIUMINT(8)  DEFAULT ''0'',
									`IRAT_RSRP_CNT` MEDIUMINT(8) DEFAULT ''0'',
									`IRAT_RSRQ_CNT` MEDIUMINT(8) DEFAULT ''0'',
									`IRAT_TA_CNT` MEDIUMINT(8) DEFAULT ''0'',
									`IRAT_RSCP_CNT` MEDIUMINT(8) DEFAULT ''0'',
									`IRAT_ECN0_CNT` MEDIUMINT(8) DEFAULT ''0'',
									`IRAT_RSSI_CNT` MEDIUMINT(8) DEFAULT ''0'',
									`PEAK_SUBSCRIBER` MEDIUMINT(8) DEFAULT ''0'',
									`PEAK_QUARTER` CHAR(4) DEFAULT ''0''
									`VOLTE_DROP` MEDIUMINT(8) DEFAULT ''0'',
									`VOLTE_END` MEDIUMINT(8) DEFAULT ''0'',
									`DL_VOLUME_SUM` DOUBLE DEFAULT ''0'',
									`UL_VOLUME_SUM` DOUBLE DEFAULT ''0'',
									`DL_THROUGHPUT_SUM` DOUBLE DEFAULT ''0'',
									`DL_THROUGHPUT_CNT` MEDIUMINT(9) DEFAULT ''0'',
									`UL_THROUGHPUT_SUM` DOUBLE DEFAULT ''0'',
									`UL_THROUGHPUT_CNT` MEDIUMINT(9) DEFAULT ''0'',
									`DL_THROUGHPUT_MAX` DOUBLE DEFAULT ''0'',
									`UL_THROUGHPUT_MAX` DOUBLE DEFAULT ''0'',
									`DL_TRAFFIC_DUR` DOUBLE DEFAULT ''0'',
									`UL_TRAFFIC_DUR` DOUBLE DEFAULT ''0''									
						) ENGINE=MYISAM DEFAULT CHARSET=latin1;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',@global_db,'.tmp_cell_agg_lte_',EX_DATE,' 
							(
							`DATA_DATE` datetime NOT NULL,
							`DATA_HOUR` tinyint(4) NOT NULL,
							`CELL_ID` tinyint(4) unsigned,
							`ENODEB_ID` mediumint(9) DEFAULT NULL,
							`PU_ID` mediumint(9) NOT NULL,
							`EARFCN` SMALLINT(6) NOT NULL,
							`EUTRABAND` SMALLINT(6) NOT NULL,
							`INIT_CALL_CNT` INT(11) DEFAULT NULL,
							`END_CALL_CNT` INT(11) DEFAULT NULL,
							`SIGNAL_CNT` INT(11) DEFAULT NULL,
							`DATA_CNT` INT(11) DEFAULT NULL,
							`SMS_CNT` INT(11) DEFAULT NULL,
							`VOLTE_CNT` INT(11) DEFAULT NULL,
							`UNSPECIFIED_CNT` INT(11) DEFAULT NULL,
							`END_SIGNAL_CNT` INT(11) DEFAULT NULL,
							`END_DATA_CNT` INT(11) DEFAULT NULL,
							`END_SMS_CNT` INT(11) DEFAULT NULL,
							`END_VOLTE_CNT` INT(11) DEFAULT NULL,
							`END_UNSPECIFIED_CNT` INT(11) DEFAULT NULL,
							`DROP_SIGNAL_CNT` INT(11) DEFAULT NULL,
							`DROP_DATA_CNT` INT(11) DEFAULT NULL,
							`DROP_SMS_CNT` INT(11) DEFAULT NULL,
							`DROP_VOLTE_CNT` INT(11) DEFAULT NULL,
							`DROP_UNSPECIFIED_CNT` INT(11) DEFAULT NULL,
							`BLOCK_SIGNAL_CNT` INT(11) DEFAULT NULL,
							`BLOCK_DATA_CNT` INT(11) DEFAULT NULL,
							`BLOCK_SMS_CNT` INT(11) DEFAULT NULL,
							`BLOCK_VOLTE_CNT` INT(11) DEFAULT NULL,
							`BLOCK_UNSPECIFIED_CNT` INT(11) DEFAULT NULL,
							`CSFB_SIGNAL_CNT` INT(11) DEFAULT NULL,
							`CSFB_DATA_CNT` INT(11) DEFAULT NULL,
							`CSFB_SMS_CNT` INT(11) DEFAULT NULL,
							`CSFB_VOLTE_CNT` INT(11) DEFAULT NULL,
							`CSFB_UNSPECIFIED_CNT` INT(11) DEFAULT NULL,
							`NON_BLOCK_SIGNAL_CNT` INT(11) DEFAULT NULL,
							`NON_BLOCK_DATA_CNT` INT(11) DEFAULT NULL,
							`NON_BLOCK_SMS_CNT` INT(11) DEFAULT NULL,
							`NON_BLOCK_VOLTE_CNT` INT(11) DEFAULT NULL,
							`NON_BLOCK_UNSPECIFIED_CNT` INT(11) DEFAULT NULL,
							`RSRP_SUM` DOUBLE DEFAULT NULL,
							`RSRP_CNT` INT(11) DEFAULT NULL,
							`RSRQ_SUM` DOUBLE DEFAULT NULL,
							`RSRQ_CNT` INT(11) DEFAULT NULL,
							`UL_VOLUME_SUM` DOUBLE DEFAULT NULL,
							`DL_VOLUME_SUM` DOUBLE DEFAULT NULL,
							`UL_THROUPUT_MAX` DOUBLE DEFAULT NULL,
							`DL_THROUPUT_MAX` DOUBLE DEFAULT NULL,
							`UL_THROUPUT_SUM` DOUBLE DEFAULT NULL,
							`UL_THROUPUT_CNT` INT(11) DEFAULT NULL,
							`DL_THROUPUT_SUM` DOUBLE DEFAULT NULL,
							`DL_THROUPUT_CNT` INT(11) DEFAULT NULL,
							`INTER_FREQ_ATTEMPT_CNT` INT(11) DEFAULT NULL,
							`INTER_FREQ_FAILURE_CNT` INT(11) DEFAULT NULL,
							`INTRA_FREQ_ATTEMPT_CNT` INT(11) DEFAULT NULL,
							`INTRA_FREQ_FAILURE_CNT` INT(11) DEFAULT NULL,
							`4G_3G_ATTEMPT_CNT` INT(11) DEFAULT NULL,
							`4G_3G_FAILURE_CNT` INT(11) DEFAULT NULL,
							`4G_2G_ATTEMPT_CNT` INT(11) DEFAULT NULL,
							`4G_2G_FAILURE_CNT` INT(11) DEFAULT NULL,
							`MR_4G_RSRP_SERVING_SUM` DOUBLE DEFAULT NULL,
							`MR_4G_RSRP_SERVING_CNT` INT(11) DEFAULT NULL,
							`MR_4G_RSRQ_SERVING_SUM` DOUBLE DEFAULT NULL,
							`MR_4G_RSRQ_SERVING_CNT` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_SUM` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_CNT` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_SIG_SUM` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_SIG_CNT` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_DATA_SUM` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_DATA_CNT` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_SMS_SUM` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_SMS_CNT` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_VOLTE_SUM` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_VOLTE_CNT` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_UNSP_SUM` INT(11) DEFAULT NULL,
							`CALL_SETUP_TIME_UNSP_CNT` INT(11) DEFAULT NULL,
							`SF_SIGNAL_CNT` INT(11) DEFAULT NULL,
							`SF_DATA_CNT` INT(11) DEFAULT NULL,
							`SF_SMS_CNT` INT(11) DEFAULT NULL,
							`SF_VOLTE_CNT` INT(11) DEFAULT NULL,
							`SF_UNSPECIFIED_CNT` INT(11) DEFAULT NULL,
							`SRVCC_ATTEMPT_CNT` INT(11) DEFAULT NULL,
							`SRVCC_FAILURE_CNT` INT(11) DEFAULT NULL,
							`S1_HO_ATTEMPT` INT(11) DEFAULT NULL,
							`S1_HO_FAILURE` INT(11) DEFAULT NULL,
							`X2_HO_ATTEMPT` INT(11) DEFAULT NULL,
							`X2_HO_FAILURE` INT(11) DEFAULT NULL,
							`LATENCY_SUM` DOUBLE DEFAULT NULL,
							`LATENCY_CNT` INT(11) DEFAULT NULL
							) ENGINE=MYISAM DEFAULT CHARSET=latin1;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;	
			IF (RPT_TYPE & 8)>0 THEN 
				SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',@global_db,'.tmp_romer_tile_lte_',EX_DATE,' 
							(
							  `TILE_ID` BIGINT(20) NOT NULL,
							  `MCC` char(3) DEFAULT NULL,
							  `MNC` varchar(3) DEFAULT NULL,
							  `',@TILE_ID_LVL2,'` BIGINT(20)  NULL,
							  `',@TILE_ID_LVL1,'` BIGINT(20)  NULL,
							  `EARFCN` MEDIUMINT(9) NOT NULL,
							  `EUTRABAND` SMALLINT(6) NOT NULL,
							  `DATA_DATE` DATETIME NOT NULL,
							  `DATA_HOUR` TINYINT(4) NOT NULL,
							  `INIT_CALL_CNT` INT(11) DEFAULT NULL,
							  `END_CALL_CNT` INT(11) DEFAULT NULL,
							  `SIGNAL_CNT` INT(11) DEFAULT NULL,
							  `DATA_CNT` INT(11) DEFAULT NULL,
							  `UNSPECIFIED_CNT` INT(11) DEFAULT NULL,
							  `CALL_DUR_SUM` DOUBLE DEFAULT NULL,
							  `BLOCK_CNT` INT(11) DEFAULT NULL,
							  `DROP_CNT` INT(11) DEFAULT NULL,
							  `CSFB_CNT` INT(11) DEFAULT NULL,
							  `PS_UL_VOLUME_SUM` DOUBLE DEFAULT NULL,
							  `PS_DL_VOLUME_SUM` DOUBLE DEFAULT NULL,
							  `PS_UL_SPEED_MAX` DOUBLE DEFAULT NULL,
							  `PS_DL_SPEED_MAX` DOUBLE DEFAULT NULL,
							  `DROP_SIGNAL_CNT` INT(11) DEFAULT NULL,
							  `DROP_DATA_CNT` INT(11) DEFAULT NULL,
							  `DROP_SMS_CNT` INT(11) DEFAULT NULL,
							  `DROP_VOLTE_CNT` INT(11) DEFAULT NULL,
							  `DROP_UNSPECIFIED_CNT` INT(11) DEFAULT NULL,
							  `END_NON_BLOCK_CALL_CNT` INT(11) DEFAULT NULL,
							  `UL_THROUPUT_SUM` DOUBLE DEFAULT NULL,
							  `UL_THROUPUT_CNT` INT(11) DEFAULT NULL,
							  `DL_THROUPUT_SUM` DOUBLE DEFAULT NULL,
							  `DL_THROUPUT_CNT` INT(11) DEFAULT NULL,
							  `END_NON_BLOCK_SIGNAL_CNT` INT(11) DEFAULT NULL,
							  `END_NON_BLOCK_DATA_CNT` INT(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_SUM` double DEFAULT NULL,
							  `CALL_SETUP_TIME_CNT` int(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_SIG_SUM` INT(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_SIG_CNT` INT(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_DATA_SUM` INT(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_DATA_CNT` INT(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_SMS_SUM` INT(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_SMS_CNT` INT(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_VOLTE_SUM` INT(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_VOLTE_CNT` INT(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_UNSP_SUM` INT(11) DEFAULT NULL,
							  `CALL_SETUP_TIME_UNSP_CNT` INT(11) DEFAULT NULL,
							  `REG_1_ID` BIGINT(20) DEFAULT NULL,
							  `REG_2_ID` BIGINT(20) DEFAULT NULL,
							  `REG_3_ID` BIGINT(20) DEFAULT NULL
							) ENGINE=MYISAM DEFAULT CHARSET=latin1;');
		
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;
			
			IF (RPT_TYPE & 16)>0 THEN  
				SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',@global_db,'.tmp_failcause_lte_',EX_DATE,' (
							  `DATA_DATE` date NOT NULL,
							  `TILE_ID` bigint(20) NOT NULL,
							  `PU_ID` mediumint(9) NOT NULL,
							  `ENODEB_ID` mediumint(9) NOT NULL,
							  `CELL_ID` mediumint(9) NOT NULL,
							  `IMSI` varchar(20) NOT NULL,
							  `IMEI` varchar(20) NOT NULL,
							  `EVENT_ID` smallint(6) NOT NULL,
							  `FAILURE_EVENT_ID` mediumint(9) NOT NULL,
							  `FAILURE_EVENT_CAUSE` mediumint(9) NOT NULL,
							  `FAILURE_CNT` mediumint(9) DEFAULT ''0''
							) ENGINE=MYISAM DEFAULT CHARSET=latin1;');		  
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;
			
			IF (RPT_TYPE & 32)>0 THEN  
				SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',@global_db,'.tmp_subscriber_lte_',EX_DATE,' (
							 `DATA_DATE` date DEFAULT NULL,
							 `END_TIME` DATETIME DEFAULT NULL,							
							 `DURATION` MEDIUMINT(9) DEFAULT NULL,
							 `IMSI` varchar(20) DEFAULT NULL,							
							 `CELL_ID` VARCHAR(50) DEFAULT NULL,
							 `DROP_REASON` MEDIUMINT(9) DEFAULT NULL,
							 `LAST_RSRP` DOUBLE DEFAULT NULL,
							 `LAST_RSRQ` DOUBLE DEFAULT NULL,
							 `FREQ_BAND` SMALLINT(6) DEFAULT NULL,
							 `TILE_ID` BIGINT(20) DEFAULT NULL						
							) ENGINE=MYISAM DEFAULT CHARSET=latin1;');		  
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
			END IF;	
		END IF;	
		SET @v_i=@v_i+1;
	END;
	END WHILE;
	INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_TmpTbl_Crt',CONCAT(WORKER_ID,' Done cost:',TIMESTAMPDIFF(SECOND,START_TIME,SYSDATE()),' sec.'), NOW());

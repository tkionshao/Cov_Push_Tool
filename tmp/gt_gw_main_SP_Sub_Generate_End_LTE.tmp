CREATE DEFINER=`covmo`@`%` PROCEDURE `SP_Sub_Generate_End_LTE`(IN GT_DB VARCHAR(50))
BEGIN
	DECLARE START_TIME DATETIME DEFAULT SYSDATE();
	DECLARE WORKER_ID VARCHAR(10) DEFAULT CONNECTION_ID();
	
	DECLARE SH_EH VARCHAR(9) DEFAULT RIGHT(GT_DB,9);
	DECLARE GT_DATE VARCHAR(18) DEFAULT RIGHT(GT_DB,18);
	DECLARE STARTHOUR VARCHAR(2) DEFAULT SUBSTRING(RIGHT(GT_DB,18),10,2);
	DECLARE ENDHOUR VARCHAR(2) DEFAULT IF(SUBSTRING(RIGHT(GT_DB,18),15,2)='00','24',SUBSTRING(RIGHT(GT_DB,18),15,2));
	
	
  	INSERT INTO gt_gw_main.SP_LOG VALUES(GT_DB,'SP_Sub_Generate_End_LTE','Start', START_TIME);
 
	SELECT REPLACE(GT_DB,SH_EH,'0000_0000') INTO GT_DB;
	
	INSERT INTO gt_gw_main.SP_LOG VALUES(GT_DB,'SP_Sub_Generate_End_LTE','rpt_cell_end', NOW());
  	  	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',GT_DB,'.rpt_cell_end_',WORKER_ID,';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	
 	SET @SqlCmd=CONCAT('CREATE TEMPORARY TABLE ',GT_DB,'.`rpt_cell_end_',WORKER_ID,'` (
	  `DATA_DATE` DATE NOT NULL,
	  `DATA_HOUR` SMALLINT(6) NOT NULL,
	  `CALL_TYPE` TINYINT(4) NOT NULL,
	  `CALL_STATUS` TINYINT(4) NOT NULL,
	  `MOVING` TINYINT(4) NOT NULL,
	  `INDOOR` TINYINT(4) NOT NULL,
	  `SUB_REGION_ID` INT(11) NOT NULL DEFAULT ''0'',
	  `EUTRABAND` SMALLINT(6) NOT NULL DEFAULT ''0'',
	  `EARFCN` SMALLINT(6) NOT NULL DEFAULT ''0'',
	  `ENODEB_ID` MEDIUMINT(9) NOT NULL DEFAULT ''0'',
	  `CELL_ID` MEDIUMINT(9) NOT NULL DEFAULT ''0'',
	  `CELL_NAME` VARCHAR(50) CHARACTER SET utf8 NOT NULL DEFAULT '''',
	  `POS_LAST_RSRP` DOUBLE  DEFAULT ''0'',
	  `POS_LAST_RSRP_CNT` INT(11)  DEFAULT ''0'',
	  `POS_LAST_RSRQ` DOUBLE  DEFAULT ''0'',
	  `POS_LAST_RSRQ_CNT` INT(11)  DEFAULT ''0'',
	  `MEASURE_CNT` INT(11)  DEFAULT ''0'',
	  `DURATION` BIGINT(20)  DEFAULT ''0'',
	  `IRAT_TO_GERAN_SUCCESS_1_RSRP` DOUBLE  DEFAULT ''0'',
	  `IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT` INT(11)  DEFAULT ''0'',
	  `IRAT_TO_GERAN_SUCCESS_1_RSRQ` DOUBLE  DEFAULT ''0'',
	  `IRAT_TO_GERAN_SUCCESS_1_RSRQ_CNT` INT(11)  DEFAULT ''0'',
	  `IRAT_TO_GERAN_SUCCESS_1_RSSI` DOUBLE  DEFAULT ''0'',
	  `IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT` INT(11)  DEFAULT ''0'',
	  `IRAT_TO_UMTS_SUCCESS_1_ECN0` DOUBLE  DEFAULT ''0'',
	  `IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT` INT(11)  DEFAULT ''0'',
	  `IRAT_TO_UMTS_SUCCESS_1_RSCP` DOUBLE  DEFAULT ''0'',
	  `IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT` INT(11)  DEFAULT ''0'',
	  `IRAT_TO_UMTS_SUCCESS_1_RSRP` DOUBLE  DEFAULT ''0'',
	  `IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT` INT(11)  DEFAULT ''0'',
	  `IRAT_TO_UMTS_SUCCESS_1_RSRQ` DOUBLE  DEFAULT ''0'',
	  `IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT` INT(11)  DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_1` DOUBLE  DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_1_CNT` INT(11)  DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_2` DOUBLE  DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_2_CNT` INT(11)  DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_3` DOUBLE  DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_3_CNT` INT(11)  DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_4` DOUBLE  DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_4_CNT` INT(11)  DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_5` DOUBLE  DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_5_CNT` INT(11)  DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_6` DOUBLE  DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_6_CNT` INT(11)  DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_7` DOUBLE  DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_7_CNT` INT(11)  DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_8` DOUBLE  DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_8_CNT` INT(11)  DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_NOT_1_8` DOUBLE  DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_NOT_1_8_CNT` INT(11)  DEFAULT ''0'',
	  `E_RAB_SETUP_FAILURE` BIGINT(20)  DEFAULT ''0'',
	  `CALL_STATUS_2` INT(11)  DEFAULT ''0'',
	  `CALL_STATUS_3` INT(11)  DEFAULT ''0'',
	  `CALL_STATUS_124` INT(11)  DEFAULT ''0'',
	  `DURATION_M30` INT(11)  DEFAULT ''0'',
	  `DURATION_L10` INT(11)  DEFAULT ''0'',
	  `DURATION_L30` INT(11)  DEFAULT ''0'',
	  `DURATION_L1` INT(11)  DEFAULT ''0'',
	  `RRC_SETUP_FAILURE_EVENT` INT(11)  DEFAULT ''0'',
	  `IRAT_TO_GERAN_ATTEMPT` INT(11)  DEFAULT ''0'',
	  `IRAT_TO_GERAN_SUCCESS` INT(11)  DEFAULT ''0'',
	  `IRAT_TO_UMTS_ATTEMPT` INT(11)  DEFAULT ''0'',
	  `IRAT_TO_UMTS_SUCCESS` INT(11)  DEFAULT ''0'',
	  `SERVING_CNT` INT(11)  DEFAULT ''0''
	  ,PRIMARY KEY (`DATA_DATE`,`DATA_HOUR`,`ENODEB_ID`,`CELL_ID`,`CALL_TYPE`,`CALL_STATUS`,`MOVING`,`INDOOR`,`SUB_REGION_ID`,`EUTRABAND`,`EARFCN`,`CELL_NAME`)	
	  ,KEY IX_CELL_DY (`ENODEB_ID`,`CELL_ID`,`CALL_TYPE`,`CALL_STATUS`,`MOVING`,`INDOOR`,`SUB_REGION_ID`,`EUTRABAND`,`EARFCN`,`CELL_NAME`)
	) ENGINE=MYISAM DEFAULT CHARSET=utf8');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
 	
	SET @SqlCmd=CONCAT('INSERT INTO ',GT_DB,'.rpt_cell_end_',WORKER_ID,'
				(
					DATA_DATE, DATA_HOUR,CALL_TYPE,CALL_STATUS,MOVING,INDOOR,
					SUB_REGION_ID,EUTRABAND,EARFCN,ENODEB_ID,CELL_ID,CELL_NAME,
					DURATION,IRAT_TO_GERAN_SUCCESS_1_RSRP,IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT,
					IRAT_TO_GERAN_SUCCESS_1_RSRQ,IRAT_TO_GERAN_SUCCESS_1_RSRQ_CNT,
					IRAT_TO_GERAN_SUCCESS_1_RSSI,IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT,
					IRAT_TO_UMTS_SUCCESS_1_ECN0,IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT,
					IRAT_TO_UMTS_SUCCESS_1_RSCP,IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT,
					IRAT_TO_UMTS_SUCCESS_1_RSRP,IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT,
					IRAT_TO_UMTS_SUCCESS_1_RSRQ,IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT,
					RRC_REQUEST_TYPE_1,RRC_REQUEST_TYPE_1_CNT,RRC_REQUEST_TYPE_2,RRC_REQUEST_TYPE_2_CNT,
					RRC_REQUEST_TYPE_3,RRC_REQUEST_TYPE_3_CNT,RRC_REQUEST_TYPE_4,RRC_REQUEST_TYPE_4_CNT,
					RRC_REQUEST_TYPE_5,RRC_REQUEST_TYPE_5_CNT,RRC_REQUEST_TYPE_6,RRC_REQUEST_TYPE_6_CNT,
					RRC_REQUEST_TYPE_7,RRC_REQUEST_TYPE_7_CNT,RRC_REQUEST_TYPE_8,RRC_REQUEST_TYPE_8_CNT,
					RRC_REQUEST_TYPE_NOT_1_8,RRC_REQUEST_TYPE_NOT_1_8_CNT,E_RAB_SETUP_FAILURE,
					CALL_STATUS_2,CALL_STATUS_3,CALL_STATUS_124,DURATION_M30,DURATION_L10,DURATION_L30,DURATION_L1,
					RRC_SETUP_FAILURE_EVENT,IRAT_TO_GERAN_ATTEMPT,IRAT_TO_GERAN_SUCCESS,IRAT_TO_UMTS_ATTEMPT,IRAT_TO_UMTS_SUCCESS,SERVING_CNT 
				)
				SELECT 
					DATA_DATE,
					DATA_HOUR,
					CALL_TYPE,
					CALL_STATUS,
					MOVING,
					IFNULL(INDOOR,99),
					POS_LAST_S_SUB_REGION,
					POS_LAST_S_EUTRABAND,
					POS_LAST_S_EARFCN,
					POS_LAST_S_ENODEB,
					POS_LAST_S_CELL,
					POS_LAST_S_CELL_NAME,
					SUM(DURATION) AS DURATION,
					SUM(IF(IRAT_TO_GERAN_SUCCESS=1,POS_LAST_RSRP,NULL)) AS IRAT_TO_GERAN_SUCCESS_1_RSRP,
					SUM(IF(IRAT_TO_GERAN_SUCCESS=1 AND POS_LAST_RSRP IS NOT NULL,1,NULL)) AS IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT,
					SUM(IF(IRAT_TO_GERAN_SUCCESS=1,POS_LAST_RSRQ,NULL)) AS IRAT_TO_GERAN_SUCCESS_1_RSRQ,
					SUM(IF(IRAT_TO_GERAN_SUCCESS=1 AND POS_LAST_RSRQ IS NOT NULL,1,NULL)) AS IRAT_TO_GERAN_SUCCESS_1_RSRQ_CNT,
					SUM(IF(IRAT_TO_GERAN_SUCCESS=1,POS_LAST_RSSI,NULL)) AS IRAT_TO_GERAN_SUCCESS_1_RSSI,
					SUM(IF(IRAT_TO_GERAN_SUCCESS=1 AND POS_LAST_RSSI IS NOT NULL,1,NULL)) AS IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT,
					SUM(IF(IRAT_TO_UMTS_SUCCESS=1,POS_LAST_ECN0,NULL)) AS IRAT_TO_UMTS_SUCCESS_1_ECN0,
					SUM(IF(IRAT_TO_UMTS_SUCCESS=1 AND POS_LAST_ECN0 IS NOT NULL,1,NULL)) AS IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT,
					SUM(IF(IRAT_TO_UMTS_SUCCESS=1,POS_LAST_RSCP,NULL)) AS IRAT_TO_UMTS_SUCCESS_1_RSCP,
					SUM(IF(IRAT_TO_UMTS_SUCCESS=1 AND POS_LAST_RSCP IS NOT NULL,1,NULL)) AS IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT,
					SUM(IF(IRAT_TO_UMTS_SUCCESS=1,POS_LAST_RSRP,NULL)) AS IRAT_TO_UMTS_SUCCESS_1_RSRP,
					SUM(IF(IRAT_TO_UMTS_SUCCESS=1 AND POS_LAST_RSRP IS NOT NULL,1,NULL)) AS IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT,
					SUM(IF(IRAT_TO_UMTS_SUCCESS=1,POS_LAST_RSRQ,NULL)) AS IRAT_TO_UMTS_SUCCESS_1_RSRQ,
					SUM(IF(IRAT_TO_UMTS_SUCCESS=1 AND POS_LAST_RSRQ IS NOT NULL,1,NULL)) AS IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT,
					SUM(IF(RRC_REQUEST_TYPE=1,DURATION,NULL)) AS RRC_REQUEST_TYPE_1,
					SUM(IF(RRC_REQUEST_TYPE=1,1,NULL)) AS RRC_REQUEST_TYPE_1_CNT,
					SUM(IF(RRC_REQUEST_TYPE=2,DURATION,NULL)) AS RRC_REQUEST_TYPE_2,
					SUM(IF(RRC_REQUEST_TYPE=2,1,NULL)) AS RRC_REQUEST_TYPE_2_CNT,
					SUM(IF(RRC_REQUEST_TYPE=3,DURATION,NULL)) AS RRC_REQUEST_TYPE_3,
					SUM(IF(RRC_REQUEST_TYPE=3,1,NULL)) AS RRC_REQUEST_TYPE_3_CNT,
					SUM(IF(RRC_REQUEST_TYPE=4,DURATION,NULL)) AS RRC_REQUEST_TYPE_4,
					SUM(IF(RRC_REQUEST_TYPE=4,1,NULL)) AS RRC_REQUEST_TYPE_4_CNT,
					SUM(IF(RRC_REQUEST_TYPE=5,DURATION,NULL)) AS RRC_REQUEST_TYPE_5,
					SUM(IF(RRC_REQUEST_TYPE=5,1,NULL)) AS RRC_REQUEST_TYPE_5_CNT,
					SUM(IF(RRC_REQUEST_TYPE=6,DURATION,NULL)) AS RRC_REQUEST_TYPE_6,
					SUM(IF(RRC_REQUEST_TYPE=6,1,NULL)) AS RRC_REQUEST_TYPE_6_CNT,
					SUM(IF(RRC_REQUEST_TYPE=7,DURATION,NULL)) AS RRC_REQUEST_TYPE_7,
					SUM(IF(RRC_REQUEST_TYPE=7,1,NULL)) AS RRC_REQUEST_TYPE_7_CNT,
					SUM(IF(RRC_REQUEST_TYPE=8,DURATION,NULL)) AS RRC_REQUEST_TYPE_8,
					SUM(IF(RRC_REQUEST_TYPE=8,1,NULL)) AS RRC_REQUEST_TYPE_8_CNT,
					SUM(IF(RRC_REQUEST_TYPE NOT IN (1,2,3,4,5,6,7,8),DURATION,NULL)) AS RRC_REQUEST_TYPE_NOT_1_8,
					SUM(IF(RRC_REQUEST_TYPE NOT IN (1,2,3,4,5,6,7,8),1,NULL)) AS RRC_REQUEST_TYPE_NOT_1_8_CNT,
					SUM(E_RAB_SETUP_FAILURE) AS E_RAB_SETUP_FAILURE,
					SUM(IF(CALL_STATUS=2,1,0)) AS CALL_STATUS_2,
					SUM(IF(CALL_STATUS=3,1,0)) AS CALL_STATUS_3,
					SUM(IF(CALL_STATUS IN (1,2,4),1,0)) AS CALL_STATUS_124,
					SUM(IF(1800000000<=DURATION,1,0)) AS DURATION_M30,
					SUM(IF(60000000<=DURATION AND DURATION<600000000,1,0)) AS DURATION_L10,
					SUM(IF(600000000<=DURATION AND DURATION<1800000000,1,0)) AS DURATION_L30,
					SUM(IF(DURATION<60000000,1,0)) AS DURATION_L1,
					SUM(IF(RRC_SETUP_FAILURE_EVENT IS NOT NULL,1,0)) AS RRC_SETUP_FAILURE_EVENT,
					SUM(IRAT_TO_GERAN_ATTEMPT) AS IRAT_TO_GERAN_ATTEMPT,
					SUM(IRAT_TO_GERAN_SUCCESS) AS IRAT_TO_GERAN_SUCCESS,
					SUM(IRAT_TO_UMTS_ATTEMPT) AS IRAT_TO_UMTS_ATTEMPT,
					SUM(IRAT_TO_UMTS_SUCCESS) AS IRAT_TO_UMTS_SUCCESS,
					COUNT(*) AS SERVING_CNT
				FROM ',GT_DB,'.`table_call_end_lte`
				WHERE POS_LAST_S_CELL IS NOT NULL 
				AND DATA_HOUR >= ',STARTHOUR,' AND DATA_HOUR < ',ENDHOUR,'
				GROUP BY 
					DATA_DATE,
					DATA_HOUR,
					CALL_TYPE,
					CALL_STATUS,
					MOVING,
					IFNULL(INDOOR,99),
					POS_LAST_S_SUB_REGION,
					POS_LAST_S_EUTRABAND,
					POS_LAST_S_EARFCN,
					POS_LAST_S_ENODEB,
					POS_LAST_S_CELL,
					POS_LAST_S_CELL_NAME
				ORDER BY NULL;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('INSERT INTO ',GT_DB,'.rpt_cell_end_',WORKER_ID,'
				(DATA_DATE,DATA_HOUR,CALL_TYPE,CALL_STATUS,MOVING,INDOOR,SUB_REGION_ID,EUTRABAND,
				EARFCN,ENODEB_ID,CELL_ID,CELL_NAME,POS_LAST_RSRP,POS_LAST_RSRP_CNT,
				POS_LAST_RSRQ,POS_LAST_RSRQ_CNT,MEASURE_CNT)
				SELECT 
					DATA_DATE,
					DATA_HOUR,
					CALL_TYPE,
					CALL_STATUS,
					MOVING,
					IFNULL(INDOOR,99),
					POS_LAST_SUB_REGION AS SUB_REGION,
					POS_LAST_EUTRABAND AS EUTRABAND,
					POS_LAST_EARFCN,
					POS_LAST_ENODEB,
					POS_LAST_CELL,
					POS_LAST_CELL_NAME,
					SUM(POS_LAST_RSRP) AS POS_LAST_RSRP,
					COUNT(POS_LAST_RSRP) AS POS_LAST_RSRP_CNT,
					SUM(POS_LAST_RSRQ) AS POS_LAST_RSRQ,
					COUNT(POS_LAST_RSRQ) AS POS_LAST_RSRQ_CNT,
					COUNT(*) AS MEASURE_CNT
				FROM ',GT_DB,'.table_call_end_lte
				WHERE POS_LAST_CELL IS NOT NULL	
				AND DATA_HOUR >= ',STARTHOUR,' AND DATA_HOUR < ',ENDHOUR,'
				GROUP BY DATA_DATE,
					DATA_HOUR,
					CALL_TYPE,
					CALL_STATUS,
					MOVING,
					IFNULL(INDOOR,99),
					POS_LAST_SUB_REGION,
					POS_LAST_EUTRABAND,
					POS_LAST_EARFCN,
					POS_LAST_ENODEB,
					POS_LAST_CELL,
					POS_LAST_CELL_NAME
				ORDER BY NULL
				ON DUPLICATE KEY UPDATE 
				',GT_DB,'.rpt_cell_end_',WORKER_ID,'.POS_LAST_RSRP=',GT_DB,'.rpt_cell_end_',WORKER_ID,'.POS_LAST_RSRP+VALUES(POS_LAST_RSRP),
				',GT_DB,'.rpt_cell_end_',WORKER_ID,'.POS_LAST_RSRP_CNT=',GT_DB,'.rpt_cell_end_',WORKER_ID,'.POS_LAST_RSRP_CNT+VALUES(POS_LAST_RSRP_CNT),
				',GT_DB,'.rpt_cell_end_',WORKER_ID,'.POS_LAST_RSRQ=',GT_DB,'.rpt_cell_end_',WORKER_ID,'.POS_LAST_RSRQ+VALUES(POS_LAST_RSRQ),
				',GT_DB,'.rpt_cell_end_',WORKER_ID,'.POS_LAST_RSRQ_CNT=',GT_DB,'.rpt_cell_end_',WORKER_ID,'.POS_LAST_RSRQ_CNT+VALUES(POS_LAST_RSRQ_CNT),
				',GT_DB,'.rpt_cell_end_',WORKER_ID,'.MEASURE_CNT=',GT_DB,'.rpt_cell_end_',WORKER_ID,'.MEASURE_CNT+VALUES(MEASURE_CNT)
				;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	SET @SqlCmd=CONCAT('REPLACE INTO ',GT_DB,'.rpt_cell_end
		SELECT
			B.DATA_DATE,
			B.DATA_HOUR,
			B.CALL_TYPE,
			B.CALL_STATUS,
			B.MOVING,
			B.INDOOR,
			B.SUB_REGION_ID,
			B.EUTRABAND,
			B.EARFCN,
			B.ENODEB_ID,
			B.CELL_ID,
			B.CELL_NAME,
			IFNULL(A.POS_LAST_RSRP,0)+IFNULL(B.POS_LAST_RSRP,0) AS POS_LAST_RSRP,
			IFNULL(A.POS_LAST_RSRP_CNT,0)+IFNULL(B.POS_LAST_RSRP_CNT,0) AS POS_LAST_RSRP_CNT,
			IFNULL(A.POS_LAST_RSRQ,0)+IFNULL(B.POS_LAST_RSRQ,0) AS POS_LAST_RSRQ,
			IFNULL(A.POS_LAST_RSRQ_CNT,0)+IFNULL(B.POS_LAST_RSRQ_CNT,0) AS POS_LAST_RSRQ_CNT,
			IFNULL(A.MEASURE_CNT,0) +IFNULL(B.MEASURE_CNT,0) AS MEASURE_CNT,
			IFNULL(A.DURATION,0)+IFNULL(B.DURATION,0) AS DURATION,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSRP,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSRP,0) AS IRAT_TO_GERAN_SUCCESS_1_RSRP,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT,0) AS IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSRQ,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSRQ,0) AS IRAT_TO_GERAN_SUCCESS_1_RSRQ,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSRQ_CNT,0) +IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSRQ_CNT,0) AS IRAT_TO_GERAN_SUCCESS_1_RSRQ_CNT,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSSI,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSSI,0) AS IRAT_TO_GERAN_SUCCESS_1_RSSI,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT,0) AS IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_ECN0,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_ECN0,0) AS IRAT_TO_UMTS_SUCCESS_1_ECN0,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT,0) +IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT,0) AS IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSCP,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSCP,0) AS IRAT_TO_UMTS_SUCCESS_1_RSCP,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT,0) AS IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSRP,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSRP,0) AS IRAT_TO_UMTS_SUCCESS_1_RSRP,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT,0) AS IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSRQ,0) +IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSRQ,0) AS IRAT_TO_UMTS_SUCCESS_1_RSRQ,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT,0) +IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT,0) AS IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_1,0)+IFNULL(B.RRC_REQUEST_TYPE_1,0) AS RRC_REQUEST_TYPE_1,
			IFNULL(A.RRC_REQUEST_TYPE_1_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_1_CNT,0) AS RRC_REQUEST_TYPE_1_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_2,0)+IFNULL(B.RRC_REQUEST_TYPE_2,0) AS RRC_REQUEST_TYPE_2,
			IFNULL(A.RRC_REQUEST_TYPE_2_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_2_CNT,0) AS RRC_REQUEST_TYPE_2_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_3,0)+IFNULL(B.RRC_REQUEST_TYPE_3,0) AS RRC_REQUEST_TYPE_3,
			IFNULL(A.RRC_REQUEST_TYPE_3_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_3_CNT,0) AS RRC_REQUEST_TYPE_3_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_4,0)+IFNULL(B.RRC_REQUEST_TYPE_4,0) AS RRC_REQUEST_TYPE_4,
			IFNULL(A.RRC_REQUEST_TYPE_4_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_4_CNT,0) AS RRC_REQUEST_TYPE_4_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_5,0)+IFNULL(B.RRC_REQUEST_TYPE_5,0) AS RRC_REQUEST_TYPE_5,
			IFNULL(A.RRC_REQUEST_TYPE_5_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_5_CNT,0) AS RRC_REQUEST_TYPE_5_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_6,0)+IFNULL(B.RRC_REQUEST_TYPE_6,0) AS RRC_REQUEST_TYPE_6,
			IFNULL(A.RRC_REQUEST_TYPE_6_CNT,0) +IFNULL(B.RRC_REQUEST_TYPE_6_CNT,0) AS RRC_REQUEST_TYPE_6_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_7,0) +IFNULL(B.RRC_REQUEST_TYPE_7,0) AS RRC_REQUEST_TYPE_7,
			IFNULL(A.RRC_REQUEST_TYPE_7_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_7_CNT,0) AS RRC_REQUEST_TYPE_7_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_8,0) +IFNULL(B.RRC_REQUEST_TYPE_8,0) AS RRC_REQUEST_TYPE_8,
			IFNULL(A.RRC_REQUEST_TYPE_8_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_8_CNT,0) AS RRC_REQUEST_TYPE_8_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_NOT_1_8,0) +IFNULL(B.RRC_REQUEST_TYPE_NOT_1_8,0) AS RRC_REQUEST_TYPE_NOT_1_8,
			IFNULL(A.RRC_REQUEST_TYPE_NOT_1_8_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_NOT_1_8_CNT,0) AS RRC_REQUEST_TYPE_NOT_1_8_CNT,
			IFNULL(A.E_RAB_SETUP_FAILURE,0)+IFNULL(B.E_RAB_SETUP_FAILURE,0) AS E_RAB_SETUP_FAILURE,
			IFNULL(A.CALL_STATUS_2,0)+IFNULL(B.CALL_STATUS_2,0) AS CALL_STATUS_2,
			IFNULL(A.CALL_STATUS_3,0) +IFNULL(B.CALL_STATUS_3,0) AS CALL_STATUS_3,
			IFNULL(A.CALL_STATUS_124,0) +IFNULL(B.CALL_STATUS_124,0) AS CALL_STATUS_124,
			IFNULL(A.DURATION_M30,0) +IFNULL(B.DURATION_M30,0) AS DURATION_M30,
			IFNULL(A.DURATION_L10,0)+IFNULL(B.DURATION_L10,0) AS DURATION_L10,
			IFNULL(A.DURATION_L30,0)+IFNULL(B.DURATION_L30,0) AS DURATION_L30,
			IFNULL(A.DURATION_L1,0)+IFNULL(B.DURATION_L1,0) AS DURATION_L1,
			IFNULL(A.RRC_SETUP_FAILURE_EVENT,0)+IFNULL(B.RRC_SETUP_FAILURE_EVENT,0) AS RRC_SETUP_FAILURE_EVENT,
			IFNULL(A.IRAT_TO_GERAN_ATTEMPT,0)+IFNULL(B.IRAT_TO_GERAN_ATTEMPT,0) AS IRAT_TO_GERAN_ATTEMPT,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS,0) AS IRAT_TO_GERAN_SUCCESS,
			IFNULL(A.IRAT_TO_UMTS_ATTEMPT,0)+IFNULL(B.IRAT_TO_UMTS_ATTEMPT,0) AS IRAT_TO_UMTS_ATTEMPT,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS,0) AS IRAT_TO_UMTS_SUCCESS,
			IFNULL(A.SERVING_CNT,0)+IFNULL(B.SERVING_CNT,0) AS SERVING_CNT
		FROM ',GT_DB,'.rpt_cell_end A RIGHT JOIN ',GT_DB,'.rpt_cell_end_',WORKER_ID,' B
		ON  A.`DATA_HOUR`    =B.`DATA_HOUR`    
		AND A.`ENODEB_ID`    =B.`ENODEB_ID`    
		AND A.`CELL_ID`       =B.`CELL_ID`     
		AND A.`CALL_TYPE`    =B.`CALL_TYPE`    
		AND A.`CALL_STATUS`  =B.`CALL_STATUS`  
		AND A.`MOVING`	     =B.`MOVING`	     
		AND A.`INDOOR`	     =B.`INDOOR`	     
		AND A.`SUB_REGION_ID`=B.`SUB_REGION_ID`
		AND A.`EUTRABAND`	 =B.`EUTRABAND`	   
		AND A.`EARFCN`		 =B.`EARFCN`		   
		AND A.`CELL_NAME`	 =B.`CELL_NAME`	   
		;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	SET @SqlCmd=CONCAT('REPLACE INTO ',GT_DB,'.rpt_cell_end_dy
		    SELECT
			B.DATA_DATE,
			B.CALL_TYPE,
			B.CALL_STATUS,
			B.MOVING,
			B.INDOOR,
			B.SUB_REGION_ID,
			B.EUTRABAND,
			B.EARFCN,
			B.ENODEB_ID,
			B.CELL_ID,
			B.CELL_NAME,
			IFNULL(A.POS_LAST_RSRP,0)+IFNULL(B.POS_LAST_RSRP,0) AS POS_LAST_RSRP,
			IFNULL(A.POS_LAST_RSRP_CNT,0)+IFNULL(B.POS_LAST_RSRP_CNT,0) AS POS_LAST_RSRP_CNT,
			IFNULL(A.POS_LAST_RSRQ,0)+IFNULL(B.POS_LAST_RSRQ,0) AS POS_LAST_RSRQ,
			IFNULL(A.POS_LAST_RSRQ_CNT,0)+IFNULL(B.POS_LAST_RSRQ_CNT,0) AS POS_LAST_RSRQ_CNT,
			IFNULL(A.MEASURE_CNT,0) +IFNULL(B.MEASURE_CNT,0) AS MEASURE_CNT,
			IFNULL(A.DURATION,0)+IFNULL(B.DURATION,0) AS DURATION,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSRP,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSRP,0) AS IRAT_TO_GERAN_SUCCESS_1_RSRP,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT,0) AS IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSRQ,0) +IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSRQ,0)AS IRAT_TO_GERAN_SUCCESS_1_RSRQ,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSRQ_CNT,0) +IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSRQ_CNT,0) AS IRAT_TO_GERAN_SUCCESS_1_RSRQ_CNT,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSSI,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSSI,0) AS IRAT_TO_GERAN_SUCCESS_1_RSSI,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT,0) AS IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_ECN0,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_ECN0,0) AS IRAT_TO_UMTS_SUCCESS_1_ECN0,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT,0) +IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT,0) AS IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSCP,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSCP,0) AS IRAT_TO_UMTS_SUCCESS_1_RSCP,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT,0) AS IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSRP,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSRP,0) AS IRAT_TO_UMTS_SUCCESS_1_RSRP,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT,0) AS IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSRQ,0) +IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSRQ,0) AS IRAT_TO_UMTS_SUCCESS_1_RSRQ,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT,0) +IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT,0) AS IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_1,0)+IFNULL(B.RRC_REQUEST_TYPE_1,0) AS RRC_REQUEST_TYPE_1,
			IFNULL(A.RRC_REQUEST_TYPE_1_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_1_CNT,0) AS RRC_REQUEST_TYPE_1_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_2,0)+IFNULL(B.RRC_REQUEST_TYPE_2,0) AS RRC_REQUEST_TYPE_2,
			IFNULL(A.RRC_REQUEST_TYPE_2_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_2_CNT,0) AS RRC_REQUEST_TYPE_2_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_3,0)+IFNULL(B.RRC_REQUEST_TYPE_3,0) AS RRC_REQUEST_TYPE_3,
			IFNULL(A.RRC_REQUEST_TYPE_3_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_3_CNT,0) AS RRC_REQUEST_TYPE_3_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_4,0)+IFNULL(B.RRC_REQUEST_TYPE_4,0) AS RRC_REQUEST_TYPE_4,
			IFNULL(A.RRC_REQUEST_TYPE_4_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_4_CNT,0) AS RRC_REQUEST_TYPE_4_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_5,0)+IFNULL(B.RRC_REQUEST_TYPE_5,0) AS RRC_REQUEST_TYPE_5,
			IFNULL(A.RRC_REQUEST_TYPE_5_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_5_CNT,0) AS RRC_REQUEST_TYPE_5_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_6,0)+IFNULL(B.RRC_REQUEST_TYPE_6,0) AS RRC_REQUEST_TYPE_6,
			IFNULL(A.RRC_REQUEST_TYPE_6_CNT,0) +IFNULL(B.RRC_REQUEST_TYPE_6_CNT,0) AS RRC_REQUEST_TYPE_6_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_7,0) +IFNULL(B.RRC_REQUEST_TYPE_7,0) AS RRC_REQUEST_TYPE_7,
			IFNULL(A.RRC_REQUEST_TYPE_7_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_7_CNT,0) AS RRC_REQUEST_TYPE_7_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_8,0) +IFNULL(B.RRC_REQUEST_TYPE_8,0) AS RRC_REQUEST_TYPE_8,
			IFNULL(A.RRC_REQUEST_TYPE_8_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_8_CNT,0) AS RRC_REQUEST_TYPE_8_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_NOT_1_8,0) +IFNULL(B.RRC_REQUEST_TYPE_NOT_1_8,0) AS RRC_REQUEST_TYPE_NOT_1_8,
			IFNULL(A.RRC_REQUEST_TYPE_NOT_1_8_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_NOT_1_8_CNT,0) AS RRC_REQUEST_TYPE_NOT_1_8_CNT,
			IFNULL(A.E_RAB_SETUP_FAILURE,0)+IFNULL(B.E_RAB_SETUP_FAILURE,0) AS E_RAB_SETUP_FAILURE,
			IFNULL(A.CALL_STATUS_2,0)+IFNULL(B.CALL_STATUS_2,0) AS CALL_STATUS_2,
			IFNULL(A.CALL_STATUS_3,0) +IFNULL(B.CALL_STATUS_3,0) AS CALL_STATUS_3,
			IFNULL(A.CALL_STATUS_124,0) +IFNULL(B.CALL_STATUS_124,0) AS CALL_STATUS_124,
			IFNULL(A.DURATION_M30,0) +IFNULL(B.DURATION_M30,0) AS DURATION_M30,
			IFNULL(A.DURATION_L10,0)+IFNULL(B.DURATION_L10,0) AS DURATION_L10,
			IFNULL(A.DURATION_L30,0)+IFNULL(B.DURATION_L30,0) AS DURATION_L30,
			IFNULL(A.DURATION_L1,0)+IFNULL(B.DURATION_L1,0) AS DURATION_L1,
			IFNULL(A.RRC_SETUP_FAILURE_EVENT,0)+IFNULL(B.RRC_SETUP_FAILURE_EVENT,0) AS RRC_SETUP_FAILURE_EVENT,
			IFNULL(A.IRAT_TO_GERAN_ATTEMPT,0)+IFNULL(B.IRAT_TO_GERAN_ATTEMPT,0) AS IRAT_TO_GERAN_ATTEMPT,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS,0) AS IRAT_TO_GERAN_SUCCESS,
			IFNULL(A.IRAT_TO_UMTS_ATTEMPT,0)+IFNULL(B.IRAT_TO_UMTS_ATTEMPT,0) AS IRAT_TO_UMTS_ATTEMPT,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS,0) AS IRAT_TO_UMTS_SUCCESS,
			IFNULL(A.SERVING_CNT,0)+IFNULL(B.SERVING_CNT,0) AS SERVING_CNT
			FROM ',GT_DB,'.rpt_cell_end_dy A RIGHT JOIN 
			(
				SELECT
					DATA_DATE,
					CALL_TYPE,
					CALL_STATUS,
					MOVING,
					INDOOR,
					SUB_REGION_ID,
					EUTRABAND,
					EARFCN,
					ENODEB_ID,
					CELL_ID,
					CELL_NAME,
					SUM(IFNULL(POS_LAST_RSRP,0)) AS POS_LAST_RSRP,
					SUM(IFNULL(POS_LAST_RSRP_CNT,0)) AS POS_LAST_RSRP_CNT,
					SUM(IFNULL(POS_LAST_RSRQ,0)) AS POS_LAST_RSRQ,
					SUM(IFNULL(POS_LAST_RSRQ_CNT,0)) AS POS_LAST_RSRQ_CNT,
					SUM(IFNULL(MEASURE_CNT,0)) AS MEASURE_CNT,
					SUM(IFNULL(DURATION,0)) AS DURATION,
					SUM(IFNULL(IRAT_TO_GERAN_SUCCESS_1_RSRP,0)) AS IRAT_TO_GERAN_SUCCESS_1_RSRP,
					SUM(IFNULL(IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT,0)) AS IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT,
					SUM(IFNULL(IRAT_TO_GERAN_SUCCESS_1_RSRQ,0)) AS IRAT_TO_GERAN_SUCCESS_1_RSRQ,
					SUM(IFNULL(IRAT_TO_GERAN_SUCCESS_1_RSRQ_CNT,0)) AS IRAT_TO_GERAN_SUCCESS_1_RSRQ_CNT,
					SUM(IFNULL(IRAT_TO_GERAN_SUCCESS_1_RSSI,0)) AS IRAT_TO_GERAN_SUCCESS_1_RSSI,
					SUM(IFNULL(IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT,0)) AS IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT,
					SUM(IFNULL(IRAT_TO_UMTS_SUCCESS_1_ECN0,0)) AS IRAT_TO_UMTS_SUCCESS_1_ECN0,
					SUM(IFNULL(IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT,0)) AS IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT,
					SUM(IFNULL(IRAT_TO_UMTS_SUCCESS_1_RSCP,0)) AS IRAT_TO_UMTS_SUCCESS_1_RSCP,
					SUM(IFNULL(IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT,0)) AS IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT,
					SUM(IFNULL(IRAT_TO_UMTS_SUCCESS_1_RSRP,0)) AS IRAT_TO_UMTS_SUCCESS_1_RSRP,
					SUM(IFNULL(IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT,0)) AS IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT,
					SUM(IFNULL(IRAT_TO_UMTS_SUCCESS_1_RSRQ,0)) AS IRAT_TO_UMTS_SUCCESS_1_RSRQ,
					SUM(IFNULL(IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT,0)) AS IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT,
					SUM(IFNULL(RRC_REQUEST_TYPE_1,0)) AS RRC_REQUEST_TYPE_1,
					SUM(IFNULL(RRC_REQUEST_TYPE_1_CNT,0)) AS RRC_REQUEST_TYPE_1_CNT,
					SUM(IFNULL(RRC_REQUEST_TYPE_2,0)) AS RRC_REQUEST_TYPE_2,
					SUM(IFNULL(RRC_REQUEST_TYPE_2_CNT,0)) AS RRC_REQUEST_TYPE_2_CNT,
					SUM(IFNULL(RRC_REQUEST_TYPE_3,0)) AS RRC_REQUEST_TYPE_3,
					SUM(IFNULL(RRC_REQUEST_TYPE_3_CNT,0)) AS RRC_REQUEST_TYPE_3_CNT,
					SUM(IFNULL(RRC_REQUEST_TYPE_4,0)) AS RRC_REQUEST_TYPE_4,
					SUM(IFNULL(RRC_REQUEST_TYPE_4_CNT,0)) AS RRC_REQUEST_TYPE_4_CNT,
					SUM(IFNULL(RRC_REQUEST_TYPE_5,0)) AS RRC_REQUEST_TYPE_5,
					SUM(IFNULL(RRC_REQUEST_TYPE_5_CNT,0)) AS RRC_REQUEST_TYPE_5_CNT,
					SUM(IFNULL(RRC_REQUEST_TYPE_6,0)) AS RRC_REQUEST_TYPE_6,
					SUM(IFNULL(RRC_REQUEST_TYPE_6_CNT,0)) AS RRC_REQUEST_TYPE_6_CNT,
					SUM(IFNULL(RRC_REQUEST_TYPE_7,0)) AS RRC_REQUEST_TYPE_7,
					SUM(IFNULL(RRC_REQUEST_TYPE_7_CNT,0)) AS RRC_REQUEST_TYPE_7_CNT,
					SUM(IFNULL(RRC_REQUEST_TYPE_8,0)) AS RRC_REQUEST_TYPE_8,
					SUM(IFNULL(RRC_REQUEST_TYPE_8_CNT,0)) AS RRC_REQUEST_TYPE_8_CNT,
					SUM(IFNULL(RRC_REQUEST_TYPE_NOT_1_8,0)) AS RRC_REQUEST_TYPE_NOT_1_8,
					SUM(IFNULL(RRC_REQUEST_TYPE_NOT_1_8_CNT,0)) AS RRC_REQUEST_TYPE_NOT_1_8_CNT,
					SUM(IFNULL(E_RAB_SETUP_FAILURE,0)) AS E_RAB_SETUP_FAILURE,
					SUM(IFNULL(CALL_STATUS_2,0)) AS CALL_STATUS_2,
					SUM(IFNULL(CALL_STATUS_3,0)) AS CALL_STATUS_3,
					SUM(IFNULL(CALL_STATUS_124,0)) AS CALL_STATUS_124,
					SUM(IFNULL(DURATION_M30,0)) AS DURATION_M30,
					SUM(IFNULL(DURATION_L10,0)) AS DURATION_L10,
					SUM(IFNULL(DURATION_L30,0)) AS DURATION_L30,
					SUM(IFNULL(DURATION_L1,0)) AS DURATION_L1,
					SUM(IFNULL(RRC_SETUP_FAILURE_EVENT,0)) AS RRC_SETUP_FAILURE_EVENT,
					SUM(IFNULL(IRAT_TO_GERAN_ATTEMPT,0)) AS IRAT_TO_GERAN_ATTEMPT,
					SUM(IFNULL(IRAT_TO_GERAN_SUCCESS,0)) AS IRAT_TO_GERAN_SUCCESS,
					SUM(IFNULL(IRAT_TO_UMTS_ATTEMPT,0)) AS IRAT_TO_UMTS_ATTEMPT,
					SUM(IFNULL(IRAT_TO_UMTS_SUCCESS,0)) AS IRAT_TO_UMTS_SUCCESS,
					SUM(IFNULL(SERVING_CNT,0)) AS SERVING_CNT
				FROM ',GT_DB,'.rpt_cell_end_',WORKER_ID,' FORCE INDEX (IX_CELL_DY)
				GROUP BY `ENODEB_ID`,`CELL_ID`,`CALL_TYPE`,`CALL_STATUS`,`MOVING`,`INDOOR`,`SUB_REGION_ID`,`EUTRABAND`,`EARFCN`,`CELL_NAME`,`DATA_DATE`
			) B 
			ON A.`ENODEB_ID`    =B.`ENODEB_ID`    
			AND A.`CELL_ID`       =B.`CELL_ID`       
			AND A.`CALL_TYPE`    =B.`CALL_TYPE`    
			AND A.`CALL_STATUS`  =B.`CALL_STATUS`  
			AND A.`MOVING`	     =B.`MOVING`	     
			AND A.`INDOOR`	     =B.`INDOOR`	     
			AND A.`SUB_REGION_ID`=B.`SUB_REGION_ID`
			AND A.`EUTRABAND`	 =B.`EUTRABAND`	   
			AND A.`EARFCN`		 =B.`EARFCN`		   
			AND A.`CELL_NAME`	 =B.`CELL_NAME`	   
		;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',GT_DB,'.rpt_cell_end_',WORKER_ID,';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',GT_DB,'.rpt_tile_end_',WORKER_ID,';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('CREATE TEMPORARY TABLE ',GT_DB,'.`rpt_tile_end_',WORKER_ID,'` (
	  `DATA_DATE` date NOT NULL,
	  `DATA_HOUR` smallint(6) NOT NULL,
	  `CALL_TYPE` tinyint(4) NOT NULL,
	  `CALL_STATUS` tinyint(4) NOT NULL,
	  `MOVING` tinyint(4) NOT NULL,
	  `INDOOR` tinyint(4) NOT NULL,
	  `TILE_ID` bigint(20) NOT NULL ,
	  `POS_LAST_RSRP` double DEFAULT ''0'',
	  `POS_LAST_RSRP_CNT` int(11) DEFAULT ''0'',
	  `POS_LAST_RSRQ` double DEFAULT ''0'',
	  `POS_LAST_RSRQ_CNT` int(11) DEFAULT ''0'',
	  `MEASURE_CNT` int(11) DEFAULT ''0'',
	  `DURATION` bigint(20) DEFAULT ''0'',
	  `IRAT_TO_GERAN_SUCCESS_1_RSRP` double DEFAULT ''0'',
	  `IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT` int(11) DEFAULT ''0'',
	  `IRAT_TO_GERAN_SUCCESS_1_RSRQ` double DEFAULT ''0'',
	  `IRAT_TO_GERAN_SUCCESS_1_RSRQ_CNT` int(11) DEFAULT ''0'',
	  `IRAT_TO_GERAN_SUCCESS_1_RSSI` double DEFAULT ''0'',
	  `IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT` int(11) DEFAULT ''0'',
	  `IRAT_TO_UMTS_SUCCESS_1_ECN0` double DEFAULT ''0'',
	  `IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT` int(11) DEFAULT ''0'',
	  `IRAT_TO_UMTS_SUCCESS_1_RSCP` double DEFAULT ''0'',
	  `IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT` int(11) DEFAULT ''0'',
	  `IRAT_TO_UMTS_SUCCESS_1_RSRP` double DEFAULT ''0'',
	  `IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT` int(11) DEFAULT ''0'',
	  `IRAT_TO_UMTS_SUCCESS_1_RSRQ` double DEFAULT ''0'',
	  `IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT` int(11) DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_1` double DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_1_CNT` int(11) DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_2` double DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_2_CNT` int(11) DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_3` double DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_3_CNT` int(11) DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_4` double DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_4_CNT` int(11) DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_5` double DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_5_CNT` int(11) DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_6` double DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_6_CNT` int(11) DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_7` double DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_7_CNT` int(11) DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_8` double DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_8_CNT` int(11) DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_NOT_1_8` double DEFAULT ''0'',
	  `RRC_REQUEST_TYPE_NOT_1_8_CNT` int(11) DEFAULT ''0'',
	  `E_RAB_SETUP_FAILURE` bigint(20) DEFAULT ''0'',
	  `CALL_STATUS_2` int(11) DEFAULT ''0'',
	  `CALL_STATUS_3` int(11) DEFAULT ''0'',
	  `CALL_STATUS_124` int(11) DEFAULT ''0'',
	  `DURATION_M30` int(11) DEFAULT ''0'',
	  `DURATION_L10` int(11) DEFAULT ''0'',
	  `DURATION_L30` int(11) DEFAULT ''0'',
	  `DURATION_L1` int(11) DEFAULT ''0'',
	  `RRC_SETUP_FAILURE_EVENT` int(11) DEFAULT ''0'',
	  `IRAT_TO_GERAN_ATTEMPT` int(11) DEFAULT ''0'',
	  `IRAT_TO_GERAN_SUCCESS` int(11) DEFAULT ''0'',
	  `IRAT_TO_UMTS_ATTEMPT` int(11) DEFAULT ''0'',
	  `IRAT_TO_UMTS_SUCCESS` int(11) DEFAULT ''0'',
	  `SERVING_CNT` int(11) DEFAULT ''0''
	  ,PRIMARY KEY (`DATA_HOUR`,`TILE_ID`,`DATA_DATE`,`CALL_TYPE`,`CALL_STATUS`,`MOVING`,`INDOOR`)
	  ,KEY IX_TILE_DY (`TILE_ID`,`CALL_TYPE`,`CALL_STATUS`,`MOVING`,`INDOOR`,`DATA_DATE`)
	) ENGINE=MYISAM DEFAULT CHARSET=utf8;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	SET @SqlCmd=CONCAT('INSERT INTO ',GT_DB,'.rpt_tile_end_',WORKER_ID,'
				(
					DATA_DATE, DATA_HOUR,CALL_TYPE,CALL_STATUS,MOVING,INDOOR,TILE_ID,
					DURATION,IRAT_TO_GERAN_SUCCESS_1_RSRP,IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT,
					IRAT_TO_GERAN_SUCCESS_1_RSRQ,IRAT_TO_GERAN_SUCCESS_1_RSRQ_CNT,
					IRAT_TO_GERAN_SUCCESS_1_RSSI,IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT,
					IRAT_TO_UMTS_SUCCESS_1_ECN0,IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT,
					IRAT_TO_UMTS_SUCCESS_1_RSCP,IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT,
					IRAT_TO_UMTS_SUCCESS_1_RSRP,IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT,
					IRAT_TO_UMTS_SUCCESS_1_RSRQ,IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT,
					RRC_REQUEST_TYPE_1,RRC_REQUEST_TYPE_1_CNT,RRC_REQUEST_TYPE_2,RRC_REQUEST_TYPE_2_CNT,
					RRC_REQUEST_TYPE_3,RRC_REQUEST_TYPE_3_CNT,RRC_REQUEST_TYPE_4,RRC_REQUEST_TYPE_4_CNT,
					RRC_REQUEST_TYPE_5,RRC_REQUEST_TYPE_5_CNT,RRC_REQUEST_TYPE_6,RRC_REQUEST_TYPE_6_CNT,
					RRC_REQUEST_TYPE_7,RRC_REQUEST_TYPE_7_CNT,RRC_REQUEST_TYPE_8,RRC_REQUEST_TYPE_8_CNT,
					RRC_REQUEST_TYPE_NOT_1_8,RRC_REQUEST_TYPE_NOT_1_8_CNT,E_RAB_SETUP_FAILURE,
					CALL_STATUS_2,CALL_STATUS_3,CALL_STATUS_124,DURATION_M30,DURATION_L10,DURATION_L30,DURATION_L1,
					RRC_SETUP_FAILURE_EVENT,IRAT_TO_GERAN_ATTEMPT,IRAT_TO_GERAN_SUCCESS,IRAT_TO_UMTS_ATTEMPT,IRAT_TO_UMTS_SUCCESS,SERVING_CNT 
				)
				SELECT 
					DATA_DATE,
					DATA_HOUR,
					CALL_TYPE,
					CALL_STATUS,
					MOVING,
					IFNULL(INDOOR,99),
					POS_LAST_S_TILE,
					SUM(DURATION) AS DURATION,
					SUM(IF(IRAT_TO_GERAN_SUCCESS=1,POS_LAST_RSRP,NULL)) AS IRAT_TO_GERAN_SUCCESS_1_RSRP,
					SUM(IF(IRAT_TO_GERAN_SUCCESS=1 AND POS_LAST_RSRP IS NOT NULL,1,NULL)) AS IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT,
					SUM(IF(IRAT_TO_GERAN_SUCCESS=1,POS_LAST_RSRQ,NULL)) AS IRAT_TO_GERAN_SUCCESS_1_RSRQ,
					SUM(IF(IRAT_TO_GERAN_SUCCESS=1 AND POS_LAST_RSRQ IS NOT NULL,1,NULL)) AS IRAT_TO_GERAN_SUCCESS_1_RSRQ_CNT,
					SUM(IF(IRAT_TO_GERAN_SUCCESS=1,POS_LAST_RSSI,NULL)) AS IRAT_TO_GERAN_SUCCESS_1_RSSI,
					SUM(IF(IRAT_TO_GERAN_SUCCESS=1 AND POS_LAST_RSSI IS NOT NULL,1,NULL)) AS IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT,
					SUM(IF(IRAT_TO_UMTS_SUCCESS=1,POS_LAST_ECN0,NULL)) AS IRAT_TO_UMTS_SUCCESS_1_ECN0,
					SUM(IF(IRAT_TO_UMTS_SUCCESS=1 AND POS_LAST_ECN0 IS NOT NULL,1,NULL)) AS IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT,
					SUM(IF(IRAT_TO_UMTS_SUCCESS=1,POS_LAST_RSCP,NULL)) AS IRAT_TO_UMTS_SUCCESS_1_RSCP,
					SUM(IF(IRAT_TO_UMTS_SUCCESS=1 AND POS_LAST_RSCP IS NOT NULL,1,NULL)) AS IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT,
					SUM(IF(IRAT_TO_UMTS_SUCCESS=1,POS_LAST_RSRP,NULL)) AS IRAT_TO_UMTS_SUCCESS_1_RSRP,
					SUM(IF(IRAT_TO_UMTS_SUCCESS=1 AND POS_LAST_RSRP IS NOT NULL,1,NULL)) AS IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT,
					SUM(IF(IRAT_TO_UMTS_SUCCESS=1,POS_LAST_RSRQ,NULL)) AS IRAT_TO_UMTS_SUCCESS_1_RSRQ,
					SUM(IF(IRAT_TO_UMTS_SUCCESS=1 AND POS_LAST_RSRQ IS NOT NULL,1,NULL)) AS IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT,
					SUM(IF(RRC_REQUEST_TYPE=1,DURATION,NULL)) AS RRC_REQUEST_TYPE_1,
					SUM(IF(RRC_REQUEST_TYPE=1,1,NULL)) AS RRC_REQUEST_TYPE_1_CNT,
					SUM(IF(RRC_REQUEST_TYPE=2,DURATION,NULL)) AS RRC_REQUEST_TYPE_2,
					SUM(IF(RRC_REQUEST_TYPE=2,1,NULL)) AS RRC_REQUEST_TYPE_2_CNT,
					SUM(IF(RRC_REQUEST_TYPE=3,DURATION,NULL)) AS RRC_REQUEST_TYPE_3,
					SUM(IF(RRC_REQUEST_TYPE=3,1,NULL)) AS RRC_REQUEST_TYPE_3_CNT,
					SUM(IF(RRC_REQUEST_TYPE=4,DURATION,NULL)) AS RRC_REQUEST_TYPE_4,
					SUM(IF(RRC_REQUEST_TYPE=4,1,NULL)) AS RRC_REQUEST_TYPE_4_CNT,
					SUM(IF(RRC_REQUEST_TYPE=5,DURATION,NULL)) AS RRC_REQUEST_TYPE_5,
					SUM(IF(RRC_REQUEST_TYPE=5,1,NULL)) AS RRC_REQUEST_TYPE_5_CNT,
					SUM(IF(RRC_REQUEST_TYPE=6,DURATION,NULL)) AS RRC_REQUEST_TYPE_6,
					SUM(IF(RRC_REQUEST_TYPE=6,1,NULL)) AS RRC_REQUEST_TYPE_6_CNT,
					SUM(IF(RRC_REQUEST_TYPE=7,DURATION,NULL)) AS RRC_REQUEST_TYPE_7,
					SUM(IF(RRC_REQUEST_TYPE=7,1,NULL)) AS RRC_REQUEST_TYPE_7_CNT,
					SUM(IF(RRC_REQUEST_TYPE=8,DURATION,NULL)) AS RRC_REQUEST_TYPE_8,
					SUM(IF(RRC_REQUEST_TYPE=8,1,NULL)) AS RRC_REQUEST_TYPE_8_CNT,
					SUM(IF(RRC_REQUEST_TYPE NOT IN (1,2,3,4,5,6,7,8),DURATION,NULL)) AS RRC_REQUEST_TYPE_NOT_1_8,
					SUM(IF(RRC_REQUEST_TYPE NOT IN (1,2,3,4,5,6,7,8),1,NULL)) AS RRC_REQUEST_TYPE_NOT_1_8_CNT,
					SUM(E_RAB_SETUP_FAILURE) AS E_RAB_SETUP_FAILURE,
					SUM(IF(CALL_STATUS=2,1,0)) AS CALL_STATUS_2,
					SUM(IF(CALL_STATUS=3,1,0)) AS CALL_STATUS_3,
					SUM(IF(CALL_STATUS IN (1,2,4),1,0)) AS CALL_STATUS_124,
					SUM(IF(1800000000<=DURATION,1,0)) AS DURATION_M30,
					SUM(IF(60000000<=DURATION AND DURATION<600000000,1,0)) AS DURATION_L10,
					SUM(IF(600000000<=DURATION AND DURATION<1800000000,1,0)) AS DURATION_L30,
					SUM(IF(DURATION<60000000,1,0)) AS DURATION_L1,
					SUM(IF(RRC_SETUP_FAILURE_EVENT IS NOT NULL,1,0)) AS RRC_SETUP_FAILURE_EVENT,
					SUM(IRAT_TO_GERAN_ATTEMPT) AS IRAT_TO_GERAN_ATTEMPT,
					SUM(IRAT_TO_GERAN_SUCCESS) AS IRAT_TO_GERAN_SUCCESS,
					SUM(IRAT_TO_UMTS_ATTEMPT) AS IRAT_TO_UMTS_ATTEMPT,
					SUM(IRAT_TO_UMTS_SUCCESS) AS IRAT_TO_UMTS_SUCCESS,
					COUNT(*) AS SERVING_CNT
				FROM ',GT_DB,'.`table_call_end_lte`
				WHERE POS_LAST_S_CELL IS NOT NULL 
				AND DATA_HOUR >= ',STARTHOUR,' AND DATA_HOUR < ',ENDHOUR,'
				GROUP BY 
					DATA_DATE,
					DATA_HOUR,
					CALL_TYPE,
					CALL_STATUS,
					MOVING,
					IFNULL(INDOOR,99),
				    POS_LAST_S_TILE
				ORDER BY NULL;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('INSERT INTO ',GT_DB,'.rpt_tile_end_',WORKER_ID,'
				(DATA_DATE,DATA_HOUR,CALL_TYPE,CALL_STATUS,MOVING,INDOOR,TILE_ID,
				POS_LAST_RSRP,POS_LAST_RSRP_CNT,
				POS_LAST_RSRQ,POS_LAST_RSRQ_CNT,MEASURE_CNT)
				SELECT 
					DATA_DATE,
					DATA_HOUR,
					CALL_TYPE,
					CALL_STATUS,
					MOVING,
					IFNULL(INDOOR,99),
					POS_LAST_TILE,
					SUM(POS_LAST_RSRP) AS POS_LAST_RSRP,
					COUNT(POS_LAST_RSRP) AS POS_LAST_RSRP_CNT,
					SUM(POS_LAST_RSRQ) AS POS_LAST_RSRQ,
					COUNT(POS_LAST_RSRQ) AS POS_LAST_RSRQ_CNT,
					COUNT(*) AS MEASURE_CNT
				FROM ',GT_DB,'.table_call_end_lte
				WHERE POS_LAST_CELL IS NOT NULL	
				AND DATA_HOUR >= ',STARTHOUR,' AND DATA_HOUR < ',ENDHOUR,'
				GROUP BY DATA_DATE,
					DATA_HOUR,
					CALL_TYPE,
					CALL_STATUS,
					MOVING,
					IFNULL(INDOOR,99),
					POS_LAST_TILE
				ORDER BY NULL
				ON DUPLICATE KEY UPDATE 
				',GT_DB,'.rpt_tile_end_',WORKER_ID,'.POS_LAST_RSRP=',GT_DB,'.rpt_tile_end_',WORKER_ID,'.POS_LAST_RSRP+VALUES(POS_LAST_RSRP),
				',GT_DB,'.rpt_tile_end_',WORKER_ID,'.POS_LAST_RSRP_CNT=',GT_DB,'.rpt_tile_end_',WORKER_ID,'.POS_LAST_RSRP_CNT+VALUES(POS_LAST_RSRP_CNT),
				',GT_DB,'.rpt_tile_end_',WORKER_ID,'.POS_LAST_RSRQ=',GT_DB,'.rpt_tile_end_',WORKER_ID,'.POS_LAST_RSRQ+VALUES(POS_LAST_RSRQ),
				',GT_DB,'.rpt_tile_end_',WORKER_ID,'.POS_LAST_RSRQ_CNT=',GT_DB,'.rpt_tile_end_',WORKER_ID,'.POS_LAST_RSRQ_CNT+VALUES(POS_LAST_RSRQ_CNT),
				',GT_DB,'.rpt_tile_end_',WORKER_ID,'.MEASURE_CNT=',GT_DB,'.rpt_tile_end_',WORKER_ID,'.MEASURE_CNT+VALUES(MEASURE_CNT)
				;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	SET @SqlCmd=CONCAT('REPLACE INTO ',GT_DB,'.rpt_tile_end
		SELECT
			B.DATA_DATE,
			B.DATA_HOUR,
			B.CALL_TYPE,
			B.CALL_STATUS,
			B.MOVING,
			B.INDOOR,
			B.TILE_ID,
			IFNULL(A.POS_LAST_RSRP,0)+IFNULL(B.POS_LAST_RSRP,0) AS POS_LAST_RSRP,
			IFNULL(A.POS_LAST_RSRP_CNT,0)+IFNULL(B.POS_LAST_RSRP_CNT,0) AS POS_LAST_RSRP_CNT,
			IFNULL(A.POS_LAST_RSRQ,0)+IFNULL(B.POS_LAST_RSRQ,0) AS POS_LAST_RSRQ,
			IFNULL(A.POS_LAST_RSRQ_CNT,0)+IFNULL(B.POS_LAST_RSRQ_CNT,0) AS POS_LAST_RSRQ_CNT,
			IFNULL(A.MEASURE_CNT,0) +IFNULL(B.MEASURE_CNT,0) AS MEASURE_CNT,
			IFNULL(A.DURATION,0)+IFNULL(B.DURATION,0) AS DURATION,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSRP,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSRP,0) AS IRAT_TO_GERAN_SUCCESS_1_RSRP,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT,0) AS IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSRQ,0) AS IRAT_TO_GERAN_SUCCESS_1_RSRQ,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSRQ,0) +IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSRQ_CNT,0) AS IRAT_TO_GERAN_SUCCESS_1_RSRQ_CNT,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSSI,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSSI,0) AS IRAT_TO_GERAN_SUCCESS_1_RSSI,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT,0) AS IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_ECN0,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_ECN0,0) AS IRAT_TO_UMTS_SUCCESS_1_ECN0,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT,0) +IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT,0) AS IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSCP,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSCP,0) AS IRAT_TO_UMTS_SUCCESS_1_RSCP,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT,0) AS IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSRP,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSRP,0) AS IRAT_TO_UMTS_SUCCESS_1_RSRP,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT,0) AS IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSRQ,0) +IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSRQ,0) AS IRAT_TO_UMTS_SUCCESS_1_RSRQ,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT,0) +IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT,0) AS IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_1,0)+IFNULL(B.RRC_REQUEST_TYPE_1,0) AS RRC_REQUEST_TYPE_1,
			IFNULL(A.RRC_REQUEST_TYPE_1_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_1_CNT,0) AS RRC_REQUEST_TYPE_1_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_2,0)+IFNULL(B.RRC_REQUEST_TYPE_2,0) AS RRC_REQUEST_TYPE_2,
			IFNULL(A.RRC_REQUEST_TYPE_2_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_2_CNT,0) AS RRC_REQUEST_TYPE_2_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_3,0)+IFNULL(B.RRC_REQUEST_TYPE_3,0) AS RRC_REQUEST_TYPE_3,
			IFNULL(A.RRC_REQUEST_TYPE_3_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_3_CNT,0) AS RRC_REQUEST_TYPE_3_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_4,0)+IFNULL(B.RRC_REQUEST_TYPE_4,0) AS RRC_REQUEST_TYPE_4,
			IFNULL(A.RRC_REQUEST_TYPE_4_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_4_CNT,0) AS RRC_REQUEST_TYPE_4_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_5,0)+IFNULL(B.RRC_REQUEST_TYPE_5,0) AS RRC_REQUEST_TYPE_5,
			IFNULL(A.RRC_REQUEST_TYPE_5_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_5_CNT,0) AS RRC_REQUEST_TYPE_5_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_6,0)+IFNULL(B.RRC_REQUEST_TYPE_6,0) AS RRC_REQUEST_TYPE_6,
			IFNULL(A.RRC_REQUEST_TYPE_6_CNT,0) +IFNULL(B.RRC_REQUEST_TYPE_6_CNT,0) AS RRC_REQUEST_TYPE_6_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_7,0) +IFNULL(B.RRC_REQUEST_TYPE_7,0) AS RRC_REQUEST_TYPE_7,
			IFNULL(A.RRC_REQUEST_TYPE_7_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_7_CNT,0) AS RRC_REQUEST_TYPE_7_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_8,0) +IFNULL(B.RRC_REQUEST_TYPE_8,0) AS RRC_REQUEST_TYPE_8,
			IFNULL(A.RRC_REQUEST_TYPE_8_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_8_CNT,0) AS RRC_REQUEST_TYPE_8_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_NOT_1_8,0) +IFNULL(B.RRC_REQUEST_TYPE_NOT_1_8,0) AS RRC_REQUEST_TYPE_NOT_1_8,
			IFNULL(A.RRC_REQUEST_TYPE_NOT_1_8_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_NOT_1_8_CNT,0) AS RRC_REQUEST_TYPE_NOT_1_8_CNT,
			IFNULL(A.E_RAB_SETUP_FAILURE,0)+IFNULL(B.E_RAB_SETUP_FAILURE,0) AS E_RAB_SETUP_FAILURE,
			IFNULL(A.CALL_STATUS_2,0)+IFNULL(B.CALL_STATUS_2,0) AS CALL_STATUS_2,
			IFNULL(A.CALL_STATUS_3,0) +IFNULL(B.CALL_STATUS_3,0) AS CALL_STATUS_3,
			IFNULL(A.CALL_STATUS_124,0) +IFNULL(B.CALL_STATUS_124,0) AS CALL_STATUS_124,
			IFNULL(A.DURATION_M30,0) +IFNULL(B.DURATION_M30,0) AS DURATION_M30,
			IFNULL(A.DURATION_L10,0)+IFNULL(B.DURATION_L10,0) AS DURATION_L10,
			IFNULL(A.DURATION_L30,0)+IFNULL(B.DURATION_L30,0) AS DURATION_L30,
			IFNULL(A.DURATION_L1,0)+IFNULL(B.DURATION_L1,0) AS DURATION_L1,
			IFNULL(A.RRC_SETUP_FAILURE_EVENT,0)+IFNULL(B.RRC_SETUP_FAILURE_EVENT,0) AS RRC_SETUP_FAILURE_EVENT,
			IFNULL(A.IRAT_TO_GERAN_ATTEMPT,0)+IFNULL(B.IRAT_TO_GERAN_ATTEMPT,0) AS IRAT_TO_GERAN_ATTEMPT,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS,0) AS IRAT_TO_GERAN_SUCCESS,
			IFNULL(A.IRAT_TO_UMTS_ATTEMPT,0)+IFNULL(B.IRAT_TO_UMTS_ATTEMPT,0) AS IRAT_TO_UMTS_ATTEMPT,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS,0) AS IRAT_TO_UMTS_SUCCESS,
			IFNULL(A.SERVING_CNT,0)+IFNULL(B.SERVING_CNT,0) AS SERVING_CNT
		FROM ',GT_DB,'.rpt_tile_end A RIGHT JOIN ',GT_DB,'.rpt_tile_end_',WORKER_ID,' B
		ON  A.`DATA_HOUR`    =B.`DATA_HOUR`    
		AND A.`TILE_ID`    =B.`TILE_ID`    
		AND A.`DATA_DATE`    =B.`DATA_DATE`    
		AND A.`CALL_TYPE`    =B.`CALL_TYPE`    
		AND A.`CALL_STATUS`  =B.`CALL_STATUS`  
		AND A.`MOVING`	     =B.`MOVING`	     
		AND A.`INDOOR`	     =B.`INDOOR`	     
		;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	SET @SqlCmd=CONCAT('REPLACE INTO ',GT_DB,'.rpt_tile_end_dy
		    SELECT
			B.DATA_DATE,
			B.CALL_TYPE,
			B.CALL_STATUS,
			B.MOVING,
			B.INDOOR,
			B.TILE_ID,
			IFNULL(A.POS_LAST_RSRP,0)+IFNULL(B.POS_LAST_RSRP,0) AS POS_LAST_RSRP,
			IFNULL(A.POS_LAST_RSRP_CNT,0)+IFNULL(B.POS_LAST_RSRP_CNT,0) AS POS_LAST_RSRP_CNT,
			IFNULL(A.POS_LAST_RSRQ,0)+IFNULL(B.POS_LAST_RSRQ,0) AS POS_LAST_RSRQ,
			IFNULL(A.POS_LAST_RSRQ_CNT,0)+IFNULL(B.POS_LAST_RSRQ_CNT,0) AS POS_LAST_RSRQ_CNT,
			IFNULL(A.MEASURE_CNT,0) +IFNULL(B.MEASURE_CNT,0) AS MEASURE_CNT,
			IFNULL(A.DURATION,0)+IFNULL(B.DURATION,0) AS DURATION,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSRP,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSRP,0) AS IRAT_TO_GERAN_SUCCESS_1_RSRP,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT,0) AS IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSRQ,0) AS IRAT_TO_GERAN_SUCCESS_1_RSRQ,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSRQ,0) +IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSRQ_CNT,0) AS IRAT_TO_GERAN_SUCCESS_1_RSRQ_CNT,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSSI,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSSI,0) AS IRAT_TO_GERAN_SUCCESS_1_RSSI,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT,0) AS IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_ECN0,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_ECN0,0) AS IRAT_TO_UMTS_SUCCESS_1_ECN0,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT,0) +IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT,0) AS IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSCP,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSCP,0) AS IRAT_TO_UMTS_SUCCESS_1_RSCP,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT,0) AS IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSRP,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSRP,0) AS IRAT_TO_UMTS_SUCCESS_1_RSRP,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT,0) AS IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSRQ,0) +IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSRQ,0) AS IRAT_TO_UMTS_SUCCESS_1_RSRQ,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT,0) +IFNULL(B.IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT,0) AS IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_1,0)+IFNULL(B.RRC_REQUEST_TYPE_1,0) AS RRC_REQUEST_TYPE_1,
			IFNULL(A.RRC_REQUEST_TYPE_1_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_1_CNT,0) AS RRC_REQUEST_TYPE_1_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_2,0)+IFNULL(B.RRC_REQUEST_TYPE_2,0) AS RRC_REQUEST_TYPE_2,
			IFNULL(A.RRC_REQUEST_TYPE_2_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_2_CNT,0) AS RRC_REQUEST_TYPE_2_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_3,0)+IFNULL(B.RRC_REQUEST_TYPE_3,0) AS RRC_REQUEST_TYPE_3,
			IFNULL(A.RRC_REQUEST_TYPE_3_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_3_CNT,0) AS RRC_REQUEST_TYPE_3_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_4,0)+IFNULL(B.RRC_REQUEST_TYPE_4,0) AS RRC_REQUEST_TYPE_4,
			IFNULL(A.RRC_REQUEST_TYPE_4_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_4_CNT,0) AS RRC_REQUEST_TYPE_4_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_5,0)+IFNULL(B.RRC_REQUEST_TYPE_5,0) AS RRC_REQUEST_TYPE_5,
			IFNULL(A.RRC_REQUEST_TYPE_5_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_5_CNT,0) AS RRC_REQUEST_TYPE_5_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_6,0)+IFNULL(B.RRC_REQUEST_TYPE_6,0) AS RRC_REQUEST_TYPE_6,
			IFNULL(A.RRC_REQUEST_TYPE_6_CNT,0) +IFNULL(B.RRC_REQUEST_TYPE_6_CNT,0) AS RRC_REQUEST_TYPE_6_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_7,0) +IFNULL(B.RRC_REQUEST_TYPE_7,0) AS RRC_REQUEST_TYPE_7,
			IFNULL(A.RRC_REQUEST_TYPE_7_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_7_CNT,0) AS RRC_REQUEST_TYPE_7_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_8,0) +IFNULL(B.RRC_REQUEST_TYPE_8,0) AS RRC_REQUEST_TYPE_8,
			IFNULL(A.RRC_REQUEST_TYPE_8_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_8_CNT,0) AS RRC_REQUEST_TYPE_8_CNT,
			IFNULL(A.RRC_REQUEST_TYPE_NOT_1_8,0) +IFNULL(B.RRC_REQUEST_TYPE_NOT_1_8,0) AS RRC_REQUEST_TYPE_NOT_1_8,
			IFNULL(A.RRC_REQUEST_TYPE_NOT_1_8_CNT,0)+IFNULL(B.RRC_REQUEST_TYPE_NOT_1_8_CNT,0) AS RRC_REQUEST_TYPE_NOT_1_8_CNT,
			IFNULL(A.E_RAB_SETUP_FAILURE,0)+IFNULL(B.E_RAB_SETUP_FAILURE,0) AS E_RAB_SETUP_FAILURE,
			IFNULL(A.CALL_STATUS_2,0)+IFNULL(B.CALL_STATUS_2,0) AS CALL_STATUS_2,
			IFNULL(A.CALL_STATUS_3,0) +IFNULL(B.CALL_STATUS_3,0) AS CALL_STATUS_3,
			IFNULL(A.CALL_STATUS_124,0) +IFNULL(B.CALL_STATUS_124,0) AS CALL_STATUS_124,
			IFNULL(A.DURATION_M30,0) +IFNULL(B.DURATION_M30,0) AS DURATION_M30,
			IFNULL(A.DURATION_L10,0)+IFNULL(B.DURATION_L10,0) AS DURATION_L10,
			IFNULL(A.DURATION_L30,0)+IFNULL(B.DURATION_L30,0) AS DURATION_L30,
			IFNULL(A.DURATION_L1,0)+IFNULL(B.DURATION_L1,0) AS DURATION_L1,
			IFNULL(A.RRC_SETUP_FAILURE_EVENT,0)+IFNULL(B.RRC_SETUP_FAILURE_EVENT,0) AS RRC_SETUP_FAILURE_EVENT,
			IFNULL(A.IRAT_TO_GERAN_ATTEMPT,0)+IFNULL(B.IRAT_TO_GERAN_ATTEMPT,0) AS IRAT_TO_GERAN_ATTEMPT,
			IFNULL(A.IRAT_TO_GERAN_SUCCESS,0)+IFNULL(B.IRAT_TO_GERAN_SUCCESS,0) AS IRAT_TO_GERAN_SUCCESS,
			IFNULL(A.IRAT_TO_UMTS_ATTEMPT,0)+IFNULL(B.IRAT_TO_UMTS_ATTEMPT,0) AS IRAT_TO_UMTS_ATTEMPT,
			IFNULL(A.IRAT_TO_UMTS_SUCCESS,0)+IFNULL(B.IRAT_TO_UMTS_SUCCESS,0) AS IRAT_TO_UMTS_SUCCESS,
			IFNULL(A.SERVING_CNT,0)+IFNULL(B.SERVING_CNT,0) AS SERVING_CNT
			FROM ',GT_DB,'.rpt_tile_end_dy A RIGHT JOIN 
			(
				SELECT
					DATA_DATE,
					CALL_TYPE,
					CALL_STATUS,
					MOVING,
					INDOOR,
					TILE_ID,
					SUM(IFNULL(POS_LAST_RSRP,0)) AS POS_LAST_RSRP,
					SUM(IFNULL(POS_LAST_RSRP_CNT,0)) AS POS_LAST_RSRP_CNT,
					SUM(IFNULL(POS_LAST_RSRQ,0)) AS POS_LAST_RSRQ,
					SUM(IFNULL(POS_LAST_RSRQ_CNT,0)) AS POS_LAST_RSRQ_CNT,
					SUM(IFNULL(MEASURE_CNT,0)) AS MEASURE_CNT,
					SUM(IFNULL(DURATION,0)) AS DURATION,
					SUM(IFNULL(IRAT_TO_GERAN_SUCCESS_1_RSRP,0)) AS IRAT_TO_GERAN_SUCCESS_1_RSRP,
					SUM(IFNULL(IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT,0)) AS IRAT_TO_GERAN_SUCCESS_1_RSRP_CNT,
					SUM(IFNULL(IRAT_TO_GERAN_SUCCESS_1_RSRQ,0)) AS IRAT_TO_GERAN_SUCCESS_1_RSRQ,
					SUM(IFNULL(IRAT_TO_GERAN_SUCCESS_1_RSRQ_CNT,0)) AS IRAT_TO_GERAN_SUCCESS_1_RSRQ_CNT,
					SUM(IFNULL(IRAT_TO_GERAN_SUCCESS_1_RSSI,0)) AS IRAT_TO_GERAN_SUCCESS_1_RSSI,
					SUM(IFNULL(IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT,0)) AS IRAT_TO_GERAN_SUCCESS_1_RSSI_CNT,
					SUM(IFNULL(IRAT_TO_UMTS_SUCCESS_1_ECN0,0)) AS IRAT_TO_UMTS_SUCCESS_1_ECN0,
					SUM(IFNULL(IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT,0)) AS IRAT_TO_UMTS_SUCCESS_1_ECN0_CNT,
					SUM(IFNULL(IRAT_TO_UMTS_SUCCESS_1_RSCP,0)) AS IRAT_TO_UMTS_SUCCESS_1_RSCP,
					SUM(IFNULL(IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT,0)) AS IRAT_TO_UMTS_SUCCESS_1_RSCP_CNT,
					SUM(IFNULL(IRAT_TO_UMTS_SUCCESS_1_RSRP,0)) AS IRAT_TO_UMTS_SUCCESS_1_RSRP,
					SUM(IFNULL(IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT,0)) AS IRAT_TO_UMTS_SUCCESS_1_RSRP_CNT,
					SUM(IFNULL(IRAT_TO_UMTS_SUCCESS_1_RSRQ,0)) AS IRAT_TO_UMTS_SUCCESS_1_RSRQ,
					SUM(IFNULL(IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT,0)) AS IRAT_TO_UMTS_SUCCESS_1_RSRQ_CNT,
					SUM(IFNULL(RRC_REQUEST_TYPE_1,0)) AS RRC_REQUEST_TYPE_1,
					SUM(IFNULL(RRC_REQUEST_TYPE_1_CNT,0)) AS RRC_REQUEST_TYPE_1_CNT,
					SUM(IFNULL(RRC_REQUEST_TYPE_2,0)) AS RRC_REQUEST_TYPE_2,
					SUM(IFNULL(RRC_REQUEST_TYPE_2_CNT,0)) AS RRC_REQUEST_TYPE_2_CNT,
					SUM(IFNULL(RRC_REQUEST_TYPE_3,0)) AS RRC_REQUEST_TYPE_3,
					SUM(IFNULL(RRC_REQUEST_TYPE_3_CNT,0)) AS RRC_REQUEST_TYPE_3_CNT,
					SUM(IFNULL(RRC_REQUEST_TYPE_4,0)) AS RRC_REQUEST_TYPE_4,
					SUM(IFNULL(RRC_REQUEST_TYPE_4_CNT,0)) AS RRC_REQUEST_TYPE_4_CNT,
					SUM(IFNULL(RRC_REQUEST_TYPE_5,0)) AS RRC_REQUEST_TYPE_5,
					SUM(IFNULL(RRC_REQUEST_TYPE_5_CNT,0)) AS RRC_REQUEST_TYPE_5_CNT,
					SUM(IFNULL(RRC_REQUEST_TYPE_6,0)) AS RRC_REQUEST_TYPE_6,
					SUM(IFNULL(RRC_REQUEST_TYPE_6_CNT,0)) AS RRC_REQUEST_TYPE_6_CNT,
					SUM(IFNULL(RRC_REQUEST_TYPE_7,0)) AS RRC_REQUEST_TYPE_7,
					SUM(IFNULL(RRC_REQUEST_TYPE_7_CNT,0)) AS RRC_REQUEST_TYPE_7_CNT,
					SUM(IFNULL(RRC_REQUEST_TYPE_8,0)) AS RRC_REQUEST_TYPE_8,
					SUM(IFNULL(RRC_REQUEST_TYPE_8_CNT,0)) AS RRC_REQUEST_TYPE_8_CNT,
					SUM(IFNULL(RRC_REQUEST_TYPE_NOT_1_8,0)) AS RRC_REQUEST_TYPE_NOT_1_8,
					SUM(IFNULL(RRC_REQUEST_TYPE_NOT_1_8_CNT,0)) AS RRC_REQUEST_TYPE_NOT_1_8_CNT,
					SUM(IFNULL(E_RAB_SETUP_FAILURE,0)) AS E_RAB_SETUP_FAILURE,
					SUM(IFNULL(CALL_STATUS_2,0)) AS CALL_STATUS_2,
					SUM(IFNULL(CALL_STATUS_3,0)) AS CALL_STATUS_3,
					SUM(IFNULL(CALL_STATUS_124,0)) AS CALL_STATUS_124,
					SUM(IFNULL(DURATION_M30,0)) AS DURATION_M30,
					SUM(IFNULL(DURATION_L10,0)) AS DURATION_L10,
					SUM(IFNULL(DURATION_L30,0)) AS DURATION_L30,
					SUM(IFNULL(DURATION_L1,0)) AS DURATION_L1,
					SUM(IFNULL(RRC_SETUP_FAILURE_EVENT,0)) AS RRC_SETUP_FAILURE_EVENT,
					SUM(IFNULL(IRAT_TO_GERAN_ATTEMPT,0)) AS IRAT_TO_GERAN_ATTEMPT,
					SUM(IFNULL(IRAT_TO_GERAN_SUCCESS,0)) AS IRAT_TO_GERAN_SUCCESS,
					SUM(IFNULL(IRAT_TO_UMTS_ATTEMPT,0)) AS IRAT_TO_UMTS_ATTEMPT,
					SUM(IFNULL(IRAT_TO_UMTS_SUCCESS,0)) AS IRAT_TO_UMTS_SUCCESS,
					SUM(IFNULL(SERVING_CNT,0)) AS SERVING_CNT
				FROM ',GT_DB,'.rpt_tile_end_',WORKER_ID,' FORCE INDEX (IX_TILE_DY)
				GROUP BY DATA_DATE,`TILE_ID`,`CALL_TYPE`,`CALL_STATUS`,`MOVING`,`INDOOR`
			) B 
			ON A.`TILE_ID`    =B.`TILE_ID` 
			AND A.`CALL_TYPE`    =B.`CALL_TYPE`    
			AND A.`CALL_STATUS`  =B.`CALL_STATUS`  
			AND A.`MOVING`	     =B.`MOVING`	     
			AND A.`INDOOR`	     =B.`INDOOR`	 
		;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	INSERT INTO gt_gw_main.SP_LOG VALUES(GT_DB,'SP_Sub_Generate_End_LTE',CONCAT('Done: ',TIMESTAMPDIFF(SECOND,START_TIME,SYSDATE()),' seconds.'), NOW());			
END
utf8
utf8_general_ci
latin1_swedish_ci

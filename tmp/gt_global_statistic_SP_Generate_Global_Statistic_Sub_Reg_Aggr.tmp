CREATE DEFINER=`covmo`@`%` PROCEDURE `SP_Generate_Global_Statistic_Sub_Reg_Aggr`(IN TECH_MASK TINYINT(2),IN WORKER_ID VARCHAR(10),IN FLAG TINYINT(2),IN exDate VARCHAR(10),IN DS_FLAG TINYINT(2),IN PENDING_FLAG TINYINT(2),IN TileResolution VARCHAR(30))
BEGIN
	DECLARE START_TIME DATETIME DEFAULT SYSDATE();
	DECLARE STEP_START_TIME DATETIME DEFAULT SYSDATE();
	DECLARE SP_Process VARCHAR(100) DEFAULT NULL;
	DECLARE KPI_ERROR CONDITION FOR SQLSTATE '99999' ;
	DECLARE FIRSTDAY_OF_WEEK TINYINT(4) DEFAULT 6;
	DECLARE v_DATA_DATE VARCHAR(10) DEFAULT NULL;
	DECLARE v_DATA_HOUR TINYINT(2) DEFAULT NULL;
	DECLARE v_PU_ID MEDIUMINT(9) DEFAULT NULL;
	DECLARE v_TECH_MASK TINYINT(2) DEFAULT NULL;
	DECLARE v_i TINYINT(2) DEFAULT 1;
	DECLARE v_R_Max TINYINT(2) DEFAULT 0;
	DECLARE v_group_db_name VARCHAR(100) DEFAULT '';
	
	DECLARE SHARE_IP VARCHAR(100) DEFAULT NULL;
	DECLARE SHARE_PORT VARCHAR(10) DEFAULT NULL;
	DECLARE SHARE_ACCOUNT VARCHAR(100) DEFAULT NULL;
	DECLARE SHARE_PW VARCHAR(100) DEFAULT NULL;
	DECLARE SHARE_DB VARCHAR(100) DEFAULT NULL;
	
	DECLARE TILE_UMTS_COLUMN_STR VARCHAR(2000) DEFAULT 
		'`INIT_CALL_CNT`,
		  `END_CALL_CNT`,
		  `VOICE_CNT`,
		  `VIDEO_CNT`,
		  `PS_R99_CNT`,
		  `PS_HSPA_CNT`,
		  `M_RAB_CNT`, 
		  `SIGNAL_CNT`,
		  `SMS_CNT`,
		  `PS_OTHER_CNT`,
		  `CALL_DUR_SUM`,
		  `CS_DUR_SUM`,
		  `DROP_CNT`,
		  `BLOCK_CNT`,
		  `DROP_VOICE_CNT`,
		  `DROP_VIDEO_CNT`,
		  `DROP_PS_R99_CNT`,
		  `DROP_PS_HSPA_CNT`,
		  `DROP_M_RAB_CNT`,
		  `DROP_SIGNAL_CNT`,
		  `DROP_SMS_CNT`,
		  `DROP_PS_OTHER_CNT`,
		  `SHO_ATTEMPT_CNT`,
		  `SHO_FAILURE_CNT`,
		  `IFHO_ATTEMPT_CNT`,
		  `IFHO_FAILURE_CNT`,
		  `IRAT_ATTEMPT_CNT`,
		  `IRAT_FAILURE_CNT`,
		  `PS_UL_VOLUME_SUM`,
		  `PS_DL_VOLUME_SUM`,
		  `PS_UL_SPEED_MAX`,
		  `PS_DL_SPEED_MAX`,
		  `RSCP_SUM`,
		  `RSCP_CNT`,
		  `ECNO_SUM`,
		  `ECNO_CNT`,
		  `ACTIVE_SET_SUM`,
		  `ACTIVE_SET_CNT`,
		  `POLLUTED_PILOT_CNT`,
		  `PILOT_DOM_SUM`,
		  `PILOT_CNT`,
		  `T19_CNT`,
		  `UL_THROUPUT_SUM`,
		  `UL_THROUPUT_CNT`,
		  `DL_THROUPUT_SUM`,
		  `DL_THROUPUT_CNT`,
		  `NON_BLOCK_VOICE_CNT`,
		  `NON_BLOCK_VIDEO_CNT`,
		  `NON_BLOCK_PS_R99_CNT`,
		  `NON_BLOCK_PS_HSPA_CNT`,
		  `NON_BLOCK_M_RAB_CNT`,
		  `NON_BLOCK_SIGNAL_CNT`,
		  `NON_BLOCK_SMS_CNT`,
		  `NON_BLOCK_PS_OTHER_CNT`,
		  `PS_CNT`,
		  `DROP_PS_CNT`,
		  `FP_RSCP_1`,
		  `FP_ECN0_1`,
		  `BEST_CNT`,
		  `UL_THROUPUT_MAX`,
		  `DL_THROUPUT_MAX`,
		  `CS_RRC_DURATION`,
		  `PS_RRC_DURATION`,
		  `CAUSE_14_CNT`,
		  `CAUSE_15_CNT`,
		  `CAUSE_46_CNT`,
		  `CAUSE_115_CNT`,
		  `CAUSE_OTHERS_CNT`,
		  `CAUSE_53_CNT`,
		  `CAUSE_65_CNT`,
		  `CAUSE_114_CNT`,
		  `CAUSE_263_CNT`,
		  `CAUSE_CAPACITY`';
		  
	DECLARE TILE_UMTS_COLUMN_IFNULL_STR VARCHAR(5000) DEFAULT 
		'IFNULL(INIT_CALL_CNT,0) AS INIT_CALL_CNT,
		IFNULL(END_CALL_CNT,0) AS END_CALL_CNT,
		IFNULL(VOICE_CNT,0) AS VOICE_CNT,
		IFNULL(VIDEO_CNT,0) AS VIDEO_CNT,
		IFNULL(PS_R99_CNT,0) AS PS_R99_CNT,
		IFNULL(PS_HSPA_CNT,0) AS PS_HSPA_CNT,
		IFNULL(M_RAB_CNT,0) AS M_RAB_CNT,
		IFNULL(SIGNAL_CNT,0) AS SIGNAL_CNT,
		IFNULL(SMS_CNT,0) AS SMS_CNT,
		IFNULL(PS_OTHER_CNT,0) AS PS_OTHER_CNT,
		IFNULL(CALL_DUR_SUM,0) AS CALL_DUR_SUM,
		IFNULL(CS_DUR_SUM,0) AS CS_DUR_SUM,
		IFNULL(DROP_CNT,0) AS DROP_CNT,
		IFNULL(BLOCK_CNT,0) AS BLOCK_CNT,
		IFNULL(DROP_VOICE_CNT,0) AS DROP_VOICE_CNT,
		IFNULL(DROP_VIDEO_CNT,0) AS DROP_VIDEO_CNT,
		IFNULL(DROP_PS_R99_CNT,0) AS DROP_PS_R99_CNT,
		IFNULL(DROP_PS_HSPA_CNT,0) AS DROP_PS_HSPA_CNT,
		IFNULL(DROP_M_RAB_CNT,0) AS DROP_M_RAB_CNT,
		IFNULL(DROP_SIGNAL_CNT,0) AS DROP_SIGNAL_CNT,
		IFNULL(DROP_SMS_CNT,0) AS DROP_SMS_CNT,
		IFNULL(DROP_PS_OTHER_CNT,0) AS DROP_PS_OTHER_CNT,
		IFNULL(SHO_ATTEMPT_CNT,0) AS SHO_ATTEMPT_CNT,
		IFNULL(SHO_FAILURE_CNT,0) AS SHO_FAILURE_CNT,
		IFNULL(IFHO_ATTEMPT_CNT,0) AS IFHO_ATTEMPT_CNT,
		IFNULL(IFHO_FAILURE_CNT,0) AS IFHO_FAILURE_CNT,
		IFNULL(IRAT_ATTEMPT_CNT,0) AS IRAT_ATTEMPT_CNT,
		IFNULL(IRAT_FAILURE_CNT,0) AS IRAT_FAILURE_CNT,
		IFNULL(PS_UL_VOLUME_SUM,0) AS PS_UL_VOLUME_SUM,
		IFNULL(PS_DL_VOLUME_SUM,0) AS PS_DL_VOLUME_SUM,
		IFNULL(PS_UL_SPEED_MAX,0) AS PS_UL_SPEED_MAX,
		IFNULL(PS_DL_SPEED_MAX,0) AS PS_DL_SPEED_MAX,
		IFNULL(RSCP_SUM,0) AS RSCP_SUM,
		IFNULL(RSCP_CNT,0) AS RSCP_CNT,
		IFNULL(ECNO_SUM,0) AS ECNO_SUM,
		IFNULL(ECNO_CNT,0) AS ECNO_CNT,
		IFNULL(ACTIVE_SET_SUM,0) AS ACTIVE_SET_SUM,
		IFNULL(ACTIVE_SET_CNT,0) AS ACTIVE_SET_CNT,
		IFNULL(POLLUTED_PILOT_CNT,0) AS POLLUTED_PILOT_CNT,
		IFNULL(PILOT_DOM_SUM,0) AS PILOT_DOM_SUM,
		IFNULL(PILOT_CNT,0) AS PILOT_CNT,
		IFNULL(T19_CNT,0) AS T19_CNT,
		IFNULL(UL_THROUPUT_SUM,0) AS UL_THROUPUT_SUM,
		IFNULL(UL_THROUPUT_CNT,0) AS UL_THROUPUT_CNT,
		IFNULL(DL_THROUPUT_SUM,0) AS DL_THROUPUT_SUM,
		IFNULL(DL_THROUPUT_CNT,0) AS DL_THROUPUT_CNT,
		IFNULL(NON_BLOCK_VOICE_CNT,0) AS NON_BLOCK_VOICE_CNT,
		IFNULL(NON_BLOCK_VIDEO_CNT,0) AS NON_BLOCK_VIDEO_CNT,
		IFNULL(NON_BLOCK_PS_R99_CNT,0) AS NON_BLOCK_PS_R99_CNT,
		IFNULL(NON_BLOCK_PS_HSPA_CNT,0) AS NON_BLOCK_PS_HSPA_CNT,
		IFNULL(NON_BLOCK_M_RAB_CNT,0) AS NON_BLOCK_M_RAB_CNT,
		IFNULL(NON_BLOCK_SIGNAL_CNT,0) AS NON_BLOCK_SIGNAL_CNT,
		IFNULL(NON_BLOCK_SMS_CNT,0) AS NON_BLOCK_SMS_CNT,
		IFNULL(NON_BLOCK_PS_OTHER_CNT,0) AS NON_BLOCK_PS_OTHER_CNT,
		IFNULL(PS_CNT,0) AS PS_CNT,
		IFNULL(DROP_PS_CNT,0) AS DROP_PS_CNT,
  		IFNULL(FP_RSCP_1,0) AS FP_RSCP_1,
  		IFNULL(FP_ECN0_1,0) AS FP_ECN0_1,
  		IFNULL(BEST_CNT,0) AS BEST_CNT,
  		IFNULL(UL_THROUPUT_MAX,0) AS UL_THROUPUT_MAX,
  		IFNULL(DL_THROUPUT_MAX,0) AS DL_THROUPUT_MAX,
		IFNULL(CS_RRC_DURATION,0) AS CS_RRC_DURATION,
  		IFNULL(PS_RRC_DURATION,0) AS PS_RRC_DURATION,
		IFNULL(CAUSE_14_CNT,0) AS CAUSE_14_CNT,
		IFNULL(CAUSE_15_CNT,0) AS CAUSE_15_CNT,
		IFNULL(CAUSE_46_CNT,0) AS CAUSE_46_CNT,
		IFNULL(CAUSE_115_CNT,0) AS CAUSE_115_CNT,
		IFNULL(CAUSE_OTHERS_CNT,0) AS CAUSE_OTHERS_CNT,
		IFNULL(CAUSE_53_CNT,0) AS CAUSE_53_CNT,
		IFNULL(CAUSE_65_CNT,0) AS CAUSE_65_CNT,
		IFNULL(CAUSE_114_CNT,0) AS CAUSE_114_CNT,
		IFNULL(CAUSE_263_CNT,0) AS CAUSE_263_CNT,
		IFNULL(CAUSE_CAPACITY,0) AS CAUSE_CAPACITY';
		
	DECLARE TILE_UMTS_COLUMN_SUM_STR VARCHAR(5000) DEFAULT 
		'SUM(IFNULL(INIT_CALL_CNT,0)) AS INIT_CALL_CNT,
		SUM(IFNULL(END_CALL_CNT,0)) AS END_CALL_CNT,
		SUM(IFNULL(VOICE_CNT,0)) AS VOICE_CNT,
		SUM(IFNULL(VIDEO_CNT,0)) AS VIDEO_CNT,
		SUM(IFNULL(PS_R99_CNT,0)) AS PS_R99_CNT,
		SUM(IFNULL(PS_HSPA_CNT,0)) AS PS_HSPA_CNT,
		SUM(IFNULL(M_RAB_CNT,0)) AS M_RAB_CNT,
		SUM(IFNULL(SIGNAL_CNT,0)) AS SIGNAL_CNT,
		SUM(IFNULL(SMS_CNT,0)) AS SMS_CNT,
		SUM(IFNULL(PS_OTHER_CNT,0)) AS PS_OTHER_CNT,
		SUM(IFNULL(CALL_DUR_SUM,0)) AS CALL_DUR_SUM,
		SUM(IFNULL(CS_DUR_SUM,0)) AS CS_DUR_SUM,
		SUM(IFNULL(DROP_CNT,0)) AS DROP_CNT,
		SUM(IFNULL(BLOCK_CNT,0)) AS BLOCK_CNT,
		SUM(IFNULL(DROP_VOICE_CNT,0)) AS DROP_VOICE_CNT,
		SUM(IFNULL(DROP_VIDEO_CNT,0)) AS DROP_VIDEO_CNT,
		SUM(IFNULL(DROP_PS_R99_CNT,0)) AS DROP_PS_R99_CNT,
		SUM(IFNULL(DROP_PS_HSPA_CNT,0)) AS DROP_PS_HSPA_CNT,
		SUM(IFNULL(DROP_M_RAB_CNT,0)) AS DROP_M_RAB_CNT,
		SUM(IFNULL(DROP_SIGNAL_CNT,0)) AS DROP_SIGNAL_CNT,
		SUM(IFNULL(DROP_SMS_CNT,0)) AS DROP_SMS_CNT,
		SUM(IFNULL(DROP_PS_OTHER_CNT,0)) AS DROP_PS_OTHER_CNT,
		SUM(IFNULL(SHO_ATTEMPT_CNT,0)) AS SHO_ATTEMPT_CNT,
		SUM(IFNULL(SHO_FAILURE_CNT,0)) AS SHO_FAILURE_CNT,
		SUM(IFNULL(IFHO_ATTEMPT_CNT,0)) AS IFHO_ATTEMPT_CNT,
		SUM(IFNULL(IFHO_FAILURE_CNT,0)) AS IFHO_FAILURE_CNT,
		SUM(IFNULL(IRAT_ATTEMPT_CNT,0)) AS IRAT_ATTEMPT_CNT,
		SUM(IFNULL(IRAT_FAILURE_CNT,0)) AS IRAT_FAILURE_CNT,
		SUM(IFNULL(PS_UL_VOLUME_SUM,0)) AS PS_UL_VOLUME_SUM,
		SUM(IFNULL(PS_DL_VOLUME_SUM,0)) AS PS_DL_VOLUME_SUM,
		MAX(IFNULL(PS_UL_SPEED_MAX,0)) AS PS_UL_SPEED_MAX,
		MAX(IFNULL(PS_DL_SPEED_MAX,0)) AS PS_DL_SPEED_MAX,
		SUM(IFNULL(RSCP_SUM,0)) AS RSCP_SUM,
		SUM(IFNULL(RSCP_CNT,0)) AS RSCP_CNT,
		SUM(IFNULL(ECNO_SUM,0)) AS ECNO_SUM,
		SUM(IFNULL(ECNO_CNT,0)) AS ECNO_CNT,
		SUM(IFNULL(ACTIVE_SET_SUM,0)) AS ACTIVE_SET_SUM,
		SUM(IFNULL(ACTIVE_SET_CNT,0)) AS ACTIVE_SET_CNT,
		SUM(IFNULL(POLLUTED_PILOT_CNT,0)) AS POLLUTED_PILOT_CNT,
		SUM(IFNULL(PILOT_DOM_SUM,0)) AS PILOT_DOM_SUM,
		SUM(IFNULL(PILOT_CNT,0)) AS PILOT_CNT,
		SUM(IFNULL(T19_CNT,0)) AS T19_CNT,
		SUM(IFNULL(UL_THROUPUT_SUM,0)) AS UL_THROUPUT_SUM,
		SUM(IFNULL(UL_THROUPUT_CNT,0)) AS UL_THROUPUT_CNT,
		SUM(IFNULL(DL_THROUPUT_SUM,0)) AS DL_THROUPUT_SUM,
		SUM(IFNULL(DL_THROUPUT_CNT,0)) AS DL_THROUPUT_CNT,
		SUM(IFNULL(NON_BLOCK_VOICE_CNT,0)) AS NON_BLOCK_VOICE_CNT,
		SUM(IFNULL(NON_BLOCK_VIDEO_CNT,0)) AS NON_BLOCK_VIDEO_CNT,
		SUM(IFNULL(NON_BLOCK_PS_R99_CNT,0)) AS NON_BLOCK_PS_R99_CNT,
		SUM(IFNULL(NON_BLOCK_PS_HSPA_CNT,0)) AS NON_BLOCK_PS_HSPA_CNT,
		SUM(IFNULL(NON_BLOCK_M_RAB_CNT,0)) AS NON_BLOCK_M_RAB_CNT,
		SUM(IFNULL(NON_BLOCK_SIGNAL_CNT,0)) AS NON_BLOCK_SIGNAL_CNT,
		SUM(IFNULL(NON_BLOCK_SMS_CNT,0)) AS NON_BLOCK_SMS_CNT,
		SUM(IFNULL(NON_BLOCK_PS_OTHER_CNT,0)) AS NON_BLOCK_PS_OTHER_CNT,
		SUM(IFNULL(PS_CNT,0)) AS PS_CNT,
		SUM(IFNULL(DROP_PS_CNT,0)) AS DROP_PS_CNT,
		SUM(IFNULL(FP_RSCP_1,0)) AS FP_RSCP_1,
		SUM(IFNULL(FP_ECN0_1,0)) AS FP_ECN0_1,
		SUM(IFNULL(BEST_CNT,0)) AS BEST_CNT,
		MAX(IFNULL(UL_THROUPUT_MAX,0)) AS UL_THROUPUT_MAX,
		MAX(IFNULL(DL_THROUPUT_MAX,0)) AS DL_THROUPUT_MAX,
		MAX(IFNULL(CS_RRC_DURATION,0)) AS CS_RRC_DURATION,
		MAX(IFNULL(PS_RRC_DURATION,0)) AS PS_RRC_DURATION,
		SUM(IFNULL(CAUSE_14_CNT,0)) AS CAUSE_14_CNT,
		SUM(IFNULL(CAUSE_15_CNT,0)) AS CAUSE_15_CNT,
		SUM(IFNULL(CAUSE_46_CNT,0)) AS CAUSE_46_CNT,
		SUM(IFNULL(CAUSE_115_CNT,0)) AS CAUSE_115_CNT,
		SUM(IFNULL(CAUSE_OTHERS_CNT,0)) AS CAUSE_OTHERS_CNT,
		SUM(IFNULL(CAUSE_53_CNT,0)) AS CAUSE_53_CNT,
		SUM(IFNULL(CAUSE_65_CNT,0)) AS CAUSE_65_CNT,
		SUM(IFNULL(CAUSE_114_CNT,0)) AS CAUSE_114_CNT,
		SUM(IFNULL(CAUSE_263_CNT,0)) AS CAUSE_263_CNT,
		SUM(IFNULL(CAUSE_CAPACITY,0)) AS CAUSE_CAPACITY';
	
	DECLARE TILE_UMTS_COLUMN_UPD_STR VARCHAR(10000) DEFAULT
		'RPT_TABLE_NAME.INIT_CALL_CNT=RPT_TABLE_NAME.INIT_CALL_CNT+VALUES(INIT_CALL_CNT),
		RPT_TABLE_NAME.END_CALL_CNT=RPT_TABLE_NAME.END_CALL_CNT+VALUES(END_CALL_CNT),
		RPT_TABLE_NAME.VOICE_CNT=RPT_TABLE_NAME.VOICE_CNT+VALUES(VOICE_CNT),
		RPT_TABLE_NAME.VIDEO_CNT=RPT_TABLE_NAME.VIDEO_CNT+VALUES(VIDEO_CNT),
		RPT_TABLE_NAME.PS_R99_CNT=RPT_TABLE_NAME.PS_R99_CNT+VALUES(PS_R99_CNT),
		RPT_TABLE_NAME.PS_HSPA_CNT=RPT_TABLE_NAME.PS_HSPA_CNT+VALUES(PS_HSPA_CNT),
		RPT_TABLE_NAME.M_RAB_CNT=RPT_TABLE_NAME.M_RAB_CNT+VALUES(M_RAB_CNT),
		RPT_TABLE_NAME.SIGNAL_CNT=RPT_TABLE_NAME.SIGNAL_CNT+VALUES(SIGNAL_CNT),
		RPT_TABLE_NAME.SMS_CNT=RPT_TABLE_NAME.SMS_CNT+VALUES(SMS_CNT),
		RPT_TABLE_NAME.PS_OTHER_CNT=RPT_TABLE_NAME.PS_OTHER_CNT+VALUES(PS_OTHER_CNT),
		RPT_TABLE_NAME.CALL_DUR_SUM=RPT_TABLE_NAME.CALL_DUR_SUM+VALUES(CALL_DUR_SUM),
		RPT_TABLE_NAME.CS_DUR_SUM=RPT_TABLE_NAME.CS_DUR_SUM+VALUES(CS_DUR_SUM),
		RPT_TABLE_NAME.DROP_CNT=RPT_TABLE_NAME.DROP_CNT+VALUES(DROP_CNT),
		RPT_TABLE_NAME.BLOCK_CNT=RPT_TABLE_NAME.BLOCK_CNT+VALUES(BLOCK_CNT),
		RPT_TABLE_NAME.DROP_VOICE_CNT=RPT_TABLE_NAME.DROP_VOICE_CNT+VALUES(DROP_VOICE_CNT),
		RPT_TABLE_NAME.DROP_VIDEO_CNT=RPT_TABLE_NAME.DROP_VIDEO_CNT+VALUES(DROP_VIDEO_CNT),
		RPT_TABLE_NAME.DROP_PS_R99_CNT=RPT_TABLE_NAME.DROP_PS_R99_CNT+VALUES(DROP_PS_R99_CNT),
		RPT_TABLE_NAME.DROP_PS_HSPA_CNT=RPT_TABLE_NAME.DROP_PS_HSPA_CNT+VALUES(DROP_PS_HSPA_CNT),
		RPT_TABLE_NAME.DROP_M_RAB_CNT=RPT_TABLE_NAME.DROP_M_RAB_CNT+VALUES(DROP_M_RAB_CNT),
		RPT_TABLE_NAME.DROP_SIGNAL_CNT=RPT_TABLE_NAME.DROP_SIGNAL_CNT+VALUES(DROP_SIGNAL_CNT),
		RPT_TABLE_NAME.DROP_SMS_CNT=RPT_TABLE_NAME.DROP_SMS_CNT+VALUES(DROP_SMS_CNT),
		RPT_TABLE_NAME.DROP_PS_OTHER_CNT=RPT_TABLE_NAME.DROP_PS_OTHER_CNT+VALUES(DROP_PS_OTHER_CNT),
		RPT_TABLE_NAME.SHO_ATTEMPT_CNT=RPT_TABLE_NAME.SHO_ATTEMPT_CNT+VALUES(SHO_ATTEMPT_CNT),
		RPT_TABLE_NAME.SHO_FAILURE_CNT=RPT_TABLE_NAME.SHO_FAILURE_CNT+VALUES(SHO_FAILURE_CNT),
		RPT_TABLE_NAME.IFHO_ATTEMPT_CNT=RPT_TABLE_NAME.IFHO_ATTEMPT_CNT+VALUES(IFHO_ATTEMPT_CNT),
		RPT_TABLE_NAME.IFHO_FAILURE_CNT=RPT_TABLE_NAME.IFHO_FAILURE_CNT+VALUES(IFHO_FAILURE_CNT),
		RPT_TABLE_NAME.IRAT_ATTEMPT_CNT=RPT_TABLE_NAME.IRAT_ATTEMPT_CNT+VALUES(IRAT_ATTEMPT_CNT),
		RPT_TABLE_NAME.IRAT_FAILURE_CNT=RPT_TABLE_NAME.IRAT_FAILURE_CNT+VALUES(IRAT_FAILURE_CNT),
		RPT_TABLE_NAME.PS_UL_VOLUME_SUM=RPT_TABLE_NAME.PS_UL_VOLUME_SUM+VALUES(PS_UL_VOLUME_SUM),
		RPT_TABLE_NAME.PS_DL_VOLUME_SUM=RPT_TABLE_NAME.PS_DL_VOLUME_SUM+VALUES(PS_DL_VOLUME_SUM),
		RPT_TABLE_NAME.PS_UL_SPEED_MAX=CASE WHEN RPT_TABLE_NAME.PS_UL_SPEED_MAX > VALUES(PS_UL_SPEED_MAX) THEN RPT_TABLE_NAME.PS_UL_SPEED_MAX ELSE VALUES(PS_UL_SPEED_MAX) END,    
		RPT_TABLE_NAME.PS_DL_SPEED_MAX=CASE WHEN RPT_TABLE_NAME.PS_DL_SPEED_MAX > VALUES(PS_DL_SPEED_MAX) THEN RPT_TABLE_NAME.PS_DL_SPEED_MAX ELSE VALUES(PS_DL_SPEED_MAX) END,
		RPT_TABLE_NAME.RSCP_SUM=RPT_TABLE_NAME.RSCP_SUM+VALUES(RSCP_SUM),
		RPT_TABLE_NAME.RSCP_CNT=RPT_TABLE_NAME.RSCP_CNT+VALUES(RSCP_CNT),
		RPT_TABLE_NAME.ECNO_SUM=RPT_TABLE_NAME.ECNO_SUM+VALUES(ECNO_SUM),
		RPT_TABLE_NAME.ECNO_CNT=RPT_TABLE_NAME.ECNO_CNT+VALUES(ECNO_CNT),
		RPT_TABLE_NAME.ACTIVE_SET_SUM=RPT_TABLE_NAME.ACTIVE_SET_SUM+VALUES(ACTIVE_SET_SUM),
		RPT_TABLE_NAME.ACTIVE_SET_CNT=RPT_TABLE_NAME.ACTIVE_SET_CNT+VALUES(ACTIVE_SET_CNT),
		RPT_TABLE_NAME.POLLUTED_PILOT_CNT=RPT_TABLE_NAME.POLLUTED_PILOT_CNT+VALUES(POLLUTED_PILOT_CNT),
		RPT_TABLE_NAME.PILOT_DOM_SUM=RPT_TABLE_NAME.PILOT_DOM_SUM+VALUES(PILOT_DOM_SUM),
		RPT_TABLE_NAME.PILOT_CNT=RPT_TABLE_NAME.PILOT_CNT+VALUES(PILOT_CNT),
		RPT_TABLE_NAME.T19_CNT=RPT_TABLE_NAME.T19_CNT+VALUES(T19_CNT),
		RPT_TABLE_NAME.UL_THROUPUT_SUM=RPT_TABLE_NAME.UL_THROUPUT_SUM+VALUES(UL_THROUPUT_SUM),
		RPT_TABLE_NAME.UL_THROUPUT_CNT=RPT_TABLE_NAME.UL_THROUPUT_CNT+VALUES(UL_THROUPUT_CNT),
		RPT_TABLE_NAME.DL_THROUPUT_SUM=RPT_TABLE_NAME.DL_THROUPUT_SUM+VALUES(DL_THROUPUT_SUM),
		RPT_TABLE_NAME.DL_THROUPUT_CNT=RPT_TABLE_NAME.DL_THROUPUT_CNT+VALUES(DL_THROUPUT_CNT),
		RPT_TABLE_NAME.NON_BLOCK_VOICE_CNT=RPT_TABLE_NAME.NON_BLOCK_VOICE_CNT+VALUES(NON_BLOCK_VOICE_CNT),
		RPT_TABLE_NAME.NON_BLOCK_VIDEO_CNT=RPT_TABLE_NAME.NON_BLOCK_VIDEO_CNT+VALUES(NON_BLOCK_VIDEO_CNT),
		RPT_TABLE_NAME.NON_BLOCK_PS_R99_CNT=RPT_TABLE_NAME.NON_BLOCK_PS_R99_CNT+VALUES(NON_BLOCK_PS_R99_CNT),
		RPT_TABLE_NAME.NON_BLOCK_PS_HSPA_CNT=RPT_TABLE_NAME.NON_BLOCK_PS_HSPA_CNT+VALUES(NON_BLOCK_PS_HSPA_CNT),
		RPT_TABLE_NAME.NON_BLOCK_M_RAB_CNT=RPT_TABLE_NAME.NON_BLOCK_M_RAB_CNT+VALUES(NON_BLOCK_M_RAB_CNT),
		RPT_TABLE_NAME.NON_BLOCK_SIGNAL_CNT=RPT_TABLE_NAME.NON_BLOCK_SIGNAL_CNT+VALUES(NON_BLOCK_SIGNAL_CNT),
		RPT_TABLE_NAME.NON_BLOCK_SMS_CNT=RPT_TABLE_NAME.NON_BLOCK_SMS_CNT+VALUES(NON_BLOCK_SMS_CNT),
		RPT_TABLE_NAME.NON_BLOCK_PS_OTHER_CNT=RPT_TABLE_NAME.NON_BLOCK_PS_OTHER_CNT+VALUES(NON_BLOCK_PS_OTHER_CNT),
		RPT_TABLE_NAME.PS_CNT=RPT_TABLE_NAME.PS_CNT+VALUES(PS_CNT),
		RPT_TABLE_NAME.DROP_PS_CNT=RPT_TABLE_NAME.DROP_PS_CNT+VALUES(DROP_PS_CNT),
		RPT_TABLE_NAME.FP_RSCP_1=RPT_TABLE_NAME.FP_RSCP_1+VALUES(FP_RSCP_1),
		RPT_TABLE_NAME.FP_ECN0_1=RPT_TABLE_NAME.FP_ECN0_1+VALUES(FP_ECN0_1),
		RPT_TABLE_NAME.BEST_CNT=RPT_TABLE_NAME.BEST_CNT+VALUES(BEST_CNT),
		RPT_TABLE_NAME.UL_THROUPUT_MAX=CASE WHEN RPT_TABLE_NAME.UL_THROUPUT_MAX > VALUES(UL_THROUPUT_MAX) THEN RPT_TABLE_NAME.UL_THROUPUT_MAX ELSE VALUES(UL_THROUPUT_MAX) END,    
		RPT_TABLE_NAME.DL_THROUPUT_MAX=CASE WHEN RPT_TABLE_NAME.DL_THROUPUT_MAX > VALUES(DL_THROUPUT_MAX) THEN RPT_TABLE_NAME.DL_THROUPUT_MAX ELSE VALUES(DL_THROUPUT_MAX) END,
		RPT_TABLE_NAME.CS_RRC_DURATION=RPT_TABLE_NAME.CS_RRC_DURATION+VALUES(CS_RRC_DURATION),
		RPT_TABLE_NAME.PS_RRC_DURATION=RPT_TABLE_NAME.PS_RRC_DURATION+VALUES(PS_RRC_DURATION),
		RPT_TABLE_NAME.CAUSE_14_CNT=RPT_TABLE_NAME.CAUSE_14_CNT+VALUES(CAUSE_14_CNT),
		RPT_TABLE_NAME.CAUSE_15_CNT=RPT_TABLE_NAME.CAUSE_15_CNT+VALUES(CAUSE_15_CNT),
		RPT_TABLE_NAME.CAUSE_46_CNT=RPT_TABLE_NAME.CAUSE_46_CNT+VALUES(CAUSE_46_CNT),
		RPT_TABLE_NAME.CAUSE_115_CNT=RPT_TABLE_NAME.CAUSE_115_CNT+VALUES(CAUSE_115_CNT),
		RPT_TABLE_NAME.CAUSE_OTHERS_CNT=RPT_TABLE_NAME.CAUSE_OTHERS_CNT+VALUES(CAUSE_OTHERS_CNT),
		RPT_TABLE_NAME.CAUSE_53_CNT=RPT_TABLE_NAME.CAUSE_53_CNT+VALUES(CAUSE_53_CNT),
		RPT_TABLE_NAME.CAUSE_65_CNT=RPT_TABLE_NAME.CAUSE_65_CNT+VALUES(CAUSE_65_CNT),
		RPT_TABLE_NAME.CAUSE_114_CNT=RPT_TABLE_NAME.CAUSE_114_CNT+VALUES(CAUSE_114_CNT),
		RPT_TABLE_NAME.CAUSE_263_CNT=RPT_TABLE_NAME.CAUSE_263_CNT+VALUES(CAUSE_263_CNT),
		RPT_TABLE_NAME.CAUSE_CAPACITY=RPT_TABLE_NAME.CAUSE_CAPACITY+VALUES(CAUSE_CAPACITY)';
	
	
	DECLARE TILE_LTE_COLUMN_STR VARCHAR(3000) DEFAULT 
		'`INIT_CALL_CNT`,
		`END_CALL_CNT`,
		`SIGNAL_CNT`,
		`DATA_CNT`,
		`UNSPECIFIED_CNT`,
		`CALL_DUR_SUM`,
		`BLOCK_CNT`,
		`DROP_CNT`,
		`CSFB_CNT`,
		`INTER_FREQ_ATTEMPT_CNT`,
		`INTER_FREQ_FAILURE_CNT`,
		`INTRA_FREQ_ATTEMPT_CNT`,
		`INTRA_FREQ_FAILURE_CNT`,
		`4G_3G_ATTEMPT_CNT`,
		`4G_3G_FAILURE_CNT`,
		`4G_2G_ATTEMPT_CNT`,
		`4G_2G_FAILURE_CNT`,
		`PS_UL_VOLUME_SUM`,
		`PS_DL_VOLUME_SUM`,
		`PS_UL_SPEED_MAX`,
		`PS_DL_SPEED_MAX`,
		`RSRP_SUM`,
		`RSRP_CNT`,
		`RSRQ_SUM`,
		`RSRQ_CNT`,
		`PILOT_DOMINANCE_SUM`,
		`PILOT_DOMINANCE_CNT`,
		`DROP_SIGNAL_CNT`,
		`DROP_DATA_CNT`,
		`DROP_SMS_CNT`,
		`DROP_VOLTE_CNT`,
		`DROP_UNSPECIFIED_CNT`,
		`END_NON_BLOCK_CALL_CNT`,
		`UL_THROUPUT_SUM`,
		`UL_THROUPUT_CNT`,
		`DL_THROUPUT_SUM`,
		`DL_THROUPUT_CNT`,
		`END_NON_BLOCK_SIGNAL_CNT`,
		`END_NON_BLOCK_DATA_CNT`,
		`MR_4G_RSRP_SERVING_SUM`,
		`MR_4G_RSRP_SERVING_CNT`,
		`MR_4G_RSRQ_SERVING_SUM`,
		`MR_4G_RSRQ_SERVING_CNT`,	
		`DATA_DUR_SUM`,
		`SIGNAL_DUR_SUM`,
		`VOLTE_DUR_SUM`,
		`SMS_DUR_SUM`,
		`UNSP_DUR_SUM`,
		`SMS_CNT`,
		`VOLTE_CNT`';
		  
	DECLARE TILE_LTE_COLUMN_IFNULL_STR VARCHAR(3000) DEFAULT 
		'IFNULL(`INIT_CALL_CNT`,0) AS INIT_CALL_CNT,
		IFNULL(`END_CALL_CNT`,0) AS END_CALL_CNT,
		IFNULL(`SIGNAL_CNT`,0) AS SIGNAL_CNT,
		IFNULL(`DATA_CNT`,0) AS DATA_CNT,
		IFNULL(`UNSPECIFIED_CNT`,0) AS UNSPECIFIED_CNT,
		IFNULL(`CALL_DUR_SUM`,0) AS CALL_DUR_SUM,
		IFNULL(`BLOCK_CNT`,0) AS BLOCK_CNT,
		IFNULL(`DROP_CNT`,0) AS DROP_CNT,
		IFNULL(`CSFB_CNT`,0) AS CSFB_CNT,
		IFNULL(`INTER_FREQ_ATTEMPT_CNT`,0) AS INTER_FREQ_ATTEMPT_CNT,
		IFNULL(`INTER_FREQ_FAILURE_CNT`,0) AS INTER_FREQ_FAILURE_CNT,
		IFNULL(`INTRA_FREQ_ATTEMPT_CNT`,0) AS INTRA_FREQ_ATTEMPT_CNT,
		IFNULL(`INTRA_FREQ_FAILURE_CNT`,0) AS INTRA_FREQ_FAILURE_CNT,
		IFNULL(`4G_3G_ATTEMPT_CNT`,0) AS 4G_3G_ATTEMPT_CNT,
		IFNULL(`4G_3G_FAILURE_CNT`,0) AS 4G_3G_FAILURE_CNT,
		IFNULL(`4G_2G_ATTEMPT_CNT`,0) AS 4G_2G_ATTEMPT_CNT,
		IFNULL(`4G_2G_FAILURE_CNT`,0) AS 4G_2G_FAILURE_CNT,
		IFNULL(`PS_UL_VOLUME_SUM`,0) AS PS_UL_VOLUME_SUM,
		IFNULL(`PS_DL_VOLUME_SUM`,0) AS PS_DL_VOLUME_SUM,
		IFNULL(`PS_UL_SPEED_MAX`,0) AS PS_UL_SPEED_MAX,
		IFNULL(`PS_DL_SPEED_MAX`,0) AS PS_DL_SPEED_MAX,
		IFNULL(`RSRP_SUM`,0) AS RSRP_SUM,
		IFNULL(`RSRP_CNT`,0) AS RSRP_CNT,
		IFNULL(`RSRQ_SUM`,0) AS RSRQ_SUM,
		IFNULL(`RSRQ_CNT`,0) AS RSRQ_CNT,
		IFNULL(`PILOT_DOMINANCE_SUM`,0) AS PILOT_DOMINANCE_SUM,
		IFNULL(`PILOT_DOMINANCE_CNT`,0) AS PILOT_DOMINANCE_CNT,
		IFNULL(`DROP_SIGNAL_CNT`,0) AS DROP_SIGNAL_CNT,
		IFNULL(`DROP_DATA_CNT`,0) AS DROP_DATA_CNT,
		IFNULL(`DROP_SMS_CNT`,0) AS DROP_SMS_CNT,
		IFNULL(`DROP_VOLTE_CNT`,0) AS DROP_VOLTE_CNT,
		IFNULL(`DROP_UNSPECIFIED_CNT`,0) AS DROP_UNSPECIFIED_CNT,
		IFNULL(`END_NON_BLOCK_CALL_CNT`,0) AS END_NON_BLOCK_CALL_CNT,
		IFNULL(`UL_THROUPUT_SUM`,0) AS UL_THROUPUT_SUM,
		IFNULL(`UL_THROUPUT_CNT`,0) AS UL_THROUPUT_CNT,
		IFNULL(`DL_THROUPUT_SUM`,0) AS DL_THROUPUT_SUM,
		IFNULL(`DL_THROUPUT_CNT`,0) AS DL_THROUPUT_CNT,
		IFNULL(`END_NON_BLOCK_SIGNAL_CNT`,0) AS END_NON_BLOCK_SIGNAL_CNT,
		IFNULL(`END_NON_BLOCK_DATA_CNT`,0) AS END_NON_BLOCK_DATA_CNT,
		IFNULL(`MR_4G_RSRP_SERVING_SUM`,0) AS MR_4G_RSRP_SERVING_SUM,
		IFNULL(`MR_4G_RSRP_SERVING_CNT`,0) AS MR_4G_RSRP_SERVING_CNT,
		IFNULL(`MR_4G_RSRQ_SERVING_SUM`,0) AS MR_4G_RSRQ_SERVING_SUM,
		IFNULL(`MR_4G_RSRQ_SERVING_CNT`,0) AS MR_4G_RSRQ_SERVING_CNT,	
		IFNULL(`DATA_DUR_SUM`,0) AS DATA_DUR_SUM,
		IFNULL(`SIGNAL_DUR_SUM`,0) AS SIGNAL_DUR_SUM,
		IFNULL(`VOLTE_DUR_SUM`,0) AS VOLTE_DUR_SUM,
		IFNULL(`SMS_DUR_SUM`,0) AS SMS_DUR_SUM,
		IFNULL(`UNSP_DUR_SUM`,0) AS UNSP_DUR_SUM,
		IFNULL(`SMS_CNT`,0) AS SMS_CNT,
		IFNULL(`VOLTE_CNT`,0) AS VOLTE_CNT';
		
	DECLARE TILE_LTE_COLUMN_SUM_STR VARCHAR(3000) DEFAULT 
		'SUM(IFNULL(`INIT_CALL_CNT`,0)) AS INIT_CALL_CNT,
		SUM(IFNULL(`END_CALL_CNT`,0)) AS END_CALL_CNT,
		SUM(IFNULL(`SIGNAL_CNT`,0)) AS SIGNAL_CNT,
		SUM(IFNULL(`DATA_CNT`,0)) AS DATA_CNT,
		SUM(IFNULL(`UNSPECIFIED_CNT`,0)) AS UNSPECIFIED_CNT,
		SUM(IFNULL(`CALL_DUR_SUM`,0)) AS CALL_DUR_SUM,
		SUM(IFNULL(`BLOCK_CNT`,0)) AS BLOCK_CNT,
		SUM(IFNULL(`DROP_CNT`,0)) AS DROP_CNT,
		SUM(IFNULL(`CSFB_CNT`,0)) AS CSFB_CNT,
		SUM(IFNULL(`INTER_FREQ_ATTEMPT_CNT`,0)) AS INTER_FREQ_ATTEMPT_CNT,
		SUM(IFNULL(`INTER_FREQ_FAILURE_CNT`,0)) AS INTER_FREQ_FAILURE_CNT,
		SUM(IFNULL(`INTRA_FREQ_ATTEMPT_CNT`,0)) AS INTRA_FREQ_ATTEMPT_CNT,
		SUM(IFNULL(`INTRA_FREQ_FAILURE_CNT`,0)) AS INTRA_FREQ_FAILURE_CNT,
		SUM(IFNULL(`4G_3G_ATTEMPT_CNT`,0)) AS 4G_3G_ATTEMPT_CNT,
		SUM(IFNULL(`4G_3G_FAILURE_CNT`,0)) AS 4G_3G_FAILURE_CNT,
		SUM(IFNULL(`4G_2G_ATTEMPT_CNT`,0)) AS 4G_2G_ATTEMPT_CNT,
		SUM(IFNULL(`4G_2G_FAILURE_CNT`,0)) AS 4G_2G_FAILURE_CNT,
		SUM(IFNULL(`PS_UL_VOLUME_SUM`,0)) AS PS_UL_VOLUME_SUM,
		SUM(IFNULL(`PS_DL_VOLUME_SUM`,0)) AS PS_DL_VOLUME_SUM,
		MAX(IFNULL(`PS_UL_SPEED_MAX`,0)) AS PS_UL_SPEED_MAX,
		MAX(IFNULL(`PS_DL_SPEED_MAX`,0)) AS PS_DL_SPEED_MAX,
		SUM(IFNULL(`RSRP_SUM`,0)) AS RSRP_SUM,
		SUM(IFNULL(`RSRP_CNT`,0)) AS RSRP_CNT,
		SUM(IFNULL(`RSRQ_SUM`,0)) AS RSRQ_SUM,
		SUM(IFNULL(`RSRQ_CNT`,0)) AS RSRQ_CNT,
		SUM(IFNULL(`PILOT_DOMINANCE_SUM`,0)) AS PILOT_DOMINANCE_SUM,
		SUM(IFNULL(`PILOT_DOMINANCE_CNT`,0)) AS PILOT_DOMINANCE_CNT,
		SUM(IFNULL(`DROP_SIGNAL_CNT`,0)) AS DROP_SIGNAL_CNT,
		SUM(IFNULL(`DROP_DATA_CNT`,0)) AS DROP_DATA_CNT,
		SUM(IFNULL(`DROP_SMS_CNT`,0)) AS DROP_SMS_CNT,
		SUM(IFNULL(`DROP_VOLTE_CNT`,0)) AS DROP_VOLTE_CNT,
		SUM(IFNULL(`DROP_UNSPECIFIED_CNT`,0)) AS DROP_UNSPECIFIED_CNT,
		SUM(IFNULL(`END_NON_BLOCK_CALL_CNT`,0)) AS END_NON_BLOCK_CALL_CNT,
		SUM(IFNULL(`UL_THROUPUT_SUM`,0)) AS UL_THROUPUT_SUM,
		SUM(IFNULL(`UL_THROUPUT_CNT`,0)) AS UL_THROUPUT_CNT,
		SUM(IFNULL(`DL_THROUPUT_SUM`,0)) AS DL_THROUPUT_SUM,
		SUM(IFNULL(`DL_THROUPUT_CNT`,0)) AS DL_THROUPUT_CNT,
		SUM(IFNULL(`END_NON_BLOCK_SIGNAL_CNT`,0)) AS END_NON_BLOCK_SIGNAL_CNT,
		SUM(IFNULL(`END_NON_BLOCK_DATA_CNT`,0)) AS END_NON_BLOCK_DATA_CNT,
		SUM(IFNULL(`MR_4G_RSRP_SERVING_SUM`,0)) AS MR_4G_RSRP_SERVING_SUM,
		SUM(IFNULL(`MR_4G_RSRP_SERVING_CNT`,0)) AS MR_4G_RSRP_SERVING_CNT,
		SUM(IFNULL(`MR_4G_RSRQ_SERVING_SUM`,0)) AS MR_4G_RSRQ_SERVING_SUM,
		SUM(IFNULL(`MR_4G_RSRQ_SERVING_CNT`,0)) AS MR_4G_RSRQ_SERVING_CNT,	
		SUM(IFNULL(`DATA_DUR_SUM`,0)) AS DATA_DUR_SUM,
		SUM(IFNULL(`SIGNAL_DUR_SUM`,0)) AS SIGNAL_DUR_SUM,
		SUM(IFNULL(`VOLTE_DUR_SUM`,0)) AS VOLTE_DUR_SUM,
		SUM(IFNULL(`SMS_DUR_SUM`,0)) AS SMS_DUR_SUM,
		SUM(IFNULL(`UNSP_DUR_SUM`,0)) AS UNSP_DUR_SUM,
		SUM(IFNULL(`SMS_CNT`,0)) AS SMS_CNT,
		SUM(IFNULL(`VOLTE_CNT`,0)) AS VOLTE_CNT';
		
	DECLARE TILE_LTE_COLUMN_UPD_STR VARCHAR(10000) DEFAULT
		'RPT_TABLE_NAME.INIT_CALL_CNT=RPT_TABLE_NAME.INIT_CALL_CNT+VALUES(INIT_CALL_CNT),
		RPT_TABLE_NAME.END_CALL_CNT=RPT_TABLE_NAME.END_CALL_CNT+VALUES(END_CALL_CNT),
		RPT_TABLE_NAME.SIGNAL_CNT=RPT_TABLE_NAME.SIGNAL_CNT+VALUES(SIGNAL_CNT),
		RPT_TABLE_NAME.DATA_CNT=RPT_TABLE_NAME.DATA_CNT+VALUES(DATA_CNT),
		RPT_TABLE_NAME.UNSPECIFIED_CNT=RPT_TABLE_NAME.UNSPECIFIED_CNT+VALUES(UNSPECIFIED_CNT),
		RPT_TABLE_NAME.CALL_DUR_SUM=RPT_TABLE_NAME.CALL_DUR_SUM+VALUES(CALL_DUR_SUM),
		RPT_TABLE_NAME.BLOCK_CNT=RPT_TABLE_NAME.BLOCK_CNT+VALUES(BLOCK_CNT),
		RPT_TABLE_NAME.DROP_CNT=RPT_TABLE_NAME.DROP_CNT+VALUES(DROP_CNT),
		RPT_TABLE_NAME.CSFB_CNT=RPT_TABLE_NAME.CSFB_CNT+VALUES(CSFB_CNT),
		RPT_TABLE_NAME.INTER_FREQ_ATTEMPT_CNT=RPT_TABLE_NAME.INTER_FREQ_ATTEMPT_CNT+VALUES(INTER_FREQ_ATTEMPT_CNT),
		RPT_TABLE_NAME.INTER_FREQ_FAILURE_CNT=RPT_TABLE_NAME.INTER_FREQ_FAILURE_CNT+VALUES(INTER_FREQ_FAILURE_CNT),
		RPT_TABLE_NAME.INTRA_FREQ_ATTEMPT_CNT=RPT_TABLE_NAME.INTRA_FREQ_ATTEMPT_CNT+VALUES(INTRA_FREQ_ATTEMPT_CNT),
		RPT_TABLE_NAME.INTRA_FREQ_FAILURE_CNT=RPT_TABLE_NAME.INTRA_FREQ_FAILURE_CNT+VALUES(INTRA_FREQ_FAILURE_CNT),
		RPT_TABLE_NAME.4G_3G_ATTEMPT_CNT=RPT_TABLE_NAME.4G_3G_ATTEMPT_CNT+VALUES(4G_3G_ATTEMPT_CNT),
		RPT_TABLE_NAME.4G_3G_FAILURE_CNT=RPT_TABLE_NAME.4G_3G_FAILURE_CNT+VALUES(4G_3G_FAILURE_CNT),
		RPT_TABLE_NAME.4G_2G_ATTEMPT_CNT=RPT_TABLE_NAME.4G_2G_ATTEMPT_CNT+VALUES(4G_2G_ATTEMPT_CNT),
		RPT_TABLE_NAME.4G_2G_FAILURE_CNT=RPT_TABLE_NAME.4G_2G_FAILURE_CNT+VALUES(4G_2G_FAILURE_CNT),
		RPT_TABLE_NAME.PS_UL_VOLUME_SUM=RPT_TABLE_NAME.PS_UL_VOLUME_SUM+VALUES(PS_UL_VOLUME_SUM),
		RPT_TABLE_NAME.PS_DL_VOLUME_SUM=RPT_TABLE_NAME.PS_DL_VOLUME_SUM+VALUES(PS_DL_VOLUME_SUM),
		RPT_TABLE_NAME.PS_UL_SPEED_MAX=CASE WHEN RPT_TABLE_NAME.PS_UL_SPEED_MAX > VALUES(PS_UL_SPEED_MAX) THEN RPT_TABLE_NAME.PS_UL_SPEED_MAX ELSE VALUES(PS_UL_SPEED_MAX) END,    
		RPT_TABLE_NAME.PS_DL_SPEED_MAX=CASE WHEN RPT_TABLE_NAME.PS_DL_SPEED_MAX > VALUES(PS_DL_SPEED_MAX) THEN RPT_TABLE_NAME.PS_DL_SPEED_MAX ELSE VALUES(PS_DL_SPEED_MAX) END,
		RPT_TABLE_NAME.RSRP_SUM=RPT_TABLE_NAME.RSRP_SUM+VALUES(RSRP_SUM),
		RPT_TABLE_NAME.RSRP_CNT=RPT_TABLE_NAME.RSRP_CNT+VALUES(RSRP_CNT),
		RPT_TABLE_NAME.RSRQ_SUM=RPT_TABLE_NAME.RSRQ_SUM+VALUES(RSRQ_SUM),
		RPT_TABLE_NAME.RSRQ_CNT=RPT_TABLE_NAME.RSRQ_CNT+VALUES(RSRQ_CNT),
		RPT_TABLE_NAME.PILOT_DOMINANCE_SUM=RPT_TABLE_NAME.PILOT_DOMINANCE_SUM+VALUES(PILOT_DOMINANCE_SUM),
		RPT_TABLE_NAME.PILOT_DOMINANCE_CNT=RPT_TABLE_NAME.PILOT_DOMINANCE_CNT+VALUES(PILOT_DOMINANCE_CNT),
		RPT_TABLE_NAME.DROP_SIGNAL_CNT=RPT_TABLE_NAME.DROP_SIGNAL_CNT+VALUES(DROP_SIGNAL_CNT),
		RPT_TABLE_NAME.DROP_DATA_CNT=RPT_TABLE_NAME.DROP_DATA_CNT+VALUES(DROP_DATA_CNT),
		RPT_TABLE_NAME.DROP_SMS_CNT=RPT_TABLE_NAME.DROP_SMS_CNT+VALUES(DROP_SMS_CNT),
		RPT_TABLE_NAME.DROP_VOLTE_CNT=RPT_TABLE_NAME.DROP_VOLTE_CNT+VALUES(DROP_VOLTE_CNT),
		RPT_TABLE_NAME.DROP_UNSPECIFIED_CNT=RPT_TABLE_NAME.DROP_UNSPECIFIED_CNT+VALUES(DROP_UNSPECIFIED_CNT),
		RPT_TABLE_NAME.END_NON_BLOCK_CALL_CNT=RPT_TABLE_NAME.END_NON_BLOCK_CALL_CNT+VALUES(END_NON_BLOCK_CALL_CNT),
		RPT_TABLE_NAME.UL_THROUPUT_SUM=RPT_TABLE_NAME.UL_THROUPUT_SUM+VALUES(UL_THROUPUT_SUM),
		RPT_TABLE_NAME.UL_THROUPUT_CNT=RPT_TABLE_NAME.UL_THROUPUT_CNT+VALUES(UL_THROUPUT_CNT),
		RPT_TABLE_NAME.DL_THROUPUT_SUM=RPT_TABLE_NAME.DL_THROUPUT_SUM+VALUES(DL_THROUPUT_SUM),
		RPT_TABLE_NAME.DL_THROUPUT_CNT=RPT_TABLE_NAME.DL_THROUPUT_CNT+VALUES(DL_THROUPUT_CNT),
		RPT_TABLE_NAME.END_NON_BLOCK_SIGNAL_CNT=RPT_TABLE_NAME.END_NON_BLOCK_SIGNAL_CNT+VALUES(END_NON_BLOCK_SIGNAL_CNT),
		RPT_TABLE_NAME.END_NON_BLOCK_DATA_CNT=RPT_TABLE_NAME.END_NON_BLOCK_DATA_CNT+VALUES(END_NON_BLOCK_DATA_CNT),
		RPT_TABLE_NAME.MR_4G_RSRP_SERVING_SUM=RPT_TABLE_NAME.MR_4G_RSRP_SERVING_SUM+VALUES(MR_4G_RSRP_SERVING_SUM),
		RPT_TABLE_NAME.MR_4G_RSRP_SERVING_CNT=RPT_TABLE_NAME.MR_4G_RSRP_SERVING_CNT+VALUES(MR_4G_RSRP_SERVING_CNT),
		RPT_TABLE_NAME.MR_4G_RSRQ_SERVING_SUM=RPT_TABLE_NAME.MR_4G_RSRQ_SERVING_SUM+VALUES(MR_4G_RSRQ_SERVING_SUM),
		RPT_TABLE_NAME.MR_4G_RSRQ_SERVING_CNT=RPT_TABLE_NAME.MR_4G_RSRQ_SERVING_CNT+VALUES(MR_4G_RSRQ_SERVING_CNT),	
		RPT_TABLE_NAME.DATA_DUR_SUM=RPT_TABLE_NAME.DATA_DUR_SUM+VALUES(DATA_DUR_SUM),
		RPT_TABLE_NAME.SIGNAL_DUR_SUM=RPT_TABLE_NAME.SIGNAL_DUR_SUM+VALUES(SIGNAL_DUR_SUM),
		RPT_TABLE_NAME.VOLTE_DUR_SUM=RPT_TABLE_NAME.VOLTE_DUR_SUM+VALUES(VOLTE_DUR_SUM),
		RPT_TABLE_NAME.SMS_DUR_SUM=RPT_TABLE_NAME.SMS_DUR_SUM+VALUES(SMS_DUR_SUM),
		RPT_TABLE_NAME.UNSP_DUR_SUM=RPT_TABLE_NAME.UNSP_DUR_SUM+VALUES(UNSP_DUR_SUM),
		RPT_TABLE_NAME.SMS_CNT=RPT_TABLE_NAME.SMS_CNT+VALUES(SMS_CNT),
		RPT_TABLE_NAME.VOLTE_CNT=RPT_TABLE_NAME.VOLTE_CNT+VALUES(VOLTE_CNT)';
		
	DECLARE TILE_GSM_COLUMN_STR VARCHAR(1500) DEFAULT 
		'INIT_CALL_CNT, 
		  END_CALL_CNT,
		  VOICE_CNT,
		  SIGNAL_CNT,
		  SMS_CNT,
		  GPRS_CNT,
		  OTHER_CNT,
		  BLOCK_CNT,
		  DROP_VOICE_CNT,
		  DROP_SIGNAL_CNT,
		  DROP_SMS_CNT,
		  DROP_GPRS_CNT,
		  DROP_OTHER_CNT,
		  NON_BLOCK_VOICE_CNT,
		  NON_BLOCK_SIGNAL_CNT,
		  NON_BLOCK_SMS_CNT,
		  NON_BLOCK_GPRS_CNT,
		  NON_BLOCK_OTHER_CNT,
		  CALL_DUR_SUM,
		  RXLEV_SUM,
		  RXLEV_CNT,
		  RXQUAL_SUM,
		  RXQUAL_CNT,
		  CALL_PS_DUR';
		
	DECLARE TILE_GSM_COLUMN_IFNULL_STR VARCHAR(2000) DEFAULT 
		'IFNULL(INIT_CALL_CNT,0) AS INIT_CALL_CNT,           
		IFNULL(END_CALL_CNT,0) AS END_CALL_CNT,          
		IFNULL(VOICE_CNT,0) AS VOICE_CNT,           
		IFNULL(SIGNAL_CNT,0) AS SIGNAL_CNT,          
		IFNULL(SMS_CNT,0) AS SMS_CNT,             
		IFNULL(GPRS_CNT,0) AS GPRS_CNT,            
		IFNULL(OTHER_CNT,0) AS OTHER_CNT,           
		IFNULL(BLOCK_CNT,0) AS BLOCK_CNT,           
		IFNULL(DROP_VOICE_CNT,0) AS DROP_VOICE_CNT,      
		IFNULL(DROP_SIGNAL_CNT,0) AS DROP_SIGNAL_CNT,     
		IFNULL(DROP_SMS_CNT,0) AS DROP_SMS_CNT,        
		IFNULL(DROP_GPRS_CNT,0) AS DROP_GPRS_CNT,       
		IFNULL(DROP_OTHER_CNT,0) AS DROP_OTHER_CNT,      
		IFNULL(NON_BLOCK_VOICE_CNT,0) AS NON_BLOCK_VOICE_CNT, 
		IFNULL(NON_BLOCK_SIGNAL_CNT,0) AS NON_BLOCK_SIGNAL_CNT,
		IFNULL(NON_BLOCK_SMS_CNT,0) AS NON_BLOCK_SMS_CNT,   
		IFNULL(NON_BLOCK_GPRS_CNT,0) AS NON_BLOCK_GPRS_CNT,  
		IFNULL(NON_BLOCK_OTHER_CNT,0) AS NON_BLOCK_OTHER_CNT, 
		IFNULL(CALL_DUR_SUM,0) AS CALL_DUR_SUM, 
		IFNULL(RXLEV_SUM,0) AS RXLEV_SUM,           
		IFNULL(RXLEV_CNT,0) AS RXLEV_CNT,           
		IFNULL(RXQUAL_SUM,0) AS RXQUAL_SUM,          
		IFNULL(RXQUAL_CNT,0) AS RXQUAL_CNT,
		IFNULL(CALL_PS_DUR,0) AS CALL_PS_DUR';
		
	DECLARE TILE_GSM_COLUMN_SUM_STR VARCHAR(2000) DEFAULT 
		'SUM(IFNULL(INIT_CALL_CNT,0)) AS INIT_CALL_CNT,           
		SUM(IFNULL(END_CALL_CNT,0)) AS END_CALL_CNT,          
		SUM(IFNULL(VOICE_CNT,0)) AS VOICE_CNT,
		SUM(IFNULL(SIGNAL_CNT,0)) AS SIGNAL_CNT,
		SUM(IFNULL(SMS_CNT,0)) AS SMS_CNT,
		SUM(IFNULL(GPRS_CNT,0)) AS GPRS_CNT,
		SUM(IFNULL(OTHER_CNT,0)) AS OTHER_CNT,
		SUM(IFNULL(BLOCK_CNT,0)) AS BLOCK_CNT,
		SUM(IFNULL(DROP_VOICE_CNT,0)) AS DROP_VOICE_CNT,
		SUM(IFNULL(DROP_SIGNAL_CNT,0)) AS DROP_SIGNAL_CNT,
		SUM(IFNULL(DROP_SMS_CNT,0)) AS DROP_SMS_CNT,
		SUM(IFNULL(DROP_GPRS_CNT,0)) AS DROP_GPRS_CNT,
		SUM(IFNULL(DROP_OTHER_CNT,0)) AS DROP_OTHER_CNT,
		SUM(IFNULL(NON_BLOCK_VOICE_CNT,0)) AS NON_BLOCK_VOICE_CNT,
		SUM(IFNULL(NON_BLOCK_SIGNAL_CNT,0)) AS NON_BLOCK_SIGNAL_CNT,
		SUM(IFNULL(NON_BLOCK_SMS_CNT,0)) AS NON_BLOCK_SMS_CNT,
		SUM(IFNULL(NON_BLOCK_GPRS_CNT,0)) AS NON_BLOCK_GPRS_CNT,
		SUM(IFNULL(NON_BLOCK_OTHER_CNT,0)) AS NON_BLOCK_OTHER_CNT,
		SUM(IFNULL(CALL_DUR_SUM,0)) AS CALL_DUR_SUM,
		SUM(IFNULL(RXLEV_SUM,0)) AS RXLEV_SUM,
		SUM(IFNULL(RXLEV_CNT,0)) AS RXLEV_CNT,
		SUM(IFNULL(RXQUAL_SUM,0)) AS RXQUAL_SUM,
		SUM(IFNULL(RXQUAL_CNT,0)) AS RXQUAL_CNT,
		SUM(IFNULL(CALL_PS_DUR,0)) AS CALL_PS_DUR';
		
	DECLARE TILE_GSM_COLUMN_UPD_STR VARCHAR(10000) DEFAULT
		'RPT_TABLE_NAME.INIT_CALL_CNT=RPT_TABLE_NAME.INIT_CALL_CNT+VALUES(INIT_CALL_CNT),
		RPT_TABLE_NAME.END_CALL_CNT=RPT_TABLE_NAME.END_CALL_CNT+VALUES(END_CALL_CNT),
		RPT_TABLE_NAME.VOICE_CNT=RPT_TABLE_NAME.VOICE_CNT+VALUES(VOICE_CNT),
		RPT_TABLE_NAME.SIGNAL_CNT=RPT_TABLE_NAME.SIGNAL_CNT+VALUES(SIGNAL_CNT),
		RPT_TABLE_NAME.SMS_CNT=RPT_TABLE_NAME.SMS_CNT+VALUES(SMS_CNT),
		RPT_TABLE_NAME.GPRS_CNT=RPT_TABLE_NAME.GPRS_CNT+VALUES(GPRS_CNT),
		RPT_TABLE_NAME.OTHER_CNT=RPT_TABLE_NAME.OTHER_CNT+VALUES(OTHER_CNT),
		RPT_TABLE_NAME.BLOCK_CNT=RPT_TABLE_NAME.BLOCK_CNT+VALUES(BLOCK_CNT),
		RPT_TABLE_NAME.DROP_VOICE_CNT=RPT_TABLE_NAME.DROP_VOICE_CNT+VALUES(DROP_VOICE_CNT),
		RPT_TABLE_NAME.DROP_SIGNAL_CNT=RPT_TABLE_NAME.DROP_SIGNAL_CNT+VALUES(DROP_SIGNAL_CNT),
		RPT_TABLE_NAME.DROP_SMS_CNT=RPT_TABLE_NAME.DROP_SMS_CNT+VALUES(DROP_SMS_CNT),
		RPT_TABLE_NAME.DROP_GPRS_CNT=RPT_TABLE_NAME.DROP_GPRS_CNT+VALUES(DROP_GPRS_CNT),
		RPT_TABLE_NAME.DROP_OTHER_CNT=RPT_TABLE_NAME.DROP_OTHER_CNT+VALUES(DROP_OTHER_CNT),
		RPT_TABLE_NAME.NON_BLOCK_VOICE_CNT=RPT_TABLE_NAME.NON_BLOCK_VOICE_CNT+VALUES(NON_BLOCK_VOICE_CNT),
		RPT_TABLE_NAME.NON_BLOCK_SIGNAL_CNT=RPT_TABLE_NAME.NON_BLOCK_SIGNAL_CNT+VALUES(NON_BLOCK_SIGNAL_CNT),
		RPT_TABLE_NAME.NON_BLOCK_SMS_CNT=RPT_TABLE_NAME.NON_BLOCK_SMS_CNT+VALUES(NON_BLOCK_SMS_CNT),
		RPT_TABLE_NAME.NON_BLOCK_GPRS_CNT=RPT_TABLE_NAME.NON_BLOCK_GPRS_CNT+VALUES(NON_BLOCK_GPRS_CNT),
		RPT_TABLE_NAME.NON_BLOCK_OTHER_CNT=RPT_TABLE_NAME.NON_BLOCK_OTHER_CNT+VALUES(NON_BLOCK_OTHER_CNT),
		RPT_TABLE_NAME.CALL_DUR_SUM=RPT_TABLE_NAME.CALL_DUR_SUM+VALUES(CALL_DUR_SUM),
		RPT_TABLE_NAME.RXLEV_SUM=RPT_TABLE_NAME.RXLEV_SUM+VALUES(RXLEV_SUM),
		RPT_TABLE_NAME.RXLEV_CNT=RPT_TABLE_NAME.RXLEV_CNT+VALUES(RXLEV_CNT),
		RPT_TABLE_NAME.RXQUAL_SUM=RPT_TABLE_NAME.RXQUAL_SUM+VALUES(RXQUAL_SUM),
		RPT_TABLE_NAME.RXQUAL_CNT=RPT_TABLE_NAME.RXQUAL_CNT+VALUES(RXQUAL_CNT),
		RPT_TABLE_NAME.CALL_PS_DUR=RPT_TABLE_NAME.CALL_PS_DUR+VALUES(CALL_PS_DUR)';
	
	DECLARE CONTINUE HANDLER FOR SQLEXCEPTION
	BEGIN
		SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS `gt_global_statistic`.`nw_error_log`
				(
				  `TABLE_NAME` VARCHAR(50) NOT NULL,
				  `SP_NAME` VARCHAR(50) DEFAULT NULL,
				  `INSERT_CMD` VARCHAR(100) DEFAULT NULL,
				  `INSERT_TIME` DATETIME DEFAULT NULL
				) ENGINE=MYISAM;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		INSERT INTO `gt_global_statistic`.`nw_error_log`(`TABLE_NAME`,`SP_NAME`,`INSERT_CMD`,`INSERT_TIME`)
		VALUES (@SOURCE_TABLE_NAME,
			'SP_Generate_Global_Statistic_Sub_tile_Aggr',
			CONCAT('Step ',@ERROR_FLAG,' error'),
			NOW());
	
		SET @SqlCmd=CONCAT('REPAIR TABLE ',@REPAIR_TABLE_NAME,';');				
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		SET @SqlCmd=CONCAT('SELECT  GROUP_CONCAT(DISTINCT CONCAT(TABLE_NAME)) INTO @DROP_TABLE_LIST
					FROM information_schema.TABLES 
					WHERE TABLE_SCHEMA=''gt_aggregate_db''
					AND TABLE_NAME<>''tmp_dim_handset''
					AND TABLE_NAME <> ''',@tmp_tile_19_umts_hr,'''
					AND TABLE_NAME <> ''',@tmp_tile_19_lte_hr,'''
					AND TABLE_NAME <> ''',@tmp_tile_19_gsm_hr,'''
					AND TABLE_NAME <> ''',@tmp_tile_pu_umts_hr,'''
					AND TABLE_NAME <> ''',@tmp_tile_pu_lte_hr,'''
					AND TABLE_NAME <> ''',@tmp_tile_pu_gsm_hr,''';');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		
		SET @v_i=1;
		SET @Quotient_v=1;
		SET @v_R_Max=(CHAR_LENGTH(@DROP_TABLE_LIST) - CHAR_LENGTH(REPLACE(@DROP_TABLE_LIST,',','')))/(CHAR_LENGTH(','))+1;	
		WHILE @v_i <= @v_R_Max DO
		BEGIN
			SET @DROP_TABLE=gt_strtok(@DROP_TABLE_LIST,@v_i,',');
			
			SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS gt_aggregate_db.',@DROP_TABLE,' ;');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
	
		SET @v_i=@v_i+@Quotient_v;	
		END;
		END WHILE;	
	END;	
	
  	CALL gt_gw_main.`SP_Sub_Set_Session_Param_LTE`('');
  	
	SET @global_db='gt_global_statistic';
	
	SET @ZOOM_LEVEL = gt_covmo_csv_get(TileResolution,3);
	SET @TILE_ID_LVL1 = CONCAT('TILE_ID_',gt_covmo_csv_get(TileResolution,1));
	SET @TILE_ID_LVL2 = CONCAT('TILE_ID_',gt_covmo_csv_get(TileResolution,2));
		
	SET @FLAG_REG_3_UMTS_HR=0;
	SET @FLAG_REG_3_UMTS_DY=0;
	SET @FLAG_REG_2_UMTS_HR=0;
	SET @FLAG_REG_2_UMTS_DY=0;
	SET @FLAG_REG_1_UMTS_HR=0;
	SET @FLAG_REG_1_UMTS_DY=0;
	SET @FLAG_REG_3_UMTS_WK=0;
	SET @FLAG_REG_3_UMTS_MN=0;
	SET @FLAG_REG_2_UMTS_WK=0;
	SET @FLAG_REG_2_UMTS_MN=0;
	SET @FLAG_REG_1_UMTS_WK=0;
	SET @FLAG_REG_1_UMTS_MN=0;
	SET @FLAG_REG_3_LTE_HR=0;
	SET @FLAG_REG_3_LTE_DY=0;
	SET @FLAG_REG_2_LTE_HR=0;
	SET @FLAG_REG_2_LTE_DY=0;
	SET @FLAG_REG_1_LTE_HR=0;
	SET @FLAG_REG_1_LTE_DY=0;
	SET @FLAG_REG_3_LTE_WK=0;
	SET @FLAG_REG_3_LTE_MN=0;
	SET @FLAG_REG_2_LTE_WK=0;
	SET @FLAG_REG_2_LTE_MN=0;
	SET @FLAG_REG_1_LTE_WK=0;
	SET @FLAG_REG_1_LTE_MN=0;
	
	SET @FLAG_REG_3_GSM_HR=0;
	SET @FLAG_REG_3_GSM_DY=0;
	SET @FLAG_REG_2_GSM_HR=0;
	SET @FLAG_REG_2_GSM_DY=0;
	SET @FLAG_REG_1_GSM_HR=0;
	SET @FLAG_REG_1_GSM_DY=0;
	SET @FLAG_REG_3_GSM_WK=0;
	SET @FLAG_REG_3_GSM_MN=0;
	SET @FLAG_REG_2_GSM_WK=0;
	SET @FLAG_REG_2_GSM_MN=0;
	SET @FLAG_REG_1_GSM_WK=0;
	SET @FLAG_REG_1_GSM_MN=0;
	
	SET SHARE_IP ='127.0.0.1';
	SELECT `VARIABLE_VALUE` INTO SHARE_PORT FROM `information_schema`.`GLOBAL_VARIABLES` WHERE VARIABLE_NAME = 'port';
	SELECT `value` INTO SHARE_ACCOUNT FROM `gt_gw_main`.`integration_param` WHERE gt_group='system' AND gt_name='apDbUser';
	SELECT `value` INTO SHARE_PW FROM `gt_gw_main`.`integration_param` WHERE gt_group='system' AND gt_name='apDbPass';
	SET SHARE_DB='gt_aggregate_db';
	
	
	INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT(TECH_MASK,',',WORKER_ID,' START'), START_TIME);
	SET STEP_START_TIME := SYSDATE();
	
											
	
	
	IF FLAG IN (1,0) THEN 
		SET @SqlCmd=CONCAT('SELECT GROUP_CONCAT(DISTINCT CONCAT(`DATA_DATE`,'','',`DATA_HOUR`,'','',`TECH_MASK`) SEPARATOR ''|'' ) INTO @PU_STR_TECH
					FROM ',@global_db,'.tmp_table_call_cnt_',WORKER_ID,' 
					WHERE TECH_MASK=',TECH_MASK,';');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		SET @SqlCmd=CONCAT('SELECT GROUP_CONCAT(DISTINCT `group_id` ORDER BY `group_id` SEPARATOR ''|'' ) INTO @REG_GROUP FROM ',@global_db,'.`usr_polygon_reg_3`;');	
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT att_value INTO @usr_def_polygon_group_id FROM gt_global_statistic.nw_config WHERE group_name= ''system'' AND att_name=''USR_DEFINE_POLYGON_GROUP_ID'';');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
			
		SET @v_reg_m=1;
		SET @v_reg_Max=gt_covmo_csv_count(@REG_GROUP,'|');
		WHILE @v_reg_m <= @v_reg_Max DO
		BEGIN
			SET v_group_db_name=CONCAT('gt_global_statistic_g',gt_strtok(@REG_GROUP, @v_reg_m, '|'));
		
			SET v_i=1;
			SET v_R_Max=gt_covmo_csv_count(@PU_STR_TECH,'|');
			
			WHILE v_i <= v_R_Max DO
			BEGIN	
				SET v_DATA_DATE:=gt_covmo_csv_get(gt_strtok(@PU_STR_TECH, v_i, '|'),1);
				SET v_DATA_HOUR:=gt_covmo_csv_get(gt_strtok(@PU_STR_TECH, v_i, '|'),2);
				SET v_TECH_MASK:=gt_covmo_csv_get(gt_strtok(@PU_STR_TECH, v_i, '|'),3);
				SELECT `DAY_OF_WEEK`(v_DATA_DATE) INTO @DAY_OF_WEEK;
				SET @FIRST_DAY=gt_strtok(@DAY_OF_WEEK, 1, '|');
				SET @END_DAY=gt_strtok(@DAY_OF_WEEK, 2, '|');
				SET @DATE_WK=CONCAT(DATE_FORMAT(@FIRST_DAY,'%Y%m%d'),'_',DATE_FORMAT(@END_DAY,'%Y%m%d'));
				SET @DATE_MN=DATE_FORMAT(v_DATA_DATE,'%Y%m');
				SET @DATE_DY=DATE_FORMAT(v_DATA_DATE,'%Y%m%d');
				SET @EX_DATE=CONCAT(DATE_FORMAT(v_DATA_DATE,'%Y%m%d_'),v_DATA_HOUR,'_',WORKER_ID);
		
				
				SET @table_tile_19_umts_hr=CONCAT('table_tile_',@ZOOM_LEVEL,'_umts_hr_',@DATE_DY);
				SET @table_tile_19_umts_dy=CONCAT('table_tile_',@ZOOM_LEVEL,'_umts_dy_',@DATE_DY);
				
	
				SET @usr_polygon_pu_3='usr_polygon_pu_3';					
				
				SET @table_tile_19_lte_hr=CONCAT('table_tile_',@ZOOM_LEVEL,'_lte_hr_',@DATE_DY);
				SET @table_tile_19_lte_dy=CONCAT('table_tile_',@ZOOM_LEVEL,'_lte_dy_',@DATE_DY);
				
				SET @table_reg_3_umts_hr=CONCAT('table_reg_3_umts_hr_',@DATE_DY);
				SET @table_reg_2_umts_hr=CONCAT('table_reg_2_umts_hr_',@DATE_DY);
				SET @table_reg_1_umts_hr=CONCAT('table_reg_1_umts_hr_',@DATE_DY);
				SET @table_reg_3_umts_dy=CONCAT('table_reg_3_umts_dy_',@DATE_DY);
				SET @table_reg_2_umts_dy=CONCAT('table_reg_2_umts_dy_',@DATE_DY);
				SET @table_reg_1_umts_dy=CONCAT('table_reg_1_umts_dy_',@DATE_DY);
				SET @table_reg_3_umts_wk=CONCAT('table_reg_3_umts_wk_',@DATE_WK);
				SET @table_reg_2_umts_wk=CONCAT('table_reg_2_umts_wk_',@DATE_WK);
				SET @table_reg_1_umts_wk=CONCAT('table_reg_1_umts_wk_',@DATE_WK);
				SET @table_reg_3_umts_mn=CONCAT('table_reg_3_umts_mn_',@DATE_MN);
				SET @table_reg_2_umts_mn=CONCAT('table_reg_2_umts_mn_',@DATE_MN);
				SET @table_reg_1_umts_mn=CONCAT('table_reg_1_umts_mn_',@DATE_MN);	
				
				SET @table_reg_3_lte_hr=CONCAT('table_reg_3_lte_hr_',@DATE_DY);
				SET @table_reg_2_lte_hr=CONCAT('table_reg_2_lte_hr_',@DATE_DY);
				SET @table_reg_1_lte_hr=CONCAT('table_reg_1_lte_hr_',@DATE_DY);
				SET @table_reg_3_lte_dy=CONCAT('table_reg_3_lte_dy_',@DATE_DY);
				SET @table_reg_2_lte_dy=CONCAT('table_reg_2_lte_dy_',@DATE_DY);
				SET @table_reg_1_lte_dy=CONCAT('table_reg_1_lte_dy_',@DATE_DY);
				SET @table_reg_3_lte_wk=CONCAT('table_reg_3_lte_wk_',@DATE_WK);
				SET @table_reg_2_lte_wk=CONCAT('table_reg_2_lte_wk_',@DATE_WK);
				SET @table_reg_1_lte_wk=CONCAT('table_reg_1_lte_wk_',@DATE_WK);
				SET @table_reg_3_lte_mn=CONCAT('table_reg_3_lte_mn_',@DATE_MN);
				SET @table_reg_2_lte_mn=CONCAT('table_reg_2_lte_mn_',@DATE_MN);
				SET @table_reg_1_lte_mn=CONCAT('table_reg_1_lte_mn_',@DATE_MN);	
				
				SET @table_tile_19_gsm_hr=CONCAT('table_tile_',@ZOOM_LEVEL,'_gsm_hr_',@DATE_DY);
				SET @table_tile_19_gsm_dy=CONCAT('table_tile_',@ZOOM_LEVEL,'_gsm_dy_',@DATE_DY);
				
				SET @table_reg_3_gsm_hr=CONCAT('table_reg_3_gsm_hr_',@DATE_DY);
				SET @table_reg_2_gsm_hr=CONCAT('table_reg_2_gsm_hr_',@DATE_DY);
				SET @table_reg_1_gsm_hr=CONCAT('table_reg_1_gsm_hr_',@DATE_DY);
				SET @table_reg_3_gsm_dy=CONCAT('table_reg_3_gsm_dy_',@DATE_DY);
				SET @table_reg_2_gsm_dy=CONCAT('table_reg_2_gsm_dy_',@DATE_DY);
				SET @table_reg_1_gsm_dy=CONCAT('table_reg_1_gsm_dy_',@DATE_DY);
				SET @table_reg_3_gsm_wk=CONCAT('table_reg_3_gsm_wk_',@DATE_WK);
				SET @table_reg_2_gsm_wk=CONCAT('table_reg_2_gsm_wk_',@DATE_WK);
				SET @table_reg_1_gsm_wk=CONCAT('table_reg_1_gsm_wk_',@DATE_WK);
				SET @table_reg_3_gsm_mn=CONCAT('table_reg_3_gsm_mn_',@DATE_MN);
				SET @table_reg_2_gsm_mn=CONCAT('table_reg_2_gsm_mn_',@DATE_MN);
				SET @table_reg_1_gsm_mn=CONCAT('table_reg_1_gsm_mn_',@DATE_MN);
				
				IF v_TECH_MASK=2 THEN 
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_tile_19_gsm_hr,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
		
					SET @SOURCE_TABLE_NAME=@table_tile_19_umts_hr;
					SET @ERROR_FLAG=CONCAT(SHARE_DB,'.',@table_tile_19_umts_hr,' DATA_HOUR=',v_DATA_HOUR);
					
		
					CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);	
					CALL gt_global_statistic.SP_Generate_Global_Statistic_Sub_Tile_Reg_Map_TEST(CONCAT(SHARE_DB,'.',@table_tile_19_umts_hr),WORKER_ID,0,gt_strtok(@REG_GROUP, @v_reg_m, '|'),TECH_MASK,1,0);
			
	
					IF FLAG IN (0,1) THEN 
						
						/*hr*/
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_reg_3_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_reg_3_umts_hr,'  LIKE ',v_group_db_name,'.',@table_reg_3_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
			
						SET @SOURCE_TABLE_NAME=@table_reg_3_umts_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_3_umts_hr);					
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_3_umts_hr,' DATA_HOUR=',v_DATA_HOUR);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_3_umts_hr,'
								    (`REG_ID`,
								     `FREQUENCY`,
								     `UARFCN`,
								     `DATA_DATE`,
								     `DATA_HOUR`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT
								  `REG_3_ID` AS `REG_ID`,
								  `FREQUENCY`,
								  `UARFCN`,
								  `DATA_DATE`,
								  `DATA_HOUR`,
								  ',TILE_UMTS_COLUMN_SUM_STR,' 
								FROM ',SHARE_DB,'.',@table_tile_19_umts_hr,' 
								GROUP BY `REG_3_ID`,`FREQUENCY`,`UARFCN`,`DATA_DATE`,`DATA_HOUR`
								ORDER BY NULL '
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_reg_3_umts_hr))
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_reg_3_umts_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_reg_3_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_REG_3_UMTS_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_3_umts_hr,' DATA_HOUR=',v_DATA_HOUR,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_reg_2_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_reg_2_umts_hr,' LIKE ',v_group_db_name,'.',@table_reg_2_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_reg_2_umts_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_2_umts_hr);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_2_umts_hr,' DATA_HOUR=',v_DATA_HOUR);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_2_umts_hr,'
								    (`REG_ID`,
								     `FREQUENCY`,
								     `UARFCN`,
								     `DATA_DATE`,
								     `DATA_HOUR`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT
									`REG_2_ID` AS `REG_ID`,
									`FREQUENCY`,
									`UARFCN`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',TILE_UMTS_COLUMN_SUM_STR,' 
								FROM ',SHARE_DB,'.',@table_tile_19_umts_hr,' 
								GROUP BY `REG_2_ID`,`FREQUENCY`,`UARFCN`,`DATA_DATE`,`DATA_HOUR`
								ORDER BY NULL '
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_reg_2_umts_hr))
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_reg_2_umts_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_reg_2_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_reg_2_UMTS_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_2_umts_hr,' DATA_HOUR=',v_DATA_HOUR,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_reg_1_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_reg_1_umts_hr,' LIKE ',v_group_db_name,'.',@table_reg_1_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_reg_1_umts_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_1_umts_hr);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_1_umts_hr,' DATA_HOUR=',v_DATA_HOUR);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_1_umts_hr,'
								    (`REG_ID`,
								     `FREQUENCY`,
								     `UARFCN`,
								     `DATA_DATE`,
								     `DATA_HOUR`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT
									`REG_1_ID` AS `REG_ID`,
									  `FREQUENCY`,
									  `UARFCN`,
									  `DATA_DATE`,
									  `DATA_HOUR`,
									  ',TILE_UMTS_COLUMN_SUM_STR,' 
								FROM ',SHARE_DB,'.',@table_tile_19_umts_hr,' 
								GROUP BY `REG_1_ID`,`FREQUENCY`,`UARFCN`,`DATA_DATE`,`DATA_HOUR`
								ORDER BY NULL '
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_reg_1_umts_hr))
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_reg_1_umts_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_reg_1_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_reg_1_UMTS_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_1_umts_hr,' DATA_HOUR=',v_DATA_HOUR,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						/*dy*/
	
						SET @SOURCE_TABLE_NAME=@table_reg_3_umts_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_3_umts_dy);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_3_umts_dy,' DATA_HOUR=',v_DATA_HOUR);
	
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
									
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_3_umts_dy,' 
								    (`REG_ID`,
								     `FREQUENCY`,
								     `UARFCN`,
								     `DATA_DATE`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT
								  `REG_3_ID` AS `REG_ID`,
								  `FREQUENCY`,
								  `UARFCN`,
								  `DATA_DATE`,
								  ',TILE_UMTS_COLUMN_SUM_STR,' 
								FROM ',SHARE_DB,'.',@table_tile_19_umts_hr,' 
								GROUP BY `REG_3_ID`,`FREQUENCY`,`UARFCN`,`DATA_DATE`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_reg_3_umts_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_reg_3_umts_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
						SET @FLAG_REG_3_UMTS_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_3_umts_dy,' DATA_HOUR=',v_DATA_HOUR,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SOURCE_TABLE_NAME=@table_reg_2_umts_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_2_umts_dy);						
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_2_umts_dy,' DATA_HOUR=',v_DATA_HOUR);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_2_umts_dy,' 
								    (`REG_ID`,
								     `FREQUENCY`,
								     `UARFCN`,
								     `DATA_DATE`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT
									`REG_2_ID` AS `REG_ID`,
									  `FREQUENCY`,
									  `UARFCN`,
									  `DATA_DATE`,
									  ',TILE_UMTS_COLUMN_SUM_STR,' 
								FROM ',SHARE_DB,'.',@table_tile_19_umts_hr,' 
								GROUP BY `REG_2_ID`,`FREQUENCY`,`UARFCN`,`DATA_DATE`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_reg_2_umts_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_reg_2_umts_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
						SET @FLAG_reg_2_UMTS_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_2_umts_dy,' DATA_HOUR=',v_DATA_HOUR,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SOURCE_TABLE_NAME=@table_reg_1_umts_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_1_umts_dy);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_1_umts_dy,' DATA_HOUR=',v_DATA_HOUR);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_1_umts_dy,' 
								    (`REG_ID`,
								     `FREQUENCY`,
								     `UARFCN`,
								     `DATA_DATE`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT
									`REG_1_ID` AS `REG_ID`,
									  `FREQUENCY`,
									  `UARFCN`,
									  `DATA_DATE`,
									  ',TILE_UMTS_COLUMN_SUM_STR,' 
								FROM ',SHARE_DB,'.',@table_tile_19_umts_hr,' 
								GROUP BY `REG_1_ID`,`FREQUENCY`,`UARFCN`,`DATA_DATE`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_reg_1_umts_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_reg_1_umts_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
						SET @FLAG_reg_1_UMTS_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_1_umts_dy,' DATA_HOUR=',v_DATA_HOUR,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						
						
	
					END IF;
		
					IF FLAG = 0 THEN 
						/*wk,mn*/
	
						SET @SOURCE_TABLE_NAME=@table_reg_3_umts_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_3_umts_wk);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_3_umts_wk);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_3_umts_wk,' 
								    (`REG_ID`,
								     `FREQUENCY`,
								     `UARFCN`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT
								  `REG_3_ID` AS `REG_ID`,
								  `FREQUENCY`,
								  `UARFCN`,
								  ',TILE_UMTS_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@table_tile_19_umts_hr,' 
								GROUP BY `REG_3_ID`,`FREQUENCY`,`UARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_3_umts_wk)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
				
						SET @SOURCE_TABLE_NAME=@table_reg_3_umts_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
												
						SET @FLAG_REG_3_UMTS_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_3_umts_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
										
						SET @SOURCE_TABLE_NAME=@table_reg_2_umts_wk;	
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_2_umts_wk);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_2_umts_wk);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
										
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_2_umts_wk,' 
								    (`REG_ID`,
								     `FREQUENCY`,
								     `UARFCN`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT
									`REG_2_ID` AS `REG_ID`,
									`FREQUENCY`,
									`UARFCN`,
									',TILE_UMTS_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@table_tile_19_umts_hr,' 
								GROUP BY `REG_2_ID`,`FREQUENCY`,`UARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_2_umts_wk)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_reg_2_umts_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
												
						SET @FLAG_reg_2_UMTS_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_2_umts_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @SOURCE_TABLE_NAME=@table_reg_1_umts_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_1_umts_wk);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_1_umts_wk);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_1_umts_wk,' 
								    (`REG_ID`,
								     `FREQUENCY`,
								     `UARFCN`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT
									`REG_1_ID` AS `REG_ID`,
									`FREQUENCY`,
									`UARFCN`,
									',TILE_UMTS_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@table_tile_19_umts_hr,' 
								GROUP BY `REG_1_ID`,`FREQUENCY`,`UARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_1_umts_wk)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_reg_1_umts_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_reg_1_UMTS_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_1_umts_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
	
	
						
	
						SET @SOURCE_TABLE_NAME=@table_reg_3_umts_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_3_umts_mn);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_3_umts_mn);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_3_umts_mn,' 
								    (`REG_ID`,
								     `FREQUENCY`,
								     `UARFCN`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT
								  `REG_3_ID` AS `REG_ID`,
								  `FREQUENCY`,
								  `UARFCN`,
								  ',TILE_UMTS_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@table_tile_19_umts_hr,' 
								GROUP BY `REG_3_ID`,`FREQUENCY`,`UARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_3_umts_mn)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_reg_3_umts_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_REG_3_UMTS_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_3_umts_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_reg_2_umts_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_2_umts_mn);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_2_umts_mn);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_2_umts_mn,' 
								    (`REG_ID`,
								     `FREQUENCY`,
								     `UARFCN`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT
									`REG_2_ID` AS `REG_ID`,
									  `FREQUENCY`,
									  `UARFCN`,
									  ',TILE_UMTS_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@table_tile_19_umts_hr,' 
								GROUP BY `REG_2_ID`,`FREQUENCY`,`UARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_2_umts_mn)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_reg_2_umts_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_reg_2_UMTS_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_2_umts_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @SOURCE_TABLE_NAME=@table_reg_1_umts_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_1_umts_mn);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_1_umts_mn);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_1_umts_mn,' 
								    (`REG_ID`,
								     `FREQUENCY`,
								     `UARFCN`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT
									`REG_1_ID` AS `REG_ID`,
									`FREQUENCY`,
									`UARFCN`,
									',TILE_UMTS_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@table_tile_19_umts_hr,' 
								GROUP BY `REG_1_ID`,`FREQUENCY`,`UARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_1_umts_mn)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_reg_1_umts_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
								
						SET @FLAG_reg_1_UMTS_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_1_umts_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						
					END IF;
	
			
	
					SET @SOURCE_TABLE_NAME=@table_tile_19_umts_hr;
					CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);	
	
	
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_tile_19_umts_hr,';');					
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.tmp_table_call_cnt_',WORKER_ID,' A
						SET 
						 
						  A.`FLAG_REG_3_HR` = ',@FLAG_REG_3_UMTS_HR,',
						  A.`FLAG_REG_3_DY` = ',@FLAG_REG_3_UMTS_DY,',
						  A.`FLAG_REG_2_HR` = ',@FLAG_REG_2_UMTS_HR,',
						  A.`FLAG_REG_2_DY` = ',@FLAG_REG_2_UMTS_DY,',
						  A.`FLAG_REG_1_HR` = ',@FLAG_REG_1_UMTS_HR,',
						  A.`FLAG_REG_1_DY` = ',@FLAG_REG_1_UMTS_DY,',
						  A.`FLAG_REG_3_WK` = ',@FLAG_REG_3_UMTS_WK,',
						  A.`FLAG_REG_3_MN` = ',@FLAG_REG_3_UMTS_MN,',
						  A.`FLAG_REG_2_WK` = ',@FLAG_REG_2_UMTS_WK,',
						  A.`FLAG_REG_2_MN` = ',@FLAG_REG_2_UMTS_MN,',
						  A.`FLAG_REG_1_WK` = ',@FLAG_REG_1_UMTS_WK,',
						  A.`FLAG_REG_1_MN` = ',@FLAG_REG_1_UMTS_MN,'  
						WHERE A.`TECH_MASK`=2
						;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('UMTS SELECT COUNT(*),TRUE,',WORKER_ID,' - ',gt_strtok(@REG_GROUP, @v_reg_m, '|'),' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				END IF;
		
				IF v_TECH_MASK=1 THEN 
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_tile_19_gsm_hr,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
		
	
					SET @SOURCE_TABLE_NAME=@table_tile_19_gsm_hr;
					SET @ERROR_FLAG=CONCAT(SHARE_DB,'.',@tmp_tile_19_gsm_hr,' DATA_HOUR=',v_DATA_HOUR);
					
					
					CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
					CALL gt_global_statistic.SP_Generate_Global_Statistic_Sub_Tile_Reg_Map_TEST(CONCAT(SHARE_DB,'.',@table_tile_19_gsm_hr),WORKER_ID,0,gt_strtok(@REG_GROUP, @v_reg_m, '|'),TECH_MASK,1,0);
			
					IF FLAG IN (0,1) THEN 
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_reg_3_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_reg_3_gsm_hr,' LIKE ',v_group_db_name,'.',@table_reg_3_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;	
				
						SET @SOURCE_TABLE_NAME=@table_reg_3_gsm_hr;		
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_3_gsm_hr);		
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_3_gsm_hr,' DATA_HOUR=',v_DATA_HOUR);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_3_gsm_hr,'
								    (`REG_ID`,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     `DATA_DATE`,
								     `DATA_HOUR`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
								  `REG_3_ID` AS `REG_ID`,
								  `FREQUENCY`,
								  `BCCH_ARFCN`,
								  `DATA_DATE`,
								  `DATA_HOUR`,
								  ',TILE_GSM_COLUMN_SUM_STR,' 
								FROM ',SHARE_DB,'.',@table_tile_19_gsm_hr,' 
								GROUP BY `REG_3_ID`,`FREQUENCY`,`BCCH_ARFCN`,`DATA_DATE`,`DATA_HOUR`
								ORDER BY NULL '
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_reg_3_gsm_hr))
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_reg_3_gsm_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_reg_3_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_REG_3_gsm_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_3_gsm_hr,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_reg_2_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_reg_2_gsm_hr,' LIKE ',v_group_db_name,'.',@table_reg_2_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_reg_2_gsm_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_2_gsm_hr);	
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_2_gsm_hr,' DATA_HOUR=',v_DATA_HOUR);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_2_gsm_hr,'
								    (`REG_ID`,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     `DATA_DATE`,
								     `DATA_HOUR`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
									`REG_2_ID` AS `REG_ID`,
									  `FREQUENCY`,
									  `BCCH_ARFCN`,
									  `DATA_DATE`,
									  `DATA_HOUR`,
									  ',TILE_GSM_COLUMN_SUM_STR,' 
								FROM ',SHARE_DB,'.',@table_tile_19_gsm_hr,' 
								GROUP BY `REG_2_ID`,`FREQUENCY`,`BCCH_ARFCN`,`DATA_DATE`,`DATA_HOUR`
								ORDER BY NULL '
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_reg_2_gsm_hr))
									ELSE '' END
								,';');
	
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_reg_2_gsm_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_reg_2_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_reg_2_gsm_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_2_gsm_hr,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_reg_1_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_reg_1_gsm_hr,' LIKE ',v_group_db_name,'.',@table_reg_1_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;		
	
						SET @SOURCE_TABLE_NAME=@table_reg_1_gsm_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_1_gsm_hr);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_1_gsm_hr,' DATA_HOUR=',v_DATA_HOUR);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_1_gsm_hr,'
								    (`REG_ID`,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     `DATA_DATE`,
								     `DATA_HOUR`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
									`REG_1_ID` AS `REG_ID`,
									  `FREQUENCY`,
									  `BCCH_ARFCN`,
									  `DATA_DATE`,
									  `DATA_HOUR`,
									  ',TILE_GSM_COLUMN_SUM_STR,' 
								FROM ',SHARE_DB,'.',@table_tile_19_gsm_hr,' 
								GROUP BY `REG_1_ID`,`FREQUENCY`,`BCCH_ARFCN`,`DATA_DATE`,`DATA_HOUR`
								ORDER BY NULL '
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_reg_1_gsm_hr))
									ELSE '' END
								,';');
	
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_reg_1_gsm_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_reg_1_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_reg_1_gsm_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_1_gsm_hr,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
		
	
						SET @SOURCE_TABLE_NAME=@table_reg_3_gsm_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_3_gsm_dy);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_3_gsm_dy,' DATA_HOUR=',v_DATA_HOUR);
	
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);				
					
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_3_gsm_dy,' 
								    (`REG_ID`,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     `DATA_DATE`,
								     ',TILE_GSM_COLUMN_STR,')
							SELECT
							  `REG_3_ID` AS `REG_ID`,
							  `FREQUENCY`,
							  `BCCH_ARFCN`,
							  `DATA_DATE`,
							  ',TILE_GSM_COLUMN_SUM_STR,' 
							FROM ',SHARE_DB,'.',@table_tile_19_gsm_hr,' 
							GROUP BY `REG_3_ID`,`FREQUENCY`,`BCCH_ARFCN`,`DATA_DATE`
							ORDER BY NULL
							ON DUPLICATE KEY UPDATE   
							',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_reg_3_gsm_dy),'
							;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_reg_3_gsm_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);						
				
						SET @FLAG_REG_3_gsm_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_3_gsm_dy,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @SOURCE_TABLE_NAME=@table_reg_2_gsm_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_2_gsm_dy);						
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_2_gsm_dy,' DATA_HOUR=',v_DATA_HOUR);
	
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_2_gsm_dy,' 
								    (`REG_ID`,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     `DATA_DATE`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
									`REG_2_ID` AS `REG_ID`,
									  `FREQUENCY`,
									  `BCCH_ARFCN`,
									  `DATA_DATE`,
									  ',TILE_GSM_COLUMN_SUM_STR,' 
								FROM ',SHARE_DB,'.',@table_tile_19_gsm_hr,' 
								GROUP BY `REG_2_ID`,`FREQUENCY`,`BCCH_ARFCN`,`DATA_DATE`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE  
								',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_reg_2_gsm_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_reg_2_gsm_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);						
				
						SET @FLAG_reg_2_gsm_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_2_gsm_dy,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SOURCE_TABLE_NAME=@table_reg_1_gsm_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_1_gsm_dy);						
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_1_gsm_dy,' DATA_HOUR=',v_DATA_HOUR);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_1_gsm_dy,' 
								    (`REG_ID`,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     `DATA_DATE`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
									`REG_1_ID` AS `REG_ID`,
									  `FREQUENCY`,
									  `BCCH_ARFCN`,
									  `DATA_DATE`,
									  ',TILE_GSM_COLUMN_SUM_STR,' 
								FROM ',SHARE_DB,'.',@table_tile_19_gsm_hr,' 
								GROUP BY `REG_1_ID`,`FREQUENCY`,`BCCH_ARFCN`,`DATA_DATE`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE  
								',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_reg_1_gsm_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_reg_1_gsm_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);						
			
						SET @FLAG_reg_1_gsm_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_1_gsm_dy,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						
						SET STEP_START_TIME := SYSDATE();
	
	
						
						SET STEP_START_TIME := SYSDATE();
					END IF;
					IF FLAG = 0 THEN 
	
						IF gt_strtok(@REG_GROUP, @v_reg_m, '|') <> @usr_def_polygon_group_id THEN
	
							SET @SOURCE_TABLE_NAME=@table_tile_19_gsm_wk;
							SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_tile_19_gsm_wk);
							SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_tile_19_gsm_wk);
							CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
								
							SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_tile_19_gsm_wk,' 
									    (`TILE_ID`,
									     `FREQUENCY`,
									     `BCCH_ARFCN`,
									     ',TILE_GSM_COLUMN_STR,')
									SELECT
									  `TILE_ID`,
									  `FREQUENCY`,
									  `BCCH_ARFCN`,
									  ',TILE_GSM_COLUMN_SUM_STR,'  
									FROM ',SHARE_DB,'.',@table_tile_19_gsm_hr,' 
									GROUP BY `TILE_ID`,`FREQUENCY`,`BCCH_ARFCN`
									ORDER BY NULL
									ON DUPLICATE KEY UPDATE  
									',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_tile_19_gsm_wk)),'
									;');
							PREPARE Stmt FROM @SqlCmd;
							EXECUTE Stmt;
							DEALLOCATE PREPARE Stmt;
										
						END IF;
	
						SET @SOURCE_TABLE_NAME=@table_reg_3_gsm_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_3_gsm_wk);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_3_gsm_wk);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_3_gsm_wk,' 
								    (`REG_ID`,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
								  `REG_3_ID` AS `REG_ID`,
								  `FREQUENCY`,
								  `BCCH_ARFCN`,
								  ',TILE_GSM_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@table_tile_19_gsm_hr,' 
								GROUP BY `REG_3_ID`,`FREQUENCY`,`BCCH_ARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_3_gsm_wk)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_reg_3_gsm_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_REG_3_gsm_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_3_gsm_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @SOURCE_TABLE_NAME=@table_reg_2_gsm_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_2_gsm_wk);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_2_gsm_wk);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_2_gsm_wk,' 
								    (`REG_ID`,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
								  `REG_2_ID` AS `REG_ID`,
								  `FREQUENCY`,
								  `BCCH_ARFCN`,
								  ',TILE_GSM_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@table_tile_19_gsm_hr,' 
								GROUP BY `REG_2_ID`,`FREQUENCY`,`BCCH_ARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_2_gsm_wk)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_reg_2_gsm_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_reg_2_gsm_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_2_gsm_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @SOURCE_TABLE_NAME=@table_reg_1_gsm_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_1_gsm_wk);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_1_gsm_wk);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_1_gsm_wk,' 
								    (`REG_ID`,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
									`REG_1_ID` AS `REG_ID`,
									  `FREQUENCY`,
									  `BCCH_ARFCN`,
									  ',TILE_GSM_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@table_tile_19_gsm_hr,' 
								GROUP BY `REG_1_ID`,`FREQUENCY`,`BCCH_ARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_1_gsm_wk)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_reg_1_gsm_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_reg_1_gsm_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_1_gsm_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						
	
						SET @SOURCE_TABLE_NAME=@table_reg_3_gsm_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_3_gsm_mn);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_3_gsm_mn);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_3_gsm_mn,' 
								    (`REG_ID`,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
								  `REG_3_ID` AS `REG_ID`,
								  `FREQUENCY`,
								  `BCCH_ARFCN`,
								  ',TILE_GSM_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@table_tile_19_gsm_hr,' 
								GROUP BY `REG_3_ID`,`FREQUENCY`,`BCCH_ARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_3_gsm_mn)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_reg_3_gsm_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_REG_3_gsm_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_3_gsm_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @SOURCE_TABLE_NAME=@table_reg_2_gsm_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_2_gsm_mn);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_2_gsm_mn);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_2_gsm_mn,' 
								    (`REG_ID`,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
									`REG_2_ID` AS `REG_ID`,
									  `FREQUENCY`,
									  `BCCH_ARFCN`,
									  ',TILE_GSM_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@table_tile_19_gsm_hr,' 
								GROUP BY `REG_2_ID`,`FREQUENCY`,`BCCH_ARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_2_gsm_mn)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_reg_2_gsm_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_reg_2_gsm_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_2_gsm_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @SOURCE_TABLE_NAME=@table_reg_1_gsm_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_1_gsm_mn);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_1_gsm_mn);
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_1_gsm_mn,' 
								    (`REG_ID`,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
									`REG_1_ID` AS `REG_ID`,
									  `FREQUENCY`,
									  `BCCH_ARFCN`,
									  ',TILE_GSM_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@table_tile_19_gsm_hr,' 
								GROUP BY `REG_1_ID`,`FREQUENCY`,`BCCH_ARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_1_gsm_mn)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;	
						
						SET @SOURCE_TABLE_NAME=@table_reg_1_gsm_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
									
						SET @FLAG_reg_1_gsm_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_1_gsm_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						
 						SET STEP_START_TIME := SYSDATE();
					END IF;
					
					SET @SOURCE_TABLE_NAME=@table_tile_19_gsm_hr;
					CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);	
	
	
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_tile_19_gsm_hr,';');					
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.tmp_table_call_cnt_',WORKER_ID,' A
						SET 
						 
						  A.`FLAG_REG_3_HR` = ',@FLAG_REG_3_gsm_HR,',
						  A.`FLAG_REG_3_DY` = ',@FLAG_REG_3_gsm_DY,',
						  A.`FLAG_REG_2_HR` = ',@FLAG_REG_2_gsm_HR,',
						  A.`FLAG_REG_2_DY` = ',@FLAG_REG_2_gsm_DY,',
						  A.`FLAG_REG_1_HR` = ',@FLAG_REG_1_gsm_HR,',
						  A.`FLAG_REG_1_DY` = ',@FLAG_REG_1_gsm_DY,',
						  A.`FLAG_REG_3_WK` = ',@FLAG_REG_3_gsm_WK,',
						  A.`FLAG_REG_3_MN` = ',@FLAG_REG_3_gsm_MN,',
						  A.`FLAG_REG_2_WK` = ',@FLAG_REG_2_gsm_WK,',
						  A.`FLAG_REG_2_MN` = ',@FLAG_REG_2_gsm_MN,',
						  A.`FLAG_REG_1_WK` = ',@FLAG_REG_1_gsm_WK,',
						  A.`FLAG_REG_1_MN` = ',@FLAG_REG_1_gsm_MN,'  
						WHERE A.`TECH_MASK`=1
						;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('GSM SELECT COUNT(*),TRUE,',WORKER_ID,' - ',gt_strtok(@REG_GROUP, @v_reg_m, '|'),' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				END IF;	
				
				IF v_TECH_MASK=4 THEN
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_tile_19_lte_hr,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;	
		
					SET @SOURCE_TABLE_NAME=@table_tile_19_lte_hr;
					SET @ERROR_FLAG=CONCAT(SHARE_DB,'.',@table_tile_19_lte_hr,' DATA_HOUR=',v_DATA_HOUR);
					
					CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
	
					CALL gt_global_statistic.SP_Generate_Global_Statistic_Sub_Tile_Reg_Map_TEST(CONCAT(SHARE_DB,'.',@table_tile_19_lte_hr),WORKER_ID,0,gt_strtok(@REG_GROUP, @v_reg_m, '|'),TECH_MASK,1,0);
					IF FLAG IN (0,1) THEN 
						
	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_reg_3_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_reg_3_lte_hr,' LIKE ',v_group_db_name,'.',@table_reg_3_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_reg_3_lte_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_3_lte_hr);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_3_lte_hr,' DATA_HOUR=',v_DATA_HOUR);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_3_lte_hr,'
								    (
									`REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_3_ID` AS `REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@table_tile_19_lte_hr,'
								GROUP BY `REG_3_ID`,`EARFCN`,`EUTRABAND`,`DATA_DATE`,`DATA_HOUR`
								ORDER BY NULL '
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_reg_3_lte_hr))
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_reg_3_lte_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_reg_3_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
					
						SET @FLAG_REG_3_LTE_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_3_lte_hr,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_reg_2_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_reg_2_lte_hr,' LIKE ',v_group_db_name,'.',@table_reg_2_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_reg_2_lte_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_2_lte_hr);					
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_2_lte_hr,' DATA_HOUR=',v_DATA_HOUR);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_2_lte_hr,'
								    (
									`REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_2_ID` AS `REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@table_tile_19_lte_hr,'
								GROUP BY `REG_2_ID`,`EARFCN`,`EUTRABAND`,`DATA_DATE`,`DATA_HOUR`
								ORDER BY NULL '
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_reg_2_lte_hr))
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SOURCE_TABLE_NAME=CONCAT(@table_reg_2_lte_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_reg_2_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
					
						SET @FLAG_reg_2_LTE_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_2_lte_hr,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_reg_1_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_reg_1_lte_hr,' LIKE ',v_group_db_name,'.',@table_reg_1_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_reg_1_lte_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_1_lte_hr);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_1_lte_hr,' DATA_HOUR=',v_DATA_HOUR);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_1_lte_hr,'
								    (
									`REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_1_ID` AS `REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@table_tile_19_lte_hr,'
								GROUP BY `REG_1_ID`,`EARFCN`,`EUTRABAND`,`DATA_DATE`,`DATA_HOUR`
								ORDER BY NULL '
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_reg_1_lte_hr))
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_reg_1_lte_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_reg_1_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_reg_1_LTE_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_1_lte_hr,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						
						
		
	
						SET @SOURCE_TABLE_NAME=@table_reg_3_lte_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_3_lte_dy);	
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_3_lte_dy,' DATA_HOUR=',v_DATA_HOUR);
	
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
										
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_3_lte_dy,'  
								    (
									`REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_3_ID` AS `REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@table_tile_19_lte_hr,'
								GROUP BY `REG_3_ID`,`EARFCN`,`EUTRABAND`,`DATA_DATE`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_reg_3_lte_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_reg_3_lte_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_REG_3_lte_dy=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_3_lte_dy,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();	
	
						SET @SOURCE_TABLE_NAME=@table_reg_2_lte_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_2_lte_dy);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_2_lte_dy,' DATA_HOUR=',v_DATA_HOUR);
	
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
									
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_2_lte_dy,'  
								    (
									`REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_2_ID` AS `REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@table_tile_19_lte_hr,'
								GROUP BY `REG_2_ID`,`EARFCN`,`EUTRABAND`,`DATA_DATE`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_reg_2_lte_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
					
						SET @SOURCE_TABLE_NAME=@table_reg_2_lte_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_reg_2_lte_dy=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_2_lte_dy,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();			
								
						SET @SOURCE_TABLE_NAME=@table_reg_1_lte_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_1_lte_dy);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_1_lte_dy,' DATA_HOUR=',v_DATA_HOUR);
	
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_1_lte_dy,'  
								    (
									`REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_1_ID` AS `REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@table_tile_19_lte_hr,'
								GROUP BY `REG_1_ID`,`EARFCN`,`EUTRABAND`,`DATA_DATE`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_reg_1_lte_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						SET @SOURCE_TABLE_NAME=@table_reg_1_lte_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_reg_1_lte_dy=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_1_lte_dy,' DATA_HOUR=',v_DATA_HOUR,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						
						
						SET STEP_START_TIME := SYSDATE();
					END IF; 
		
					IF FLAG =0 THEN 
						
			
						SET @SOURCE_TABLE_NAME=@table_reg_3_lte_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_3_lte_wk);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_3_lte_wk);
	
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
										
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_3_lte_wk,' 
								    (
									`REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_3_ID` AS `REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@table_tile_19_lte_hr,' 
								GROUP BY `REG_3_ID`,`EARFCN`,`EUTRABAND`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE  
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_3_lte_wk)),'
								;'); 
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_reg_3_lte_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_REG_3_lte_wk=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_3_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @SOURCE_TABLE_NAME=@table_reg_2_lte_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_2_lte_wk);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_2_lte_wk);
	
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_2_lte_wk,' 
								    (
									`REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_2_ID` AS `REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@table_tile_19_lte_hr,' 
								GROUP BY `REG_2_ID`,`EARFCN`,`EUTRABAND`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE  
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_2_lte_wk)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_reg_2_lte_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_reg_2_lte_wk=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_2_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_reg_1_lte_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_1_lte_wk);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_1_lte_wk);
	
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_1_lte_wk,' 
								    (
									`REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_1_ID` AS `REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@table_tile_19_lte_hr,' 
								GROUP BY `REG_1_ID`,`EARFCN`,`EUTRABAND`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE  
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_1_lte_wk)),'
								;'); 
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_reg_1_lte_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_reg_1_lte_wk=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_1_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						
						
			
						SET @SOURCE_TABLE_NAME=@table_reg_3_lte_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_3_lte_mn);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_3_lte_mn);
	
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
												
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_3_lte_mn,' 
								    (
									`REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_3_ID` AS `REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@table_tile_19_lte_hr,' 
								GROUP BY `REG_3_ID`,`EARFCN`,`EUTRABAND`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_3_lte_mn)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_reg_3_lte_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_REG_3_lte_mn=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_3_lte_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_reg_2_lte_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_2_lte_mn);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_2_lte_mn);
	
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_2_lte_mn,' 
								    (
									`REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_2_ID` AS `REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@table_tile_19_lte_hr,' 
								GROUP BY `REG_2_ID`,`EARFCN`,`EUTRABAND`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_2_lte_mn)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_reg_2_lte_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_reg_2_lte_mn=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_2_lte_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_reg_1_lte_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_1_lte_mn);
						SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_1_lte_mn);
	
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_1_lte_mn,' 
								    (
									`REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_1_ID` AS `REG_ID`,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@table_tile_19_lte_hr,' 
								GROUP BY `REG_1_ID`,`EARFCN`,`EUTRABAND`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_1_lte_mn)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_reg_1_lte_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_reg_1_lte_mn=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_1_lte_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						
					END IF;
					
					SET @SOURCE_TABLE_NAME=@table_tile_19_lte_hr;
					CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
	
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_tile_19_lte_hr,';');					
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
			
					SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.tmp_table_call_cnt_',WORKER_ID,' A
								SET 
								 
								  A.`FLAG_REG_3_HR` = ',@FLAG_REG_3_LTE_HR,',
								  A.`FLAG_REG_3_DY` = ',@FLAG_REG_3_LTE_DY,',
								  A.`FLAG_REG_2_HR` = ',@FLAG_REG_2_LTE_HR,',
								  A.`FLAG_REG_2_DY` = ',@FLAG_REG_2_LTE_DY,',
								  A.`FLAG_REG_1_HR` = ',@FLAG_REG_1_LTE_HR,',
								  A.`FLAG_REG_1_DY` = ',@FLAG_REG_1_LTE_DY,',
								  A.`FLAG_REG_3_WK` = ',@FLAG_REG_3_LTE_WK,',
								  A.`FLAG_REG_3_MN` = ',@FLAG_REG_3_LTE_MN,',
								  A.`FLAG_REG_2_WK` = ',@FLAG_REG_2_LTE_WK,',
								  A.`FLAG_REG_2_MN` = ',@FLAG_REG_2_LTE_MN,',
								  A.`FLAG_REG_1_WK` = ',@FLAG_REG_1_LTE_WK,',
								  A.`FLAG_REG_1_MN` = ',@FLAG_REG_1_LTE_MN,' 
								WHERE A.`TECH_MASK`=4;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('LTE update table_call_cnt_',WORKER_ID,' - ',gt_strtok(@REG_GROUP, @v_reg_m, '|'),' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				END IF;	
				SET v_i=v_i+1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT(v_TECH_MASK,',',WORKER_ID,',',v_i,' - ',gt_strtok(@REG_GROUP, @v_reg_m, '|')), NOW());
			END;
			END WHILE;
			SET @v_reg_m=@v_reg_m+1;
		END;
		END WHILE;
		
		
		INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT(v_DATA_DATE,',',v_DATA_HOUR,',',v_TECH_MASK,',',WORKER_ID,' Done: ',TIMESTAMPDIFF(SECOND,START_TIME,SYSDATE()),' seconds.'), NOW());
	END IF;
	
	IF FLAG=2 THEN 
	
		IF exDate IS NOT NULL THEN 
			SET @v_DATA_DATE=CAST(exDate AS DATE);
		ELSE 
			SET @v_DATA_DATE=DATE(DATE_ADD(START_TIME,INTERVAL -1 DAY));
		END IF;
		SELECT `DAY_OF_WEEK`(@v_DATA_DATE) INTO @DAY_OF_WEEK;
		SET @FIRST_DAY=gt_strtok(@DAY_OF_WEEK, 1, '|');
		SET @END_DAY=gt_strtok(@DAY_OF_WEEK, 2, '|');
		SET @DATE_WK=CONCAT(DATE_FORMAT(@FIRST_DAY,'%Y%m%d'),'_',DATE_FORMAT(@END_DAY,'%Y%m%d'));
		SET @DATE_MN=DATE_FORMAT(@v_DATA_DATE,'%Y%m');
		SET @EX_DATE=CONCAT(DATE_FORMAT(@v_DATA_DATE,'%Y%m%d_'),WORKER_ID);
		SET @SR_DATE=CONCAT(DATE_FORMAT(@v_DATA_DATE,'%Y%m%d'));
		
		SET @SqlCmd=CONCAT('SELECT GROUP_CONCAT(DISTINCT `group_id` ORDER BY `group_id` SEPARATOR ''|'' ) INTO @REG_GROUP FROM ',@global_db,'.`usr_polygon_reg_3`;');
	
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT att_value INTO @usr_def_polygon_group_id FROM gt_global_statistic.nw_config WHERE group_name= ''system'' AND att_name=''USR_DEFINE_POLYGON_GROUP_ID'';');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
			
		SET @v_reg_m=1;
		SET @v_reg_Max=gt_covmo_csv_count(@REG_GROUP,'|');
		WHILE @v_reg_m <= @v_reg_Max DO
		BEGIN			
			SET v_group_db_name=CONCAT('gt_global_statistic_g',gt_strtok(@REG_GROUP, @v_reg_m, '|'));
		
			IF TECH_MASK=2 THEN 
				SET @table_tile_19_umts_dy=CONCAT('table_tile_',@ZOOM_LEVEL,'_umts_dy_',@SR_DATE);
				SET @table_reg_3_umts_wk=CONCAT('table_reg_3_umts_wk_',@DATE_WK);
				SET @table_reg_2_umts_wk=CONCAT('table_reg_2_umts_wk_',@DATE_WK);
				SET @table_reg_1_umts_wk=CONCAT('table_reg_1_umts_wk_',@DATE_WK);
				SET @table_reg_3_umts_mn=CONCAT('table_reg_3_umts_mn_',@DATE_MN);
				SET @table_reg_2_umts_mn=CONCAT('table_reg_2_umts_mn_',@DATE_MN);
				SET @table_reg_1_umts_mn=CONCAT('table_reg_1_umts_mn_',@DATE_MN);
				
				SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_tile_19_umts_dy,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;	
				
				SET @SOURCE_TABLE_NAME=CONCAT(@table_tile_19_umts_dy,',',@table_reg_3_umts_wk);
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_3_umts_wk);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_3_umts_wk);
	
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_3_umts_wk,' 
						    (`REG_ID`,
						     `FREQUENCY`,
						     `UARFCN`,
						     ',TILE_UMTS_COLUMN_STR,')
						SELECT
						  `REG_3_ID` AS `REG_ID`,
						  `FREQUENCY`,
						  `UARFCN`,
						  ',TILE_UMTS_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_tile_19_umts_dy,'  
						GROUP BY `REG_3_ID`,`FREQUENCY`,`UARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_3_umts_wk)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_reg_3_umts_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_REG_3_UMTS_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_3_umts_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_reg_2_umts_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_2_umts_wk);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_2_umts_wk);
	
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
								
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_2_umts_wk,' 
						    (
						     `REG_ID`,
						     `FREQUENCY`,
						     `UARFCN`,
						     ',TILE_UMTS_COLUMN_STR,')
						SELECT
							`REG_2_ID` AS `REG_ID`,
							  `FREQUENCY`,
							  `UARFCN`,
							  ',TILE_UMTS_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_tile_19_umts_dy,'  
						GROUP BY `REG_2_ID`,`FREQUENCY`,`UARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_2_umts_wk)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_reg_2_umts_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_reg_2_UMTS_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_2_umts_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_reg_1_umts_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_1_umts_wk);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_1_umts_wk);
	
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_1_umts_wk,' 
						    (`REG_ID`,
						     `FREQUENCY`,
						     `UARFCN`,
						     ',TILE_UMTS_COLUMN_STR,')
						SELECT
							`REG_1_ID` AS `REG_ID`,
							  `FREQUENCY`,
							  `UARFCN`,
							  ',TILE_UMTS_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_tile_19_umts_dy,'  
						GROUP BY `REG_1_ID`,`FREQUENCY`,`UARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_1_umts_wk)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_reg_1_umts_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_reg_1_UMTS_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_1_umts_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				
				
				SET @SOURCE_TABLE_NAME=@table_reg_3_umts_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_3_umts_mn);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_3_umts_mn);
	
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_3_umts_mn,' 
						    (`REG_ID`,
						     `FREQUENCY`,
						     `UARFCN`,
						     ',TILE_UMTS_COLUMN_STR,')
						SELECT
						  `REG_3_ID` AS `REG_ID`,
						  `FREQUENCY`,
						  `UARFCN`,
						  ',TILE_UMTS_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_tile_19_umts_dy,'  
						GROUP BY `REG_3_ID`,`FREQUENCY`,`UARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_3_umts_mn)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_reg_3_umts_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_REG_3_UMTS_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_3_umts_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_reg_2_umts_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_2_umts_mn);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_2_umts_mn);
	
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_2_umts_mn,' 
						    (`REG_ID`,
						     `FREQUENCY`,
						     `UARFCN`,
						     ',TILE_UMTS_COLUMN_STR,')
						SELECT
							`REG_2_ID` AS `REG_ID`,
							  `FREQUENCY`,
							  `UARFCN`,
							  ',TILE_UMTS_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_tile_19_umts_dy,'  
						GROUP BY `REG_2_ID`,`FREQUENCY`,`UARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_2_umts_mn)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_reg_2_umts_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_reg_2_UMTS_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_2_umts_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_reg_1_umts_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_1_umts_mn);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_1_umts_mn);
	
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_1_umts_mn,' 
						    (`REG_ID`,
						     `FREQUENCY`,
						     `UARFCN`,
						     ',TILE_UMTS_COLUMN_STR,')
						SELECT
							`REG_1_ID` AS `REG_ID`,
							  `FREQUENCY`,
							  `UARFCN`,
							  ',TILE_UMTS_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_tile_19_umts_dy,'  
						GROUP BY `REG_1_ID`,`FREQUENCY`,`UARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_1_umts_mn)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_reg_1_umts_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_reg_1_UMTS_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_1_umts_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				
				SET STEP_START_TIME := SYSDATE();			
				
				
				SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_tile_19_umts_dy,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.`table_call_cnt_history` A
					SET 
					  A.`FLAG_REG_3_WK` = ',@FLAG_REG_3_UMTS_WK,',
					  A.`FLAG_REG_3_MN` = ',@FLAG_REG_3_UMTS_MN,',
					  A.`FLAG_REG_2_WK` = ',@FLAG_REG_2_UMTS_WK,',
					  A.`FLAG_REG_2_MN` = ',@FLAG_REG_2_UMTS_MN,',
					  A.`FLAG_REG_1_WK` = ',@FLAG_REG_1_UMTS_WK,',
					  A.`FLAG_REG_1_MN` = ',@FLAG_REG_1_UMTS_MN,'  
					WHERE A.`DATA_DATE`=''',@v_DATA_DATE,''' AND `TECH_MASK`=2
					;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('UMTS SELECT COUNT(*),TRUE,',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
			END IF;
			
			IF TECH_MASK=1 THEN 
				SET @table_tile_19_gsm_dy=CONCAT('table_tile_',@ZOOM_LEVEL,'_gsm_dy_',@SR_DATE);
	
				SET @table_reg_3_gsm_wk=CONCAT('table_reg_3_gsm_wk_',@DATE_WK);
				SET @table_reg_2_gsm_wk=CONCAT('table_reg_2_gsm_wk_',@DATE_WK);
				SET @table_reg_1_gsm_wk=CONCAT('table_reg_1_gsm_wk_',@DATE_WK);
				SET @table_reg_3_gsm_mn=CONCAT('table_reg_3_gsm_mn_',@DATE_MN);
				SET @table_reg_2_gsm_mn=CONCAT('table_reg_2_gsm_mn_',@DATE_MN);
				SET @table_reg_1_gsm_mn=CONCAT('table_reg_1_gsm_mn_',@DATE_MN);
				
	
	
	
				SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_tile_19_gsm_dy,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;	
		
				SET @SOURCE_TABLE_NAME=CONCAT(@table_tile_19_gsm_dy,',',@table_reg_3_gsm_wk);
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_3_gsm_wk);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_3_gsm_wk);
	
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
			
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_3_gsm_wk,' 
						    (`REG_ID`,
						     `FREQUENCY`,
						     `BCCH_ARFCN`,
						     ',TILE_GSM_COLUMN_STR,')
						SELECT
						  `REG_3_ID` AS `REG_ID`,
						  `FREQUENCY`,
						  `BCCH_ARFCN`,
						  ',TILE_GSM_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_tile_19_gsm_dy,' 
						GROUP BY `REG_3_ID`,`FREQUENCY`,`BCCH_ARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_3_gsm_wk)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_reg_3_gsm_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_REG_3_gsm_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_3_gsm_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_reg_2_gsm_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_2_gsm_wk);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_2_gsm_wk);
	
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_2_gsm_wk,' 
						    (
						     `REG_ID`,
						     `FREQUENCY`,
						     `BCCH_ARFCN`,
						     ',TILE_GSM_COLUMN_STR,')
						SELECT
							`REG_2_ID` AS `REG_ID`,
							  `FREQUENCY`,
							  `BCCH_ARFCN`,
							  ',TILE_GSM_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_tile_19_gsm_dy,' 
						GROUP BY `REG_2_ID`,`FREQUENCY`,`BCCH_ARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_2_gsm_wk)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_reg_2_gsm_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_reg_2_gsm_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_2_gsm_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
	
				SET @SOURCE_TABLE_NAME=@table_reg_1_gsm_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_1_gsm_wk);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_1_gsm_wk);
	
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_1_gsm_wk,' 
						    (`REG_ID`,
						     `FREQUENCY`,
						     `BCCH_ARFCN`,
						     ',TILE_GSM_COLUMN_STR,')
						SELECT
							`REG_1_ID` AS `REG_ID`,
							  `FREQUENCY`,
							  `BCCH_ARFCN`,
							  ',TILE_GSM_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_tile_19_gsm_dy,' 
						GROUP BY `REG_1_ID`,`FREQUENCY`,`BCCH_ARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_1_gsm_wk)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_reg_1_gsm_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_reg_1_gsm_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_1_gsm_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				
				SET STEP_START_TIME := SYSDATE(); 
	
				
	
				SET @SOURCE_TABLE_NAME=@table_reg_3_gsm_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_3_gsm_mn);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_3_gsm_mn);
	
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_3_gsm_mn,' 
						    (`REG_ID`,
						     `FREQUENCY`,
						     `BCCH_ARFCN`,
						     ',TILE_GSM_COLUMN_STR,')
						SELECT
						  `REG_3_ID` AS `REG_ID`,
						  `FREQUENCY`,
						  `BCCH_ARFCN`,
						  ',TILE_GSM_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_tile_19_gsm_dy,' 
						GROUP BY `REG_3_ID`,`FREQUENCY`,`BCCH_ARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_3_gsm_mn)),'
						;');
				
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_reg_3_gsm_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_REG_3_gsm_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_3_gsm_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_reg_2_gsm_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_2_gsm_mn);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_2_gsm_mn);
	
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_2_gsm_mn,' 
						    (
						     `REG_ID`,
						     `FREQUENCY`,
						     `BCCH_ARFCN`,
						     ',TILE_GSM_COLUMN_STR,')
					SELECT
						`REG_2_ID` AS `REG_ID`,
						  `FREQUENCY`,
						  `BCCH_ARFCN`,
						  ',TILE_GSM_COLUMN_SUM_STR,'  
					FROM ',SHARE_DB,'.',@table_tile_19_gsm_dy,' 
					GROUP BY `REG_2_ID`,`FREQUENCY`,`BCCH_ARFCN`
					ORDER BY NULL
					ON DUPLICATE KEY UPDATE 
					',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_2_gsm_mn)),'
					;');
				
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_reg_2_gsm_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_reg_2_gsm_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_2_gsm_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_reg_1_gsm_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_1_gsm_mn);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_1_gsm_mn);
	
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_1_gsm_mn,' 
						    (
						     `REG_ID`,
						     `FREQUENCY`,
						     `BCCH_ARFCN`,
						     ',TILE_GSM_COLUMN_STR,')
					SELECT
						`REG_1_ID` AS `REG_ID`,
						  `FREQUENCY`,
						  `BCCH_ARFCN`,
						  ',TILE_GSM_COLUMN_SUM_STR,'  
					FROM ',SHARE_DB,'.',@table_tile_19_gsm_dy,' 
					GROUP BY `REG_1_ID`,`FREQUENCY`,`BCCH_ARFCN`
					ORDER BY NULL
					ON DUPLICATE KEY UPDATE 
					',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_1_gsm_mn)),'
					;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_reg_1_gsm_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
								
				SET @FLAG_reg_1_gsm_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_1_gsm_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				
				SET STEP_START_TIME := SYSDATE();
				
				
				SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_tile_19_gsm_dy,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.`table_call_cnt_history` A
					SET 
					  A.`FLAG_REG_3_WK` = ',@FLAG_REG_3_GSM_WK,',
					  A.`FLAG_REG_3_MN` = ',@FLAG_REG_3_GSM_MN,',
					  A.`FLAG_REG_2_WK` = ',@FLAG_REG_2_GSM_WK,',
					  A.`FLAG_REG_2_MN` = ',@FLAG_REG_2_GSM_MN,',
					  A.`FLAG_REG_1_WK` = ',@FLAG_REG_1_GSM_WK,',
					  A.`FLAG_REG_1_MN` = ',@FLAG_REG_1_GSM_MN,' 
					WHERE A.`DATA_DATE`=''',@v_DATA_DATE,''' AND `TECH_MASK`=1
					;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('UMTS SELECT COUNT(*),TRUE,',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
			END IF;
			IF TECH_MASK=4 THEN
			
				SET @table_tile_19_lte_dy=CONCAT('table_tile_',@ZOOM_LEVEL,'_lte_dy_',@SR_DATE);
		
				SET @table_reg_3_lte_wk=CONCAT('table_reg_3_lte_wk_',@DATE_WK);
				SET @table_reg_2_lte_wk=CONCAT('table_reg_2_lte_wk_',@DATE_WK);
				SET @table_reg_1_lte_wk=CONCAT('table_reg_1_lte_wk_',@DATE_WK);
				SET @table_reg_3_lte_mn=CONCAT('table_reg_3_lte_mn_',@DATE_MN);
				SET @table_reg_2_lte_mn=CONCAT('table_reg_2_lte_mn_',@DATE_MN);
				SET @table_reg_1_lte_mn=CONCAT('table_reg_1_lte_mn_',@DATE_MN);
		
				
				
				SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_tile_19_lte_dy,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
	
				SET @SOURCE_TABLE_NAME=CONCAT(@table_tile_19_lte_dy,',',@table_reg_3_lte_wk);
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_3_lte_wk);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_3_lte_wk);
	
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
									
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_3_lte_wk,' 
						    (
							`REG_ID`,
							`EARFCN`,
							`EUTRABAND`,
							',TILE_LTE_COLUMN_STR,')
						SELECT
							`REG_3_ID` AS `REG_ID`,
							`EARFCN`,
							`EUTRABAND`,
							',TILE_LTE_COLUMN_SUM_STR,'
						FROM ',SHARE_DB,'.',@table_tile_19_lte_dy,'
						GROUP BY `REG_3_ID`,`EARFCN`,`EUTRABAND`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE  
						',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_3_lte_wk)),'
						;');
	
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_reg_3_lte_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_REG_3_lte_wk=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_3_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_reg_2_lte_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_2_lte_wk);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_2_lte_wk);
	
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_2_lte_wk,' 
						    (
							`REG_ID`,
							`EARFCN`,
							`EUTRABAND`,
							',TILE_LTE_COLUMN_STR,')
						SELECT
							`REG_2_ID` AS `REG_ID`,
							`EARFCN`,
							`EUTRABAND`,
							',TILE_LTE_COLUMN_SUM_STR,'
						FROM ',SHARE_DB,'.',@table_tile_19_lte_dy,'
						GROUP BY `REG_2_ID`,`EARFCN`,`EUTRABAND`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE  
						',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_2_lte_wk)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_reg_2_lte_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_reg_2_lte_wk=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_2_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_reg_1_lte_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_1_lte_wk);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_1_lte_wk);
	
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_1_lte_wk,' 
						    (
							`REG_ID`,
							`EARFCN`,
							`EUTRABAND`,
							',TILE_LTE_COLUMN_STR,')
						SELECT
							`REG_1_ID` AS `REG_ID`,
							`EARFCN`,
							`EUTRABAND`,
							',TILE_LTE_COLUMN_SUM_STR,'
						FROM ',SHARE_DB,'.',@table_tile_19_lte_dy,'
						GROUP BY `REG_1_ID`,`EARFCN`,`EUTRABAND`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE  
						',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_1_lte_wk)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_reg_1_lte_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_reg_1_lte_wk=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_1_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				
				SET STEP_START_TIME := SYSDATE();
	
				
				
				SET @SOURCE_TABLE_NAME=@table_reg_3_lte_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_3_lte_mn);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_3_lte_mn);
	
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
										
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_3_lte_mn,' 
						    (
							`REG_ID`,
							`EARFCN`,
							`EUTRABAND`,
							',TILE_LTE_COLUMN_STR,')
						SELECT
							`REG_3_ID` AS `REG_ID`,
							`EARFCN`,
							`EUTRABAND`,
							',TILE_LTE_COLUMN_SUM_STR,'
						FROM ',SHARE_DB,'.',@table_tile_19_lte_dy,'
						GROUP BY `REG_3_ID`,`EARFCN`,`EUTRABAND`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE  
						',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_3_lte_mn)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_reg_3_lte_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_REG_3_lte_mn=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_3_lte_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_reg_2_lte_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_2_lte_mn);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_2_lte_mn);
	
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_2_lte_mn,' 
						    (
							`REG_ID`,
							`EARFCN`,
							`EUTRABAND`,
							',TILE_LTE_COLUMN_STR,')
						SELECT
							`REG_2_ID` AS `REG_ID`,
							`EARFCN`,
							`EUTRABAND`,
							',TILE_LTE_COLUMN_SUM_STR,'
						FROM ',SHARE_DB,'.',@table_tile_19_lte_dy,'
						GROUP BY `REG_2_ID`,`EARFCN`,`EUTRABAND`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE
						',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_2_lte_mn)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_reg_2_lte_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_reg_2_lte_mn=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_2_lte_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_reg_1_lte_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_reg_1_lte_mn);
				SET @ERROR_FLAG=CONCAT(v_group_db_name,'.',@table_reg_1_lte_mn);
	
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_reg_1_lte_mn,' 
						    (
							`REG_ID`,
							`EARFCN`,
							`EUTRABAND`,
							',TILE_LTE_COLUMN_STR,')
						SELECT
							`REG_1_ID` AS `REG_ID`,
							`EARFCN`,
							`EUTRABAND`,
							',TILE_LTE_COLUMN_SUM_STR,'
						FROM ',SHARE_DB,'.',@table_tile_19_lte_dy,'
						GROUP BY `REG_1_ID`,`EARFCN`,`EUTRABAND`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE
						',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_reg_1_lte_mn)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_reg_1_lte_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_reg_1_lte_mn=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT('INSERT INTO ',@table_reg_1_lte_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				
				SET STEP_START_TIME := SYSDATE();
				
				
				SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_tile_19_lte_dy,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.`table_call_cnt_history` A
					SET 
					  A.`FLAG_REG_3_WK` = ',@FLAG_REG_3_LTE_WK,',
					  A.`FLAG_REG_3_MN` = ',@FLAG_REG_3_LTE_MN,',
					  A.`FLAG_REG_2_WK` = ',@FLAG_REG_2_LTE_WK,',
					  A.`FLAG_REG_2_MN` = ',@FLAG_REG_2_LTE_MN,',
					  A.`FLAG_REG_1_WK` = ',@FLAG_REG_1_LTE_WK,',
					  A.`FLAG_REG_1_MN` = ',@FLAG_REG_1_LTE_MN,' 
					WHERE A.`DATA_DATE`=''',@v_DATA_DATE,''' AND `TECH_MASK`=4
					;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				INSERT INTO gt_gw_main.SP_LOG VALUES(v_group_db_name,'SP_Generate_Global_Statistic_Sub_tile_Aggr',CONCAT(v_DATA_DATE,',',v_TECH_MASK,',',WORKER_ID,' Done: ',TIMESTAMPDIFF(SECOND,START_TIME,SYSDATE()),' seconds.'), NOW());
			END IF;
			SET @v_reg_m=@v_reg_m+1;
		END;
		END WHILE;
	END IF;
    END
utf8
utf8_general_ci
latin1_swedish_ci

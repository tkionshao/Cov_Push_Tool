DELIMITER $$
USE `gt_gw_main`$$
DROP PROCEDURE IF EXISTS `SP_CreateDB_LTE`$$
CREATE DEFINER=`covmo`@`%` PROCEDURE `SP_Qlikview_CTO_dashboard`(IN gt_global_statistic VARCHAR(100),IN gt_global_statistic_g1 VARCHAR(100),IN GT_COVMO VARCHAR(100),IN KIND VARCHAR(100),IN DATA_DATE VARCHAR(100),IN FOLDER_PATH VARCHAR(100) )
BEGIN
	
	DECLARE START_TIME DATETIME DEFAULT SYSDATE();
	
	DECLARE PID VARCHAR(10) DEFAULT CONNECTION_ID();
	
	DECLARE GT_DB VARCHAR(50);
	
	
	
	SET @KPI_NAME_1=NULL;
	SET @WEIGHTAGE_1=NULL;
	SET @SCORE_EXCELLENT_LOW_1=NULL;
	SET @SCORE_EXCELLENT_UP_1=NULL;
	SET @SCORE_GOOD_LOW_1=NULL;
	SET @SCORE_GOOD_UP_1=NULL;
	SET @SCORE_FAIR_LOW_1=NULL;
	SET @SCORE_FAIR_UP_1=NULL;
	SET @SCORE_BAD_LOW_1=NULL;
	SET @SCORE_BAD_UP_1=NULL;
	SET @SCORE_VERYBAD_LOW_1=NULL;
	SET @SCORE_VERYBAD_UP_1=NULL;
	
	SET @KPI_NAME_2=NULL;
	SET @WEIGHTAGE_2=NULL;
	SET @SCORE_EXCELLENT_LOW_2=NULL;
	SET @SCORE_EXCELLENT_UP_2=NULL;
	SET @SCORE_GOOD_LOW_2=NULL;
	SET @SCORE_GOOD_UP_2=NULL;
	SET @SCORE_FAIR_LOW_2=NULL;
	SET @SCORE_FAIR_UP_2=NULL;
	SET @SCORE_BAD_LOW_2=NULL;
	SET @SCORE_BAD_UP_2=NULL;
	SET @SCORE_VERYBAD_LOW_2=NULL;
	SET @SCORE_VERYBAD_UP_2=NULL;
	
	SET @KPI_NAME_3=NULL;
	SET @WEIGHTAGE_3=NULL;
	SET @SCORE_EXCELLENT_LOW_3=NULL;
	SET @SCORE_EXCELLENT_UP_3=NULL;
	SET @SCORE_GOOD_LOW_3=NULL;
	SET @SCORE_GOOD_UP_3=NULL;
	SET @SCORE_FAIR_LOW_3=NULL;
	SET @SCORE_FAIR_UP_3=NULL;
	SET @SCORE_BAD_LOW_3=NULL;
	SET @SCORE_BAD_UP_3=NULL;
	SET @SCORE_VERYBAD_LOW_3=NULL;
	SET @SCORE_VERYBAD_UP_3=NULL;
	
	SET @KPI_NAME_4=NULL;
	SET @WEIGHTAGE_4=NULL;
	SET @SCORE_EXCELLENT_LOW_4=NULL;
	SET @SCORE_EXCELLENT_UP_4=NULL;
	SET @SCORE_GOOD_LOW_4=NULL;
	SET @SCORE_GOOD_UP_4=NULL;
	SET @SCORE_FAIR_LOW_4=NULL;
	SET @SCORE_FAIR_UP_4=NULL;
	SET @SCORE_BAD_LOW_4=NULL;
	SET @SCORE_BAD_UP_4=NULL;
	SET @SCORE_VERYBAD_LOW_4=NULL;
	SET @SCORE_VERYBAD_UP_4=NULL;
	
	SET @KPI_NAME_5=NULL;
	SET @WEIGHTAGE_5=NULL;
	SET @SCORE_EXCELLENT_LOW_5=NULL;
	SET @SCORE_EXCELLENT_UP_5=NULL;
	SET @SCORE_GOOD_LOW_5=NULL;
	SET @SCORE_GOOD_UP_5=NULL;
	SET @SCORE_FAIR_LOW_5=NULL;
	SET @SCORE_FAIR_UP_5=NULL;
	SET @SCORE_BAD_LOW_5=NULL;
	SET @SCORE_BAD_UP_5=NULL;
	SET @SCORE_VERYBAD_LOW_5=NULL;
	SET @SCORE_VERYBAD_UP_5=NULL;
	
	SET @KPI_NAME_6=NULL;
	SET @WEIGHTAGE_6=NULL;
	SET @SCORE_EXCELLENT_LOW_6=NULL;
	SET @SCORE_EXCELLENT_UP_6=NULL;
	SET @SCORE_GOOD_LOW_6=NULL;
	SET @SCORE_GOOD_UP_6=NULL;
	SET @SCORE_FAIR_LOW_6=NULL;
	SET @SCORE_FAIR_UP_6=NULL;
	SET @SCORE_BAD_LOW_6=NULL;
	SET @SCORE_BAD_UP_6=NULL;
	SET @SCORE_VERYBAD_LOW_6=NULL;
	SET @SCORE_VERYBAD_UP_6=NULL;
	
	SET @KPI_NAME_7=NULL;
	SET @WEIGHTAGE_7=NULL;
	SET @SCORE_EXCELLENT_LOW_7=NULL;
	SET @SCORE_EXCELLENT_UP_7=NULL;
	SET @SCORE_GOOD_LOW_7=NULL;
	SET @SCORE_GOOD_UP_7=NULL;
	SET @SCORE_FAIR_LOW_7=NULL;
	SET @SCORE_FAIR_UP_7=NULL;
	SET @SCORE_BAD_LOW_7=NULL;
	SET @SCORE_BAD_UP_7=NULL;
	SET @SCORE_VERYBAD_LOW_7=NULL;
	SET @SCORE_VERYBAD_UP_7=NULL;
	
	SET @KPI_NAME_8=NULL;
	SET @WEIGHTAGE_8=NULL;
	SET @SCORE_EXCELLENT_LOW_8=NULL;
	SET @SCORE_EXCELLENT_UP_8=NULL;
	SET @SCORE_GOOD_LOW_8=NULL;
	SET @SCORE_GOOD_UP_8=NULL;
	SET @SCORE_FAIR_LOW_8=NULL;
	SET @SCORE_FAIR_UP_8=NULL;
	SET @SCORE_BAD_LOW_8=NULL;
	SET @SCORE_BAD_UP_8=NULL;
	SET @SCORE_VERYBAD_LOW_8=NULL;
	SET @SCORE_VERYBAD_UP_8=NULL;
	
	SET @KPI_NAME_9=NULL;
	SET @WEIGHTAGE_9=NULL;
	SET @SCORE_EXCELLENT_LOW_9=NULL;
	SET @SCORE_EXCELLENT_UP_9=NULL;
	SET @SCORE_GOOD_LOW_9=NULL;
	SET @SCORE_GOOD_UP_9=NULL;
	SET @SCORE_FAIR_LOW_9=NULL;
	SET @SCORE_FAIR_UP_9=NULL;
	SET @SCORE_BAD_LOW_9=NULL;
	SET @SCORE_BAD_UP_9=NULL;
	SET @SCORE_VERYBAD_LOW_9=NULL;
	SET @SCORE_VERYBAD_UP_9=NULL;
	
	SET @KPI_NAME_10=NULL;
	SET @WEIGHTAGE_10=NULL;
	SET @SCORE_EXCELLENT_LOW_10=NULL;
	SET @SCORE_EXCELLENT_UP_10=NULL;
	SET @SCORE_GOOD_LOW_10=NULL;
	SET @SCORE_GOOD_UP_10=NULL;
	SET @SCORE_FAIR_LOW_10=NULL;
	SET @SCORE_FAIR_UP_10=NULL;
	SET @SCORE_BAD_LOW_10=NULL;
	SET @SCORE_BAD_UP_10=NULL;
	SET @SCORE_VERYBAD_LOW_10=NULL;
	SET @SCORE_VERYBAD_UP_10=NULL;
	
	SET @KPI_NAME_11=NULL;
	SET @WEIGHTAGE_11=NULL;
	SET @SCORE_EXCELLENT_LOW_11=NULL;
	SET @SCORE_EXCELLENT_UP_11=NULL;
	SET @SCORE_GOOD_LOW_11=NULL;
	SET @SCORE_GOOD_UP_11=NULL;
	SET @SCORE_FAIR_LOW_11=NULL;
	SET @SCORE_FAIR_UP_11=NULL;
	SET @SCORE_BAD_LOW_11=NULL;
	SET @SCORE_BAD_UP_11=NULL;
	SET @SCORE_VERYBAD_LOW_11=NULL;
	SET @SCORE_VERYBAD_UP_11=NULL;
	
	SET @KPI_NAME_12=NULL;
	SET @WEIGHTAGE_12=NULL;
	SET @SCORE_EXCELLENT_LOW_12=NULL;
	SET @SCORE_EXCELLENT_UP_12=NULL;
	SET @SCORE_GOOD_LOW_12=NULL;
	SET @SCORE_GOOD_UP_12=NULL;
	SET @SCORE_FAIR_LOW_12=NULL;
	SET @SCORE_FAIR_UP_12=NULL;
	SET @SCORE_BAD_LOW_12=NULL;
	SET @SCORE_BAD_UP_12=NULL;
	SET @SCORE_VERYBAD_LOW_12=NULL;
	SET @SCORE_VERYBAD_UP_12=NULL;
	
	SET @KPI_NAME_13=NULL;
	SET @WEIGHTAGE_13=NULL;
	SET @SCORE_EXCELLENT_LOW_13=NULL;
	SET @SCORE_EXCELLENT_UP_13=NULL;
	SET @SCORE_GOOD_LOW_13=NULL;
	SET @SCORE_GOOD_UP_13=NULL;
	SET @SCORE_FAIR_LOW_13=NULL;
	SET @SCORE_FAIR_UP_13=NULL;
	SET @SCORE_BAD_LOW_13=NULL;
	SET @SCORE_BAD_UP_13=NULL;
	SET @SCORE_VERYBAD_LOW_13=NULL;
	SET @SCORE_VERYBAD_UP_13=NULL;
	
	SET @KPI_NAME_14=NULL;
	SET @WEIGHTAGE_14=NULL;
	SET @SCORE_EXCELLENT_LOW_14=NULL;
	SET @SCORE_EXCELLENT_UP_14=NULL;
	SET @SCORE_GOOD_LOW_14=NULL;
	SET @SCORE_GOOD_UP_14=NULL;
	SET @SCORE_FAIR_LOW_14=NULL;
	SET @SCORE_FAIR_UP_14=NULL;
	SET @SCORE_BAD_LOW_14=NULL;
	SET @SCORE_BAD_UP_14=NULL;
	SET @SCORE_VERYBAD_LOW_14=NULL;
	SET @SCORE_VERYBAD_UP_14=NULL;
	
	SET @KPI_NAME_15=NULL;
	SET @WEIGHTAGE_15=NULL;
	SET @SCORE_EXCELLENT_LOW_15=NULL;
	SET @SCORE_EXCELLENT_UP_15=NULL;
	SET @SCORE_GOOD_LOW_15=NULL;
	SET @SCORE_GOOD_UP_15=NULL;
	SET @SCORE_FAIR_LOW_15=NULL;
	SET @SCORE_FAIR_UP_15=NULL;
	SET @SCORE_BAD_LOW_15=NULL;
	SET @SCORE_BAD_UP_15=NULL;
	SET @SCORE_VERYBAD_LOW_15=NULL;
	SET @SCORE_VERYBAD_UP_15=NULL;
	
	
	SET @KPI_NAME_16=NULL;
	SET @WEIGHTAGE_16=NULL;
	SET @SCORE_EXCELLENT_LOW_16=NULL;
	SET @SCORE_EXCELLENT_UP_16=NULL;
	SET @SCORE_GOOD_LOW_16=NULL;
	SET @SCORE_GOOD_UP_16=NULL;
	SET @SCORE_FAIR_LOW_16=NULL;
	SET @SCORE_FAIR_UP_16=NULL;
	SET @SCORE_BAD_LOW_16=NULL;
	SET @SCORE_BAD_UP_16=NULL;
	SET @SCORE_VERYBAD_LOW_16=NULL;
	SET @SCORE_VERYBAD_UP_16=NULL;
	
 	
	INSERT INTO gt_gw_main.SP_LOG VALUES(gt_global_statistic,'SP_Qlikview_CTO_dashboard','Start', START_TIME);
	
	
	
	IF KIND='AREAS' THEN 
	
		INSERT INTO gt_gw_main.SP_LOG VALUES(gt_global_statistic,'SP_Qlikview_CTO_dashboard','Start Generate AREAS DATA', START_TIME);
	
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW/100,SCORE_EXCELLENT_UP/100,SCORE_GOOD_LOW/100,SCORE_GOOD_UP/100,
				SCORE_FAIR_LOW/100,SCORE_FAIR_UP/100,SCORE_BAD_LOW/100,SCORE_BAD_UP/100,SCORE_VERYBAD_LOW/100,SCORE_VERYBAD_UP/100
				INTO @WEIGHTAGE_1,@SCORE_EXCELLENT_LOW_1,@SCORE_EXCELLENT_UP_1,@SCORE_GOOD_LOW_1,
					@SCORE_GOOD_UP_1,@SCORE_FAIR_LOW_1,@SCORE_FAIR_UP_1,@SCORE_BAD_LOW_1,@SCORE_BAD_UP_1,
					@SCORE_VERYBAD_LOW_1,@SCORE_VERYBAD_UP_1
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''AREAS'' AND SERVICE=''CS'' AND KPI_NAME=''Block_call'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		
	
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW/100,SCORE_EXCELLENT_UP/100,SCORE_GOOD_LOW/100,SCORE_GOOD_UP/100,
				SCORE_FAIR_LOW/100,SCORE_FAIR_UP/100,SCORE_BAD_LOW/100,SCORE_BAD_UP/100,SCORE_VERYBAD_LOW/100,SCORE_VERYBAD_UP/100
				INTO @WEIGHTAGE_2,@SCORE_EXCELLENT_LOW_2,@SCORE_EXCELLENT_UP_2,@SCORE_GOOD_LOW_2,
					@SCORE_GOOD_UP_2,@SCORE_FAIR_LOW_2,@SCORE_FAIR_UP_2,@SCORE_BAD_LOW_2,@SCORE_BAD_UP_2,
					@SCORE_VERYBAD_LOW_2,@SCORE_VERYBAD_UP_2
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''AREAS'' AND SERVICE=''CS'' AND KPI_NAME=''CSSR'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
			
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_3,@SCORE_EXCELLENT_LOW_3,@SCORE_EXCELLENT_UP_3,@SCORE_GOOD_LOW_3,
					@SCORE_GOOD_UP_3,@SCORE_FAIR_LOW_3,@SCORE_FAIR_UP_3,@SCORE_BAD_LOW_3,@SCORE_BAD_UP_3,
					@SCORE_VERYBAD_LOW_3,@SCORE_VERYBAD_UP_3
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''AREAS'' AND SERVICE=''CS'' AND KPI_NAME=''Setup_Time'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_4,@SCORE_EXCELLENT_LOW_4,@SCORE_EXCELLENT_UP_4,@SCORE_GOOD_LOW_4,
					@SCORE_GOOD_UP_4,@SCORE_FAIR_LOW_4,@SCORE_FAIR_UP_4,@SCORE_BAD_LOW_4,@SCORE_BAD_UP_4,
					@SCORE_VERYBAD_LOW_4,@SCORE_VERYBAD_UP_4
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''AREAS'' AND SERVICE=''CS'' AND KPI_NAME=''Drop_call'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW/100,SCORE_EXCELLENT_UP/100,SCORE_GOOD_LOW/100,SCORE_GOOD_UP/100,
				SCORE_FAIR_LOW/100,SCORE_FAIR_UP/100,SCORE_BAD_LOW/100,SCORE_BAD_UP/100,SCORE_VERYBAD_LOW/100,SCORE_VERYBAD_UP/100
				INTO @WEIGHTAGE_5,@SCORE_EXCELLENT_LOW_5,@SCORE_EXCELLENT_UP_5,@SCORE_GOOD_LOW_5,
					@SCORE_GOOD_UP_5,@SCORE_FAIR_LOW_5,@SCORE_FAIR_UP_5,@SCORE_BAD_LOW_5,@SCORE_BAD_UP_5,
					@SCORE_VERYBAD_LOW_5,@SCORE_VERYBAD_UP_5
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''AREAS'' AND SERVICE=''PS'' AND KPI_NAME=''Block_call'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW/100,SCORE_EXCELLENT_UP/100,SCORE_GOOD_LOW/100,SCORE_GOOD_UP/100,
				SCORE_FAIR_LOW/100,SCORE_FAIR_UP/100,SCORE_BAD_LOW/100,SCORE_BAD_UP/100,SCORE_VERYBAD_LOW/100,SCORE_VERYBAD_UP/100
				INTO @WEIGHTAGE_6,@SCORE_EXCELLENT_LOW_6,@SCORE_EXCELLENT_UP_6,@SCORE_GOOD_LOW_6,
					@SCORE_GOOD_UP_6,@SCORE_FAIR_LOW_6,@SCORE_FAIR_UP_6,@SCORE_BAD_LOW_6,@SCORE_BAD_UP_6,
					@SCORE_VERYBAD_LOW_6,@SCORE_VERYBAD_UP_6
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''AREAS'' AND SERVICE=''PS'' AND KPI_NAME=''CSSR'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW/100,SCORE_EXCELLENT_UP/100,SCORE_GOOD_LOW/100,SCORE_GOOD_UP/100,
				SCORE_FAIR_LOW/100,SCORE_FAIR_UP/100,SCORE_BAD_LOW/100,SCORE_BAD_UP/100,SCORE_VERYBAD_LOW/100,SCORE_VERYBAD_UP/100
				INTO @WEIGHTAGE_7,@SCORE_EXCELLENT_LOW_7,@SCORE_EXCELLENT_UP_7,@SCORE_GOOD_LOW_7,
					@SCORE_GOOD_UP_7,@SCORE_FAIR_LOW_7,@SCORE_FAIR_UP_7,@SCORE_BAD_LOW_7,@SCORE_BAD_UP_7,
					@SCORE_VERYBAD_LOW_7,@SCORE_VERYBAD_UP_7
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''AREAS'' AND SERVICE=''PS'' AND KPI_NAME=''Drop_call'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_8,@SCORE_EXCELLENT_LOW_8,@SCORE_EXCELLENT_UP_8,@SCORE_GOOD_LOW_8,
					@SCORE_GOOD_UP_8,@SCORE_FAIR_LOW_8,@SCORE_FAIR_UP_8,@SCORE_BAD_LOW_8,@SCORE_BAD_UP_8,
					@SCORE_VERYBAD_LOW_8,@SCORE_VERYBAD_UP_8
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''AREAS'' AND SERVICE=''PS'' AND KPI_NAME=''DL_throughput'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_9,@SCORE_EXCELLENT_LOW_9,@SCORE_EXCELLENT_UP_9,@SCORE_GOOD_LOW_9,
					@SCORE_GOOD_UP_9,@SCORE_FAIR_LOW_9,@SCORE_FAIR_UP_9,@SCORE_BAD_LOW_9,@SCORE_BAD_UP_9,
					@SCORE_VERYBAD_LOW_9,@SCORE_VERYBAD_UP_9
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''AREAS'' AND SERVICE=''COVERAGE/QUALITY'' AND KPI_NAME=''RXLEV_Sub'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_10,@SCORE_EXCELLENT_LOW_10,@SCORE_EXCELLENT_UP_10,@SCORE_GOOD_LOW_10,
					@SCORE_GOOD_UP_10,@SCORE_FAIR_LOW_10,@SCORE_FAIR_UP_10,@SCORE_BAD_LOW_10,@SCORE_BAD_UP_10,
					@SCORE_VERYBAD_LOW_10,@SCORE_VERYBAD_UP_10
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''AREAS'' AND SERVICE=''COVERAGE/QUALITY'' AND KPI_NAME=''RXQUAL'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_11,@SCORE_EXCELLENT_LOW_11,@SCORE_EXCELLENT_UP_11,@SCORE_GOOD_LOW_11,
					@SCORE_GOOD_UP_11,@SCORE_FAIR_LOW_11,@SCORE_FAIR_UP_11,@SCORE_BAD_LOW_11,@SCORE_BAD_UP_11,
					@SCORE_VERYBAD_LOW_11,@SCORE_VERYBAD_UP_11
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''AREAS'' AND SERVICE=''COVERAGE/QUALITY'' AND KPI_NAME=''RSCP'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_12,@SCORE_EXCELLENT_LOW_12,@SCORE_EXCELLENT_UP_12,@SCORE_GOOD_LOW_12,
					@SCORE_GOOD_UP_12,@SCORE_FAIR_LOW_12,@SCORE_FAIR_UP_12,@SCORE_BAD_LOW_12,@SCORE_BAD_UP_12,
					@SCORE_VERYBAD_LOW_12,@SCORE_VERYBAD_UP_12
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''AREAS'' AND SERVICE=''COVERAGE/QUALITY'' AND KPI_NAME=''EcNo'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_13,@SCORE_EXCELLENT_LOW_13,@SCORE_EXCELLENT_UP_13,@SCORE_GOOD_LOW_13,
					@SCORE_GOOD_UP_13,@SCORE_FAIR_LOW_13,@SCORE_FAIR_UP_13,@SCORE_BAD_LOW_13,@SCORE_BAD_UP_13,
					@SCORE_VERYBAD_LOW_13,@SCORE_VERYBAD_UP_13
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''AREAS'' AND SERVICE=''COVERAGE/QUALITY'' AND KPI_NAME=''RSRP'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_14,@SCORE_EXCELLENT_LOW_14,@SCORE_EXCELLENT_UP_14,@SCORE_GOOD_LOW_14,
					@SCORE_GOOD_UP_14,@SCORE_FAIR_LOW_14,@SCORE_FAIR_UP_14,@SCORE_BAD_LOW_14,@SCORE_BAD_UP_14,
					@SCORE_VERYBAD_LOW_14,@SCORE_VERYBAD_UP_14
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''AREAS'' AND SERVICE=''COVERAGE/QUALITY'' AND KPI_NAME=''RSRQ'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		
	
		SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.TMP_cto_dashboard_areas;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
	
	
		SET @SqlCmd=CONCAT('CREATE TEMPORARY TABLE ',gt_global_statistic,'.TMP_cto_dashboard_areas
				SELECT REG_ID,Voice_CS_Block_call_original,Voice_CS_Block_call_score,Voice_CS_CSSR_original,Voice_CS_CSSR_score,Voice_CS_CALL_SET_UP_TIME_original,Voice_CS_CALL_SET_UP_TIME_score,Voice_CS_Drop_calls_original,Voice_CS_Drop_calls_score,data_PS_Blocl_call_original,data_PS_Blocl_call_score,
					data_PS_CSSR_original,data_PS_CSSR_score,data_PS_Drop_calls_original,data_PS_Drop_calls_score,data_PS_Throughput_original,data_PS_Throughput_score,Coverage_Quality_2G_coverage_original,Coverage_Quality_2G_coverage_score,
					Coverage_Quality_2G_Quality_original,Coverage_Quality_2G_Quality_score,Coverage_Quality_3G_Coverage_original,Coverage_Quality_3G_Coverage_score,Coverage_Quality_3G_Quality_original,Coverage_Quality_3G_Quality_score,
					Coverage_Quality_4G_coverage_original,Coverage_Quality_4G_coverage_score,Coverage_Quality_4G_Quality_original,Coverage_Quality_4G_Quality_score 
				FROM ',gt_global_statistic,'.qv_cto_dashboard_areas;
				');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
	
		SET @SqlCmd=CONCAT('
				INSERT INTO ',gt_global_statistic,'.TMP_cto_dashboard_areas(REG_id,Voice_CS_Block_call_original,Voice_CS_Block_call_score,Voice_CS_CSSR_original,Voice_CS_CSSR_score,Voice_CS_CALL_SET_UP_TIME_original,Voice_CS_CALL_SET_UP_TIME_score,Voice_CS_Drop_calls_original,Voice_CS_Drop_calls_score
							,data_PS_Blocl_call_original,data_PS_Blocl_call_score,data_PS_CSSR_original,data_PS_CSSR_score,data_PS_Drop_calls_original,data_PS_Drop_calls_score,data_PS_Throughput_original,data_PS_Throughput_score,Coverage_Quality_2G_coverage_original,Coverage_Quality_2G_coverage_score
							,Coverage_Quality_2G_Quality_original,Coverage_Quality_2G_Quality_score,Coverage_Quality_3G_Coverage_original,Coverage_Quality_3G_Coverage_score,Coverage_Quality_3G_Quality_original,Coverage_Quality_3G_Quality_score,Coverage_Quality_4G_coverage_original,Coverage_Quality_4G_coverage_score
							,Coverage_Quality_4G_Quality_original,Coverage_Quality_4G_Quality_score)
					SELECT 
					REG_ID,
					(GSM_CS_BLOCK_CNT+UMTS_CS_BLOCK_CNT)/(GSM_CS_CALL_CNT+UMTS_CS_CALL_CNT),
					(CASE 
					WHEN (GSM_CS_BLOCK_CNT+UMTS_CS_BLOCK_CNT)/(GSM_CS_CALL_CNT+UMTS_CS_CALL_CNT) BETWEEN ',@SCORE_EXCELLENT_LOW_1,' AND ',@SCORE_EXCELLENT_UP_1,' THEN ''5''
					WHEN (GSM_CS_BLOCK_CNT+UMTS_CS_BLOCK_CNT)/(GSM_CS_CALL_CNT+UMTS_CS_CALL_CNT) BETWEEN ',@SCORE_GOOD_LOW_1,' AND ',@SCORE_GOOD_UP_1,' THEN ''4''
					WHEN (GSM_CS_BLOCK_CNT+UMTS_CS_BLOCK_CNT)/(GSM_CS_CALL_CNT+UMTS_CS_CALL_CNT) BETWEEN ',@SCORE_FAIR_LOW_1,' AND ',@SCORE_FAIR_UP_1,' THEN ''3''
					WHEN (GSM_CS_BLOCK_CNT+UMTS_CS_BLOCK_CNT)/(GSM_CS_CALL_CNT+UMTS_CS_CALL_CNT) BETWEEN ',@SCORE_BAD_LOW_1,' AND ',@SCORE_BAD_UP_1,' THEN ''2''
					WHEN (GSM_CS_BLOCK_CNT+UMTS_CS_BLOCK_CNT)/(GSM_CS_CALL_CNT+UMTS_CS_CALL_CNT) >=',@SCORE_VERYBAD_UP_1,' THEN ''1''
					ELSE ''5'' END) ,
	
					IFNULL((1-((GSM_CS_SETUP_FAILURE_CNT+GSM_CS_BLOCK_CNT+UMTS_CS_SETUP_FAILURE_CNT+UMTS_CS_BLOCK_CNT)/(GSM_CS_CALL_CNT+UMTS_CS_CALL_CNT))),0),
					(CASE 
					WHEN (1-((GSM_CS_SETUP_FAILURE_CNT+GSM_CS_BLOCK_CNT+UMTS_CS_SETUP_FAILURE_CNT+UMTS_CS_BLOCK_CNT)/(GSM_CS_CALL_CNT+UMTS_CS_CALL_CNT))) BETWEEN ',@SCORE_EXCELLENT_LOW_2,' AND ',@SCORE_EXCELLENT_UP_2,' THEN ''5''
					WHEN (1-((GSM_CS_SETUP_FAILURE_CNT+GSM_CS_BLOCK_CNT+UMTS_CS_SETUP_FAILURE_CNT+UMTS_CS_BLOCK_CNT)/(GSM_CS_CALL_CNT+UMTS_CS_CALL_CNT))) BETWEEN ',@SCORE_GOOD_LOW_2,' AND ',@SCORE_GOOD_UP_2,' THEN ''4''
					WHEN (1-((GSM_CS_SETUP_FAILURE_CNT+GSM_CS_BLOCK_CNT+UMTS_CS_SETUP_FAILURE_CNT+UMTS_CS_BLOCK_CNT)/(GSM_CS_CALL_CNT+UMTS_CS_CALL_CNT))) BETWEEN ',@SCORE_FAIR_LOW_2,' AND ',@SCORE_FAIR_UP_2,' THEN ''3''
					WHEN (1-((GSM_CS_SETUP_FAILURE_CNT+GSM_CS_BLOCK_CNT+UMTS_CS_SETUP_FAILURE_CNT+UMTS_CS_BLOCK_CNT)/(GSM_CS_CALL_CNT+UMTS_CS_CALL_CNT))) BETWEEN ',@SCORE_BAD_LOW_2,' AND ',@SCORE_BAD_UP_2,' THEN ''2''
					WHEN (1-((GSM_CS_SETUP_FAILURE_CNT+GSM_CS_BLOCK_CNT+UMTS_CS_SETUP_FAILURE_CNT+UMTS_CS_BLOCK_CNT)/(GSM_CS_CALL_CNT+UMTS_CS_CALL_CNT))) <= ',@SCORE_VERYBAD_UP_2,' THEN ''1''
					ELSE ''5'' END) AS Voice_CS_CSSR_score,
	
					((GSM_CALL_SETUP_TIME_SUM+UMTS_CALL_SETUP_TIME_SUM)/(GSM_CALL_SETUP_TIME_CNT+UMTS_CALL_SETUP_TIME_CNT))/1000,
					(CASE 
					WHEN ((GSM_CALL_SETUP_TIME_SUM+UMTS_CALL_SETUP_TIME_SUM)/(GSM_CALL_SETUP_TIME_CNT+UMTS_CALL_SETUP_TIME_CNT))/1000 <= ',@SCORE_EXCELLENT_UP_3,' THEN ''5''
					WHEN ((GSM_CALL_SETUP_TIME_SUM+UMTS_CALL_SETUP_TIME_SUM)/(GSM_CALL_SETUP_TIME_CNT+UMTS_CALL_SETUP_TIME_CNT))/1000 BETWEEN ',@SCORE_GOOD_LOW_3,' AND ',@SCORE_GOOD_UP_3,' THEN ''4''
					WHEN ((GSM_CALL_SETUP_TIME_SUM+UMTS_CALL_SETUP_TIME_SUM)/(GSM_CALL_SETUP_TIME_CNT+UMTS_CALL_SETUP_TIME_CNT))/1000 BETWEEN ',@SCORE_FAIR_LOW_3,' AND ',@SCORE_FAIR_UP_3,' THEN ''3''
					WHEN ((GSM_CALL_SETUP_TIME_SUM+UMTS_CALL_SETUP_TIME_SUM)/(GSM_CALL_SETUP_TIME_CNT+UMTS_CALL_SETUP_TIME_CNT))/1000 BETWEEN ',@SCORE_BAD_LOW_3,' AND ',@SCORE_BAD_UP_3,' THEN ''2''
					WHEN ((GSM_CALL_SETUP_TIME_SUM+UMTS_CALL_SETUP_TIME_SUM)/(GSM_CALL_SETUP_TIME_CNT+UMTS_CALL_SETUP_TIME_CNT))/1000 >= ',@SCORE_VERYBAD_UP_3,' THEN ''1''
					ELSE ''5'' END) AS Voice_CS_CALL_SET_UP_TIME_score,
	
					(GSM_VOICE_DROP_CNT+UMTS_VOICE_DROP_CNT),
					(CASE 
					WHEN (GSM_VOICE_DROP_CNT+UMTS_VOICE_DROP_CNT) BETWEEN ',@SCORE_EXCELLENT_LOW_4,' AND ',@SCORE_EXCELLENT_UP_4,' THEN ''5''
					WHEN (GSM_VOICE_DROP_CNT+UMTS_VOICE_DROP_CNT) BETWEEN ',@SCORE_GOOD_LOW_4,' AND ',@SCORE_GOOD_UP_4,' THEN ''4''
					WHEN (GSM_VOICE_DROP_CNT+UMTS_VOICE_DROP_CNT) BETWEEN ',@SCORE_FAIR_LOW_4,' AND ',@SCORE_FAIR_UP_4,' THEN ''3''
					WHEN (GSM_VOICE_DROP_CNT+UMTS_VOICE_DROP_CNT) BETWEEN ',@SCORE_BAD_LOW_4,' AND ',@SCORE_BAD_UP_4,' THEN ''2''
					WHEN (GSM_VOICE_DROP_CNT+UMTS_VOICE_DROP_CNT) >= ',@SCORE_VERYBAD_UP_4,' THEN ''1''
					ELSE ''0'' END) AS Voice_CS_Drop_calls_score,
	
					(GSM_PS_BLOCK_CNT+UMTS_PS_BLOCK_CNT+LTE_BLOCK_CNT)/(GSM_PS_CALL_CNT+UMTS_PS_CALL_CNT+LTE_CALL_CNT),
					(CASE 
					WHEN (GSM_PS_BLOCK_CNT+UMTS_PS_BLOCK_CNT+LTE_BLOCK_CNT)/(GSM_PS_CALL_CNT+UMTS_PS_CALL_CNT+LTE_CALL_CNT) <= ',@SCORE_EXCELLENT_UP_5,' THEN ''5''
					WHEN (GSM_PS_BLOCK_CNT+UMTS_PS_BLOCK_CNT+LTE_BLOCK_CNT)/(GSM_PS_CALL_CNT+UMTS_PS_CALL_CNT+LTE_CALL_CNT) BETWEEN ',@SCORE_GOOD_LOW_5,' AND ',@SCORE_GOOD_UP_5,' THEN ''4''
					WHEN (GSM_PS_BLOCK_CNT+UMTS_PS_BLOCK_CNT+LTE_BLOCK_CNT)/(GSM_PS_CALL_CNT+UMTS_PS_CALL_CNT+LTE_CALL_CNT) BETWEEN ',@SCORE_FAIR_LOW_5,' AND ',@SCORE_FAIR_UP_5,' THEN ''3''
					WHEN (GSM_PS_BLOCK_CNT+UMTS_PS_BLOCK_CNT+LTE_BLOCK_CNT)/(GSM_PS_CALL_CNT+UMTS_PS_CALL_CNT+LTE_CALL_CNT) BETWEEN ',@SCORE_BAD_LOW_5,' AND ',@SCORE_BAD_UP_5,' THEN ''2''
					WHEN (GSM_PS_BLOCK_CNT+UMTS_PS_BLOCK_CNT+LTE_BLOCK_CNT)/(GSM_PS_CALL_CNT+UMTS_PS_CALL_CNT+LTE_CALL_CNT) >= ',@SCORE_VERYBAD_UP_5,' THEN ''1''
					ELSE ''5'' END) AS data_PS_Blocl_call_score,
					
					(1-((GSM_PS_SETUP_FAILURE_CNT+GSM_PS_BLOCK_CNT+UMTS_PS_SETUP_FAILURE_CNT+UMTS_PS_BLOCK_CNT+LTE_SETUP_FAILURE_CNT+LTE_BLOCK_CNT)/(GSM_PS_CALL_CNT+UMTS_PS_CALL_CNT+LTE_CALL_CNT))),
					(CASE 
					WHEN ((1-((GSM_PS_SETUP_FAILURE_CNT+GSM_PS_BLOCK_CNT+UMTS_PS_SETUP_FAILURE_CNT+UMTS_PS_BLOCK_CNT+LTE_SETUP_FAILURE_CNT+LTE_BLOCK_CNT)/(GSM_PS_CALL_CNT+UMTS_PS_CALL_CNT+LTE_CALL_CNT)))) >=',@SCORE_EXCELLENT_UP_6,' THEN ''5''
					WHEN ((1-((GSM_PS_SETUP_FAILURE_CNT+GSM_PS_BLOCK_CNT+UMTS_PS_SETUP_FAILURE_CNT+UMTS_PS_BLOCK_CNT+LTE_SETUP_FAILURE_CNT+LTE_BLOCK_CNT)/(GSM_PS_CALL_CNT+UMTS_PS_CALL_CNT+LTE_CALL_CNT)))) BETWEEN ',@SCORE_GOOD_LOW_6,' AND ',@SCORE_GOOD_UP_6,' THEN ''4''
					WHEN ((1-((GSM_PS_SETUP_FAILURE_CNT+GSM_PS_BLOCK_CNT+UMTS_PS_SETUP_FAILURE_CNT+UMTS_PS_BLOCK_CNT+LTE_SETUP_FAILURE_CNT+LTE_BLOCK_CNT)/(GSM_PS_CALL_CNT+UMTS_PS_CALL_CNT+LTE_CALL_CNT)))) BETWEEN ',@SCORE_FAIR_LOW_6,' AND ',@SCORE_FAIR_UP_6,' THEN ''3''
					WHEN ((1-((GSM_PS_SETUP_FAILURE_CNT+GSM_PS_BLOCK_CNT+UMTS_PS_SETUP_FAILURE_CNT+UMTS_PS_BLOCK_CNT+LTE_SETUP_FAILURE_CNT+LTE_BLOCK_CNT)/(GSM_PS_CALL_CNT+UMTS_PS_CALL_CNT+LTE_CALL_CNT)))) BETWEEN ',@SCORE_BAD_LOW_6,' AND ',@SCORE_BAD_UP_6,' THEN ''2''
					WHEN (1-((GSM_CS_SETUP_FAILURE_CNT+GSM_CS_BLOCK_CNT+UMTS_CS_SETUP_FAILURE_CNT+UMTS_CS_BLOCK_CNT)/(GSM_CS_CALL_CNT+UMTS_CS_CALL_CNT))) <= ',@SCORE_VERYBAD_UP_6,' THEN ''1''
					ELSE ''5'' END) AS data_PS_CSSR_score,
	
					(GSM_GPRS_DROP_CNT+UMTS_PS_DROP_CNT+LTE_DROP_CNT)/(GSM_PS_CALL_CNT+UMTS_PS_CALL_CNT+LTE_CALL_CNT),
					(CASE 
					WHEN (GSM_GPRS_DROP_CNT+UMTS_PS_DROP_CNT+LTE_DROP_CNT)/(GSM_PS_CALL_CNT+UMTS_PS_CALL_CNT+LTE_CALL_CNT) <=',@SCORE_EXCELLENT_UP_7,' THEN ''5''
					WHEN (GSM_GPRS_DROP_CNT+UMTS_PS_DROP_CNT+LTE_DROP_CNT)/(GSM_PS_CALL_CNT+UMTS_PS_CALL_CNT+LTE_CALL_CNT)  BETWEEN ',@SCORE_GOOD_LOW_7,' AND ',@SCORE_GOOD_UP_7,' THEN ''4''
					WHEN (GSM_GPRS_DROP_CNT+UMTS_PS_DROP_CNT+LTE_DROP_CNT)/(GSM_PS_CALL_CNT+UMTS_PS_CALL_CNT+LTE_CALL_CNT)  BETWEEN ',@SCORE_FAIR_LOW_7,' AND ',@SCORE_FAIR_UP_7,' THEN ''3''
					WHEN (GSM_GPRS_DROP_CNT+UMTS_PS_DROP_CNT+LTE_DROP_CNT)/(GSM_PS_CALL_CNT+UMTS_PS_CALL_CNT+LTE_CALL_CNT)  BETWEEN ',@SCORE_BAD_LOW_7,' AND ',@SCORE_BAD_UP_7,' THEN ''2''
					WHEN (GSM_GPRS_DROP_CNT+UMTS_PS_DROP_CNT+LTE_DROP_CNT)/(GSM_PS_CALL_CNT+UMTS_PS_CALL_CNT+LTE_CALL_CNT) >= ',@SCORE_VERYBAD_UP_7,' THEN ''1''
					ELSE ''5'' END) AS data_PS_Drop_calls_score,
	
	
					(((UMTS_DL_THROUPUT_SUM+LTE_DL_THROUPUT_SUM)/(UMTS_DL_THROUPUT_CNT+LTE_DL_THROUPUT_CNT))/1024),
					(CASE 
					WHEN (((UMTS_DL_THROUPUT_SUM+LTE_DL_THROUPUT_SUM)/(UMTS_DL_THROUPUT_CNT+LTE_DL_THROUPUT_CNT))/1024) >=',@SCORE_EXCELLENT_UP_8,' THEN ''5''
					WHEN (((UMTS_DL_THROUPUT_SUM+LTE_DL_THROUPUT_SUM)/(UMTS_DL_THROUPUT_CNT+LTE_DL_THROUPUT_CNT))/1024)  BETWEEN ',@SCORE_GOOD_LOW_8,' AND ',@SCORE_GOOD_UP_8,' THEN ''4''
					WHEN (((UMTS_DL_THROUPUT_SUM+LTE_DL_THROUPUT_SUM)/(UMTS_DL_THROUPUT_CNT+LTE_DL_THROUPUT_CNT))/1024)  BETWEEN ',@SCORE_FAIR_LOW_8,' AND ',@SCORE_FAIR_UP_8,' THEN ''3''
					WHEN (((UMTS_DL_THROUPUT_SUM+LTE_DL_THROUPUT_SUM)/(UMTS_DL_THROUPUT_CNT+LTE_DL_THROUPUT_CNT))/1024)  BETWEEN ',@SCORE_BAD_LOW_8,' AND ',@SCORE_BAD_UP_8,' THEN ''2''
					WHEN (((UMTS_DL_THROUPUT_SUM+LTE_DL_THROUPUT_SUM)/(UMTS_DL_THROUPUT_CNT+LTE_DL_THROUPUT_CNT))/1024) <=',@SCORE_VERYBAD_UP_8,' THEN ''1''
					ELSE ''1'' END) AS data_PS_Throughput_score,
	
					(RXLEV_SUM/RXLEV_CNT),
					(CASE 
					WHEN (RXLEV_SUM/RXLEV_CNT) >= ',@SCORE_EXCELLENT_UP_9,' THEN ''5''
					WHEN (RXLEV_SUM/RXLEV_CNT)  BETWEEN ',@SCORE_GOOD_LOW_9,' AND ',@SCORE_GOOD_UP_9,' THEN ''4''
					WHEN (RXLEV_SUM/RXLEV_CNT)  BETWEEN ',@SCORE_FAIR_LOW_9,' AND ',@SCORE_FAIR_UP_9,' THEN ''3''
					WHEN (RXLEV_SUM/RXLEV_CNT)  BETWEEN ',@SCORE_BAD_LOW_9,' AND ',@SCORE_BAD_UP_9,' THEN ''2''
					WHEN (RXLEV_SUM/RXLEV_CNT) <= ',@SCORE_VERYBAD_UP_9,' THEN ''1''
					ELSE ''5'' END) AS Coverage_Quality_2G_coverage_score,
					
					(RXQUAL_SUM/RXQUAL_CNT),
					(CASE 
					WHEN (RXQUAL_SUM/RXQUAL_CNT)  BETWEEN ',@SCORE_EXCELLENT_LOW_10,' AND ',@SCORE_EXCELLENT_UP_10,' THEN ''5''
					WHEN (RXQUAL_SUM/RXQUAL_CNT)  BETWEEN ',@SCORE_GOOD_LOW_10,' AND ',@SCORE_GOOD_UP_10,' THEN ''4''
					WHEN (RXQUAL_SUM/RXQUAL_CNT)  BETWEEN ',@SCORE_FAIR_LOW_10,' AND ',@SCORE_FAIR_UP_10,' THEN ''3''
					WHEN (RXQUAL_SUM/RXQUAL_CNT)  BETWEEN ',@SCORE_BAD_LOW_10,' AND ',@SCORE_BAD_UP_10,' THEN ''2''
					WHEN (RXQUAL_SUM/RXQUAL_CNT)  >= ',@SCORE_VERYBAD_UP_10,' THEN ''1''
					ELSE ''5'' END) AS Coverage_Quality_2G_Quality_score,
	
					(RSCP_SUM/RSCP_CNT),
					(CASE 
					WHEN (RSCP_SUM/RSCP_CNT) >=',@SCORE_EXCELLENT_UP_11,' THEN ''5''
					WHEN (RSCP_SUM/RSCP_CNT)  BETWEEN ',@SCORE_GOOD_LOW_11,' AND ',@SCORE_GOOD_UP_11,' THEN ''4''
					WHEN (RSCP_SUM/RSCP_CNT)  BETWEEN ',@SCORE_FAIR_LOW_11,' AND ',@SCORE_FAIR_UP_11,' THEN ''3''
					WHEN (RSCP_SUM/RSCP_CNT)  BETWEEN ',@SCORE_BAD_LOW_11,' AND ',@SCORE_BAD_UP_11,' THEN ''2''
					WHEN (RSCP_SUM/RSCP_CNT) <= ',@SCORE_VERYBAD_UP_11,' THEN ''1''
					ELSE ''5'' END) AS Coverage_Quality_3G_coverage_score,
					
					(ECNO_SUM/ECNO_CNT),
					(CASE 
					WHEN (ECNO_SUM/ECNO_CNT)  BETWEEN ',@SCORE_EXCELLENT_LOW_12,' AND ',@SCORE_EXCELLENT_UP_12,' THEN ''5''
					WHEN (ECNO_SUM/ECNO_CNT)  BETWEEN ',@SCORE_GOOD_LOW_12,' AND ',@SCORE_GOOD_UP_12,' THEN ''4''
					WHEN (ECNO_SUM/ECNO_CNT)  BETWEEN ',@SCORE_FAIR_LOW_12,' AND ',@SCORE_FAIR_UP_12,' THEN ''3''
					WHEN (ECNO_SUM/ECNO_CNT)  BETWEEN ',@SCORE_BAD_LOW_12,' AND ',@SCORE_BAD_UP_12,' THEN ''2''
					WHEN (ECNO_SUM/ECNO_CNT)  <= ',@SCORE_VERYBAD_UP_12,' THEN ''1''
					ELSE ''5'' END) AS Coverage_Quality_3G_Quality_score,
	
					(RSRP_SUM/RSRP_CNT),
					(CASE 
					WHEN (RSRP_SUM/RSRP_CNT) >=',@SCORE_EXCELLENT_UP_13,' THEN ''5''
					WHEN (RSRP_SUM/RSRP_CNT)  BETWEEN ',@SCORE_GOOD_LOW_13,' AND ',@SCORE_GOOD_UP_13,' THEN ''4''
					WHEN (RSRP_SUM/RSRP_CNT)  BETWEEN ',@SCORE_FAIR_LOW_13,' AND ',@SCORE_FAIR_UP_13,' THEN ''3''
					WHEN (RSRP_SUM/RSRP_CNT)  BETWEEN ',@SCORE_BAD_LOW_13,' AND ',@SCORE_BAD_UP_13,' THEN ''2''
					WHEN (RSRP_SUM/RSRP_CNT) <=',@SCORE_VERYBAD_UP_13,' THEN ''1''
					ELSE ''5'' END) AS Coverage_Quality_4G_coverage_score,
					
					(RSRQ_SUM/RSRQ_CNT),
					(CASE 
					WHEN (RSRQ_SUM/RSRQ_CNT)  BETWEEN ',@SCORE_EXCELLENT_LOW_14,' AND ',@SCORE_EXCELLENT_UP_14,' THEN ''5''
					WHEN (RSRQ_SUM/RSRQ_CNT)  BETWEEN ',@SCORE_GOOD_LOW_14,' AND ',@SCORE_GOOD_UP_14,' THEN ''4''
					WHEN (RSRQ_SUM/RSRQ_CNT)  BETWEEN ',@SCORE_FAIR_LOW_14,' AND ',@SCORE_FAIR_UP_14,' THEN ''3''
					WHEN (RSRQ_SUM/RSRQ_CNT)  BETWEEN ',@SCORE_BAD_LOW_14,' AND ',@SCORE_BAD_UP_14,' THEN ''2''
					WHEN (RSRQ_SUM/RSRQ_CNT)  <=',@SCORE_VERYBAD_UP_14,'  THEN ''1''
					ELSE ''5'' END) AS Coverage_Quality_4G_Quality_score
					
				FROM ',gt_global_statistic_g1,'.table_reg_3_ds_DY_',DATA_DATE,'
					WHERE REG_ID>0
			GROUP BY REG_ID
			ORDER BY NULL ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		
		SET @SqlCmd=CONCAT('TRUNCATE TABLE ',gt_global_statistic,'.qv_cto_dashboard_areas;');		
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('
				INSERT INTO ',gt_global_statistic,'.qv_cto_dashboard_areas(REG_id,NAME,
					Voice_CS_Block_call_original,Voice_CS_Block_call_score,Voice_CS_Block_call_total,
					Voice_CS_CSSR_original,Voice_CS_CSSR_score,Voice_CS_CSSR_total,
					Voice_CS_CALL_SET_UP_TIME_original,Voice_CS_CALL_SET_UP_TIME_score,Voice_CS_CALL_SET_UP_TIME_TOTAL,
					Voice_CS_Drop_calls_original,Voice_CS_Drop_calls_score,Voice_CS_Drop_calls_total,
					data_PS_Blocl_call_original,data_PS_Blocl_call_score,data_PS_Blocl_call_total,
					data_PS_CSSR_original,data_PS_CSSR_score,data_PS_CSSR_total,
					data_PS_Drop_calls_original,data_PS_Drop_calls_score,data_PS_Drop_calls_total,
					data_PS_Throughput_original,data_PS_Throughput_score,data_PS_Throughput_total,					
					Coverage_Quality_2G_coverage_original,Coverage_Quality_2G_coverage_score,Coverage_Quality_2G_coverage_total,
					Coverage_Quality_2G_Quality_original,Coverage_Quality_2G_Quality_score,Coverage_Quality_2G_Quality_total,
					Coverage_Quality_3G_Coverage_original,Coverage_Quality_3G_Coverage_score,Coverage_Quality_3G_Coverage_total,
					Coverage_Quality_3G_Quality_original,Coverage_Quality_3G_Quality_score,Coverage_Quality_3G_Quality_total,
					Coverage_Quality_4G_coverage_original,Coverage_Quality_4G_coverage_score,Coverage_Quality_4G_coverage_total,
					Coverage_Quality_4G_Quality_original,Coverage_Quality_4G_Quality_score,Coverage_Quality_4G_Quality_total)
					
	
				SELECT A.REG_id,B.name,
					A.Voice_CS_Block_call_original,A.Voice_CS_Block_call_score,(A.Voice_CS_Block_call_score)*',@WEIGHTAGE_1,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5),
					A.Voice_CS_CSSR_original,A.Voice_CS_CSSR_score,(A.Voice_CS_CSSR_score)*',@WEIGHTAGE_2,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5),
					A.Voice_CS_CALL_SET_UP_TIME_original,A.Voice_CS_CALL_SET_UP_TIME_score,(A.Voice_CS_CALL_SET_UP_TIME_score)*',@WEIGHTAGE_3,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5),
					A.Voice_CS_Drop_calls_original,A.Voice_CS_Drop_calls_score,(A.Voice_CS_Drop_calls_score)*',@WEIGHTAGE_4,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5),
					A.data_PS_Blocl_call_original,A.data_PS_Blocl_call_score,(A.data_PS_Blocl_call_score)*',@WEIGHTAGE_5,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5),
					A.data_PS_CSSR_original,A.data_PS_CSSR_score,(A.data_PS_CSSR_score)*',@WEIGHTAGE_6,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5),
					A.data_PS_Drop_calls_original,A.data_PS_Drop_calls_score,(A.data_PS_Drop_calls_score)*',@WEIGHTAGE_7,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5),
					A.data_PS_Throughput_original,A.data_PS_Throughput_score,(A.data_PS_Throughput_score)*',@WEIGHTAGE_8,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5),					
					A.Coverage_Quality_2G_coverage_original,A.Coverage_Quality_2G_coverage_score,(A.Coverage_Quality_2G_coverage_score)*',@WEIGHTAGE_9,'/((',@WEIGHTAGE_9,'+',@WEIGHTAGE_10,'+',@WEIGHTAGE_11,'+',@WEIGHTAGE_12,'+',@WEIGHTAGE_13,'+',@WEIGHTAGE_14,')*5),
					A.Coverage_Quality_2G_Quality_original,A.Coverage_Quality_2G_Quality_score,(A.Coverage_Quality_2G_Quality_score)*',@WEIGHTAGE_10,'/((',@WEIGHTAGE_9,'+',@WEIGHTAGE_10,'+',@WEIGHTAGE_11,'+',@WEIGHTAGE_12,'+',@WEIGHTAGE_13,'+',@WEIGHTAGE_14,')*5),
					A.Coverage_Quality_3G_Coverage_original,A.Coverage_Quality_3G_Coverage_score,(A.Coverage_Quality_3G_Coverage_score)*',@WEIGHTAGE_11,'/((',@WEIGHTAGE_9,'+',@WEIGHTAGE_10,'+',@WEIGHTAGE_11,'+',@WEIGHTAGE_12,'+',@WEIGHTAGE_13,'+',@WEIGHTAGE_14,')*5),
					A.Coverage_Quality_3G_Quality_original,A.Coverage_Quality_3G_Quality_score,(A.Coverage_Quality_3G_Quality_score)*',@WEIGHTAGE_12,'/((',@WEIGHTAGE_9,'+',@WEIGHTAGE_10,'+',@WEIGHTAGE_11,'+',@WEIGHTAGE_12,'+',@WEIGHTAGE_13,'+',@WEIGHTAGE_14,')*5),
					A.Coverage_Quality_4G_coverage_original,A.Coverage_Quality_4G_coverage_score,(A.Coverage_Quality_4G_coverage_score)*',@WEIGHTAGE_13,'/((',@WEIGHTAGE_9,'+',@WEIGHTAGE_10,'+',@WEIGHTAGE_11,'+',@WEIGHTAGE_12,'+',@WEIGHTAGE_13,'+',@WEIGHTAGE_14,')*5),
					A.Coverage_Quality_4G_Quality_original,A.Coverage_Quality_4G_Quality_score,(A.Coverage_Quality_4G_Quality_score)*',@WEIGHTAGE_14,'/((',@WEIGHTAGE_9,'+',@WEIGHTAGE_10,'+',@WEIGHTAGE_11,'+',@WEIGHTAGE_12,'+',@WEIGHTAGE_13,'+',@WEIGHTAGE_14,')*5)
						
				FROM ',gt_global_statistic,'.TMP_cto_dashboard_areas A JOIN ',gt_global_statistic,'.usr_polygon_reg_3_v4 B
				ON A.REG_ID=B.id 
				GROUP BY B.`NAME` 
				;');
	
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		SET @SqlCmd=CONCAT('
				UPDATE ',gt_global_statistic,'.qv_cto_dashboard_areas
				SET Voice_CS=Voice_CS_Block_call_total+Voice_CS_CSSR_total+Voice_CS_CALL_SET_UP_TIME_TOTAL+Voice_CS_Drop_calls_total,
					Data_PS=Data_PS_Blocl_call_total+Data_PS_CSSR_total+Data_PS_Drop_calls_total+Data_PS_Throughput_total,
					Coverage_Quality=Coverage_Quality_2G_coverage_total+Coverage_Quality_2G_Quality_total+Coverage_Quality_3G_Coverage_total+Coverage_Quality_3G_Quality_total+Coverage_Quality_4G_coverage_total+Coverage_Quality_4G_Quality_total;
				');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;		
		
		SET @SqlCmd=CONCAT('
						SELECT 
						''REG_id'',''NAME'',
						''Voice_CS_Block_call_original'' ,''Voice_CS_Block_call_score'' ,''Voice_CS_Block_call_total'' ,
						''Voice_CS_CSSR_original'',''Voice_CS_CSSR_score'' ,''Voice_CS_CSSR_total'' ,
						''Voice_CS_CALL_SET_UP_TIME_original'' ,''Voice_CS_CALL_SET_UP_TIME_score'' ,''Voice_CS_CALL_SET_UP_TIME_TOTAL'',
						''Voice_CS_Drop_calls_original'' ,''Voice_CS_Drop_calls_score'' ,''Voice_CS_Drop_calls_total'',
						''Data_PS_Blocl_call_original'' ,''Data_PS_Blocl_call_score'' ,''Data_PS_Blocl_call_total'',
						''Data_PS_CSSR_original'' ,''Data_PS_CSSR_score'',''Data_PS_CSSR_total'' ,
						''Data_PS_Drop_calls_original'' ,''Data_PS_Drop_calls_score'' ,''Data_PS_Drop_calls_total'' ,
						''Data_PS_Throughput_original'' ,''Data_PS_Throughput_score'' ,''Data_PS_Throughput_total'',						
						''Coverage_Quality_2G_coverage_original'' ,''Coverage_Quality_2G_coverage_score'',''Coverage_Quality_2G_coverage_total'',
						''Coverage_Quality_2G_Quality_original'' ,''Coverage_Quality_2G_Quality_score'' ,''Coverage_Quality_2G_Quality_total'',
						''Coverage_Quality_3G_coverage_original'',''Coverage_Quality_3G_coverage_score'' ,''Coverage_Quality_3G_coverage_total'' ,
						''Coverage_Quality_3G_Quality_original'',''Coverage_Quality_3G_Quality_score'',''Coverage_Quality_3G_Quality_total'' ,
						''Coverage_Quality_4G_coverage_original'',''Coverage_Quality_4G_coverage_score'',''Coverage_Quality_4G_coverage_total'' ,
						''Coverage_Quality_4G_Quality_original'',''Coverage_Quality_4G_Quality_score'' ,''Coverage_Quality_4G_Quality_total'',
						''Voice_CS'',
						''Data_PS'',
						''Coverage_Quality'' 
						UNION
						SELECT *
						FROM ',gt_global_statistic,'.qv_cto_dashboard_areas 
						
						INTO OUTFILE "',FOLDER_PATH,'cto_dashboard_areas_',DATA_DATE,'.csv"
						FIELDS TERMINATED BY '',''
						OPTIONALLY ENCLOSED BY ''''
						LINES TERMINATED BY ''\\n'';');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('TRUNCATE TABLE ',gt_global_statistic,'.qv_cto_dashboard_areas;');
				
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @SCORE_EXCELLENT_LOW_15,@SCORE_EXCELLENT_UP_15,@SCORE_GOOD_LOW_15,
					@SCORE_GOOD_UP_15,@SCORE_FAIR_LOW_15,@SCORE_FAIR_UP_15,@SCORE_BAD_LOW_15,@SCORE_BAD_UP_15,
					@SCORE_VERYBAD_LOW_15,@SCORE_VERYBAD_UP_15
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''AREAS'' AND SERVICE=''TRAFFIC'' AND KPI_NAME=''Traffic_CS_Erlang '' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @SCORE_EXCELLENT_LOW_16,@SCORE_EXCELLENT_UP_16,@SCORE_GOOD_LOW_16,
					@SCORE_GOOD_UP_16,@SCORE_FAIR_LOW_16,@SCORE_FAIR_UP_16,@SCORE_BAD_LOW_16,@SCORE_BAD_UP_16,
					@SCORE_VERYBAD_LOW_16,@SCORE_VERYBAD_UP_16
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''AREAS'' AND SERVICE=''TRAFFIC'' AND KPI_NAME=''Traffic_PS_Volume'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		
		
		SET @SqlCmd=CONCAT('TRUNCATE TABLE ',gt_global_statistic,'.qv_cto_dashboard_traffic;');
				
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('
				INSERT INTO ',gt_global_statistic,'.qv_cto_dashboard_traffic(REG_ID,name,Traffic_CS_Erlang,level_CS,Traffic_PS_Volume,level_PS
				)
				SELECT A.REG_ID,B.name,
					(A.GSM_CS_CALL_DURATION+A.UMTS_CS_CALL_DURATION)/1000/3600,
					(CASE 
					WHEN ((A.GSM_CS_CALL_DURATION+A.UMTS_CS_CALL_DURATION)/1000/3600) >=',@SCORE_EXCELLENT_UP_15,' THEN ''HIGH''
					WHEN ((A.GSM_CS_CALL_DURATION+A.UMTS_CS_CALL_DURATION)/1000/3600)  BETWEEN ',@SCORE_GOOD_LOW_15,' AND ',@SCORE_GOOD_UP_15,' THEN ''NORMAL''					
					WHEN ((A.GSM_CS_CALL_DURATION+A.UMTS_CS_CALL_DURATION)/1000/3600)  <=',@SCORE_FAIR_LOW_15,' THEN  ''LOW'' END),
					(A.UMTS_UL_VOLUME+A.UMTS_DL_VOLUME+A.LTE_UL_VOLUME+A.LTE_DL_VOLUME)/1024/1024,
					(CASE 
					WHEN (A.UMTS_UL_VOLUME+A.UMTS_DL_VOLUME+A.LTE_UL_VOLUME+A.LTE_DL_VOLUME)/1024/1024 >=',@SCORE_EXCELLENT_UP_16,' THEN ''HIGH''
					WHEN (A.UMTS_UL_VOLUME+A.UMTS_DL_VOLUME+A.LTE_UL_VOLUME+A.LTE_DL_VOLUME)/1024/1024  BETWEEN ',@SCORE_GOOD_LOW_16,' AND ',@SCORE_GOOD_UP_16,' THEN ''NORMAL''					
					WHEN (A.UMTS_UL_VOLUME+A.UMTS_DL_VOLUME+A.LTE_UL_VOLUME+A.LTE_DL_VOLUME)/1024/1024  <=',@SCORE_FAIR_LOW_16,' THEN ''LOW'' END)
						
				FROM ',gt_global_statistic_g1,'.table_reg_3_ds_dy_',DATA_DATE,' A JOIN ',gt_global_statistic,'.usr_polygon_reg_3_v4 B
				ON A.REG_ID=B.id
				GROUP BY B.`NAME`
				ORDER BY NULL;');
		
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('
						SELECT 
						''REG_id'',''name'',
						''Traffic_CS_Erlang'' ,''level_CS'',
						''Traffic_PS_Volume'' ,''level_PS'' 
						UNION
						SELECT *
						FROM ',gt_global_statistic,'.qv_cto_dashboard_traffic 
						
						INTO OUTFILE "',FOLDER_PATH,'cto_dashboard_traffic_',DATA_DATE,'.csv"
						FIELDS TERMINATED BY '',''
						OPTIONALLY ENCLOSED BY ''''
						LINES TERMINATED BY ''\\n'';');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		
	
		SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.TMP_cto_dashboard_areas;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('TRUNCATE TABLE ',gt_global_statistic,'.qv_cto_dashboard_traffic;');
				
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		INSERT INTO gt_gw_main.SP_LOG VALUES(gt_global_statistic,'SP_Qlikview_CTO_dashboard',CONCAT('Generate AREAS DATA Done: ',TIMESTAMPDIFF(SECOND,START_TIME,SYSDATE()),' seconds.'), NOW());
	ELSEIF KIND='CUSTOMERS' THEN 
	
		INSERT INTO gt_gw_main.SP_LOG VALUES(gt_global_statistic,'SP_Qlikview_CTO_dashboard','Generate CUSTOMERS DATA Start', START_TIME);
		
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_1,@SCORE_EXCELLENT_LOW_1,@SCORE_EXCELLENT_UP_1,@SCORE_GOOD_LOW_1,
					@SCORE_GOOD_UP_1,@SCORE_FAIR_LOW_1,@SCORE_FAIR_UP_1,@SCORE_BAD_LOW_1,@SCORE_BAD_UP_1,
					@SCORE_VERYBAD_LOW_1,@SCORE_VERYBAD_UP_1
				FROM gt_global_statistic.qv_cto_threshold
				WHERE KIND=''CUSTOMERS'' AND SERVICE=''CS'' AND KPI_NAME=''Block_call'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		
	
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW/100,SCORE_EXCELLENT_UP/100,SCORE_GOOD_LOW/100,SCORE_GOOD_UP/100,
				SCORE_FAIR_LOW/100,SCORE_FAIR_UP/100,SCORE_BAD_LOW/100,SCORE_BAD_UP/100,SCORE_VERYBAD_LOW/100,SCORE_VERYBAD_UP/100
				INTO @WEIGHTAGE_2,@SCORE_EXCELLENT_LOW_2,@SCORE_EXCELLENT_UP_2,@SCORE_GOOD_LOW_2,
					@SCORE_GOOD_UP_2,@SCORE_FAIR_LOW_2,@SCORE_FAIR_UP_2,@SCORE_BAD_LOW_2,@SCORE_BAD_UP_2,
					@SCORE_VERYBAD_LOW_2,@SCORE_VERYBAD_UP_2
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CUSTOMERS'' AND SERVICE=''CS'' AND KPI_NAME=''CSSR'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
			
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_3,@SCORE_EXCELLENT_LOW_3,@SCORE_EXCELLENT_UP_3,@SCORE_GOOD_LOW_3,
					@SCORE_GOOD_UP_3,@SCORE_FAIR_LOW_3,@SCORE_FAIR_UP_3,@SCORE_BAD_LOW_3,@SCORE_BAD_UP_3,
					@SCORE_VERYBAD_LOW_3,@SCORE_VERYBAD_UP_3
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CUSTOMERS'' AND SERVICE=''CS'' AND KPI_NAME=''Setup_Time'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_4,@SCORE_EXCELLENT_LOW_4,@SCORE_EXCELLENT_UP_4,@SCORE_GOOD_LOW_4,
					@SCORE_GOOD_UP_4,@SCORE_FAIR_LOW_4,@SCORE_FAIR_UP_4,@SCORE_BAD_LOW_4,@SCORE_BAD_UP_4,
					@SCORE_VERYBAD_LOW_4,@SCORE_VERYBAD_UP_4
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CUSTOMERS'' AND SERVICE=''CS'' AND KPI_NAME=''Drop_call'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW/100,SCORE_EXCELLENT_UP/100,SCORE_GOOD_LOW/100,SCORE_GOOD_UP/100,
				SCORE_FAIR_LOW/100,SCORE_FAIR_UP/100,SCORE_BAD_LOW/100,SCORE_BAD_UP/100,SCORE_VERYBAD_LOW/100,SCORE_VERYBAD_UP/100
				INTO @WEIGHTAGE_5,@SCORE_EXCELLENT_LOW_5,@SCORE_EXCELLENT_UP_5,@SCORE_GOOD_LOW_5,
					@SCORE_GOOD_UP_5,@SCORE_FAIR_LOW_5,@SCORE_FAIR_UP_5,@SCORE_BAD_LOW_5,@SCORE_BAD_UP_5,
					@SCORE_VERYBAD_LOW_5,@SCORE_VERYBAD_UP_5
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CUSTOMERS'' AND SERVICE=''PS'' AND KPI_NAME=''Block_call'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW/100,SCORE_EXCELLENT_UP/100,SCORE_GOOD_LOW/100,SCORE_GOOD_UP/100,
				SCORE_FAIR_LOW/100,SCORE_FAIR_UP/100,SCORE_BAD_LOW/100,SCORE_BAD_UP/100,SCORE_VERYBAD_LOW/100,SCORE_VERYBAD_UP/100
				INTO @WEIGHTAGE_6,@SCORE_EXCELLENT_LOW_6,@SCORE_EXCELLENT_UP_6,@SCORE_GOOD_LOW_6,
					@SCORE_GOOD_UP_6,@SCORE_FAIR_LOW_6,@SCORE_FAIR_UP_6,@SCORE_BAD_LOW_6,@SCORE_BAD_UP_6,
					@SCORE_VERYBAD_LOW_6,@SCORE_VERYBAD_UP_6
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CUSTOMERS'' AND SERVICE=''PS'' AND KPI_NAME=''CSSR'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW/100,SCORE_EXCELLENT_UP/100,SCORE_GOOD_LOW/100,SCORE_GOOD_UP/100,
				SCORE_FAIR_LOW/100,SCORE_FAIR_UP/100,SCORE_BAD_LOW/100,SCORE_BAD_UP/100,SCORE_VERYBAD_LOW/100,SCORE_VERYBAD_UP/100
				INTO @WEIGHTAGE_7,@SCORE_EXCELLENT_LOW_7,@SCORE_EXCELLENT_UP_7,@SCORE_GOOD_LOW_7,
					@SCORE_GOOD_UP_7,@SCORE_FAIR_LOW_7,@SCORE_FAIR_UP_7,@SCORE_BAD_LOW_7,@SCORE_BAD_UP_7,
					@SCORE_VERYBAD_LOW_7,@SCORE_VERYBAD_UP_7
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CUSTOMERS'' AND SERVICE=''PS'' AND KPI_NAME=''Drop_call'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_8,@SCORE_EXCELLENT_LOW_8,@SCORE_EXCELLENT_UP_8,@SCORE_GOOD_LOW_8,
					@SCORE_GOOD_UP_8,@SCORE_FAIR_LOW_8,@SCORE_FAIR_UP_8,@SCORE_BAD_LOW_8,@SCORE_BAD_UP_8,
					@SCORE_VERYBAD_LOW_8,@SCORE_VERYBAD_UP_8
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CUSTOMERS'' AND SERVICE=''PS'' AND KPI_NAME=''DL_throughput'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
	
	
		SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',gt_global_statistic,'.tmp_cto_dashboard_customers;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('CREATE TABLE ',gt_global_statistic,'.`tmp_cto_dashboard_customers` (
					`IMSI` VARCHAR(20) NOT NULL,
					`BLOCK_VOICE_CNT_GSM` INT(11) NOT NULL,
					`BLOCK_VOICE_CNT_UMTS` INT(11) NOT NULL,
					`SF_VOICE_CNT_GSM` INT(11) NOT NULL,
					`SF_VOICE_CNT_UMTS` INT(11) NOT NULL,
					`VOICE_MO_CNT_GSM` INT(11) NOT NULL,
					`VOICE_MT_CNT_GSM` INT(11) NOT NULL,
					`VOICE_MO_CNT_UMTS` INT(11) NOT NULL,
					`VOICE_MT_CNT_UMTS` INT(11) NOT NULL,
					`CALL_SETUP_TIME_SUM_GSM` INT(11) NOT NULL,
					`CALL_SETUP_TIME_SUM_UMTS` INT(11) NOT NULL,
					`CALL_SETUP_TIME_CNT_GSM` INT(11) NOT NULL,
					`CALL_SETUP_TIME_CNT_UMTS` INT(11) NOT NULL,
					`DROP_VOICE_CNT_GSM` INT(11) NOT NULL,
					`DROP_VOICE_CNT_UMTS` INT(11) NOT NULL,
					`BLOCK_GPRS_CNT` INT(11) NOT NULL,
					`BLOCK_R99_CNT` INT(11) NOT NULL,
					`BLOCK_HSPA_CNT` INT(11) NOT NULL,
					`BLOCK_MRAB_CNT` INT(11) NOT NULL,
					`BLOCK_PS_OTHER_CNT` INT(11) NOT NULL,
					`BLOCK_CNT` INT(11) NOT NULL,
					`DATA_MO_CNT` INT(11) NOT NULL,
					`DATA_MT_CNT` INT(11) NOT NULL,
					`R99_MO_CNT` INT(11) NOT NULL,
					`R99_MT_CNT` INT(11) NOT NULL,
					`HSPA_MO_CNT` INT(11) NOT NULL,
					`HSPA_MT_CNT` INT(11) NOT NULL,
					`MRAB_MO_CNT` INT(11) NOT NULL,
					`MRAB_MT_CNT` INT(11) NOT NULL,
					`PS_OTHER_CNT` INT(11) NOT NULL,
					`CALL_CNT` INT(11) NOT NULL,
					`SF_GPRS_CNT` INT(11) NOT NULL,
					`SF_R99_CNT` INT(11) NOT NULL,
					`SF_HSPA_CNT` INT(11) NOT NULL,
					`SF_MRAB_CNT` INT(11) NOT NULL,
					`SF_PS_OTHER_CNT` INT(11) NOT NULL,
					`SF_CNT` INT(11) NOT NULL,
					`DROP_GPRS_CNT` INT(11) NOT NULL,
					`DROP_R99_CNT` INT(11) NOT NULL,
					`DROP_HSPA_CNT` INT(11) NOT NULL,
					`DROP_MRAB_CNT` INT(11) NOT NULL,
					`DROP_PS_OTHER_CNT` INT(11) NOT NULL,
					`DROP_CNT` INT(11) NOT NULL,
					`PS_DL_SPEED_MAX_UMTS` INT(11) NOT NULL,
					`PS_DL_SPEED_MAX_LTE` INT(11) NOT NULL,
				PRIMARY KEY (`IMSI`)) ENGINE=MYISAM DEFAULT CHARSET=latin1
					;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('INSERT INTO ',gt_global_statistic,'.tmp_cto_dashboard_customers(IMSI , BLOCK_VOICE_CNT_GSM , BLOCK_VOICE_CNT_UMTS ,SF_VOICE_CNT_GSM ,SF_VOICE_CNT_UMTS ,
				  VOICE_MO_CNT_GSM , VOICE_MT_CNT_GSM , VOICE_MO_CNT_UMTS ,VOICE_MT_CNT_UMTS ,
				  CALL_SETUP_TIME_SUM_GSM ,  CALL_SETUP_TIME_SUM_UMTS ,CALL_SETUP_TIME_CNT_GSM ,CALL_SETUP_TIME_CNT_UMTS ,
				  DROP_VOICE_CNT_GSM , DROP_VOICE_CNT_UMTS ,  BLOCK_GPRS_CNT ,BLOCK_R99_CNT  ,
	                          BLOCK_HSPA_CNT ,BLOCK_MRAB_CNT ,BLOCK_PS_OTHER_CNT ,BLOCK_CNT  ,DATA_MO_CNT ,DATA_MT_CNT ,
	                          R99_MO_CNT , R99_MT_CNT , HSPA_MO_CNT ,HSPA_MT_CNT ,MRAB_MO_CNT ,MRAB_MT_CNT ,
	                          PS_OTHER_CNT ,CALL_CNT ,SF_GPRS_CNT , SF_R99_CNT ,SF_HSPA_CNT , SF_MRAB_CNT ,
	                          SF_PS_OTHER_CNT , SF_CNT ,DROP_GPRS_CNT , DROP_R99_CNT ,DROP_HSPA_CNT ,DROP_MRAB_CNT ,
	                          DROP_PS_OTHER_CNT , DROP_CNT , PS_DL_SPEED_MAX_UMTS ,PS_DL_SPEED_MAX_LTE 
				 )
				SELECT IMSI ,SUM(BLOCK_VOICE_CNT_GSM) AS BLOCK_VOICE_CNT_GSM,SUM(BLOCK_VOICE_CNT_UMTS) AS BLOCK_VOICE_CNT_UMTS,SUM(SF_VOICE_CNT_GSM) AS SF_VOICE_CNT_GSM,SUM(SF_VOICE_CNT_UMTS) AS SF_VOICE_CNT_UMTS,
				  SUM(VOICE_MO_CNT_GSM) AS VOICE_MO_CNT_GSM,SUM(VOICE_MT_CNT_GSM) AS VOICE_MT_CNT_GSM,SUM(VOICE_MO_CNT_UMTS) AS VOICE_MO_CNT_UMTS,SUM(VOICE_MT_CNT_UMTS) AS VOICE_MT_CNT_UMTS,
				  SUM(CALL_SETUP_TIME_SUM_GSM) AS CALL_SETUP_TIME_SUM_GSM,SUM(CALL_SETUP_TIME_SUM_UMTS) AS CALL_SETUP_TIME_SUM_UMTS,SUM(CALL_SETUP_TIME_CNT_GSM) AS CALL_SETUP_TIME_CNT_GSM,SUM(CALL_SETUP_TIME_CNT_UMTS) AS CALL_SETUP_TIME_CNT_UMTS,
				  SUM(DROP_VOICE_CNT_GSM) AS DROP_VOICE_CNT_GSM,SUM(DROP_VOICE_CNT_UMTS) AS DROP_VOICE_CNT_UMTS,SUM(BLOCK_GPRS_CNT) AS BLOCK_GPRS_CNT,SUM(BLOCK_R99_CNT) AS BLOCK_R99_CNT,
	                          SUM(BLOCK_HSPA_CNT) AS BLOCK_HSPA_CNT,SUM(BLOCK_MRAB_CNT) AS BLOCK_MRAB_CNT,SUM(BLOCK_PS_OTHER_CNT) AS BLOCK_PS_OTHER_CNT,SUM(BLOCK_CNT) AS BLOCK_CNT,SUM(DATA_MO_CNT) AS DATA_MO_CNT,SUM(DATA_MT_CNT) AS DATA_MT_CNT,
	                          SUM(R99_MO_CNT) AS R99_MO_CNT,SUM(R99_MT_CNT) AS R99_MT_CNT,SUM(HSPA_MO_CNT) AS HSPA_MO_CNT,SUM(HSPA_MT_CNT) AS HSPA_MT_CNT,SUM(MRAB_MO_CNT) AS MRAB_MO_CNT,SUM(MRAB_MT_CNT) AS MRAB_MT_CNT,
	                          SUM(PS_OTHER_CNT) AS PS_OTHER_CNT,SUM(CALL_CNT) AS CALL_CNT,SUM(SF_GPRS_CNT) AS SF_GPRS_CNT,SUM(SF_R99_CNT) AS SF_R99_CNT,SUM(SF_HSPA_CNT) AS SF_HSPA_CNT,SUM(SF_MRAB_CNT) AS SF_MRAB_CNT,
	                          SUM(SF_PS_OTHER_CNT) AS SF_PS_OTHER_CNT,SUM(SF_CNT) AS SF_CNT,SUM(DROP_GPRS_CNT) AS DROP_GPRS_CNT,SUM(DROP_R99_CNT) AS DROP_R99_CNT,SUM(DROP_HSPA_CNT) AS DROP_HSPA_CNT,SUM(DROP_MRAB_CNT) AS DROP_MRAB_CNT,
	                          SUM(DROP_PS_OTHER_CNT) AS DROP_PS_OTHER_CNT,SUM(DROP_CNT) AS DROP_CNT,MAX(PS_DL_SPEED_MAX_UMTS) AS PS_DL_SPEED_MAX_UMTS,MAX(PS_DL_SPEED_MAX_LTE) AS PS_DL_SPEED_MAX_LTE
				   FROM(
				SELECT  IMSI , BLOCK_VOICE_CNT AS BLOCK_VOICE_CNT_GSM ,NULL AS BLOCK_VOICE_CNT_UMTS,SF_VOICE_CNT AS SF_VOICE_CNT_GSM ,NULL AS SF_VOICE_CNT_UMTS,
				  VOICE_MO_CNT AS VOICE_MO_CNT_GSM , VOICE_MT_CNT AS VOICE_MT_CNT_GSM , NULL AS VOICE_MO_CNT_UMTS ,NULL AS VOICE_MT_CNT_UMTS ,
				  CALL_SETUP_TIME_SUM AS CALL_SETUP_TIME_SUM_GSM ,NULL AS CALL_SETUP_TIME_SUM_UMTS ,CALL_SETUP_TIME_CNT AS CALL_SETUP_TIME_CNT_GSM ,NULL AS CALL_SETUP_TIME_CNT_UMTS ,
				  DROP_VOICE_CNT AS DROP_VOICE_CNT_GSM ,NULL AS DROP_VOICE_CNT_UMTS ,BLOCK_GPRS_CNT AS BLOCK_GPRS_CNT,NULL AS BLOCK_R99_CNT ,
	                          NULL AS BLOCK_HSPA_CNT ,NULL AS BLOCK_MRAB_CNT ,NULL AS BLOCK_PS_OTHER_CNT , NULL AS BLOCK_CNT ,DATA_MO_CNT AS DATA_MO_CNT ,DATA_MT_CNT AS DATA_MT_CNT ,
	                          NULL AS R99_MO_CNT ,NULL AS R99_MT_CNT ,NULL AS HSPA_MO_CNT ,NULL AS HSPA_MT_CNT ,NULL AS MRAB_MO_CNT ,NULL AS MRAB_MT_CNT ,
	                          NULL AS PS_OTHER_CNT ,NULL AS CALL_CNT ,SF_GPRS_CNT AS SF_GPRS_CNT ,NULL AS SF_R99_CNT ,NULL AS SF_HSPA_CNT ,NULL AS SF_MRAB_CNT ,
	                         NULL AS SF_PS_OTHER_CNT ,NULL AS SF_CNT ,DROP_GPRS_CNT AS DROP_GPRS_CNT ,NULL AS DROP_R99_CNT ,NULL AS DROP_HSPA_CNT ,NULL AS DROP_MRAB_CNT ,
	                          NULL AS DROP_PS_OTHER_CNT ,NULL AS DROP_CNT ,NULL AS PS_DL_SPEED_MAX_UMTS,NULL AS PS_DL_SPEED_MAX_LTE 
				
				FROM ',gt_global_statistic_g1,'.table_imsi_GSM_dy_',DATA_DATE,'
				UNION
				SELECT  IMSI ,NULL AS BLOCK_VOICE_CNT_GSM ,BLOCK_VOICE_CNT AS BLOCK_VOICE_CNT_UMTS ,NULL AS SF_VOICE_CNT_GSM ,SF_VOICE_CNT AS SF_VOICE_CNT_UMTS ,
				  NULL AS VOICE_MO_CNT_GSM ,NULL AS VOICE_MT_CNT_GSM ,VOICE_MO_CNT AS VOICE_MO_CNT_UMTS ,VOICE_MO_CNT AS VOICE_MT_CNT_UMTS ,
				 NULL AS CALL_SETUP_TIME_SUM_GSM ,CALL_SETUP_TIME_SUM AS CALL_SETUP_TIME_SUM_UMTS ,NULL AS CALL_SETUP_TIME_CNT_GSM ,CALL_SETUP_TIME_CNT AS CALL_SETUP_TIME_CNT_UMTS ,
				 NULL AS DROP_VOICE_CNT_GSM ,DROP_VOICE_CNT AS DROP_VOICE_CNT_UMTS ,NULL AS BLOCK_GPRS_CNT ,BLOCK_R99_CNT AS BLOCK_R99_CNT  ,
	                         BLOCK_HSPA_CNT AS BLOCK_HSPA_CNT ,BLOCK_MRAB_CNT AS BLOCK_MRAB_CNT ,BLOCK_PS_OTHER_CNT AS BLOCK_PS_OTHER_CNT,NULL AS BLOCK_CNT ,NULL AS DATA_MO_CNT,NULL AS DATA_MT_CNT ,
	                         R99_MO_CNT AS R99_MO_CNT , R99_MT_CNT AS R99_MT_CNT, HSPA_MO_CNT AS HSPA_MO_CNT,HSPA_MT_CNT AS HSPA_MT_CNT,MRAB_MO_CNT AS MRAB_MO_CNT ,MRAB_MT_CNT AS MRAB_MT_CNT ,
	                          PS_OTHER_CNT AS PS_OTHER_CNT,NULL AS CALL_CNT ,NULL AS SF_GPRS_CNT ,SF_R99_CNT AS SF_R99_CNT ,SF_HSPA_CNT AS SF_HSPA_CNT ,SF_MRAB_CNT AS SF_MRAB_CNT ,
	                         SF_PS_OTHER_CNT AS SF_PS_OTHER_CNT ,NULL AS SF_CNT ,NULL AS DROP_GPRS_CNT ,DROP_R99_CNT AS DROP_R99_CNT ,DROP_HSPA_CNT AS DROP_HSPA_CNT ,DROP_MRAB_CNT AS DROP_MRAB_CNT ,
	                         DROP_PS_OTHER_CNT AS DROP_PS_OTHER_CNT ,NULL AS DROP_CNT ,PS_DL_SPEED_MAX AS PS_DL_SPEED_MAX_UMTS ,NULL AS PS_DL_SPEED_MAX_LTE 
				
				FROM ',gt_global_statistic_g1,'.table_imsi_UMTS_dy_',DATA_DATE,'
				UNION
				SELECT  IMSI ,NULL AS BLOCK_VOICE_CNT_GSM ,NULL AS BLOCK_VOICE_CNT_UMTS ,NULL AS SF_VOICE_CNT_GSM ,NULL AS SF_VOICE_CNT_UMTS ,
				NULL AS  VOICE_MO_CNT_GSM ,NULL AS VOICE_MT_CNT_GSM ,NULL AS VOICE_MO_CNT_UMTS ,NULL AS VOICE_MT_CNT_UMTS ,
				NULL AS  CALL_SETUP_TIME_SUM_GSM ,NULL AS  CALL_SETUP_TIME_SUM_UMTS ,NULL AS CALL_SETUP_TIME_CNT_GSM ,NULL AS CALL_SETUP_TIME_CNT_UMTS ,
				NULL AS  DROP_VOICE_CNT_GSM ,NULL AS DROP_VOICE_CNT_UMTS ,NULL AS BLOCK_GPRS_CNT ,NULL AS BLOCK_R99_CNT ,
	                      NULL AS BLOCK_HSPA_CNT ,NULL AS BLOCK_MRAB_CNT ,NULL AS BLOCK_PS_OTHER_CNT ,BLOCK_CNT AS BLOCK_CNT,NULL AS DATA_MO_CNT ,NULL AS DATA_MT_CNT ,
	                     NULL AS R99_MO_CNT ,NULL AS R99_MT_CNT ,NULL AS HSPA_MO_CNT ,NULL AS HSPA_MT_CNT ,NULL AS MRAB_MO_CNT ,NULL AS MRAB_MT_CNT ,
	                    NULL AS PS_OTHER_CNT ,CALL_CNT AS CALL_CNT ,NULL AS SF_GPRS_CNT ,NULL AS SF_R99_CNT ,NULL AS SF_HSPA_CNT ,NULL AS SF_MRAB_CNT ,
	                    NULL AS SF_PS_OTHER_CNT ,SF_CNT AS SF_CNT ,NULL AS DROP_GPRS_CNT ,NULL AS DROP_R99_CNT ,NULL AS DROP_HSPA_CNT ,NULL AS DROP_MRAB_CNT ,
	                      NULL AS DROP_PS_OTHER_CNT ,DROP_CNT AS DROP_CNT ,NULL AS PS_DL_SPEED_MAX_UMTS ,PS_DL_SPEED_MAX AS PS_DL_SPEED_MAX_LTE 
				
				FROM ',gt_global_statistic_g1,'.table_imsi_LTE_dy_',DATA_DATE,'
				)A	
				GROUP BY  imsi 
				ORDER BY NULL;');
		
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('TRUNCATE TABLE ',gt_global_statistic,'.qv_cto_dashboard_customers;');		
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('
				INSERT INTO ',gt_global_statistic,'.qv_cto_dashboard_customers(IMSI,
					Voice_CS_Block_call_original,Voice_CS_Block_call_score,
					Voice_CS_CSSR_original,Voice_CS_CSSR_score,
					Voice_CS_CALL_SET_UP_TIME_original,Voice_CS_CALL_SET_UP_TIME_score,
					Voice_CS_Drop_calls_original,Voice_CS_Drop_calls_score,
					Data_PS_Blocl_call_original,Data_PS_Blocl_call_score,
					Data_PS_CSSR_original,Data_PS_CSSR_score,
					Data_PS_Drop_calls_original,Data_PS_Drop_calls_score,
					Data_PS_Throughput_original,Data_PS_Throughput_score
					)
					SELECT 
					IMSI,
					(BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_GSM),
					(CASE 
					WHEN (BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_GSM) =',@SCORE_EXCELLENT_UP_1,' THEN ''5''
					WHEN (BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_GSM) BETWEEN ',@SCORE_GOOD_LOW_1,' AND ',@SCORE_GOOD_UP_1,' THEN ''4''
					WHEN (BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_GSM) BETWEEN ',@SCORE_FAIR_LOW_1,' AND ',@SCORE_FAIR_UP_1,' THEN ''3''
					WHEN (BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_GSM) BETWEEN ',@SCORE_BAD_LOW_1,' AND ',@SCORE_BAD_UP_1,' THEN ''2''
					WHEN (BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_GSM) >',@SCORE_VERYBAD_UP_1,' THEN ''1''
					ELSE ''0'' END)  AS Voice_CS_Block_call_score,
				
	
					(1-((SF_VOICE_CNT_GSM+SF_VOICE_CNT_UMTS+BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_UMTS)/(VOICE_MO_CNT_GSM+VOICE_MT_CNT_GSM+VOICE_MO_CNT_UMTS+VOICE_MT_CNT_UMTS))),
					(CASE 
					WHEN (1-((SF_VOICE_CNT_GSM+SF_VOICE_CNT_UMTS+BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_UMTS)/(VOICE_MO_CNT_GSM+VOICE_MT_CNT_GSM+VOICE_MO_CNT_UMTS+VOICE_MT_CNT_UMTS))) =',@SCORE_EXCELLENT_UP_2,' THEN ''5''
					WHEN (1-((SF_VOICE_CNT_GSM+SF_VOICE_CNT_UMTS+BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_UMTS)/(VOICE_MO_CNT_GSM+VOICE_MT_CNT_GSM+VOICE_MO_CNT_UMTS+VOICE_MT_CNT_UMTS))) BETWEEN ',@SCORE_GOOD_LOW_2,' AND ',@SCORE_GOOD_UP_2,' THEN ''4''
					WHEN (1-((SF_VOICE_CNT_GSM+SF_VOICE_CNT_UMTS+BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_UMTS)/(VOICE_MO_CNT_GSM+VOICE_MT_CNT_GSM+VOICE_MO_CNT_UMTS+VOICE_MT_CNT_UMTS))) BETWEEN ',@SCORE_FAIR_LOW_2,' AND ',@SCORE_FAIR_UP_2,' THEN ''3''
					WHEN (1-((SF_VOICE_CNT_GSM+SF_VOICE_CNT_UMTS+BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_UMTS)/(VOICE_MO_CNT_GSM+VOICE_MT_CNT_GSM+VOICE_MO_CNT_UMTS+VOICE_MT_CNT_UMTS))) BETWEEN ',@SCORE_BAD_LOW_2,' AND ',@SCORE_BAD_UP_2,' THEN ''2''
					WHEN (1-((SF_VOICE_CNT_GSM+SF_VOICE_CNT_UMTS+BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_UMTS)/(VOICE_MO_CNT_GSM+VOICE_MT_CNT_GSM+VOICE_MO_CNT_UMTS+VOICE_MT_CNT_UMTS))) <= ',@SCORE_VERYBAD_UP_2,' THEN ''1''
					ELSE ''5'' END) AS Voice_CS_CSSR_score,
				
	
					((CALL_SETUP_TIME_SUM_GSM+CALL_SETUP_TIME_SUM_UMTS)/(CALL_SETUP_TIME_CNT_GSM+CALL_SETUP_TIME_CNT_UMTS))/1000,
					(CASE 
					WHEN ((CALL_SETUP_TIME_SUM_GSM+CALL_SETUP_TIME_SUM_UMTS)/(CALL_SETUP_TIME_CNT_GSM+CALL_SETUP_TIME_CNT_UMTS))/1000 <= ',@SCORE_EXCELLENT_UP_3,' THEN ''5''
					WHEN ((CALL_SETUP_TIME_SUM_GSM+CALL_SETUP_TIME_SUM_UMTS)/(CALL_SETUP_TIME_CNT_GSM+CALL_SETUP_TIME_CNT_UMTS))/1000 BETWEEN ',@SCORE_GOOD_LOW_3,' AND ',@SCORE_GOOD_UP_3,' THEN ''4''
					WHEN ((CALL_SETUP_TIME_SUM_GSM+CALL_SETUP_TIME_SUM_UMTS)/(CALL_SETUP_TIME_CNT_GSM+CALL_SETUP_TIME_CNT_UMTS))/1000 BETWEEN ',@SCORE_FAIR_LOW_3,' AND ',@SCORE_FAIR_UP_3,' THEN ''3''
					WHEN ((CALL_SETUP_TIME_SUM_GSM+CALL_SETUP_TIME_SUM_UMTS)/(CALL_SETUP_TIME_CNT_GSM+CALL_SETUP_TIME_CNT_UMTS))/1000 BETWEEN ',@SCORE_BAD_LOW_3,' AND ',@SCORE_BAD_UP_3,' THEN ''2''
					WHEN ((CALL_SETUP_TIME_SUM_GSM+CALL_SETUP_TIME_SUM_UMTS)/(CALL_SETUP_TIME_CNT_GSM+CALL_SETUP_TIME_CNT_UMTS))/1000 >= ',@SCORE_VERYBAD_UP_3,' THEN ''1''
					ELSE ''5'' END) AS Voice_CS_CALL_SET_UP_TIME_score,
				
	
					(DROP_VOICE_CNT_GSM+DROP_VOICE_CNT_UMTS),
					(CASE 
					WHEN (DROP_VOICE_CNT_GSM+DROP_VOICE_CNT_UMTS) =',@SCORE_EXCELLENT_UP_4,' THEN ''5''
					WHEN (DROP_VOICE_CNT_GSM+DROP_VOICE_CNT_UMTS) BETWEEN ',@SCORE_GOOD_LOW_4,' AND ',@SCORE_GOOD_UP_4,' THEN ''4''
					WHEN (DROP_VOICE_CNT_GSM+DROP_VOICE_CNT_UMTS) BETWEEN ',@SCORE_FAIR_LOW_4,' AND ',@SCORE_FAIR_UP_4,' THEN ''3''
					WHEN (DROP_VOICE_CNT_GSM+DROP_VOICE_CNT_UMTS) BETWEEN ',@SCORE_BAD_LOW_4,' AND ',@SCORE_BAD_UP_4,' THEN ''2''
					WHEN (DROP_VOICE_CNT_GSM+DROP_VOICE_CNT_UMTS) >',@SCORE_VERYBAD_UP_4,' THEN ''1''
					ELSE ''0'' END) AS Voice_CS_Drop_calls_score,
					
	
					(BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT),
					(CASE 
					WHEN (BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT) <= ',@SCORE_EXCELLENT_UP_5,' THEN ''5''
					WHEN (BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT) BETWEEN ',@SCORE_GOOD_LOW_5,' AND ',@SCORE_GOOD_UP_5,' THEN ''4''
					WHEN (BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT) BETWEEN ',@SCORE_FAIR_LOW_5,' AND ',@SCORE_FAIR_UP_5,' THEN ''3''
					WHEN (BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT) BETWEEN ',@SCORE_BAD_LOW_5,' AND ',@SCORE_BAD_UP_5,' THEN ''2''
					WHEN (BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT) >= ',@SCORE_VERYBAD_UP_5,' THEN ''1''
					ELSE ''5'' END) AS Data_PS_Blocl_call_score,
				
	
					1-((SF_GPRS_CNT+SF_R99_CNT+SF_HSPA_CNT+SF_MRAB_CNT+SF_PS_OTHER_CNT+SF_CNT+BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT)),
					(CASE 
					WHEN ((1-((SF_GPRS_CNT+SF_R99_CNT+SF_HSPA_CNT+SF_MRAB_CNT+SF_PS_OTHER_CNT+SF_CNT+BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT)))) >=',@SCORE_EXCELLENT_UP_6,' THEN ''5''
					WHEN ((1-((SF_GPRS_CNT+SF_R99_CNT+SF_HSPA_CNT+SF_MRAB_CNT+SF_PS_OTHER_CNT+SF_CNT+BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT)))) BETWEEN ',@SCORE_GOOD_LOW_6,' AND ',@SCORE_GOOD_UP_6,' THEN ''4''
					WHEN ((1-((SF_GPRS_CNT+SF_R99_CNT+SF_HSPA_CNT+SF_MRAB_CNT+SF_PS_OTHER_CNT+SF_CNT+BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT)))) BETWEEN ',@SCORE_FAIR_LOW_6,' AND ',@SCORE_FAIR_UP_6,' THEN ''3''
					WHEN ((1-((SF_GPRS_CNT+SF_R99_CNT+SF_HSPA_CNT+SF_MRAB_CNT+SF_PS_OTHER_CNT+SF_CNT+BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT)))) BETWEEN ',@SCORE_BAD_LOW_6,' AND ',@SCORE_BAD_UP_6,' THEN ''2''
					WHEN ((1-((SF_GPRS_CNT+SF_R99_CNT+SF_HSPA_CNT+SF_MRAB_CNT+SF_PS_OTHER_CNT+SF_CNT+BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT)))) <=',@SCORE_VERYBAD_UP_6,' THEN ''1''
					ELSE ''5'' END) AS Data_PS_CSSR_score, 
					
	
					(DROP_GPRS_CNT+DROP_R99_CNT+DROP_HSPA_CNT+DROP_MRAB_CNT+DROP_PS_OTHER_CNT+DROP_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT),
					(CASE 
					WHEN (DROP_GPRS_CNT+DROP_R99_CNT+DROP_HSPA_CNT+DROP_MRAB_CNT+DROP_PS_OTHER_CNT+DROP_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT) <=',@SCORE_EXCELLENT_UP_7,' THEN ''5''
					WHEN (DROP_GPRS_CNT+DROP_R99_CNT+DROP_HSPA_CNT+DROP_MRAB_CNT+DROP_PS_OTHER_CNT+DROP_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT)  BETWEEN ',@SCORE_GOOD_LOW_7,' AND ',@SCORE_GOOD_UP_7,' THEN ''4''
					WHEN (DROP_GPRS_CNT+DROP_R99_CNT+DROP_HSPA_CNT+DROP_MRAB_CNT+DROP_PS_OTHER_CNT+DROP_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT)  BETWEEN ',@SCORE_FAIR_LOW_7,' AND ',@SCORE_FAIR_UP_7,' THEN ''3''
					WHEN (DROP_GPRS_CNT+DROP_R99_CNT+DROP_HSPA_CNT+DROP_MRAB_CNT+DROP_PS_OTHER_CNT+DROP_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT)  BETWEEN ',@SCORE_BAD_LOW_7,' AND ',@SCORE_BAD_UP_7,' THEN ''2''
					WHEN (DROP_GPRS_CNT+DROP_R99_CNT+DROP_HSPA_CNT+DROP_MRAB_CNT+DROP_PS_OTHER_CNT+DROP_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT) >=',@SCORE_VERYBAD_UP_7,' THEN ''1''
					ELSE ''5'' END) AS Data_PS_Drop_calls_score,
			
	
					(PS_DL_SPEED_MAX_UMTS+PS_DL_SPEED_MAX_LTE)/1024,
					(CASE 
					WHEN ((PS_DL_SPEED_MAX_UMTS+PS_DL_SPEED_MAX_LTE)/1024) >=',@SCORE_EXCELLENT_UP_8,' THEN ''5''
					WHEN ((PS_DL_SPEED_MAX_UMTS+PS_DL_SPEED_MAX_LTE)/1024)  BETWEEN ',@SCORE_GOOD_LOW_8,' AND ',@SCORE_GOOD_UP_8,' THEN ''4''
					WHEN ((PS_DL_SPEED_MAX_UMTS+PS_DL_SPEED_MAX_LTE)/1024)  BETWEEN ',@SCORE_FAIR_LOW_8,' AND ',@SCORE_FAIR_UP_8,' THEN ''3''
					WHEN ((PS_DL_SPEED_MAX_UMTS+PS_DL_SPEED_MAX_LTE)/1024)  BETWEEN ',@SCORE_BAD_LOW_8,' AND ',@SCORE_BAD_UP_8,' THEN ''2''
					WHEN ((PS_DL_SPEED_MAX_UMTS+PS_DL_SPEED_MAX_LTE)/1024)  <=',@SCORE_VERYBAD_UP_8,' THEN ''1''
					ELSE ''0'' END) AS data_PS_Throughput_score
	
					
					
				FROM ',gt_global_statistic,'.tmp_cto_dashboard_customers
					
				');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('
				UPDATE ',gt_global_statistic,'.qv_cto_dashboard_customers
				SET 
					Voice_CS_Block_call_total=(Voice_CS_Block_call_score)*',@WEIGHTAGE_1,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5),
					Voice_CS_CSSR_total=(Voice_CS_CSSR_score)*',@WEIGHTAGE_2,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5),
					Voice_CS_CALL_SET_UP_TIME_total=(Voice_CS_CALL_SET_UP_TIME_score)*',@WEIGHTAGE_3,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5),
					Voice_CS_Drop_calls_total=(Voice_CS_Drop_calls_score)*',@WEIGHTAGE_4,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5),
					Data_PS_Blocl_call_total=(Data_PS_Blocl_call_score)*',@WEIGHTAGE_5,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5),
					Data_PS_CSSR_total=(Data_PS_CSSR_score)*',@WEIGHTAGE_6,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5),
					Data_PS_Drop_calls_total=(Data_PS_Drop_calls_score)*',@WEIGHTAGE_7,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5),
					Data_PS_Throughput_total=(Data_PS_Throughput_score)*',@WEIGHTAGE_8,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5),
					Voice_CS=(((Voice_CS_Block_call_score)*',@WEIGHTAGE_1,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5))+((Voice_CS_CSSR_score)*',@WEIGHTAGE_2,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5))
						+((Voice_CS_CALL_SET_UP_TIME_score)*',@WEIGHTAGE_3,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5))+((Voice_CS_Drop_calls_score)*',@WEIGHTAGE_4,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5))),
					Data_PS=(((Data_PS_Blocl_call_score)*',@WEIGHTAGE_5,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5))+((Data_PS_CSSR_score)*',@WEIGHTAGE_6,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5))
						+((Data_PS_Drop_calls_score)*',@WEIGHTAGE_7,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5))+((Data_PS_Throughput_score)*',@WEIGHTAGE_8,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5)))
					;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('
						SELECT 
						''IMSI'',
						''Voice_CS_Block_call_original'' ,''Voice_CS_Block_call_score'' ,''Voice_CS_Block_call_total'' ,
						''Voice_CS_CSSR_original'',''Voice_CS_CSSR_score'' ,''Voice_CS_CSSR_total'' ,
						''Voice_CS_CALL_SET_UP_TIME_original'' ,''Voice_CS_CALL_SET_UP_TIME_score'' ,''Voice_CS_CALL_SET_UP_TIME_TOTAL'',
						''Voice_CS_Drop_calls_original'' ,''Voice_CS_Drop_calls_score'' ,''Voice_CS_Drop_calls_total'',
						''Data_PS_Blocl_call_original'' ,''Data_PS_Blocl_call_score'' ,''Data_PS_Blocl_call_total'',
						''Data_PS_CSSR_original'' ,''Data_PS_CSSR_score'',''Data_PS_CSSR_total'' ,
						''Data_PS_Drop_calls_original'' ,''Data_PS_Drop_calls_score'' ,''Data_PS_Drop_calls_total'' ,
						''Data_PS_Throughput_original'' ,''Data_PS_Throughput_score'' ,''Data_PS_Throughput_total'',						
						''Voice_CS'',
						''Data_PS''
						
						UNION
						SELECT *
						FROM ',gt_global_statistic,'.qv_cto_dashboard_customers
						
						INTO OUTFILE "',FOLDER_PATH,'cto_dashboard_customers_',DATA_DATE,'.csv"
						FIELDS TERMINATED BY '',''
						OPTIONALLY ENCLOSED BY ''''
						LINES TERMINATED BY ''\\n'';');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		
	
		SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',gt_global_statistic,'.tmp_cto_dashboard_customers;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('TRUNCATE TABLE ',gt_global_statistic,'.qv_cto_dashboard_customers;');		
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		INSERT INTO gt_gw_main.SP_LOG VALUES(gt_global_statistic,'SP_Qlikview_CTO_dashboard',CONCAT('Generate CUSTOMERS DATA Done: ',TIMESTAMPDIFF(SECOND,START_TIME,SYSDATE()),' seconds.'), NOW());
		
	
	ELSEIF KIND='DEVICE' THEN 
		
		INSERT INTO gt_gw_main.SP_LOG VALUES(gt_global_statistic,'SP_Qlikview_CTO_dashboard','Generate DEVICE DATA Start', START_TIME);
		
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW/100,SCORE_EXCELLENT_UP/100,SCORE_GOOD_LOW/100,SCORE_GOOD_UP/100,
				SCORE_FAIR_LOW/100,SCORE_FAIR_UP/100,SCORE_BAD_LOW/100,SCORE_BAD_UP/100,SCORE_VERYBAD_LOW/100,SCORE_VERYBAD_UP/100
				INTO @WEIGHTAGE_1,@SCORE_EXCELLENT_LOW_1,@SCORE_EXCELLENT_UP_1,@SCORE_GOOD_LOW_1,
					@SCORE_GOOD_UP_1,@SCORE_FAIR_LOW_1,@SCORE_FAIR_UP_1,@SCORE_BAD_LOW_1,@SCORE_BAD_UP_1,
					@SCORE_VERYBAD_LOW_1,@SCORE_VERYBAD_UP_1
				FROM gt_global_statistic.qv_cto_threshold
				WHERE KIND=''DEVICE'' AND SERVICE=''CS'' AND KPI_NAME=''Block_call'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		
	
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW/100,SCORE_EXCELLENT_UP/100,SCORE_GOOD_LOW/100,SCORE_GOOD_UP/100,
				SCORE_FAIR_LOW/100,SCORE_FAIR_UP/100,SCORE_BAD_LOW/100,SCORE_BAD_UP/100,SCORE_VERYBAD_LOW/100,SCORE_VERYBAD_UP/100
				INTO @WEIGHTAGE_2,@SCORE_EXCELLENT_LOW_2,@SCORE_EXCELLENT_UP_2,@SCORE_GOOD_LOW_2,
					@SCORE_GOOD_UP_2,@SCORE_FAIR_LOW_2,@SCORE_FAIR_UP_2,@SCORE_BAD_LOW_2,@SCORE_BAD_UP_2,
					@SCORE_VERYBAD_LOW_2,@SCORE_VERYBAD_UP_2
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''DEVICE'' AND SERVICE=''CS'' AND KPI_NAME=''CSSR'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
			
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_3,@SCORE_EXCELLENT_LOW_3,@SCORE_EXCELLENT_UP_3,@SCORE_GOOD_LOW_3,
					@SCORE_GOOD_UP_3,@SCORE_FAIR_LOW_3,@SCORE_FAIR_UP_3,@SCORE_BAD_LOW_3,@SCORE_BAD_UP_3,
					@SCORE_VERYBAD_LOW_3,@SCORE_VERYBAD_UP_3
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''DEVICE'' AND SERVICE=''CS'' AND KPI_NAME=''Setup_Time'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW/100,SCORE_EXCELLENT_UP/100,SCORE_GOOD_LOW/100,SCORE_GOOD_UP/100,
				SCORE_FAIR_LOW/100,SCORE_FAIR_UP/100,SCORE_BAD_LOW/100,SCORE_BAD_UP/100,SCORE_VERYBAD_LOW/100,SCORE_VERYBAD_UP/100
				INTO @WEIGHTAGE_4,@SCORE_EXCELLENT_LOW_4,@SCORE_EXCELLENT_UP_4,@SCORE_GOOD_LOW_4,
					@SCORE_GOOD_UP_4,@SCORE_FAIR_LOW_4,@SCORE_FAIR_UP_4,@SCORE_BAD_LOW_4,@SCORE_BAD_UP_4,
					@SCORE_VERYBAD_LOW_4,@SCORE_VERYBAD_UP_4
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''DEVICE'' AND SERVICE=''CS'' AND KPI_NAME=''Drop_call'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW/100,SCORE_EXCELLENT_UP/100,SCORE_GOOD_LOW/100,SCORE_GOOD_UP/100,
				SCORE_FAIR_LOW/100,SCORE_FAIR_UP/100,SCORE_BAD_LOW/100,SCORE_BAD_UP/100,SCORE_VERYBAD_LOW/100,SCORE_VERYBAD_UP/100
				INTO @WEIGHTAGE_5,@SCORE_EXCELLENT_LOW_5,@SCORE_EXCELLENT_UP_5,@SCORE_GOOD_LOW_5,
					@SCORE_GOOD_UP_5,@SCORE_FAIR_LOW_5,@SCORE_FAIR_UP_5,@SCORE_BAD_LOW_5,@SCORE_BAD_UP_5,
					@SCORE_VERYBAD_LOW_5,@SCORE_VERYBAD_UP_5
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''DEVICE'' AND SERVICE=''PS'' AND KPI_NAME=''Block_call'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW/100,SCORE_EXCELLENT_UP/100,SCORE_GOOD_LOW/100,SCORE_GOOD_UP/100,
				SCORE_FAIR_LOW/100,SCORE_FAIR_UP/100,SCORE_BAD_LOW/100,SCORE_BAD_UP/100,SCORE_VERYBAD_LOW/100,SCORE_VERYBAD_UP/100
				INTO @WEIGHTAGE_6,@SCORE_EXCELLENT_LOW_6,@SCORE_EXCELLENT_UP_6,@SCORE_GOOD_LOW_6,
					@SCORE_GOOD_UP_6,@SCORE_FAIR_LOW_6,@SCORE_FAIR_UP_6,@SCORE_BAD_LOW_6,@SCORE_BAD_UP_6,
					@SCORE_VERYBAD_LOW_6,@SCORE_VERYBAD_UP_6
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''DEVICE'' AND SERVICE=''PS'' AND KPI_NAME=''CSSR'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW/100,SCORE_EXCELLENT_UP/100,SCORE_GOOD_LOW/100,SCORE_GOOD_UP/100,
				SCORE_FAIR_LOW/100,SCORE_FAIR_UP/100,SCORE_BAD_LOW/100,SCORE_BAD_UP/100,SCORE_VERYBAD_LOW/100,SCORE_VERYBAD_UP/100
				INTO @WEIGHTAGE_7,@SCORE_EXCELLENT_LOW_7,@SCORE_EXCELLENT_UP_7,@SCORE_GOOD_LOW_7,
					@SCORE_GOOD_UP_7,@SCORE_FAIR_LOW_7,@SCORE_FAIR_UP_7,@SCORE_BAD_LOW_7,@SCORE_BAD_UP_7,
					@SCORE_VERYBAD_LOW_7,@SCORE_VERYBAD_UP_7
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''DEVICE'' AND SERVICE=''PS'' AND KPI_NAME=''Drop_call'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_8,@SCORE_EXCELLENT_LOW_8,@SCORE_EXCELLENT_UP_8,@SCORE_GOOD_LOW_8,
					@SCORE_GOOD_UP_8,@SCORE_FAIR_LOW_8,@SCORE_FAIR_UP_8,@SCORE_BAD_LOW_8,@SCORE_BAD_UP_8,
					@SCORE_VERYBAD_LOW_8,@SCORE_VERYBAD_UP_8
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''DEVICE'' AND SERVICE=''PS'' AND KPI_NAME=''DL_throughput'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		
		SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.tmp_dim_handset;');
	
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('CREATE TEMPORARY TABLE ',gt_global_statistic,'.tmp_dim_handset AS
			SELECT MAKE_ID,MODEL_ID,CONCAT(manufacturer,''-'',MODEL) AS DEVICE
			FROM  ',GT_COVMO,'.dim_handset ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',gt_global_statistic,'.tmp_cto_dashboard_davice;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('CREATE TABLE ',gt_global_statistic,'.`tmp_cto_dashboard_davice` (
					`MAKE_ID` int(11) NOT NULL ,
					`MODEL_ID` int(11) NOT NULL,
					`BLOCK_VOICE_CNT_GSM` INT(11) NOT NULL,
					`BLOCK_VOICE_CNT_UMTS` INT(11) NOT NULL,
					`SF_VOICE_CNT_GSM` INT(11) NOT NULL,
					`SF_VOICE_CNT_UMTS` INT(11) NOT NULL,
					`VOICE_MO_CNT_GSM` INT(11) NOT NULL,
					`VOICE_MT_CNT_GSM` INT(11) NOT NULL,
					`VOICE_MO_CNT_UMTS` INT(11) NOT NULL,
					`VOICE_MT_CNT_UMTS` INT(11) NOT NULL,
					`CALL_SETUP_TIME_SUM_GSM` INT(11) NOT NULL,
					`CALL_SETUP_TIME_SUM_UMTS` INT(11) NOT NULL,
					`CALL_SETUP_TIME_CNT_GSM` INT(11) NOT NULL,
					`CALL_SETUP_TIME_CNT_UMTS` INT(11) NOT NULL,
					`DROP_VOICE_CNT_GSM` INT(11) NOT NULL,
					`DROP_VOICE_CNT_UMTS` INT(11) NOT NULL,
					`BLOCK_GPRS_CNT` INT(11) NOT NULL,
					`BLOCK_R99_CNT` INT(11) NOT NULL,
					`BLOCK_HSPA_CNT` INT(11) NOT NULL,
					`BLOCK_MRAB_CNT` INT(11) NOT NULL,
					`BLOCK_PS_OTHER_CNT` INT(11) NOT NULL,
					`BLOCK_CNT` INT(11) NOT NULL,
					`DATA_MO_CNT` INT(11) NOT NULL,
					`DATA_MT_CNT` INT(11) NOT NULL,
					`R99_MO_CNT` INT(11) NOT NULL,
					`R99_MT_CNT` INT(11) NOT NULL,
					`HSPA_MO_CNT` INT(11) NOT NULL,
					`HSPA_MT_CNT` INT(11) NOT NULL,
					`MRAB_MO_CNT` INT(11) NOT NULL,
					`MRAB_MT_CNT` INT(11) NOT NULL,
					`PS_OTHER_CNT` INT(11) NOT NULL,
					`CALL_CNT` INT(11) NOT NULL,
					`SF_GPRS_CNT` INT(11) NOT NULL,
					`SF_R99_CNT` INT(11) NOT NULL,
					`SF_HSPA_CNT` INT(11) NOT NULL,
					`SF_MRAB_CNT` INT(11) NOT NULL,
					`SF_PS_OTHER_CNT` INT(11) NOT NULL,
					`SF_CNT` INT(11) NOT NULL,
					`DROP_GPRS_CNT` INT(11) NOT NULL,
					`DROP_R99_CNT` INT(11) NOT NULL,
					`DROP_HSPA_CNT` INT(11) NOT NULL,
					`DROP_MRAB_CNT` INT(11) NOT NULL,
					`DROP_PS_OTHER_CNT` INT(11) NOT NULL,
					`DROP_CNT` INT(11) NOT NULL,
					`PS_DL_SPEED_MAX_UMTS` INT(11) NOT NULL,
					`PS_DL_SPEED_MAX_LTE` INT(11) NOT NULL,
				PRIMARY KEY (`make_id`,`model_id`)) ENGINE=MYISAM DEFAULT CHARSET=latin1
					;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('INSERT INTO ',gt_global_statistic,'.tmp_cto_dashboard_davice(
				  MAKE_ID,MODEL_ID,BLOCK_VOICE_CNT_GSM , BLOCK_VOICE_CNT_UMTS ,SF_VOICE_CNT_GSM ,SF_VOICE_CNT_UMTS ,
				  VOICE_MO_CNT_GSM , VOICE_MT_CNT_GSM , VOICE_MO_CNT_UMTS ,VOICE_MT_CNT_UMTS ,
				  CALL_SETUP_TIME_SUM_GSM ,  CALL_SETUP_TIME_SUM_UMTS ,CALL_SETUP_TIME_CNT_GSM ,CALL_SETUP_TIME_CNT_UMTS ,
				  DROP_VOICE_CNT_GSM , DROP_VOICE_CNT_UMTS ,  BLOCK_GPRS_CNT ,BLOCK_R99_CNT  ,
	                          BLOCK_HSPA_CNT ,BLOCK_MRAB_CNT ,BLOCK_PS_OTHER_CNT ,BLOCK_CNT  ,DATA_MO_CNT ,DATA_MT_CNT ,
	                          R99_MO_CNT , R99_MT_CNT , HSPA_MO_CNT ,HSPA_MT_CNT ,MRAB_MO_CNT ,MRAB_MT_CNT ,
	                          PS_OTHER_CNT ,CALL_CNT ,SF_GPRS_CNT , SF_R99_CNT ,SF_HSPA_CNT , SF_MRAB_CNT ,
	                          SF_PS_OTHER_CNT , SF_CNT ,DROP_GPRS_CNT , DROP_R99_CNT ,DROP_HSPA_CNT ,DROP_MRAB_CNT ,
	                          DROP_PS_OTHER_CNT , DROP_CNT , PS_DL_SPEED_MAX_UMTS ,PS_DL_SPEED_MAX_LTE 
				 )
				SELECT MAKE_ID,MODEL_ID,SUM(BLOCK_VOICE_CNT_GSM) AS BLOCK_VOICE_CNT_GSM,SUM(BLOCK_VOICE_CNT_UMTS) AS BLOCK_VOICE_CNT_UMTS,SUM(SF_VOICE_CNT_GSM) AS SF_VOICE_CNT_GSM,SUM(SF_VOICE_CNT_UMTS) AS SF_VOICE_CNT_UMTS,
				  SUM(VOICE_MO_CNT_GSM) AS VOICE_MO_CNT_GSM,SUM(VOICE_MT_CNT_GSM) AS VOICE_MT_CNT_GSM,SUM(VOICE_MO_CNT_UMTS) AS VOICE_MO_CNT_UMTS,SUM(VOICE_MT_CNT_UMTS) AS VOICE_MT_CNT_UMTS,
				  SUM(CALL_SETUP_TIME_SUM_GSM) AS CALL_SETUP_TIME_SUM_GSM,SUM(CALL_SETUP_TIME_SUM_UMTS) AS CALL_SETUP_TIME_SUM_UMTS,SUM(CALL_SETUP_TIME_CNT_GSM) AS CALL_SETUP_TIME_CNT_GSM,SUM(CALL_SETUP_TIME_CNT_UMTS) AS CALL_SETUP_TIME_CNT_UMTS,
				  SUM(DROP_VOICE_CNT_GSM) AS DROP_VOICE_CNT_GSM,SUM(DROP_VOICE_CNT_UMTS) AS DROP_VOICE_CNT_UMTS,SUM(BLOCK_GPRS_CNT) AS BLOCK_GPRS_CNT,SUM(BLOCK_R99_CNT) AS BLOCK_R99_CNT,
	                          SUM(BLOCK_HSPA_CNT) AS BLOCK_HSPA_CNT,SUM(BLOCK_MRAB_CNT) AS BLOCK_MRAB_CNT,SUM(BLOCK_PS_OTHER_CNT) AS BLOCK_PS_OTHER_CNT,SUM(BLOCK_CNT) AS BLOCK_CNT,SUM(DATA_MO_CNT) AS DATA_MO_CNT,SUM(DATA_MT_CNT) AS DATA_MT_CNT,
	                          SUM(R99_MO_CNT) AS R99_MO_CNT,SUM(R99_MT_CNT) AS R99_MT_CNT,SUM(HSPA_MO_CNT) AS HSPA_MO_CNT,SUM(HSPA_MT_CNT) AS HSPA_MT_CNT,SUM(MRAB_MO_CNT) AS MRAB_MO_CNT,SUM(MRAB_MT_CNT) AS MRAB_MT_CNT,
	                          SUM(PS_OTHER_CNT) AS PS_OTHER_CNT,SUM(CALL_CNT) AS CALL_CNT,SUM(SF_GPRS_CNT) AS SF_GPRS_CNT,SUM(SF_R99_CNT) AS SF_R99_CNT,SUM(SF_HSPA_CNT) AS SF_HSPA_CNT,SUM(SF_MRAB_CNT) AS SF_MRAB_CNT,
	                          SUM(SF_PS_OTHER_CNT) AS SF_PS_OTHER_CNT,SUM(SF_CNT) AS SF_CNT,SUM(DROP_GPRS_CNT) AS DROP_GPRS_CNT,SUM(DROP_R99_CNT) AS DROP_R99_CNT,SUM(DROP_HSPA_CNT) AS DROP_HSPA_CNT,SUM(DROP_MRAB_CNT) AS DROP_MRAB_CNT,
	                          SUM(DROP_PS_OTHER_CNT) AS DROP_PS_OTHER_CNT,SUM(DROP_CNT) AS DROP_CNT,MAX(PS_DL_SPEED_MAX_UMTS) AS PS_DL_SPEED_MAX_UMTS,MAX(PS_DL_SPEED_MAX_LTE) AS PS_DL_SPEED_MAX_LTE
				   FROM(
				SELECT  MAKE_ID,MODEL_ID,BLOCK_VOICE_CNT AS BLOCK_VOICE_CNT_GSM ,NULL AS BLOCK_VOICE_CNT_UMTS,SF_VOICE_CNT AS SF_VOICE_CNT_GSM ,NULL AS SF_VOICE_CNT_UMTS,
				  VOICE_MO_CNT AS VOICE_MO_CNT_GSM , VOICE_MT_CNT AS VOICE_MT_CNT_GSM , NULL AS VOICE_MO_CNT_UMTS ,NULL AS VOICE_MT_CNT_UMTS ,
				  CALL_SETUP_TIME_SUM AS CALL_SETUP_TIME_SUM_GSM ,NULL AS CALL_SETUP_TIME_SUM_UMTS ,CALL_SETUP_TIME_CNT AS CALL_SETUP_TIME_CNT_GSM ,NULL AS CALL_SETUP_TIME_CNT_UMTS ,
				  DROP_VOICE_CNT AS DROP_VOICE_CNT_GSM ,NULL AS DROP_VOICE_CNT_UMTS ,BLOCK_GPRS_CNT AS BLOCK_GPRS_CNT,NULL AS BLOCK_R99_CNT ,
	                          NULL AS BLOCK_HSPA_CNT ,NULL AS BLOCK_MRAB_CNT ,NULL AS BLOCK_PS_OTHER_CNT , NULL AS BLOCK_CNT ,DATA_MO_CNT AS DATA_MO_CNT ,DATA_MT_CNT AS DATA_MT_CNT ,
	                          NULL AS R99_MO_CNT ,NULL AS R99_MT_CNT ,NULL AS HSPA_MO_CNT ,NULL AS HSPA_MT_CNT ,NULL AS MRAB_MO_CNT ,NULL AS MRAB_MT_CNT ,
	                          NULL AS PS_OTHER_CNT ,NULL AS CALL_CNT ,SF_GPRS_CNT AS SF_GPRS_CNT ,NULL AS SF_R99_CNT ,NULL AS SF_HSPA_CNT ,NULL AS SF_MRAB_CNT ,
	                         NULL AS SF_PS_OTHER_CNT ,NULL AS SF_CNT ,DROP_GPRS_CNT AS DROP_GPRS_CNT ,NULL AS DROP_R99_CNT ,NULL AS DROP_HSPA_CNT ,NULL AS DROP_MRAB_CNT ,
	                          NULL AS DROP_PS_OTHER_CNT ,NULL AS DROP_CNT ,NULL AS PS_DL_SPEED_MAX_UMTS,NULL AS PS_DL_SPEED_MAX_LTE 
				
				FROM ',gt_global_statistic_g1,'.table_imsi_GSM_dy_',DATA_DATE,'
				UNION
				SELECT  MAKE_ID,MODEL_ID,NULL AS BLOCK_VOICE_CNT_GSM ,BLOCK_VOICE_CNT AS BLOCK_VOICE_CNT_UMTS ,NULL AS SF_VOICE_CNT_GSM ,SF_VOICE_CNT AS SF_VOICE_CNT_UMTS ,
				  NULL AS VOICE_MO_CNT_GSM ,NULL AS VOICE_MT_CNT_GSM ,VOICE_MO_CNT AS VOICE_MO_CNT_UMTS ,VOICE_MO_CNT AS VOICE_MT_CNT_UMTS ,
				 NULL AS CALL_SETUP_TIME_SUM_GSM ,CALL_SETUP_TIME_SUM AS CALL_SETUP_TIME_SUM_UMTS ,NULL AS CALL_SETUP_TIME_CNT_GSM ,CALL_SETUP_TIME_CNT AS CALL_SETUP_TIME_CNT_UMTS ,
				 NULL AS DROP_VOICE_CNT_GSM ,DROP_VOICE_CNT AS DROP_VOICE_CNT_UMTS ,NULL AS BLOCK_GPRS_CNT ,BLOCK_R99_CNT AS BLOCK_R99_CNT  ,
	                         BLOCK_HSPA_CNT AS BLOCK_HSPA_CNT ,BLOCK_MRAB_CNT AS BLOCK_MRAB_CNT ,BLOCK_PS_OTHER_CNT AS BLOCK_PS_OTHER_CNT,NULL AS BLOCK_CNT ,NULL AS DATA_MO_CNT,NULL AS DATA_MT_CNT ,
	                         R99_MO_CNT AS R99_MO_CNT , R99_MT_CNT AS R99_MT_CNT, HSPA_MO_CNT AS HSPA_MO_CNT,HSPA_MT_CNT AS HSPA_MT_CNT,MRAB_MO_CNT AS MRAB_MO_CNT ,MRAB_MT_CNT AS MRAB_MT_CNT ,
	                          PS_OTHER_CNT AS PS_OTHER_CNT,NULL AS CALL_CNT ,NULL AS SF_GPRS_CNT ,SF_R99_CNT AS SF_R99_CNT ,SF_HSPA_CNT AS SF_HSPA_CNT ,SF_MRAB_CNT AS SF_MRAB_CNT ,
	                         SF_PS_OTHER_CNT AS SF_PS_OTHER_CNT ,NULL AS SF_CNT ,NULL AS DROP_GPRS_CNT ,DROP_R99_CNT AS DROP_R99_CNT ,DROP_HSPA_CNT AS DROP_HSPA_CNT ,DROP_MRAB_CNT AS DROP_MRAB_CNT ,
	                         DROP_PS_OTHER_CNT AS DROP_PS_OTHER_CNT ,NULL AS DROP_CNT ,PS_DL_SPEED_MAX AS PS_DL_SPEED_MAX_UMTS ,NULL AS PS_DL_SPEED_MAX_LTE 
				
				FROM ',gt_global_statistic_g1,'.table_imsi_UMTS_dy_',DATA_DATE,'
				UNION
				SELECT  MAKE_ID,MODEL_ID,NULL AS BLOCK_VOICE_CNT_GSM ,NULL AS BLOCK_VOICE_CNT_UMTS ,NULL AS SF_VOICE_CNT_GSM ,NULL AS SF_VOICE_CNT_UMTS ,
				NULL AS  VOICE_MO_CNT_GSM ,NULL AS VOICE_MT_CNT_GSM ,NULL AS VOICE_MO_CNT_UMTS ,NULL AS VOICE_MT_CNT_UMTS ,
				NULL AS  CALL_SETUP_TIME_SUM_GSM ,NULL AS  CALL_SETUP_TIME_SUM_UMTS ,NULL AS CALL_SETUP_TIME_CNT_GSM ,NULL AS CALL_SETUP_TIME_CNT_UMTS ,
				NULL AS  DROP_VOICE_CNT_GSM ,NULL AS DROP_VOICE_CNT_UMTS ,NULL AS BLOCK_GPRS_CNT ,NULL AS BLOCK_R99_CNT ,
	                      NULL AS BLOCK_HSPA_CNT ,NULL AS BLOCK_MRAB_CNT ,NULL AS BLOCK_PS_OTHER_CNT ,BLOCK_CNT AS BLOCK_CNT,NULL AS DATA_MO_CNT ,NULL AS DATA_MT_CNT ,
	                     NULL AS R99_MO_CNT ,NULL AS R99_MT_CNT ,NULL AS HSPA_MO_CNT ,NULL AS HSPA_MT_CNT ,NULL AS MRAB_MO_CNT ,NULL AS MRAB_MT_CNT ,
	                    NULL AS PS_OTHER_CNT ,CALL_CNT AS CALL_CNT ,NULL AS SF_GPRS_CNT ,NULL AS SF_R99_CNT ,NULL AS SF_HSPA_CNT ,NULL AS SF_MRAB_CNT ,
	                    NULL AS SF_PS_OTHER_CNT ,SF_CNT AS SF_CNT ,NULL AS DROP_GPRS_CNT ,NULL AS DROP_R99_CNT ,NULL AS DROP_HSPA_CNT ,NULL AS DROP_MRAB_CNT ,
	                      NULL AS DROP_PS_OTHER_CNT ,DROP_CNT AS DROP_CNT ,NULL AS PS_DL_SPEED_MAX_UMTS ,PS_DL_SPEED_MAX AS PS_DL_SPEED_MAX_LTE 
				
				FROM ',gt_global_statistic_g1,'.table_imsi_LTE_dy_',DATA_DATE,'
				)A	
				GROUP BY  MAKE_ID,MODEL_ID
				ORDER BY NULL;');
		
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('TRUNCATE TABLE ',gt_global_statistic,'.qv_cto_dashboard_device;');		
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('
				INSERT INTO ',gt_global_statistic,'.qv_cto_dashboard_device(MAKE_ID,MODEL_ID,DEVICE,
					Voice_CS_Block_call_original,Voice_CS_Block_call_score,
					Voice_CS_CSSR_original,Voice_CS_CSSR_score,
					Voice_CS_CALL_SET_UP_TIME_original,Voice_CS_CALL_SET_UP_TIME_score,
					Voice_CS_Drop_calls_original,Voice_CS_Drop_calls_score,
					Data_PS_Blocl_call_original,Data_PS_Blocl_call_score,
					Data_PS_CSSR_original,Data_PS_CSSR_score,
					Data_PS_Drop_calls_original,Data_PS_Drop_calls_score,
					Data_PS_Throughput_original,Data_PS_Throughput_score
				
					)
					SELECT 
					A.MAKE_ID,A.MODEL_ID,B.DEVICE,
					(A.BLOCK_VOICE_CNT_GSM+A.BLOCK_VOICE_CNT_UMTS)/(A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS+A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS),
					(CASE 
					WHEN (A.BLOCK_VOICE_CNT_GSM+A.BLOCK_VOICE_CNT_UMTS)/(A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS+A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS) BETWEEN ',@SCORE_EXCELLENT_LOW_1,' AND ',@SCORE_EXCELLENT_UP_1,' THEN ''5''
					WHEN (A.BLOCK_VOICE_CNT_GSM+A.BLOCK_VOICE_CNT_UMTS)/(A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS+A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS) BETWEEN ',@SCORE_GOOD_LOW_1,' AND ',@SCORE_GOOD_UP_1,' THEN ''4''
					WHEN (A.BLOCK_VOICE_CNT_GSM+A.BLOCK_VOICE_CNT_UMTS)/(A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS+A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS) BETWEEN ',@SCORE_FAIR_LOW_1,' AND ',@SCORE_FAIR_UP_1,' THEN ''3''
					WHEN (A.BLOCK_VOICE_CNT_GSM+A.BLOCK_VOICE_CNT_UMTS)/(A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS+A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS) BETWEEN ',@SCORE_BAD_LOW_1,' AND ',@SCORE_BAD_UP_3,' THEN ''2''
					WHEN (A.BLOCK_VOICE_CNT_GSM+A.BLOCK_VOICE_CNT_UMTS)/(A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS+A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS) >=',@SCORE_VERYBAD_UP_1,' THEN ''1''
					ELSE ''5'' END)  AS Voice_CS_Block_call_score,
					
	
					(1-((A.SF_VOICE_CNT_GSM+A.SF_VOICE_CNT_UMTS+A.BLOCK_VOICE_CNT_GSM+A.BLOCK_VOICE_CNT_UMTS)/(A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_GSM+A.VOICE_MO_CNT_UMTS+A.VOICE_MT_CNT_UMTS))),
					(CASE 
					WHEN (1-((A.SF_VOICE_CNT_GSM+A.SF_VOICE_CNT_UMTS+A.BLOCK_VOICE_CNT_GSM+A.BLOCK_VOICE_CNT_UMTS)/(A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_GSM+A.VOICE_MO_CNT_UMTS+A.VOICE_MT_CNT_UMTS))) =',@SCORE_EXCELLENT_UP_2,' THEN ''5''
					WHEN (1-((A.SF_VOICE_CNT_GSM+A.SF_VOICE_CNT_UMTS+A.BLOCK_VOICE_CNT_GSM+A.BLOCK_VOICE_CNT_UMTS)/(A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_GSM+A.VOICE_MO_CNT_UMTS+A.VOICE_MT_CNT_UMTS))) BETWEEN ',@SCORE_GOOD_LOW_2,' AND ',@SCORE_GOOD_UP_2,' THEN ''4''
					WHEN (1-((A.SF_VOICE_CNT_GSM+A.SF_VOICE_CNT_UMTS+A.BLOCK_VOICE_CNT_GSM+A.BLOCK_VOICE_CNT_UMTS)/(A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_GSM+A.VOICE_MO_CNT_UMTS+A.VOICE_MT_CNT_UMTS))) BETWEEN ',@SCORE_FAIR_LOW_2,' AND ',@SCORE_FAIR_UP_2,' THEN ''3''
					WHEN (1-((A.SF_VOICE_CNT_GSM+A.SF_VOICE_CNT_UMTS+A.BLOCK_VOICE_CNT_GSM+A.BLOCK_VOICE_CNT_UMTS)/(A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_GSM+A.VOICE_MO_CNT_UMTS+A.VOICE_MT_CNT_UMTS))) BETWEEN ',@SCORE_BAD_LOW_2,' AND ',@SCORE_BAD_UP_2,' THEN ''2''
					WHEN (1-((A.SF_VOICE_CNT_GSM+A.SF_VOICE_CNT_UMTS+A.BLOCK_VOICE_CNT_GSM+A.BLOCK_VOICE_CNT_UMTS)/(A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_GSM+A.VOICE_MO_CNT_UMTS+A.VOICE_MT_CNT_UMTS))) <= ',@SCORE_VERYBAD_UP_2,' THEN ''1''
					ELSE ''5'' END) AS Voice_CS_CSSR_score,
					
	
					((A.CALL_SETUP_TIME_SUM_GSM+A.CALL_SETUP_TIME_SUM_UMTS)/(A.CALL_SETUP_TIME_CNT_GSM+A.CALL_SETUP_TIME_CNT_UMTS))/1000,
					(CASE 
					WHEN ((A.CALL_SETUP_TIME_SUM_GSM+A.CALL_SETUP_TIME_SUM_UMTS)/(A.CALL_SETUP_TIME_CNT_GSM+A.CALL_SETUP_TIME_CNT_UMTS))/1000 <= ',@SCORE_EXCELLENT_UP_3,' THEN ''5''
					WHEN ((A.CALL_SETUP_TIME_SUM_GSM+A.CALL_SETUP_TIME_SUM_UMTS)/(A.CALL_SETUP_TIME_CNT_GSM+A.CALL_SETUP_TIME_CNT_UMTS))/1000 BETWEEN ',@SCORE_GOOD_LOW_3,' AND ',@SCORE_GOOD_UP_3,' THEN ''4''
					WHEN ((A.CALL_SETUP_TIME_SUM_GSM+A.CALL_SETUP_TIME_SUM_UMTS)/(A.CALL_SETUP_TIME_CNT_GSM+A.CALL_SETUP_TIME_CNT_UMTS))/1000 BETWEEN ',@SCORE_FAIR_LOW_3,' AND ',@SCORE_FAIR_UP_3,' THEN ''3''
					WHEN ((A.CALL_SETUP_TIME_SUM_GSM+A.CALL_SETUP_TIME_SUM_UMTS)/(A.CALL_SETUP_TIME_CNT_GSM+A.CALL_SETUP_TIME_CNT_UMTS))/1000 BETWEEN ',@SCORE_BAD_LOW_3,' AND ',@SCORE_BAD_UP_3,' THEN ''2''
					WHEN ((A.CALL_SETUP_TIME_SUM_GSM+A.CALL_SETUP_TIME_SUM_UMTS)/(A.CALL_SETUP_TIME_CNT_GSM+A.CALL_SETUP_TIME_CNT_UMTS))/1000 >= ',@SCORE_VERYBAD_UP_3,' THEN ''1''
					ELSE ''5'' END) AS Voice_CS_CALL_SET_UP_TIME_score,
					
	
					(A.DROP_VOICE_CNT_GSM+A.DROP_VOICE_CNT_UMTS)/(A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS+A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS),
					(CASE 
					WHEN (A.DROP_VOICE_CNT_GSM+A.DROP_VOICE_CNT_UMTS)/(A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS+A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS) <=',@SCORE_EXCELLENT_UP_4,' THEN ''5''
					WHEN (A.DROP_VOICE_CNT_GSM+A.DROP_VOICE_CNT_UMTS)/(A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS+A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS) BETWEEN ',@SCORE_GOOD_LOW_4,' AND ',@SCORE_GOOD_UP_4,' THEN ''4''
					WHEN (A.DROP_VOICE_CNT_GSM+A.DROP_VOICE_CNT_UMTS)/(A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS+A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS) BETWEEN ',@SCORE_FAIR_LOW_4,' AND ',@SCORE_FAIR_UP_4,' THEN ''3''
					WHEN (A.DROP_VOICE_CNT_GSM+A.DROP_VOICE_CNT_UMTS)/(A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS+A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS) BETWEEN ',@SCORE_BAD_LOW_4,' AND ',@SCORE_BAD_UP_4,' THEN ''2''
					WHEN (A.DROP_VOICE_CNT_GSM+A.DROP_VOICE_CNT_UMTS)/(A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS+A.VOICE_MO_CNT_GSM+A.VOICE_MT_CNT_UMTS) >=',@SCORE_VERYBAD_UP_4,' THEN ''1''
					ELSE ''5'' END) AS Voice_CS_Drop_calls_score,
					
	
					(BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT),
					(CASE 
					WHEN (BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT) <= ',@SCORE_EXCELLENT_UP_5,' THEN ''5''
					WHEN (BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT) BETWEEN ',@SCORE_GOOD_LOW_5,' AND ',@SCORE_GOOD_UP_5,' THEN ''4''
					WHEN (BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT) BETWEEN ',@SCORE_FAIR_LOW_5,' AND ',@SCORE_FAIR_UP_5,' THEN ''3''
					WHEN (BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT) BETWEEN ',@SCORE_BAD_LOW_5,' AND ',@SCORE_BAD_UP_5,' THEN ''2''
					WHEN (BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT) >= ',@SCORE_VERYBAD_UP_5,' THEN ''1''
					ELSE ''5'' END) AS Data_PS_Blocl_call_score,
				
					
					1-((SF_GPRS_CNT+SF_R99_CNT+SF_HSPA_CNT+SF_MRAB_CNT+SF_PS_OTHER_CNT+SF_CNT+BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT)),
					(CASE 
					WHEN ((1-((SF_GPRS_CNT+SF_R99_CNT+SF_HSPA_CNT+SF_MRAB_CNT+SF_PS_OTHER_CNT+SF_CNT+BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT)))) >=',@SCORE_EXCELLENT_UP_6,' THEN ''5''
					WHEN ((1-((SF_GPRS_CNT+SF_R99_CNT+SF_HSPA_CNT+SF_MRAB_CNT+SF_PS_OTHER_CNT+SF_CNT+BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT)))) BETWEEN ',@SCORE_GOOD_LOW_6,' AND ',@SCORE_GOOD_UP_6,' THEN ''4''
					WHEN ((1-((SF_GPRS_CNT+SF_R99_CNT+SF_HSPA_CNT+SF_MRAB_CNT+SF_PS_OTHER_CNT+SF_CNT+BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT)))) BETWEEN ',@SCORE_FAIR_LOW_6,' AND ',@SCORE_FAIR_UP_6,'  THEN ''3''
					WHEN ((1-((SF_GPRS_CNT+SF_R99_CNT+SF_HSPA_CNT+SF_MRAB_CNT+SF_PS_OTHER_CNT+SF_CNT+BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT)))) BETWEEN ',@SCORE_BAD_LOW_6,' AND ',@SCORE_BAD_UP_6,'  THEN ''2''
					WHEN ((1-((SF_GPRS_CNT+SF_R99_CNT+SF_HSPA_CNT+SF_MRAB_CNT+SF_PS_OTHER_CNT+SF_CNT+BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT)))) <=',@SCORE_VERYBAD_UP_6,' THEN ''1''
					ELSE ''5'' END) AS Data_PS_CSSR_score, 
					
	
					(DROP_GPRS_CNT+DROP_R99_CNT+DROP_HSPA_CNT+DROP_MRAB_CNT+DROP_PS_OTHER_CNT+DROP_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT),
					(CASE 
					WHEN (DROP_GPRS_CNT+DROP_R99_CNT+DROP_HSPA_CNT+DROP_MRAB_CNT+DROP_PS_OTHER_CNT+DROP_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT) <=',@SCORE_EXCELLENT_UP_7,' THEN ''5''
					WHEN (DROP_GPRS_CNT+DROP_R99_CNT+DROP_HSPA_CNT+DROP_MRAB_CNT+DROP_PS_OTHER_CNT+DROP_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT)  BETWEEN ',@SCORE_GOOD_LOW_7,' AND ',@SCORE_GOOD_UP_7,' THEN ''4''
					WHEN (DROP_GPRS_CNT+DROP_R99_CNT+DROP_HSPA_CNT+DROP_MRAB_CNT+DROP_PS_OTHER_CNT+DROP_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT)  BETWEEN ',@SCORE_FAIR_LOW_7,' AND ',@SCORE_FAIR_UP_7,' THEN ''3''
					WHEN (DROP_GPRS_CNT+DROP_R99_CNT+DROP_HSPA_CNT+DROP_MRAB_CNT+DROP_PS_OTHER_CNT+DROP_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT)  BETWEEN ',@SCORE_BAD_LOW_7,' AND ',@SCORE_BAD_UP_7,' THEN ''2''
					WHEN (DROP_GPRS_CNT+DROP_R99_CNT+DROP_HSPA_CNT+DROP_MRAB_CNT+DROP_PS_OTHER_CNT+DROP_CNT)/(DATA_MO_CNT+DATA_MT_CNT+R99_MO_CNT+R99_MT_CNT+HSPA_MO_CNT+HSPA_MT_CNT+MRAB_MO_CNT+MRAB_MT_CNT+PS_OTHER_CNT+CALL_CNT) >=',@SCORE_VERYBAD_UP_7,' THEN ''1''
					ELSE ''5'' END) AS Data_PS_Drop_calls_score,
					
	
					(PS_DL_SPEED_MAX_UMTS+PS_DL_SPEED_MAX_LTE)/1024,
					(CASE 
					WHEN ((PS_DL_SPEED_MAX_UMTS+PS_DL_SPEED_MAX_LTE)/1024) >=',@SCORE_EXCELLENT_UP_8,' THEN ''5''
					WHEN ((PS_DL_SPEED_MAX_UMTS+PS_DL_SPEED_MAX_LTE)/1024)  BETWEEN ',@SCORE_GOOD_LOW_8,' AND ',@SCORE_GOOD_UP_8,' THEN ''4''
					WHEN ((PS_DL_SPEED_MAX_UMTS+PS_DL_SPEED_MAX_LTE)/1024)  BETWEEN ',@SCORE_FAIR_LOW_8,' AND ',@SCORE_FAIR_UP_8,' THEN ''3''
					WHEN ((PS_DL_SPEED_MAX_UMTS+PS_DL_SPEED_MAX_LTE)/1024)  BETWEEN ',@SCORE_BAD_LOW_8,' AND ',@SCORE_BAD_UP_8,' THEN ''2''
					WHEN ((PS_DL_SPEED_MAX_UMTS+PS_DL_SPEED_MAX_LTE)/1024)  <=',@SCORE_VERYBAD_UP_8,' THEN ''1''
					ELSE ''1'' END) AS data_PS_Throughput_score
	
	
				FROM ',gt_global_statistic,'.tmp_cto_dashboard_davice A,',gt_global_statistic,'.tmp_dim_handset B
					WHERE A.MAKE_ID=B.MAKE_ID AND A.MODEL_ID=B.MODEL_ID  
					AND A.MAKE_ID <>0 AND A.MODEL_ID <>0
					GROUP BY make_id,model_id
					ORDER BY NULL;
					;');
		
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('
				UPDATE ',gt_global_statistic,'.qv_cto_dashboard_device
				SET 
					Voice_CS_Block_call_total=(Voice_CS_Block_call_score)*',@WEIGHTAGE_1,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5),
					Voice_CS_CSSR_total=(Voice_CS_CSSR_score)*',@WEIGHTAGE_2,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5),
					Voice_CS_CALL_SET_UP_TIME_TOTAL=(Voice_CS_CALL_SET_UP_TIME_score)*',@WEIGHTAGE_3,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5),
					Voice_CS_Drop_calls_total=(Voice_CS_Drop_calls_score)*',@WEIGHTAGE_4,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5),
					Data_PS_Blocl_call_total=(Data_PS_Blocl_call_score)*',@WEIGHTAGE_5,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5),
					Data_PS_CSSR_total=(Data_PS_CSSR_score)*',@WEIGHTAGE_6,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5),
					Data_PS_Drop_calls_total=(Data_PS_Drop_calls_score)*',@WEIGHTAGE_7,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5),
					Data_PS_Throughput_total=(Data_PS_Throughput_score)*',@WEIGHTAGE_8,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5),
					Voice_CS=(((Voice_CS_Block_call_score)*',@WEIGHTAGE_1,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5))+((Voice_CS_CSSR_score)*',@WEIGHTAGE_2,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5))
						+((Voice_CS_CALL_SET_UP_TIME_score)*',@WEIGHTAGE_3,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5))+((Voice_CS_Drop_calls_score)*',@WEIGHTAGE_4,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5))),
					Data_PS=(((Data_PS_Blocl_call_score)*',@WEIGHTAGE_5,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5))+((Data_PS_CSSR_score)*',@WEIGHTAGE_6,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5))
						+((Data_PS_Drop_calls_score)*',@WEIGHTAGE_7,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5))+((Data_PS_Throughput_score)*',@WEIGHTAGE_8,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5)))
					;');
	
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('
				UPDATE ',gt_global_statistic,'.qv_cto_dashboard_device SET DEVICE = REPLACE(DEVICE,'','','' '') WHERE DEVICE LIKE ''%,%'';');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		
		SET @SqlCmd=CONCAT('
						SELECT 
						''MAKE_ID'',''MODEL_ID'',''DEVICE'',
						''Voice_CS_Block_call_original'' ,''Voice_CS_Block_call_score'' ,''Voice_CS_Block_call_total'' ,
						''Voice_CS_CSSR_original'',''Voice_CS_CSSR_score'' ,''Voice_CS_CSSR_total'' ,
						''Voice_CS_CALL_SET_UP_TIME_original'' ,''Voice_CS_CALL_SET_UP_TIME_score'' ,''Voice_CS_CALL_SET_UP_TIME_TOTAL'',
						''Voice_CS_Drop_calls_original'' ,''Voice_CS_Drop_calls_score'' ,''Voice_CS_Drop_calls_total'',
						''Data_PS_Blocl_call_original'' ,''Data_PS_Blocl_call_score'' ,''Data_PS_Blocl_call_total'',
						''Data_PS_CSSR_original'' ,''Data_PS_CSSR_score'',''Data_PS_CSSR_total'' ,
						''Data_PS_Drop_calls_original'' ,''Data_PS_Drop_calls_score'' ,''Data_PS_Drop_calls_total'' ,
						''Data_PS_Throughput_original'' ,''Data_PS_Throughput_score'' ,''Data_PS_Throughput_total'',						
						''Voice_CS'',
						''Data_PS''
						UNION
						SELECT *
						FROM ',gt_global_statistic,'.qv_cto_dashboard_device 
						WHERE MAKE_ID<>0 AND MODEL_ID<>0
						INTO OUTFILE "',FOLDER_PATH,'cto_dashboard_device_',DATA_DATE,'.csv"
						FIELDS TERMINATED BY '',''
						OPTIONALLY ENCLOSED BY ''''
						LINES TERMINATED BY ''\\n'';');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
	
		SET @SqlCmd=CONCAT('DROP  TABLE IF EXISTS ',gt_global_statistic,'.tmp_cto_dashboard_davice;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.tmp_dim_handset;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
	
		SET @SqlCmd=CONCAT('TRUNCATE TABLE ',gt_global_statistic,'.qv_cto_dashboard_device;');		
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		INSERT INTO gt_gw_main.SP_LOG VALUES(gt_global_statistic,'SP_Qlikview_CTO_dashboard',CONCAT('Generate DEVICE DATA Done: ',TIMESTAMPDIFF(SECOND,START_TIME,SYSDATE()),' seconds.'), NOW());
	
	ELSEIF KIND='CELL' THEN 	
		INSERT INTO gt_gw_main.SP_LOG VALUES(gt_global_statistic,'SP_Qlikview_CTO_dashboard','Generate CELL DATA Start', START_TIME);
		
	
		
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW/100,SCORE_EXCELLENT_UP/100,SCORE_GOOD_LOW/100,SCORE_GOOD_UP/100,
				SCORE_FAIR_LOW/100,SCORE_FAIR_UP/100,SCORE_BAD_LOW/100,SCORE_BAD_UP/100,SCORE_VERYBAD_LOW/100,SCORE_VERYBAD_UP/100
				INTO @WEIGHTAGE_1,@SCORE_EXCELLENT_LOW_1,@SCORE_EXCELLENT_UP_1,@SCORE_GOOD_LOW_1,
					@SCORE_GOOD_UP_1,@SCORE_FAIR_LOW_1,@SCORE_FAIR_UP_1,@SCORE_BAD_LOW_1,@SCORE_BAD_UP_1,
					@SCORE_VERYBAD_LOW_1,@SCORE_VERYBAD_UP_1
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CELL'' AND SERVICE=''CS'' AND KPI_NAME=''Block_call'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		
	
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW/100,SCORE_EXCELLENT_UP/100,SCORE_GOOD_LOW/100,SCORE_GOOD_UP/100,
				SCORE_FAIR_LOW/100,SCORE_FAIR_UP/100,SCORE_BAD_LOW/100,SCORE_BAD_UP/100,SCORE_VERYBAD_LOW/100,SCORE_VERYBAD_UP/100
				INTO @WEIGHTAGE_2,@SCORE_EXCELLENT_LOW_2,@SCORE_EXCELLENT_UP_2,@SCORE_GOOD_LOW_2,
					@SCORE_GOOD_UP_2,@SCORE_FAIR_LOW_2,@SCORE_FAIR_UP_2,@SCORE_BAD_LOW_2,@SCORE_BAD_UP_2,
					@SCORE_VERYBAD_LOW_2,@SCORE_VERYBAD_UP_2
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CELL'' AND SERVICE=''CS'' AND KPI_NAME=''CSSR'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
			
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_3,@SCORE_EXCELLENT_LOW_3,@SCORE_EXCELLENT_UP_3,@SCORE_GOOD_LOW_3,
					@SCORE_GOOD_UP_3,@SCORE_FAIR_LOW_3,@SCORE_FAIR_UP_3,@SCORE_BAD_LOW_3,@SCORE_BAD_UP_3,
					@SCORE_VERYBAD_LOW_3,@SCORE_VERYBAD_UP_3
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CELL'' AND SERVICE=''CS'' AND KPI_NAME=''Setup_Time'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_4,@SCORE_EXCELLENT_LOW_4,@SCORE_EXCELLENT_UP_4,@SCORE_GOOD_LOW_4,
					@SCORE_GOOD_UP_4,@SCORE_FAIR_LOW_4,@SCORE_FAIR_UP_4,@SCORE_BAD_LOW_4,@SCORE_BAD_UP_4,
					@SCORE_VERYBAD_LOW_4,@SCORE_VERYBAD_UP_4
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CELL'' AND SERVICE=''CS'' AND KPI_NAME=''Drop_call'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW/100,SCORE_EXCELLENT_UP/100,SCORE_GOOD_LOW/100,SCORE_GOOD_UP/100,
				SCORE_FAIR_LOW/100,SCORE_FAIR_UP/100,SCORE_BAD_LOW/100,SCORE_BAD_UP/100,SCORE_VERYBAD_LOW/100,SCORE_VERYBAD_UP/100
				INTO @WEIGHTAGE_5,@SCORE_EXCELLENT_LOW_5,@SCORE_EXCELLENT_UP_5,@SCORE_GOOD_LOW_5,
					@SCORE_GOOD_UP_5,@SCORE_FAIR_LOW_5,@SCORE_FAIR_UP_5,@SCORE_BAD_LOW_5,@SCORE_BAD_UP_5,
					@SCORE_VERYBAD_LOW_5,@SCORE_VERYBAD_UP_5
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CELL'' AND SERVICE=''PS'' AND KPI_NAME=''Block_call'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW/100,SCORE_EXCELLENT_UP/100,SCORE_GOOD_LOW/100,SCORE_GOOD_UP/100,
				SCORE_FAIR_LOW/100,SCORE_FAIR_UP/100,SCORE_BAD_LOW/100,SCORE_BAD_UP/100,SCORE_VERYBAD_LOW/100,SCORE_VERYBAD_UP/100
				INTO @WEIGHTAGE_6,@SCORE_EXCELLENT_LOW_6,@SCORE_EXCELLENT_UP_6,@SCORE_GOOD_LOW_6,
					@SCORE_GOOD_UP_6,@SCORE_FAIR_LOW_6,@SCORE_FAIR_UP_6,@SCORE_BAD_LOW_6,@SCORE_BAD_UP_6,
					@SCORE_VERYBAD_LOW_6,@SCORE_VERYBAD_UP_6
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CELL'' AND SERVICE=''PS'' AND KPI_NAME=''CSSR'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW/100,SCORE_EXCELLENT_UP/100,SCORE_GOOD_LOW/100,SCORE_GOOD_UP/100,
				SCORE_FAIR_LOW/100,SCORE_FAIR_UP/100,SCORE_BAD_LOW/100,SCORE_BAD_UP/100,SCORE_VERYBAD_LOW/100,SCORE_VERYBAD_UP/100
				INTO @WEIGHTAGE_7,@SCORE_EXCELLENT_LOW_7,@SCORE_EXCELLENT_UP_7,@SCORE_GOOD_LOW_7,
					@SCORE_GOOD_UP_7,@SCORE_FAIR_LOW_7,@SCORE_FAIR_UP_7,@SCORE_BAD_LOW_7,@SCORE_BAD_UP_7,
					@SCORE_VERYBAD_LOW_7,@SCORE_VERYBAD_UP_7
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CELL'' AND SERVICE=''PS'' AND KPI_NAME=''Drop_call'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_8,@SCORE_EXCELLENT_LOW_8,@SCORE_EXCELLENT_UP_8,@SCORE_GOOD_LOW_8,
					@SCORE_GOOD_UP_8,@SCORE_FAIR_LOW_8,@SCORE_FAIR_UP_8,@SCORE_BAD_LOW_8,@SCORE_BAD_UP_8,
					@SCORE_VERYBAD_LOW_8,@SCORE_VERYBAD_UP_8
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CELL'' AND SERVICE=''PS'' AND KPI_NAME=''DL_throughput'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_9,@SCORE_EXCELLENT_LOW_9,@SCORE_EXCELLENT_UP_9,@SCORE_GOOD_LOW_9,
					@SCORE_GOOD_UP_9,@SCORE_FAIR_LOW_9,@SCORE_FAIR_UP_9,@SCORE_BAD_LOW_9,@SCORE_BAD_UP_9,
					@SCORE_VERYBAD_LOW_9,@SCORE_VERYBAD_UP_9
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CELL'' AND SERVICE=''COVERAGE/QUALITY'' AND KPI_NAME=''RXLEV_Sub'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_10,@SCORE_EXCELLENT_LOW_10,@SCORE_EXCELLENT_UP_10,@SCORE_GOOD_LOW_10,
					@SCORE_GOOD_UP_10,@SCORE_FAIR_LOW_10,@SCORE_FAIR_UP_10,@SCORE_BAD_LOW_10,@SCORE_BAD_UP_10,
					@SCORE_VERYBAD_LOW_10,@SCORE_VERYBAD_UP_10
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CELL'' AND SERVICE=''COVERAGE/QUALITY'' AND KPI_NAME=''RXQUAL'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_11,@SCORE_EXCELLENT_LOW_11,@SCORE_EXCELLENT_UP_11,@SCORE_GOOD_LOW_11,
					@SCORE_GOOD_UP_11,@SCORE_FAIR_LOW_11,@SCORE_FAIR_UP_11,@SCORE_BAD_LOW_11,@SCORE_BAD_UP_11,
					@SCORE_VERYBAD_LOW_11,@SCORE_VERYBAD_UP_11
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CELL'' AND SERVICE=''COVERAGE/QUALITY'' AND KPI_NAME=''RSCP'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_12,@SCORE_EXCELLENT_LOW_12,@SCORE_EXCELLENT_UP_12,@SCORE_GOOD_LOW_12,
					@SCORE_GOOD_UP_12,@SCORE_FAIR_LOW_12,@SCORE_FAIR_UP_12,@SCORE_BAD_LOW_12,@SCORE_BAD_UP_12,
					@SCORE_VERYBAD_LOW_12,@SCORE_VERYBAD_UP_12
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CELL'' AND SERVICE=''COVERAGE/QUALITY'' AND KPI_NAME=''EcNo'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_13,@SCORE_EXCELLENT_LOW_13,@SCORE_EXCELLENT_UP_13,@SCORE_GOOD_LOW_13,
					@SCORE_GOOD_UP_13,@SCORE_FAIR_LOW_13,@SCORE_FAIR_UP_13,@SCORE_BAD_LOW_13,@SCORE_BAD_UP_13,
					@SCORE_VERYBAD_LOW_13,@SCORE_VERYBAD_UP_13
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CELL'' AND SERVICE=''COVERAGE/QUALITY'' AND KPI_NAME=''RSRP'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT WEIGHTAGE,SCORE_EXCELLENT_LOW,SCORE_EXCELLENT_UP,SCORE_GOOD_LOW,SCORE_GOOD_UP,
				SCORE_FAIR_LOW,SCORE_FAIR_UP,SCORE_BAD_LOW,SCORE_BAD_UP,SCORE_VERYBAD_LOW,SCORE_VERYBAD_UP
				INTO @WEIGHTAGE_14,@SCORE_EXCELLENT_LOW_14,@SCORE_EXCELLENT_UP_14,@SCORE_GOOD_LOW_14,
					@SCORE_GOOD_UP_14,@SCORE_FAIR_LOW_14,@SCORE_FAIR_UP_14,@SCORE_BAD_LOW_14,@SCORE_BAD_UP_14,
					@SCORE_VERYBAD_LOW_14,@SCORE_VERYBAD_UP_14
				FROM ',gt_global_statistic,'.qv_cto_threshold
				WHERE KIND=''CELL'' AND SERVICE=''COVERAGE/QUALITY'' AND KPI_NAME=''RSRQ'' ;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
	
		SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.TMP_cto_dashboard_cell;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('CREATE TEMPORARY TABLE ',gt_global_statistic,'.tmp_cto_dashboard_cell
                                 (Network_Element mediumint(9) NOT NULL ,
				  SITE_ID mediumint(9) NOT NULL ,
				  Cell_ID mediumint(9) NOT NULL ,
				  BLOCK_VOICE_CNT_GSM int(11) NOT NULL ,
				  BLOCK_VOICE_CNT_UMTS int(11) NOT NULL ,
				  SF_VOICE_CNT_GSM int(11) NOT NULL ,
				  SF_VOICE_CNT_UMTS int(11) NOT NULL ,
				  VOICE_CNT_GSM int(11) NOT NULL ,
				  VOICE_CNT_UMTS int(11) NOT NULL ,
				 CALL_SETUP_TIME_SUM_GSM int(11) NOT NULL , 
				 CALL_SETUP_TIME_SUM_UMTS int(11) NOT NULL ,
				 CALL_SETUP_TIME_CNT_GSM int(11) NOT NULL ,
				 CALL_SETUP_TIME_CNT_UMTS int(11) NOT NULL ,
				 DROP_VOICE_CNT_GSM int(11) NOT NULL , 
				 DROP_VOICE_CNT_UMTS int(11) NOT NULL , 
				BLOCK_GPRS_CNT int(11) NOT NULL ,
	                        BLOCK_R99_CNT  int(11) NOT NULL ,
	                        BLOCK_HSPA_CNT int(11) NOT NULL ,
	                        BLOCK_MRAB_CNT int(11) NOT NULL ,
	                        BLOCK_PS_OTHER_CNT int(11) NOT NULL ,
				BLOCK_DATA_CNT int(11) NOT NULL ,
				BLOCK_SIGNAL_CNT int(11) NOT NULL ,
				BLOCK_SMS_CNT int(11) NOT NULL ,
				BLOCK_VOLTE_CNT int(11) NOT NULL ,
				BLOCK_UNSPECIFIED_CNT int(11) NOT NULL ,
	                        GPRS_CNT int(11) NOT NULL ,
				PS_R99_CNT int(11) NOT NULL ,
				PS_HSPA_CNT int(11) NOT NULL ,
				M_RAB_CNT int(11) NOT NULL ,
				PS_OTHER_CNT int(11) NOT NULL ,
				SIGNAL_CNT int(11) NOT NULL ,
				DATA_CNT int(11) NOT NULL ,
				SMS_CNT int(11) NOT NULL ,
				VOLTE_CNT int(11) NOT NULL ,
				UNSPECIFIED_CNT int(11) NOT NULL ,
				SF_DATA_CNT_GSM int(11) NOT NULL ,
	                        SF_R99_CNT int(11) NOT NULL ,
	                        SF_HSPA_CNT int(11) NOT NULL ,
	                        SF_MRAB_CNT int(11) NOT NULL ,
	                        SF_OTHER_CNT int(11) NOT NULL ,
	                        SF_DATA_CNT_LTE int(11) NOT NULL ,
				SF_SIGNAL_CNT int(11) NOT NULL ,
				SF_SMS_CNT int(11) NOT NULL ,
				SF_VOLTE_CNT int(11) NOT NULL ,
				SF_UNSPECIFIED_CNT int(11) NOT NULL ,
	                        DROP_GPRS_CNT int(11) NOT NULL ,
	                        DROP_PS_R99_CNT int(11) NOT NULL ,
	                        DROP_PS_HSPA_CNT int(11) NOT NULL ,
	                        DROP_M_RAB_CNT int(11) NOT NULL ,
	                        DROP_PS_OTHER_CNT int(11) NOT NULL ,
	                        DROP_SIGNAL_CNT int(11) NOT NULL ,
				DROP_DATA_CNT int(11) NOT NULL ,
				DROP_SMS_CNT int(11) NOT NULL ,
				DROP_VOLTE_CNT int(11) NOT NULL ,
				DROP_UNSPECIFIED_CNT int(11) NOT NULL ,
	                        DL_THROUPUT_SUM_UMTS int(11) NOT NULL ,
				DL_THROUPUT_SUM_LTE int(11) NOT NULL ,
				DL_THROUPUT_CNT_UMTS int(11) NOT NULL ,
				DL_THROUPUT_CNT_LTE int(11) NOT NULL ,
				RXLEV_SUM int(11) NOT NULL ,
				RXLEV_CNT int(11) NOT NULL ,
				RXQUAL_SUM int(11) NOT NULL ,
				RXQUAL_CNT int(11) NOT NULL ,
				RSCP_SUM int(11) NOT NULL ,
				RSCP_CNT int(11) NOT NULL ,
				ECN0_SUM int(11) NOT NULL ,
				ECN0_CNT int(11) NOT NULL ,
				RSRP_SUM int(11) NOT NULL ,
				RSRP_CNT int(11) NOT NULL ,
				RSRQ_SUM int(11) NOT NULL ,
				RSRQ_CNT int(11) NOT NULL 
				)ENGINE = MyISAM;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		
	
		SET @SqlCmd=CONCAT('INSERT INTO ',gt_global_statistic,'.tmp_cto_dashboard_cell(
					Network_Element,SITE_ID,Cell_ID,
					BLOCK_VOICE_CNT_GSM,BLOCK_VOICE_CNT_UMTS,SF_VOICE_CNT_GSM,SF_VOICE_CNT_UMTS,
					VOICE_CNT_GSM, VOICE_CNT_UMTS,CALL_SETUP_TIME_SUM_GSM,  CALL_SETUP_TIME_SUM_UMTS,
					CALL_SETUP_TIME_CNT_GSM,CALL_SETUP_TIME_CNT_UMTS,DROP_VOICE_CNT_GSM, DROP_VOICE_CNT_UMTS, 
					BLOCK_GPRS_CNT,BLOCK_R99_CNT, BLOCK_HSPA_CNT, BLOCK_MRAB_CNT, BLOCK_PS_OTHER_CNT,
					BLOCK_DATA_CNT,BLOCK_SIGNAL_CNT,BLOCK_SMS_CNT,BLOCK_VOLTE_CNT,BLOCK_UNSPECIFIED_CNT,
					GPRS_CNT,PS_R99_CNT,PS_HSPA_CNT,M_RAB_CNT,PS_OTHER_CNT,SIGNAL_CNT,DATA_CNT,SMS_CNT,
					VOLTE_CNT,UNSPECIFIED_CNT,SF_DATA_CNT_GSM,SF_R99_CNT, SF_HSPA_CNT,SF_MRAB_CNT,
					SF_OTHER_CNT,  SF_DATA_CNT_LTE,SF_SIGNAL_CNT,SF_SMS_CNT,SF_VOLTE_CNT,SF_UNSPECIFIED_CNT,             
					DROP_GPRS_CNT,DROP_PS_R99_CNT, DROP_PS_HSPA_CNT, DROP_M_RAB_CNT, DROP_PS_OTHER_CNT,
					DROP_SIGNAL_CNT,DROP_DATA_CNT,DROP_SMS_CNT,DROP_VOLTE_CNT,DROP_UNSPECIFIED_CNT,
					DL_THROUPUT_SUM_UMTS,DL_THROUPUT_SUM_LTE,DL_THROUPUT_CNT_UMTS,DL_THROUPUT_CNT_LTE,
					RXLEV_SUM,RXLEV_CNT,RXQUAL_SUM,RXQUAL_CNT,RSCP_SUM,RSCP_CNT,ECN0_SUM,ECN0_CNT,
					RSRP_SUM,RSRP_CNT,RSRQ_SUM,RSRQ_CNT 
				 )
	
				SELECT  Network_Element,SITE_ID,Cell_ID,
					SUM(BLOCK_VOICE_CNT_GSM) AS BLOCK_VOICE_CNT_GSM,SUM(BLOCK_VOICE_CNT_UMTS) AS BLOCK_VOICE_CNT_UMTS,
					SUM(SF_VOICE_CNT_GSM) AS SF_VOICE_CNT_GSM,SUM(SF_VOICE_CNT_UMTS) AS SF_VOICE_CNT_UMTS,
					SUM(VOICE_CNT_GSM) AS VOICE_CNT_GSM,SUM(VOICE_CNT_UMTS) AS VOICE_CNT_UMTS,
					SUM(CALL_SETUP_TIME_SUM_GSM) AS CALL_SETUP_TIME_SUM_GSM,SUM(CALL_SETUP_TIME_SUM_UMTS) AS CALL_SETUP_TIME_SUM_UMTS,
					SUM(CALL_SETUP_TIME_CNT_GSM) AS CALL_SETUP_TIME_CNT_GSM,SUM(CALL_SETUP_TIME_CNT_UMTS) AS CALL_SETUP_TIME_CNT_UMTS,
					SUM(DROP_VOICE_CNT_GSM) AS DROP_VOICE_CNT_GSM,SUM(DROP_VOICE_CNT_UMTS) AS DROP_VOICE_CNT_UMTS, 
					SUM(BLOCK_GPRS_CNT) AS BLOCK_GPRS_CNT,SUM(BLOCK_R99_CNT) AS BLOCK_R99_CNT,SUM(BLOCK_HSPA_CNT) AS BLOCK_HSPA_CNT,
					SUM(BLOCK_MRAB_CNT) AS BLOCK_MRAB_CNT,SUM(BLOCK_PS_OTHER_CNT) AS BLOCK_PS_OTHER_CNT,
					SUM(BLOCK_DATA_CNT) AS BLOCK_DATA_CNT,SUM(BLOCK_SIGNAL_CNT) AS BLOCK_SIGNAL_CNT,SUM(BLOCK_SMS_CNT) AS BLOCK_SMS_CNT,
					SUM(BLOCK_VOLTE_CNT) AS BLOCK_VOLTE_CNT,SUM(BLOCK_UNSPECIFIED_CNT) AS BLOCK_UNSPECIFIED_CNT,
					SUM(GPRS_CNT) AS GPRS_CNT,SUM(PS_R99_CNT) AS PS_R99_CNT,SUM(PS_HSPA_CNT) AS PS_HSPA_CNT,
					SUM(M_RAB_CNT) AS M_RAB_CNT,SUM(PS_OTHER_CNT) AS PS_OTHER_CNT,SUM(SIGNAL_CNT) AS SIGNAL_CNT,SUM(DATA_CNT) AS DATA_CNT,
					SUM(SMS_CNT) AS SMS_CNT,SUM(VOLTE_CNT) AS VOLTE_CNT,SUM(UNSPECIFIED_CNT) AS UNSPECIFIED_CNT,
					SUM(SF_DATA_CNT_GSM) AS SF_DATA_CNT_GSM,SUM(SF_R99_CNT) AS SF_R99_CNT,SUM(SF_HSPA_CNT) AS SF_HSPA_CNT,
					SUM(SF_MRAB_CNT) AS SF_MRAB_CNT,SUM(SF_OTHER_CNT) AS SF_OTHER_CNT,SUM(SF_DATA_CNT_LTE) AS SF_DATA_CNT_LTE,
					SUM(SF_SIGNAL_CNT) AS SF_SIGNAL_CNT,SUM(SF_SMS_CNT) AS SF_SMS_CNT,SUM(SF_VOLTE_CNT) AS SF_VOLTE_CNT,
					SUM(SF_UNSPECIFIED_CNT) AS SF_UNSPECIFIED_CNT,SUM(DROP_GPRS_CNT) AS DROP_GPRS_CNT,SUM(DROP_PS_R99_CNT) AS DROP_PS_R99_CNT,           
					SUM(DROP_PS_HSPA_CNT) AS DROP_PS_HSPA_CNT,SUM(DROP_M_RAB_CNT) AS DROP_M_RAB_CNT,SUM(DROP_PS_OTHER_CNT) AS DROP_PS_OTHER_CNT,
					SUM(DROP_SIGNAL_CNT) AS DROP_SIGNAL_CNT,SUM(DROP_DATA_CNT) AS DROP_DATA_CNT,SUM(DROP_SMS_CNT) AS DROP_SMS_CNT,
					SUM(DROP_VOLTE_CNT) AS DROP_VOLTE_CNT,SUM(DROP_UNSPECIFIED_CNT) AS DROP_UNSPECIFIED_CNT,
					SUM(DL_THROUPUT_SUM_UMTS) AS DL_THROUPUT_SUM_UMTS,SUM(DL_THROUPUT_SUM_LTE) AS DL_THROUPUT_SUM_LTE,
					SUM(DL_THROUPUT_CNT_UMTS) AS DL_THROUPUT_CNT_UMTS,SUM(DL_THROUPUT_CNT_LTE) AS DL_THROUPUT_CNT_LTE,
					SUM(RXLEV_SUM) AS RXLEV_SUM,SUM(RXLEV_CNT) AS RXLEV_CNT,SUM(RXQUAL_SUM) AS RXQUAL_SUM,SUM(RXQUAL_CNT) AS RXQUAL_CNT,
					SUM(RSCP_SUM) AS RSCP_SUM,SUM(RSCP_CNT) AS RSCP_CNT,SUM(ECN0_SUM) AS ECN0_SUM,SUM(ECN0_CNT) AS ECN0_CNT,
					SUM(RSRP_SUM) AS RSRP_SUM,SUM(RSRP_CNT) AS RSRP_CNT,SUM(RSRQ_SUM) AS RSRQ_SUM,SUM(RSRQ_CNT) AS  RSRQ_CNT 
				FROM(
				SELECT  
					BSC_ID AS `Network_Element`,SITE_ID AS `SITE_ID`,CELL_ID AS `CELL_ID`,
					BLOCK_VOICE_CNT AS `BLOCK_VOICE_CNT_GSM`,NULL AS `BLOCK_VOICE_CNT_UMTS`,
					SF_VOICE_CNT AS `SF_VOICE_CNT_GSM`,NULL AS `SF_VOICE_CNT_UMTS`,
					VOICE_CNT AS `VOICE_CNT_GSM`,NULL AS `VOICE_CNT_UMTS`,
					CALL_SETUP_TIME_SUM AS `CALL_SETUP_TIME_SUM_GSM`,NULL AS `CALL_SETUP_TIME_SUM_UMTS`,
					CALL_SETUP_TIME_CNT AS `CALL_SETUP_TIME_CNT_GSM`,NULL AS `CALL_SETUP_TIME_CNT_UMTS`,
					DROP_VOICE_CNT AS `DROP_VOICE_CNT_GSM`,NULL AS `DROP_VOICE_CNT_UMTS`,
					BLOCK_GPRS_CNT AS `BLOCK_GPRS_CNT`,NULL AS BLOCK_R99_CNT,NULL AS BLOCK_HSPA_CNT,
					NULL AS `BLOCK_MRAB_CNT`,NULL AS `BLOCK_PS_OTHER_CNT`,NULL AS `BLOCK_DATA_CNT`,
					NULL AS `BLOCK_SIGNAL_CNT`,NULL AS `BLOCK_SMS_CNT`,NULL AS `BLOCK_VOLTE_CNT`,
					NULL AS `BLOCK_UNSPECIFIED_CNT`,GPRS_CNT AS `GPRS_CNT`,NULL AS `PS_R99_CNT`,
					NULL AS `PS_HSPA_CNT`,NULL AS `M_RAB_CNT`,NULL AS `PS_OTHER_CNT`,NULL AS `SIGNAL_CNT`,
					NULL AS `DATA_CNT`,NULL AS `SMS_CNT`,NULL AS `VOLTE_CNT`,NULL AS `UNSPECIFIED_CNT`,
					SF_DATA_CNT AS `SF_DATA_CNT_GSM`,NULL AS `SF_R99_CNT`,NULL AS `SF_HSPA_CNT`,
					NULL AS `SF_MRAB_CNT`,NULL AS `SF_OTHER_CNT`,NULL AS `SF_DATA_CNT_LTE`,
					NULL AS `SF_SIGNAL_CNT`,NULL AS `SF_SMS_CNT`,NULL AS `SF_VOLTE_CNT`,
					NULL AS `SF_UNSPECIFIED_CNT`,DROP_GPRS_CNT AS `DROP_GPRS_CNT`,NULL AS `DROP_PS_R99_CNT`,
					NULL AS `DROP_PS_HSPA_CNT`,NULL AS `DROP_M_RAB_CNT`,NULL AS `DROP_PS_OTHER_CNT`,
					NULL AS `DROP_SIGNAL_CNT`,NULL AS `DROP_DATA_CNT`,NULL AS `DROP_SMS_CNT`,
					NULL AS `DROP_VOLTE_CNT`,NULL AS `DROP_UNSPECIFIED_CNT`,
					NULL AS `DL_THROUPUT_SUM_UMTS`,NULL AS `DL_THROUPUT_SUM_LTE`,
					NULL AS `DL_THROUPUT_CNT_UMTS`,NULL AS `DL_THROUPUT_CNT_LTE`,
					RXLEV_SUM AS `RXLEV_SUM`,RXLEV_CNT AS `RXLEV_CNT`,RXQUAL_SUM AS `RXQUAL_SUM`,RXQUAL_CNT AS `RXQUAL_CNT`,
					NULL AS `RSCP_SUM`,NULL AS `RSCP_CNT`,NULL AS `ECN0_SUM`,NULL AS `ECN0_CNT`,
					NULL AS `RSRP_SUM`,NULL AS `RSRP_CNT`,NULL AS `RSRQ_SUM`,NULL AS `RSRQ_CNT`
				
					
				FROM ',gt_global_statistic_g1,'.table_cell_agg_gsm_dy_',DATA_DATE,'
				UNION
				SELECT  RNC_ID AS `Network_Element`,SITE_ID AS `SITE_ID`,Cell_ID AS `Cell_ID`,
					NULL AS `BLOCK_VOICE_CNT_GSM`,BLOCK_VOICE_CNT AS `BLOCK_VOICE_CNT_UMTS`,NULL AS `SF_VOICE_CNT_GSM`,SF_VOICE_CNT AS `SF_VOICE_CNT_UMTS`,
					NULL AS `VOICE_CNT_GSM`,VOICE_CNT AS `VOICE_CNT_UMTS`,NULL AS `CALL_SETUP_TIME_SUM_GSM`,CALL_SETUP_TIME_SUM AS `CALL_SETUP_TIME_SUM_UMTS`,
					NULL AS `CALL_SETUP_TIME_CNT_GSM`,CALL_SETUP_TIME_CNT AS `CALL_SETUP_TIME_CNT_UMTS`,NULL AS `DROP_VOICE_CNT_GSM`,DROP_VOICE_CNT AS `DROP_VOICE_CNT_UMTS`, 
					NULL AS `BLOCK_GPRS_CNT`,BLOCK_R99_CNT AS `BLOCK_R99_CNT`,BLOCK_HSPA_CNT AS `BLOCK_HSPA_CNT`,BLOCK_MRAB_CNT AS `BLOCK_MRAB_CNT`,BLOCK_PS_OTHER_CNT AS `BLOCK_PS_OTHER_CNT`,
					NULL AS `BLOCK_DATA_CNT`,NULL AS `BLOCK_SIGNAL_CNT`,NULL AS `BLOCK_SMS_CNT`,NULL AS `BLOCK_VOLTE_CNT`,NULL AS `BLOCK_UNSPECIFIED_CNT`,
					NULL AS `GPRS_CNT`,PS_R99_CNT AS `PS_R99_CNT`,PS_HSPA_CNT AS `PS_HSPA_CNT`,M_RAB_CNT AS `M_RAB_CNT`,PS_OTHER_CNT AS `PS_OTHER_CNT`,NULL AS `SIGNAL_CNT`,NULL AS `DATA_CNT`,NULL AS `SMS_CNT`,
					NULL AS `VOLTE_CNT`,NULL AS `UNSPECIFIED_CNT`,NULL AS `SF_DATA_CNT_GSM`,SF_R99_CNT AS `SF_R99_CNT`,SF_HSPA_CNT AS `SF_HSPA_CNT`,SF_MRAB_CNT AS `SF_MRAB_CNT`,
					SF_OTHER_CNT AS `SF_OTHER_CNT`,NULL AS `SF_DATA_CNT_LTE`,NULL AS `SF_SIGNAL_CNT`,NULL AS `SF_SMS_CNT`,NULL AS `SF_VOLTE_CNT`,NULL AS `SF_UNSPECIFIED_CNT`,             
					NULL AS `DROP_GPRS_CNT`,DROP_PS_R99_CNT AS `DROP_PS_R99_CNT`,DROP_PS_HSPA_CNT AS `DROP_PS_HSPA_CNT`,DROP_M_RAB_CNT AS `DROP_M_RAB_CNT`,DROP_PS_OTHER_CNT AS `DROP_PS_OTHER_CNT`,
					NULL AS `DROP_SIGNAL_CNT`,NULL AS `DROP_DATA_CNT`,NULL AS `DROP_SMS_CNT`,NULL AS `DROP_VOLTE_CNT`,NULL AS `DROP_UNSPECIFIED_CNT`,
					DL_THROUPUT_SUM AS `DL_THROUPUT_SUM_UMTS`,NULL AS `DL_THROUPUT_SUM_LTE`,DL_THROUPUT_CNT AS `DL_THROUPUT_CNT_UMTS`,NULL AS `DL_THROUPUT_CNT_LTE`,
					NULL AS `RXLEV_SUM`,NULL AS `RXLEV_CNT`,NULL AS `RXQUAL_SUM`,NULL AS `RXQUAL_CNT`,RSCP_SUM AS `RSCP_SUM`,RSCP_CNT AS `RSCP_CNT`,ECN0_SUM AS `ECN0_SUM`,ECN0_CNT AS `ECN0_CNT`,
					NULL AS `RSRP_SUM`,NULL AS `RSRP_CNT`,NULL AS `RSRQ_SUM`,NULL AS `RSRQ_CNT` 
				FROM ',gt_global_statistic_g1,'.table_cell_agg_umts_dy_',DATA_DATE,'
				UNION
				SELECT  PU_ID AS `Network_Element`,ENODEB_ID AS `SITE_ID`,CELL_ID AS `CELL_ID`,
					NULL AS `BLOCK_VOICE_CNT_GSM`,NULL AS `BLOCK_VOICE_CNT_UMTS`,NULL AS `SF_VOICE_CNT_GSM`,NULL AS `SF_VOICE_CNT_UMTS`,
					NULL AS `VOICE_CNT_GSM`,NULL AS `VOICE_CNT_UMTS`,NULL AS `CALL_SETUP_TIME_SUM_GSM`,NULL AS `CALL_SETUP_TIME_SUM_UMTS`,
					NULL AS `CALL_SETUP_TIME_CNT_GSM`,NULL AS `CALL_SETUP_TIME_CNT_UMTS`,NULL AS `DROP_VOICE_CNT_GSM`,NULL AS `DROP_VOICE_CNT_UMTS`, 
					NULL AS `BLOCK_GPRS_CNT`,NULL AS `BLOCK_R99_CNT`,NULL AS `BLOCK_HSPA_CNT`,NULL AS `BLOCK_MRAB_CNT`,NULL AS `BLOCK_PS_OTHER_CNT`,
					BLOCK_DATA_CNT AS `BLOCK_DATA_CNT`,BLOCK_SIGNAL_CNT AS `BLOCK_SIGNAL_CNT`,BLOCK_SMS_CNT AS `BLOCK_SMS_CNT`,BLOCK_VOLTE_CNT AS `BLOCK_VOLTE_CNT`,
					BLOCK_UNSPECIFIED_CNT AS `BLOCK_UNSPECIFIED_CNT`,
					NULL AS `GPRS_CNT`,NULL AS `PS_R99_CNT`,NULL AS `PS_HSPA_CNT`,NULL AS `M_RAB_CNT`,NULL AS `PS_OTHER_CNT`,SIGNAL_CNT AS `SIGNAL_CNT`,DATA_CNT AS `DATA_CNT`,SMS_CNT AS `SMS_CNT`,
					VOLTE_CNT AS `VOLTE_CNT`,UNSPECIFIED_CNT AS `UNSPECIFIED_CNT`,NULL AS `SF_DATA_CNT_GSM`,NULL AS `SF_R99_CNT`,NULL AS `SF_HSPA_CNT`,NULL AS `SF_MRAB_CNT`,
					NULL AS `SF_OTHER_CNT`,SF_DATA_CNT AS `SF_DATA_CNT_LTE`,SF_SIGNAL_CNT AS `SF_SIGNAL_CNT`,SF_SMS_CNT AS `SF_SMS_CNT`,SF_VOLTE_CNT AS `SF_VOLTE_CNT`,SF_UNSPECIFIED_CNT AS `SF_UNSPECIFIED_CNT`,             
					NULL AS `DROP_GPRS_CNT`,NULL AS `DROP_PS_R99_CNT`,NULL AS `DROP_PS_HSPA_CNT`,NULL AS `DROP_M_RAB_CNT`,NULL AS `DROP_PS_OTHER_CNT`,
					DROP_SIGNAL_CNT AS `DROP_SIGNAL_CNT`,DROP_DATA_CNT AS `DROP_DATA_CNT`,DROP_SMS_CNT AS `DROP_SMS_CNT`,DROP_VOLTE_CNT AS `DROP_VOLTE_CNT`,DROP_UNSPECIFIED_CNT AS `DROP_UNSPECIFIED_CNT`,
					NULL AS `DL_THROUPUT_SUM_UMTS`,DL_THROUPUT_SUM AS `DL_THROUPUT_SUM_LTE`,NULL AS `DL_THROUPUT_CNT_UMTS`,DL_THROUPUT_CNT AS `DL_THROUPUT_CNT_LTE`,
					NULL AS `RXLEV_SUM`,NULL AS `RXLEV_CNT`,NULL AS `RXQUAL_SUM`,NULL AS `RXQUAL_CNT`,NULL AS `RSCP_SUM`,NULL AS `RSCP_CNT`,NULL AS `ECN0_SUM`,NULL AS `ECN0_CNT`,
					RSRP_SUM AS `RSRP_SUM`,RSRP_CNT AS `RSRP_CNT`,RSRQ_SUM AS `RSRQ_SUM`,RSRQ_CNT AS `RSRQ_CNT`
				FROM ',gt_global_statistic_g1,'.table_cell_agg_lte_dy_',DATA_DATE,'
				)A	
				GROUP BY Network_Element,SITE_ID,Cell_ID 
				ORDER BY NULL;');
	
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
	
		SET @SqlCmd=CONCAT('TRUNCATE TABLE ',gt_global_statistic,'.qv_cto_dashboard_cell;');		
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
			
	
		SET @SqlCmd=CONCAT('
				INSERT INTO ',gt_global_statistic,'.qv_cto_dashboard_cell(Network_Element_SITE_ID_Cell_ID,Voice_CS_Block_call_original,Voice_CS_Block_call_score,Voice_CS_CSSR_original,Voice_CS_CSSR_score,Voice_CS_CALL_SET_UP_TIME_original,Voice_CS_CALL_SET_UP_TIME_score,
					Voice_CS_Drop_calls_original,Voice_CS_Drop_calls_score,Data_PS_Blocl_call_original,Data_PS_Blocl_call_score,
					Data_PS_CSSR_original,Data_PS_CSSR_score,Data_PS_Drop_calls_original,Data_PS_Drop_calls_score,Data_PS_Throughput_original,Data_PS_Throughput_score,
					Coverage_Quality_2G_coverage_original,Coverage_Quality_2G_coverage_score,Coverage_Quality_2G_Quality_original,Coverage_Quality_2G_Quality_score,
					Coverage_Quality_3G_Coverage_original,Coverage_Quality_3G_Coverage_score,Coverage_Quality_3G_Quality_original,Coverage_Quality_3G_Quality_score,
					Coverage_Quality_4G_coverage_original,Coverage_Quality_4G_coverage_score,Coverage_Quality_4G_Quality_original,Coverage_Quality_4G_Quality_score
					)
					SELECT 
					CONCAT(Network_Element,''_'',SITE_ID,''_'',CELL_ID),
					(BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_UMTS)/(VOICE_CNT_GSM+VOICE_CNT_UMTS),
					(CASE 
					WHEN (BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_UMTS)/(VOICE_CNT_GSM+VOICE_CNT_UMTS) BETWEEN ',@SCORE_EXCELLENT_LOW_1,' AND ',@SCORE_EXCELLENT_UP_1,' THEN ''5''
					WHEN (BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_UMTS)/(VOICE_CNT_GSM+VOICE_CNT_UMTS) BETWEEN ',@SCORE_GOOD_LOW_1,' AND ',@SCORE_GOOD_UP_1,' THEN ''4''
					WHEN (BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_UMTS)/(VOICE_CNT_GSM+VOICE_CNT_UMTS) BETWEEN ',@SCORE_FAIR_LOW_1,' AND ',@SCORE_FAIR_UP_1,' THEN ''3''
					WHEN (BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_UMTS)/(VOICE_CNT_GSM+VOICE_CNT_UMTS) BETWEEN ',@SCORE_BAD_LOW_1,' AND ',@SCORE_BAD_UP_1,' THEN ''2''
					WHEN (BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_UMTS)/(VOICE_CNT_GSM+VOICE_CNT_UMTS) >=',@SCORE_VERYBAD_UP_1,' THEN ''1''
					ELSE ''5'' END)  AS Voice_CS_Block_call_score,
	
					1-((SF_VOICE_CNT_GSM+SF_VOICE_CNT_UMTS+BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_UMTS)/(VOICE_CNT_GSM+VOICE_CNT_UMTS)),
					(CASE 
					WHEN (1-((SF_VOICE_CNT_GSM+SF_VOICE_CNT_UMTS+BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_UMTS)/(VOICE_CNT_GSM+VOICE_CNT_UMTS))) BETWEEN ',@SCORE_EXCELLENT_LOW_2,' AND ',@SCORE_EXCELLENT_UP_2,' THEN ''5''
					WHEN (1-((SF_VOICE_CNT_GSM+SF_VOICE_CNT_UMTS+BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_UMTS)/(VOICE_CNT_GSM+VOICE_CNT_UMTS))) BETWEEN ',@SCORE_GOOD_LOW_2,' AND ',@SCORE_GOOD_UP_2,' THEN ''4''
					WHEN (1-((SF_VOICE_CNT_GSM+SF_VOICE_CNT_UMTS+BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_UMTS)/(VOICE_CNT_GSM+VOICE_CNT_UMTS))) BETWEEN ',@SCORE_FAIR_LOW_2,' AND ',@SCORE_FAIR_UP_2,' THEN ''3''
					WHEN (1-((SF_VOICE_CNT_GSM+SF_VOICE_CNT_UMTS+BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_UMTS)/(VOICE_CNT_GSM+VOICE_CNT_UMTS))) BETWEEN ',@SCORE_BAD_LOW_2,' AND ',@SCORE_BAD_UP_2,' THEN ''2''
					WHEN (1-((SF_VOICE_CNT_GSM+SF_VOICE_CNT_UMTS+BLOCK_VOICE_CNT_GSM+BLOCK_VOICE_CNT_UMTS)/(VOICE_CNT_GSM+VOICE_CNT_UMTS))) <= ',@SCORE_VERYBAD_UP_2,' THEN ''1''
					ELSE ''5'' END) AS Voice_CS_CSSR_score,
	
					((CALL_SETUP_TIME_SUM_GSM+CALL_SETUP_TIME_SUM_UMTS)/(CALL_SETUP_TIME_CNT_GSM+CALL_SETUP_TIME_CNT_UMTS))/1000,
					(CASE 
					WHEN ((CALL_SETUP_TIME_SUM_GSM+CALL_SETUP_TIME_SUM_UMTS)/(CALL_SETUP_TIME_CNT_GSM+CALL_SETUP_TIME_CNT_UMTS))/1000 <= ',@SCORE_EXCELLENT_UP_3,' THEN ''5''
					WHEN ((CALL_SETUP_TIME_SUM_GSM+CALL_SETUP_TIME_SUM_UMTS)/(CALL_SETUP_TIME_CNT_GSM+CALL_SETUP_TIME_CNT_UMTS))/1000 BETWEEN ',@SCORE_GOOD_LOW_3,' AND ',@SCORE_GOOD_UP_3,' THEN ''4''
					WHEN ((CALL_SETUP_TIME_SUM_GSM+CALL_SETUP_TIME_SUM_UMTS)/(CALL_SETUP_TIME_CNT_GSM+CALL_SETUP_TIME_CNT_UMTS))/1000 BETWEEN ',@SCORE_FAIR_LOW_3,' AND ',@SCORE_FAIR_UP_3,' THEN ''3''
					WHEN ((CALL_SETUP_TIME_SUM_GSM+CALL_SETUP_TIME_SUM_UMTS)/(CALL_SETUP_TIME_CNT_GSM+CALL_SETUP_TIME_CNT_UMTS))/1000 BETWEEN ',@SCORE_BAD_LOW_3,' AND ',@SCORE_BAD_UP_3,' THEN ''2''
					WHEN ((CALL_SETUP_TIME_SUM_GSM+CALL_SETUP_TIME_SUM_UMTS)/(CALL_SETUP_TIME_CNT_GSM+CALL_SETUP_TIME_CNT_UMTS))/1000 >= ',@SCORE_VERYBAD_UP_3,' THEN ''1''
					ELSE ''5'' END) AS Voice_CS_CALL_SET_UP_TIME_score,
	
					(DROP_VOICE_CNT_GSM+DROP_VOICE_CNT_UMTS)/(VOICE_CNT_GSM+VOICE_CNT_UMTS),
					(CASE 
					WHEN (DROP_VOICE_CNT_GSM+DROP_VOICE_CNT_UMTS)/(VOICE_CNT_GSM+VOICE_CNT_UMTS) BETWEEN ',@SCORE_EXCELLENT_LOW_4,' AND ',@SCORE_EXCELLENT_UP_4,' THEN ''5''
					WHEN (DROP_VOICE_CNT_GSM+DROP_VOICE_CNT_UMTS)/(VOICE_CNT_GSM+VOICE_CNT_UMTS) BETWEEN ',@SCORE_GOOD_LOW_4,' AND ',@SCORE_GOOD_UP_4,' THEN ''4''
					WHEN (DROP_VOICE_CNT_GSM+DROP_VOICE_CNT_UMTS)/(VOICE_CNT_GSM+VOICE_CNT_UMTS) BETWEEN ',@SCORE_FAIR_LOW_4,' AND ',@SCORE_FAIR_UP_4,' THEN ''3''
					WHEN (DROP_VOICE_CNT_GSM+DROP_VOICE_CNT_UMTS)/(VOICE_CNT_GSM+VOICE_CNT_UMTS) BETWEEN ',@SCORE_BAD_LOW_4,' AND ',@SCORE_BAD_UP_4,' THEN ''2''
					WHEN (DROP_VOICE_CNT_GSM+DROP_VOICE_CNT_UMTS)/(VOICE_CNT_GSM+VOICE_CNT_UMTS) >=',@SCORE_VERYBAD_UP_4,' THEN ''1''
					ELSE ''5'' END) AS Voice_CS_Drop_calls_score,
	
					(BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_DATA_CNT+BLOCK_SIGNAL_CNT+BLOCK_SMS_CNT+BLOCK_VOLTE_CNT+BLOCK_UNSPECIFIED_CNT)/(GPRS_CNT+PS_R99_CNT+PS_HSPA_CNT+M_RAB_CNT+PS_OTHER_CNT+SIGNAL_CNT+DATA_CNT+SMS_CNT+VOLTE_CNT+UNSPECIFIED_CNT),
					(CASE 
					WHEN (BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_DATA_CNT+BLOCK_SIGNAL_CNT+BLOCK_SMS_CNT+BLOCK_VOLTE_CNT+BLOCK_UNSPECIFIED_CNT)/(GPRS_CNT+PS_R99_CNT+PS_HSPA_CNT+M_RAB_CNT+PS_OTHER_CNT+SIGNAL_CNT+DATA_CNT+SMS_CNT+VOLTE_CNT+UNSPECIFIED_CNT) <= ',@SCORE_EXCELLENT_UP_5,' THEN ''5''
					WHEN (BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_DATA_CNT+BLOCK_SIGNAL_CNT+BLOCK_SMS_CNT+BLOCK_VOLTE_CNT+BLOCK_UNSPECIFIED_CNT)/(GPRS_CNT+PS_R99_CNT+PS_HSPA_CNT+M_RAB_CNT+PS_OTHER_CNT+SIGNAL_CNT+DATA_CNT+SMS_CNT+VOLTE_CNT+UNSPECIFIED_CNT) BETWEEN ',@SCORE_GOOD_LOW_5,' AND ',@SCORE_GOOD_UP_5,' THEN ''4''
					WHEN (BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_DATA_CNT+BLOCK_SIGNAL_CNT+BLOCK_SMS_CNT+BLOCK_VOLTE_CNT+BLOCK_UNSPECIFIED_CNT)/(GPRS_CNT+PS_R99_CNT+PS_HSPA_CNT+M_RAB_CNT+PS_OTHER_CNT+SIGNAL_CNT+DATA_CNT+SMS_CNT+VOLTE_CNT+UNSPECIFIED_CNT) BETWEEN ',@SCORE_FAIR_LOW_5,' AND ',@SCORE_FAIR_UP_5,' THEN ''3''
					WHEN (BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_DATA_CNT+BLOCK_SIGNAL_CNT+BLOCK_SMS_CNT+BLOCK_VOLTE_CNT+BLOCK_UNSPECIFIED_CNT)/(GPRS_CNT+PS_R99_CNT+PS_HSPA_CNT+M_RAB_CNT+PS_OTHER_CNT+SIGNAL_CNT+DATA_CNT+SMS_CNT+VOLTE_CNT+UNSPECIFIED_CNT) BETWEEN ',@SCORE_BAD_LOW_5,' AND ',@SCORE_BAD_UP_5,' THEN ''2''
					WHEN (BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_DATA_CNT+BLOCK_SIGNAL_CNT+BLOCK_SMS_CNT+BLOCK_VOLTE_CNT+BLOCK_UNSPECIFIED_CNT)/(GPRS_CNT+PS_R99_CNT+PS_HSPA_CNT+M_RAB_CNT+PS_OTHER_CNT+SIGNAL_CNT+DATA_CNT+SMS_CNT+VOLTE_CNT+UNSPECIFIED_CNT) >= ',@SCORE_VERYBAD_UP_5,' THEN ''1''
					ELSE ''5'' END) AS Data_PS_Blocl_call_score,
					
					IFNULL(1-((SF_DATA_CNT_GSM+SF_R99_CNT+SF_HSPA_CNT+SF_MRAB_CNT+SF_OTHER_CNT+SF_DATA_CNT_LTE+SF_SIGNAL_CNT+SF_SMS_CNT+SF_VOLTE_CNT+SF_UNSPECIFIED_CNT+BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_DATA_CNT+BLOCK_SIGNAL_CNT+BLOCK_SMS_CNT+BLOCK_VOLTE_CNT+BLOCK_UNSPECIFIED_CNT)/(GPRS_CNT+PS_R99_CNT+PS_HSPA_CNT+M_RAB_CNT+PS_OTHER_CNT+SIGNAL_CNT+DATA_CNT+SMS_CNT+VOLTE_CNT+UNSPECIFIED_CNT)),''0''),
					(CASE 
					WHEN ((1-((SF_DATA_CNT_GSM+SF_R99_CNT+SF_HSPA_CNT+SF_MRAB_CNT+SF_OTHER_CNT+SF_DATA_CNT_LTE+SF_SIGNAL_CNT+SF_SMS_CNT+SF_VOLTE_CNT+SF_UNSPECIFIED_CNT+BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_DATA_CNT+BLOCK_SIGNAL_CNT+BLOCK_SMS_CNT+BLOCK_VOLTE_CNT+BLOCK_UNSPECIFIED_CNT)/(GPRS_CNT+PS_R99_CNT+PS_HSPA_CNT+M_RAB_CNT+PS_OTHER_CNT+SIGNAL_CNT+DATA_CNT+SMS_CNT+VOLTE_CNT+UNSPECIFIED_CNT)))) >=',@SCORE_EXCELLENT_UP_6,' THEN ''5''
					WHEN ((1-((SF_DATA_CNT_GSM+SF_R99_CNT+SF_HSPA_CNT+SF_MRAB_CNT+SF_OTHER_CNT+SF_DATA_CNT_LTE+SF_SIGNAL_CNT+SF_SMS_CNT+SF_VOLTE_CNT+SF_UNSPECIFIED_CNT+BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_DATA_CNT+BLOCK_SIGNAL_CNT+BLOCK_SMS_CNT+BLOCK_VOLTE_CNT+BLOCK_UNSPECIFIED_CNT)/(GPRS_CNT+PS_R99_CNT+PS_HSPA_CNT+M_RAB_CNT+PS_OTHER_CNT+SIGNAL_CNT+DATA_CNT+SMS_CNT+VOLTE_CNT+UNSPECIFIED_CNT)))) BETWEEN ',@SCORE_GOOD_LOW_6,' AND ',@SCORE_GOOD_UP_6,' THEN ''4''
					WHEN ((1-((SF_DATA_CNT_GSM+SF_R99_CNT+SF_HSPA_CNT+SF_MRAB_CNT+SF_OTHER_CNT+SF_DATA_CNT_LTE+SF_SIGNAL_CNT+SF_SMS_CNT+SF_VOLTE_CNT+SF_UNSPECIFIED_CNT+BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_DATA_CNT+BLOCK_SIGNAL_CNT+BLOCK_SMS_CNT+BLOCK_VOLTE_CNT+BLOCK_UNSPECIFIED_CNT)/(GPRS_CNT+PS_R99_CNT+PS_HSPA_CNT+M_RAB_CNT+PS_OTHER_CNT+SIGNAL_CNT+DATA_CNT+SMS_CNT+VOLTE_CNT+UNSPECIFIED_CNT)))) BETWEEN ',@SCORE_FAIR_LOW_6,' AND ',@SCORE_FAIR_UP_6,'  THEN ''3''
					WHEN ((1-((SF_DATA_CNT_GSM+SF_R99_CNT+SF_HSPA_CNT+SF_MRAB_CNT+SF_OTHER_CNT+SF_DATA_CNT_LTE+SF_SIGNAL_CNT+SF_SMS_CNT+SF_VOLTE_CNT+SF_UNSPECIFIED_CNT+BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_DATA_CNT+BLOCK_SIGNAL_CNT+BLOCK_SMS_CNT+BLOCK_VOLTE_CNT+BLOCK_UNSPECIFIED_CNT)/(GPRS_CNT+PS_R99_CNT+PS_HSPA_CNT+M_RAB_CNT+PS_OTHER_CNT+SIGNAL_CNT+DATA_CNT+SMS_CNT+VOLTE_CNT+UNSPECIFIED_CNT)))) BETWEEN ',@SCORE_BAD_LOW_6,' AND ',@SCORE_BAD_UP_6,' THEN ''2''
					WHEN ((1-((SF_DATA_CNT_GSM+SF_R99_CNT+SF_HSPA_CNT+SF_MRAB_CNT+SF_OTHER_CNT+SF_DATA_CNT_LTE+SF_SIGNAL_CNT+SF_SMS_CNT+SF_VOLTE_CNT+SF_UNSPECIFIED_CNT+BLOCK_GPRS_CNT+BLOCK_R99_CNT+BLOCK_HSPA_CNT+BLOCK_MRAB_CNT+BLOCK_PS_OTHER_CNT+BLOCK_DATA_CNT+BLOCK_SIGNAL_CNT+BLOCK_SMS_CNT+BLOCK_VOLTE_CNT+BLOCK_UNSPECIFIED_CNT)/(GPRS_CNT+PS_R99_CNT+PS_HSPA_CNT+M_RAB_CNT+PS_OTHER_CNT+SIGNAL_CNT+DATA_CNT+SMS_CNT+VOLTE_CNT+UNSPECIFIED_CNT)))) <=',@SCORE_VERYBAD_UP_6,' THEN ''1''
					ELSE ''5'' END) AS Data_PS_CSSR_score, 
	
					(DROP_GPRS_CNT+DROP_PS_R99_CNT+DROP_PS_HSPA_CNT+DROP_M_RAB_CNT+DROP_PS_OTHER_CNT+DROP_SIGNAL_CNT+DROP_DATA_CNT+DROP_SMS_CNT+DROP_VOLTE_CNT+DROP_UNSPECIFIED_CNT)/(GPRS_CNT+PS_R99_CNT+PS_HSPA_CNT+M_RAB_CNT+PS_OTHER_CNT+SIGNAL_CNT+DATA_CNT+SMS_CNT+VOLTE_CNT+UNSPECIFIED_CNT),
					(CASE 
					WHEN (DROP_GPRS_CNT+DROP_PS_R99_CNT+DROP_PS_HSPA_CNT+DROP_M_RAB_CNT+DROP_PS_OTHER_CNT+DROP_SIGNAL_CNT+DROP_DATA_CNT+DROP_SMS_CNT+DROP_VOLTE_CNT+DROP_UNSPECIFIED_CNT)/(GPRS_CNT+PS_R99_CNT+PS_HSPA_CNT+M_RAB_CNT+PS_OTHER_CNT+SIGNAL_CNT+DATA_CNT+SMS_CNT+VOLTE_CNT+UNSPECIFIED_CNT) <=',@SCORE_EXCELLENT_UP_7,' THEN ''5''
					WHEN (DROP_GPRS_CNT+DROP_PS_R99_CNT+DROP_PS_HSPA_CNT+DROP_M_RAB_CNT+DROP_PS_OTHER_CNT+DROP_SIGNAL_CNT+DROP_DATA_CNT+DROP_SMS_CNT+DROP_VOLTE_CNT+DROP_UNSPECIFIED_CNT)/(GPRS_CNT+PS_R99_CNT+PS_HSPA_CNT+M_RAB_CNT+PS_OTHER_CNT+SIGNAL_CNT+DATA_CNT+SMS_CNT+VOLTE_CNT+UNSPECIFIED_CNT)  BETWEEN ',@SCORE_GOOD_LOW_7,' AND ',@SCORE_GOOD_UP_7,' THEN ''4''
					WHEN (DROP_GPRS_CNT+DROP_PS_R99_CNT+DROP_PS_HSPA_CNT+DROP_M_RAB_CNT+DROP_PS_OTHER_CNT+DROP_SIGNAL_CNT+DROP_DATA_CNT+DROP_SMS_CNT+DROP_VOLTE_CNT+DROP_UNSPECIFIED_CNT)/(GPRS_CNT+PS_R99_CNT+PS_HSPA_CNT+M_RAB_CNT+PS_OTHER_CNT+SIGNAL_CNT+DATA_CNT+SMS_CNT+VOLTE_CNT+UNSPECIFIED_CNT)  BETWEEN ',@SCORE_FAIR_LOW_7,' AND ',@SCORE_FAIR_UP_7,' THEN ''3''
					WHEN (DROP_GPRS_CNT+DROP_PS_R99_CNT+DROP_PS_HSPA_CNT+DROP_M_RAB_CNT+DROP_PS_OTHER_CNT+DROP_SIGNAL_CNT+DROP_DATA_CNT+DROP_SMS_CNT+DROP_VOLTE_CNT+DROP_UNSPECIFIED_CNT)/(GPRS_CNT+PS_R99_CNT+PS_HSPA_CNT+M_RAB_CNT+PS_OTHER_CNT+SIGNAL_CNT+DATA_CNT+SMS_CNT+VOLTE_CNT+UNSPECIFIED_CNT)  BETWEEN ',@SCORE_BAD_LOW_7,' AND ',@SCORE_BAD_UP_7,' THEN ''2''
					WHEN (DROP_GPRS_CNT+DROP_PS_R99_CNT+DROP_PS_HSPA_CNT+DROP_M_RAB_CNT+DROP_PS_OTHER_CNT+DROP_SIGNAL_CNT+DROP_DATA_CNT+DROP_SMS_CNT+DROP_VOLTE_CNT+DROP_UNSPECIFIED_CNT)/(GPRS_CNT+PS_R99_CNT+PS_HSPA_CNT+M_RAB_CNT+PS_OTHER_CNT+SIGNAL_CNT+DATA_CNT+SMS_CNT+VOLTE_CNT+UNSPECIFIED_CNT) >= ',@SCORE_VERYBAD_UP_7,' THEN ''1''
					ELSE ''5'' END) AS Data_PS_Drop_calls_score,
	
	
					(((DL_THROUPUT_SUM_UMTS+DL_THROUPUT_SUM_LTE)/(DL_THROUPUT_CNT_UMTS+DL_THROUPUT_CNT_LTE))/1024),
					(CASE 
					WHEN (((DL_THROUPUT_SUM_UMTS+DL_THROUPUT_SUM_LTE)/(DL_THROUPUT_CNT_UMTS+DL_THROUPUT_CNT_LTE))/1024) >= ',@SCORE_EXCELLENT_UP_8,' THEN ''5''
					WHEN (((DL_THROUPUT_SUM_UMTS+DL_THROUPUT_SUM_LTE)/(DL_THROUPUT_CNT_UMTS+DL_THROUPUT_CNT_LTE))/1024)  BETWEEN ',@SCORE_GOOD_LOW_8,' AND ',@SCORE_GOOD_UP_8,' THEN ''4''
					WHEN (((DL_THROUPUT_SUM_UMTS+DL_THROUPUT_SUM_LTE)/(DL_THROUPUT_CNT_UMTS+DL_THROUPUT_CNT_LTE))/1024)  BETWEEN ',@SCORE_FAIR_LOW_8,' AND ',@SCORE_FAIR_UP_8,' THEN ''3''
					WHEN (((DL_THROUPUT_SUM_UMTS+DL_THROUPUT_SUM_LTE)/(DL_THROUPUT_CNT_UMTS+DL_THROUPUT_CNT_LTE))/1024)  BETWEEN ',@SCORE_BAD_LOW_8,' AND ',@SCORE_BAD_UP_8,' THEN ''2''
					WHEN (((DL_THROUPUT_SUM_UMTS+DL_THROUPUT_SUM_LTE)/(DL_THROUPUT_CNT_UMTS+DL_THROUPUT_CNT_LTE))/1024) <= ',@SCORE_VERYBAD_UP_8,' THEN ''1''
					ELSE ''1'' END) AS data_PS_Throughput_score,
	
	
	
					(RXLEV_SUM/RXLEV_CNT),
					(CASE 
					WHEN (RXLEV_SUM/RXLEV_CNT) >=',@SCORE_EXCELLENT_UP_9,' THEN ''5''
					WHEN (RXLEV_SUM/RXLEV_CNT)  BETWEEN ',@SCORE_GOOD_LOW_9,' AND ',@SCORE_GOOD_UP_9,' THEN ''4''
					WHEN (RXLEV_SUM/RXLEV_CNT)  BETWEEN ',@SCORE_FAIR_LOW_9,' AND ',@SCORE_FAIR_UP_9,' THEN ''3''
					WHEN (RXLEV_SUM/RXLEV_CNT)  BETWEEN ',@SCORE_BAD_LOW_9,' AND ',@SCORE_BAD_UP_9,' THEN ''2''
					WHEN (RXLEV_SUM/RXLEV_CNT) <=',@SCORE_VERYBAD_UP_9,' THEN ''1''
					ELSE ''5'' END) AS Coverage_Quality_2G_coverage_score,
					
					(RXQUAL_SUM/RXQUAL_CNT),
					(CASE 
					WHEN (RXQUAL_SUM/RXQUAL_CNT)  BETWEEN ',@SCORE_EXCELLENT_LOW_10,' AND ',@SCORE_EXCELLENT_UP_10,' THEN ''5''
					WHEN (RXQUAL_SUM/RXQUAL_CNT)  BETWEEN ',@SCORE_GOOD_LOW_10,' AND ',@SCORE_GOOD_UP_10,' THEN ''4''
					WHEN (RXQUAL_SUM/RXQUAL_CNT)  BETWEEN ',@SCORE_FAIR_LOW_10,' AND ',@SCORE_FAIR_UP_10,' THEN ''3''
					WHEN (RXQUAL_SUM/RXQUAL_CNT)  BETWEEN ',@SCORE_BAD_LOW_10,' AND ',@SCORE_BAD_UP_10,' THEN ''2''
					WHEN (RXQUAL_SUM/RXQUAL_CNT)  >=',@SCORE_VERYBAD_UP_10,' THEN ''1''
					ELSE ''5'' END) AS Coverage_Quality_2G_Quality_score,
	
					(RSCP_SUM/RSCP_CNT),
					(CASE 
					WHEN (RSCP_SUM/RSCP_CNT) >=',@SCORE_EXCELLENT_UP_11,' THEN ''5''
					WHEN (RSCP_SUM/RSCP_CNT)  BETWEEN ',@SCORE_GOOD_LOW_11,' AND ',@SCORE_GOOD_UP_11,' THEN ''4''
					WHEN (RSCP_SUM/RSCP_CNT)  BETWEEN ',@SCORE_FAIR_LOW_11,' AND ',@SCORE_FAIR_UP_11,' THEN ''3''
					WHEN (RSCP_SUM/RSCP_CNT)  BETWEEN ',@SCORE_BAD_LOW_11,' AND ',@SCORE_BAD_UP_11,' THEN ''2''
					WHEN (RSCP_SUM/RSCP_CNT) <=',@SCORE_VERYBAD_UP_11,' THEN ''1''
					ELSE ''5'' END) AS Coverage_Quality_3G_coverage_score,
					
					(ECN0_SUM/ECN0_CNT),
					(CASE 
					WHEN (ECN0_SUM/ECN0_CNT)  BETWEEN ',@SCORE_EXCELLENT_LOW_12,' AND ',@SCORE_EXCELLENT_UP_12,' THEN ''5''
					WHEN (ECN0_SUM/ECN0_CNT)  BETWEEN ',@SCORE_GOOD_LOW_12,' AND ',@SCORE_GOOD_UP_12,' THEN ''4''
					WHEN (ECN0_SUM/ECN0_CNT)  BETWEEN ',@SCORE_FAIR_LOW_12,' AND ',@SCORE_FAIR_UP_12,' THEN ''3''
					WHEN (ECN0_SUM/ECN0_CNT)  BETWEEN ',@SCORE_BAD_LOW_12,' AND ',@SCORE_BAD_UP_12,' THEN ''2''
					WHEN (ECN0_SUM/ECN0_CNT)  <=',@SCORE_VERYBAD_UP_12,' THEN ''1''
					ELSE ''5'' END) AS Coverage_Quality_3G_Quality_score,
	
					(RSRP_SUM/RSRP_CNT),
					(CASE 
					WHEN (RSRP_SUM/RSRP_CNT) >=',@SCORE_EXCELLENT_UP_13,' THEN ''5''
					WHEN (RSRP_SUM/RSRP_CNT)  BETWEEN ',@SCORE_GOOD_LOW_13,' AND ',@SCORE_GOOD_UP_13,' THEN ''4''
					WHEN (RSRP_SUM/RSRP_CNT)  BETWEEN ',@SCORE_FAIR_LOW_13,' AND ',@SCORE_FAIR_UP_13,' THEN ''3''
					WHEN (RSRP_SUM/RSRP_CNT)  BETWEEN ',@SCORE_BAD_LOW_13,' AND ',@SCORE_BAD_UP_13,' THEN ''2''
					WHEN (RSRP_SUM/RSRP_CNT) <=',@SCORE_VERYBAD_UP_13,' THEN ''1''
					ELSE ''5'' END) AS Coverage_Quality_4G_coverage_score,
					
					(RSRQ_SUM/RSRQ_CNT),
					(CASE 
					WHEN (RSRQ_SUM/RSRQ_CNT)  BETWEEN ',@SCORE_EXCELLENT_LOW_14,' AND ',@SCORE_EXCELLENT_UP_14,' THEN ''5''
					WHEN (RSRQ_SUM/RSRQ_CNT)  BETWEEN ',@SCORE_GOOD_LOW_14,' AND ',@SCORE_GOOD_UP_14,' THEN ''4''
					WHEN (RSRQ_SUM/RSRQ_CNT)  BETWEEN ',@SCORE_FAIR_LOW_14,' AND ',@SCORE_FAIR_UP_14,' THEN ''3''
					WHEN (RSRQ_SUM/RSRQ_CNT)  BETWEEN ',@SCORE_BAD_LOW_14,' AND ',@SCORE_BAD_UP_14,' THEN ''2''
					WHEN (RSRQ_SUM/RSRQ_CNT)  <=',@SCORE_VERYBAD_UP_14,' THEN ''1''
					ELSE ''5'' END) AS Coverage_Quality_4G_Quality_score
					
	
				FROM ',gt_global_statistic,'.TMP_cto_dashboard_cell
				
					GROUP BY Network_Element,SITE_ID,Cell_ID
					ORDER BY NULL;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		
	
		
		SET @SqlCmd=CONCAT('
				UPDATE ',gt_global_statistic,'.qv_cto_dashboard_cell
				    SET Voice_CS_Block_call_total=(Voice_CS_Block_call_score)*',@WEIGHTAGE_1,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5),
					Voice_CS_CSSR_total=(Voice_CS_CSSR_score)*',@WEIGHTAGE_2,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5),
					Voice_CS_CALL_SET_UP_TIME_TOTAL=(Voice_CS_CALL_SET_UP_TIME_score)*',@WEIGHTAGE_3,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5),
					Voice_CS_Drop_calls_total=(Voice_CS_Drop_calls_score)*',@WEIGHTAGE_4,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5),
					Data_PS_Blocl_call_total=(Data_PS_Blocl_call_score)*',@WEIGHTAGE_5,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5),
					Data_PS_CSSR_total=(Data_PS_CSSR_score)*',@WEIGHTAGE_6,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5),
					Data_PS_Drop_calls_total=(Data_PS_Drop_calls_score)*',@WEIGHTAGE_7,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5),
					Data_PS_Throughput_total=(Data_PS_Throughput_score)*',@WEIGHTAGE_8,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5),
					
					Coverage_Quality_2G_coverage_total=(Coverage_Quality_2G_coverage_score)*',@WEIGHTAGE_9,'/((',@WEIGHTAGE_9,'+',@WEIGHTAGE_10,')*5),
					Coverage_Quality_2G_Quality_total=(Coverage_Quality_2G_Quality_score)*',@WEIGHTAGE_10,'/((',@WEIGHTAGE_9,'+',@WEIGHTAGE_10,')*5),
					Coverage_Quality_3G_Coverage_total=(Coverage_Quality_3G_coverage_score)*',@WEIGHTAGE_11,'/((',@WEIGHTAGE_11,'+',@WEIGHTAGE_12,')*5),
					Coverage_Quality_3G_Quality_total=(Coverage_Quality_3G_Quality_score)*',@WEIGHTAGE_12,'/((',@WEIGHTAGE_11,'+',@WEIGHTAGE_12,')*5),
					Coverage_Quality_4G_coverage_total=(Coverage_Quality_4G_coverage_score)*',@WEIGHTAGE_13,'/((',@WEIGHTAGE_13,'+',@WEIGHTAGE_14,')*5),
					Coverage_Quality_4G_Quality_total=(Coverage_Quality_4G_Quality_score)*',@WEIGHTAGE_14,'/((',@WEIGHTAGE_13,'+',@WEIGHTAGE_14,')*5),
					
					Voice_CS=(((Voice_CS_Block_call_score)*',@WEIGHTAGE_1,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5))+((Voice_CS_CSSR_score)*',@WEIGHTAGE_2,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5))
						+((Voice_CS_CALL_SET_UP_TIME_score)*',@WEIGHTAGE_3,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5))+((Voice_CS_Drop_calls_score)*',@WEIGHTAGE_4,'/((',@WEIGHTAGE_1,'+',@WEIGHTAGE_2,'+',@WEIGHTAGE_3,'+',@WEIGHTAGE_4,')*5))),
					Data_PS=(((Data_PS_Blocl_call_score)*',@WEIGHTAGE_5,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5))+((Data_PS_CSSR_score)*',@WEIGHTAGE_6,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5))
						+((Data_PS_Drop_calls_score)*',@WEIGHTAGE_7,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5))+((Data_PS_Throughput_score)*',@WEIGHTAGE_8,'/((',@WEIGHTAGE_5,'+',@WEIGHTAGE_6,'+',@WEIGHTAGE_7,'+',@WEIGHTAGE_8,')*5))),
					
					Coverage_Quality=
					(CASE 
					WHEN Coverage_Quality_2G_coverage_original IS NOT NULL  THEN (Coverage_Quality_2G_coverage_score)*',@WEIGHTAGE_9,'/((',@WEIGHTAGE_9,'+',@WEIGHTAGE_10,')*5)+(Coverage_Quality_2G_Quality_score)*',@WEIGHTAGE_10,'/((',@WEIGHTAGE_9,'+',@WEIGHTAGE_10,')*5)
					WHEN Coverage_Quality_3G_coverage_original IS NOT NULL  THEN (Coverage_Quality_3G_coverage_score)*',@WEIGHTAGE_11,'/((',@WEIGHTAGE_11,'+',@WEIGHTAGE_12,')*5)+(Coverage_Quality_3G_Quality_score)*',@WEIGHTAGE_12,'/((',@WEIGHTAGE_11,'+',@WEIGHTAGE_12,')*5)
					WHEN Coverage_Quality_4G_coverage_original IS NOT NULL  THEN (Coverage_Quality_4G_coverage_score)*',@WEIGHTAGE_13,'/((',@WEIGHTAGE_13,'+',@WEIGHTAGE_14,')*5)+(Coverage_Quality_4G_Quality_score)*',@WEIGHTAGE_14,'/((',@WEIGHTAGE_13,'+',@WEIGHTAGE_14,')*5)
					ELSE 0.5 END)
					;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		
		
		SET @SqlCmd=CONCAT('
						SELECT 
						''Network_Element_SITE_ID_Cell_ID'',
						''Voice_CS_Block_call_original'' ,''Voice_CS_Block_call_score'' ,''Voice_CS_Block_call_total'' ,
						''Voice_CS_CSSR_original'',''Voice_CS_CSSR_score'' ,''Voice_CS_CSSR_total'' ,
						''Voice_CS_CALL_SET_UP_TIME_original'' ,''Voice_CS_CALL_SET_UP_TIME_score'' ,''Voice_CS_CALL_SET_UP_TIME_TOTAL'',
						''Voice_CS_Drop_calls_original'' ,''Voice_CS_Drop_calls_score'' ,''Voice_CS_Drop_calls_total'',
						''Data_PS_Blocl_call_original'' ,''Data_PS_Blocl_call_score'' ,''Data_PS_Blocl_call_total'',
						''Data_PS_CSSR_original'' ,''Data_PS_CSSR_score'',''Data_PS_CSSR_total'' ,
						''Data_PS_Drop_calls_original'' ,''Data_PS_Drop_calls_score'' ,''Data_PS_Drop_calls_total'' ,
						''Data_PS_Throughput_original'' ,''Data_PS_Throughput_score'' ,''Data_PS_Throughput_total'',						
						''Coverage_Quality_2G_coverage_original'' ,''Coverage_Quality_2G_coverage_score'',''Coverage_Quality_2G_coverage_total'',
						''Coverage_Quality_2G_Quality_original'' ,''Coverage_Quality_2G_Quality_score'' ,''Coverage_Quality_2G_Quality_total'',
						''Coverage_Quality_3G_coverage_original'',''Coverage_Quality_3G_coverage_score'' ,''Coverage_Quality_3G_coverage_total'' ,
						''Coverage_Quality_3G_Quality_original'',''Coverage_Quality_3G_Quality_score'',''Coverage_Quality_3G_Quality_total'' ,
						''Coverage_Quality_4G_coverage_original'',''Coverage_Quality_4G_coverage_score'',''Coverage_Quality_4G_coverage_total'' ,
						''Coverage_Quality_4G_Quality_original'',''Coverage_Quality_4G_Quality_score'' ,''Coverage_Quality_4G_Quality_total'',
						''Voice_CS'',
						''Data_PS'',
						''Coverage_Quality'' 
						UNION
						SELECT *
						FROM ',gt_global_statistic,'.qv_cto_dashboard_cell
						
						INTO OUTFILE "',FOLDER_PATH,'cto_dashboard_cell_',DATA_DATE,'.csv"
						FIELDS TERMINATED BY '',''
						OPTIONALLY ENCLOSED BY ''''
						LINES TERMINATED BY ''\\n'';');
	
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		
	
		SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',gt_global_statistic,'.TMP_cto_dashboard_cell;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		
		SET @SqlCmd=CONCAT('TRUNCATE TABLE ',gt_global_statistic,'.qv_cto_dashboard_cell;');		
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		INSERT INTO gt_gw_main.SP_LOG VALUES(gt_global_statistic,'SP_Qlikview_CTO_dashboard',CONCAT('Generate CELL DATA Done: ',TIMESTAMPDIFF(SECOND,START_TIME,SYSDATE()),' seconds.'), NOW());
		
	END IF;
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	INSERT INTO gt_gw_main.SP_LOG VALUES(gt_global_statistic,'SP_Qlikview_CTO_dashboard',CONCAT('Done: ',TIMESTAMPDIFF(SECOND,START_TIME,SYSDATE()),' seconds.'), NOW());
			
END$$
DELIMITER ;

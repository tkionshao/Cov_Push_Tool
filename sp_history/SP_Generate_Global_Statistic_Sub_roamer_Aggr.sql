DELIMITER $$
USE `gt_global_statistic`$$
DROP PROCEDURE IF EXISTS `SP_CreateDB_LTE`$$
CREATE DEFINER=`covmo`@`%` PROCEDURE `SP_Generate_Global_Statistic_Sub_roamer_Aggr`(IN TECH_MASK TINYINT(2),IN WORKER_ID VARCHAR(10),IN FLAG TINYINT(2),IN exDate VARCHAR(10),IN DS_FLAG TINYINT(2),PENDING_FLAG TINYINT(2),IN TileResolution VARCHAR(8))
BEGIN
	DECLARE START_TIME DATETIME DEFAULT SYSDATE();
	DECLARE STEP_START_TIME DATETIME DEFAULT SYSDATE();
	DECLARE SP_Process VARCHAR(100) DEFAULT NULL;
	DECLARE KPI_ERROR CONDITION FOR SQLSTATE '99999' ;
	DECLARE FIRSTDAY_OF_WEEK TINYINT(4) DEFAULT 6;
	DECLARE v_DATA_DATE VARCHAR(10) DEFAULT NULL;
	DECLARE v_DATA_HOUR TINYINT(2) DEFAULT NULL;
	DECLARE v_PU_ID MEDIUMINT(9) DEFAULT NULL;
	DECLARE v_TECH_MASK TINYINT(2) DEFAULT NULL;
	DECLARE v_i TINYINT(2) DEFAULT 1;
	DECLARE v_R_Max TINYINT(2) DEFAULT 0;
	DECLARE v_group_db_name VARCHAR(100) DEFAULT '';
	
	DECLARE SHARE_IP VARCHAR(100) DEFAULT NULL;
	DECLARE SHARE_PORT VARCHAR(10) DEFAULT NULL;
	DECLARE SHARE_ACCOUNT VARCHAR(100) DEFAULT NULL;
	DECLARE SHARE_PW VARCHAR(100) DEFAULT NULL;	
	DECLARE SHARE_DB VARCHAR(100) DEFAULT NULL;
	
	DECLARE TILE_UMTS_COLUMN_STR VARCHAR(2000) DEFAULT 
		'`INIT_CALL_CNT`,
		  `END_CALL_CNT`,
		  `VOICE_CNT`,
		  `VIDEO_CNT`,
		  `PS_R99_CNT`,
		  `PS_HSPA_CNT`,
		  `M_RAB_CNT`, 
		  `SIGNAL_CNT`,
		  `SMS_CNT`,
		  `PS_OTHER_CNT`,
		  `CALL_DUR_SUM`,
		  `CS_DUR_SUM`,
		  `DROP_CNT`,
		  `BLOCK_CNT`,
		  `DROP_VOICE_CNT`,
		  `DROP_VIDEO_CNT`,
		  `DROP_PS_R99_CNT`,
		  `DROP_PS_HSPA_CNT`,
		  `DROP_M_RAB_CNT`,
		  `DROP_SIGNAL_CNT`,
		  `DROP_SMS_CNT`,
		  `DROP_PS_OTHER_CNT`,
		  `PS_UL_VOLUME_SUM`,
		  `PS_DL_VOLUME_SUM`,
		  `PS_UL_SPEED_MAX`,
		  `PS_DL_SPEED_MAX`,
		  `UL_THROUPUT_SUM`,
		  `UL_THROUPUT_CNT`,
		  `DL_THROUPUT_SUM`,
		  `DL_THROUPUT_CNT`,
		  `NON_BLOCK_VOICE_CNT`,
		  `NON_BLOCK_VIDEO_CNT`,
		  `NON_BLOCK_PS_R99_CNT`,
		  `NON_BLOCK_PS_HSPA_CNT`,
		  `NON_BLOCK_M_RAB_CNT`,
		  `NON_BLOCK_SIGNAL_CNT`,
		  `NON_BLOCK_SMS_CNT`,
		  `NON_BLOCK_PS_OTHER_CNT`,
		  `PS_CNT`,
		  `DROP_PS_CNT`,
		  `CALL_SETUP_TIME_SUM`,
		  `CALL_SETUP_TIME_CNT`,
		  `CALL_SETUP_TIME_VOICE_SUM`,
		  `CALL_SETUP_TIME_VOICE_CNT`,
		  `CALL_SETUP_TIME_VEDIO_SUM`,
		  `CALL_SETUP_TIME_VEDIO_CNT`,
		  `CALL_SETUP_TIME_R99_SUM`,
		  `CALL_SETUP_TIME_R99_CNT`,
		  `CALL_SETUP_TIME_HSPA_SUM`,
		  `CALL_SETUP_TIME_HSPA_CNT`,
		  `CALL_SETUP_TIME_MRAB_SUM`,
		  `CALL_SETUP_TIME_MRAB_CNT`,
		  `CALL_SETUP_TIME_SIG_SUM`,
		  `CALL_SETUP_TIME_SIG_CNT`,
		  `CALL_SETUP_TIME_OTH_SUM`,
		  `CALL_SETUP_TIME_OTH_CNT`,
		  `CALL_SETUP_TIME_SMS_SUM`,
		  `CALL_SETUP_TIME_SMS_CNT`';
		  
	DECLARE TILE_UMTS_COLUMN_IFNULL_STR VARCHAR(6000) DEFAULT 
		'IFNULL(INIT_CALL_CNT,0) AS INIT_CALL_CNT,
		IFNULL(END_CALL_CNT,0) AS END_CALL_CNT,
		IFNULL(VOICE_CNT,0) AS VOICE_CNT,
		IFNULL(VIDEO_CNT,0) AS VIDEO_CNT,
		IFNULL(PS_R99_CNT,0) AS PS_R99_CNT,
		IFNULL(PS_HSPA_CNT,0) AS PS_HSPA_CNT,
		IFNULL(M_RAB_CNT,0) AS M_RAB_CNT,
		IFNULL(SIGNAL_CNT,0) AS SIGNAL_CNT,
		IFNULL(SMS_CNT,0) AS SMS_CNT,
		IFNULL(PS_OTHER_CNT,0) AS PS_OTHER_CNT,
		IFNULL(CALL_DUR_SUM,0) AS CALL_DUR_SUM,
		IFNULL(CS_DUR_SUM,0) AS CS_DUR_SUM,
		IFNULL(DROP_CNT,0) AS DROP_CNT,
		IFNULL(BLOCK_CNT,0) AS BLOCK_CNT,
		IFNULL(DROP_VOICE_CNT,0) AS DROP_VOICE_CNT,
		IFNULL(DROP_VIDEO_CNT,0) AS DROP_VIDEO_CNT,
		IFNULL(DROP_PS_R99_CNT,0) AS DROP_PS_R99_CNT,
		IFNULL(DROP_PS_HSPA_CNT,0) AS DROP_PS_HSPA_CNT,
		IFNULL(DROP_M_RAB_CNT,0) AS DROP_M_RAB_CNT,
		IFNULL(DROP_SIGNAL_CNT,0) AS DROP_SIGNAL_CNT,
		IFNULL(DROP_SMS_CNT,0) AS DROP_SMS_CNT,
		IFNULL(DROP_PS_OTHER_CNT,0) AS DROP_PS_OTHER_CNT,
		IFNULL(PS_UL_VOLUME_SUM,0) AS PS_UL_VOLUME_SUM,
		IFNULL(PS_DL_VOLUME_SUM,0) AS PS_DL_VOLUME_SUM,
		IFNULL(PS_UL_SPEED_MAX,0) AS PS_UL_SPEED_MAX,
		IFNULL(PS_DL_SPEED_MAX,0) AS PS_DL_SPEED_MAX,
		IFNULL(UL_THROUPUT_SUM,0) AS UL_THROUPUT_SUM,
		IFNULL(UL_THROUPUT_CNT,0) AS UL_THROUPUT_CNT,
		IFNULL(DL_THROUPUT_SUM,0) AS DL_THROUPUT_SUM,
		IFNULL(DL_THROUPUT_CNT,0) AS DL_THROUPUT_CNT,
		IFNULL(NON_BLOCK_VOICE_CNT,0) AS NON_BLOCK_VOICE_CNT,
		IFNULL(NON_BLOCK_VIDEO_CNT,0) AS NON_BLOCK_VIDEO_CNT,
		IFNULL(NON_BLOCK_PS_R99_CNT,0) AS NON_BLOCK_PS_R99_CNT,
		IFNULL(NON_BLOCK_PS_HSPA_CNT,0) AS NON_BLOCK_PS_HSPA_CNT,
		IFNULL(NON_BLOCK_M_RAB_CNT,0) AS NON_BLOCK_M_RAB_CNT,
		IFNULL(NON_BLOCK_SIGNAL_CNT,0) AS NON_BLOCK_SIGNAL_CNT,
		IFNULL(NON_BLOCK_SMS_CNT,0) AS NON_BLOCK_SMS_CNT,
		IFNULL(NON_BLOCK_PS_OTHER_CNT,0) AS NON_BLOCK_PS_OTHER_CNT,
		IFNULL(PS_CNT,0) AS PS_CNT,
		IFNULL(DROP_PS_CNT,0) AS DROP_PS_CNT,
		IFNULL(CALL_SETUP_TIME_SUM,0) AS CALL_SETUP_TIME_SUM,
		IFNULL(CALL_SETUP_TIME_CNT,0) AS CALL_SETUP_TIME_CNT,
		IFNULL(`CALL_SETUP_TIME_VOICE_SUM`,0) AS `CALL_SETUP_TIME_VOICE_SUM`,
		IFNULL(`CALL_SETUP_TIME_VOICE_CNT`,0) AS `CALL_SETUP_TIME_VOICE_CNT`,
		IFNULL(`CALL_SETUP_TIME_VEDIO_SUM`,0) AS `CALL_SETUP_TIME_VEDIO_SUM`,
		IFNULL(`CALL_SETUP_TIME_VEDIO_CNT`,0) AS `CALL_SETUP_TIME_VEDIO_CNT`,
		IFNULL(`CALL_SETUP_TIME_R99_SUM`,0) AS `CALL_SETUP_TIME_R99_SUM`,
		IFNULL(`CALL_SETUP_TIME_R99_CNT`,0) AS `CALL_SETUP_TIME_R99_CNT`,
		IFNULL(`CALL_SETUP_TIME_HSPA_SUM`,0) AS `CALL_SETUP_TIME_HSPA_SUM`,
		IFNULL(`CALL_SETUP_TIME_HSPA_CNT`,0) AS `CALL_SETUP_TIME_HSPA_CNT`,
		IFNULL(`CALL_SETUP_TIME_MRAB_SUM`,0) AS `CALL_SETUP_TIME_MRAB_SUM`,
		IFNULL(`CALL_SETUP_TIME_MRAB_CNT`,0) AS `CALL_SETUP_TIME_MRAB_CNT`,
		IFNULL(`CALL_SETUP_TIME_SIG_SUM`,0) AS `CALL_SETUP_TIME_SIG_SUM`,
		IFNULL(`CALL_SETUP_TIME_SIG_CNT`,0) AS `CALL_SETUP_TIME_SIG_CNT`,
		IFNULL(`CALL_SETUP_TIME_OTH_SUM`,0) AS `CALL_SETUP_TIME_OTH_SUM`,
		IFNULL(`CALL_SETUP_TIME_OTH_CNT`,0) AS `CALL_SETUP_TIME_OTH_CNT`,
		IFNULL(`CALL_SETUP_TIME_SMS_SUM`,0) AS `CALL_SETUP_TIME_SMS_SUM`,
		IFNULL(`CALL_SETUP_TIME_SMS_CNT`,0) AS `CALL_SETUP_TIME_SMS_CNT`';
		
	DECLARE TILE_UMTS_COLUMN_SUM_STR VARCHAR(6000) DEFAULT 
		'SUM(IFNULL(INIT_CALL_CNT,0)) AS INIT_CALL_CNT,
		SUM(IFNULL(END_CALL_CNT,0)) AS END_CALL_CNT,
		SUM(IFNULL(VOICE_CNT,0)) AS VOICE_CNT,
		SUM(IFNULL(VIDEO_CNT,0)) AS VIDEO_CNT,
		SUM(IFNULL(PS_R99_CNT,0)) AS PS_R99_CNT,
		SUM(IFNULL(PS_HSPA_CNT,0)) AS PS_HSPA_CNT,
		SUM(IFNULL(M_RAB_CNT,0)) AS M_RAB_CNT,
		SUM(IFNULL(SIGNAL_CNT,0)) AS SIGNAL_CNT,
		SUM(IFNULL(SMS_CNT,0)) AS SMS_CNT,
		SUM(IFNULL(PS_OTHER_CNT,0)) AS PS_OTHER_CNT,
		SUM(IFNULL(CALL_DUR_SUM,0)) AS CALL_DUR_SUM,
		SUM(IFNULL(CS_DUR_SUM,0)) AS CS_DUR_SUM,
		SUM(IFNULL(DROP_CNT,0)) AS DROP_CNT,
		SUM(IFNULL(BLOCK_CNT,0)) AS BLOCK_CNT,
		SUM(IFNULL(DROP_VOICE_CNT,0)) AS DROP_VOICE_CNT,
		SUM(IFNULL(DROP_VIDEO_CNT,0)) AS DROP_VIDEO_CNT,
		SUM(IFNULL(DROP_PS_R99_CNT,0)) AS DROP_PS_R99_CNT,
		SUM(IFNULL(DROP_PS_HSPA_CNT,0)) AS DROP_PS_HSPA_CNT,
		SUM(IFNULL(DROP_M_RAB_CNT,0)) AS DROP_M_RAB_CNT,
		SUM(IFNULL(DROP_SIGNAL_CNT,0)) AS DROP_SIGNAL_CNT,
		SUM(IFNULL(DROP_SMS_CNT,0)) AS DROP_SMS_CNT,
		SUM(IFNULL(DROP_PS_OTHER_CNT,0)) AS DROP_PS_OTHER_CNT,
		SUM(IFNULL(PS_UL_VOLUME_SUM,0)) AS PS_UL_VOLUME_SUM,
		SUM(IFNULL(PS_DL_VOLUME_SUM,0)) AS PS_DL_VOLUME_SUM,
		MAX(IFNULL(PS_UL_SPEED_MAX,0)) AS PS_UL_SPEED_MAX,
		MAX(IFNULL(PS_DL_SPEED_MAX,0)) AS PS_DL_SPEED_MAX,
		SUM(IFNULL(UL_THROUPUT_SUM,0)) AS UL_THROUPUT_SUM,
		SUM(IFNULL(UL_THROUPUT_CNT,0)) AS UL_THROUPUT_CNT,
		SUM(IFNULL(DL_THROUPUT_SUM,0)) AS DL_THROUPUT_SUM,
		SUM(IFNULL(DL_THROUPUT_CNT,0)) AS DL_THROUPUT_CNT,
		SUM(IFNULL(NON_BLOCK_VOICE_CNT,0)) AS NON_BLOCK_VOICE_CNT,
		SUM(IFNULL(NON_BLOCK_VIDEO_CNT,0)) AS NON_BLOCK_VIDEO_CNT,
		SUM(IFNULL(NON_BLOCK_PS_R99_CNT,0)) AS NON_BLOCK_PS_R99_CNT,
		SUM(IFNULL(NON_BLOCK_PS_HSPA_CNT,0)) AS NON_BLOCK_PS_HSPA_CNT,
		SUM(IFNULL(NON_BLOCK_M_RAB_CNT,0)) AS NON_BLOCK_M_RAB_CNT,
		SUM(IFNULL(NON_BLOCK_SIGNAL_CNT,0)) AS NON_BLOCK_SIGNAL_CNT,
		SUM(IFNULL(NON_BLOCK_SMS_CNT,0)) AS NON_BLOCK_SMS_CNT,
		SUM(IFNULL(NON_BLOCK_PS_OTHER_CNT,0)) AS NON_BLOCK_PS_OTHER_CNT,
		SUM(IFNULL(PS_CNT,0)) AS PS_CNT,
		SUM(IFNULL(DROP_PS_CNT,0)) AS DROP_PS_CNT,
		SUM(IFNULL(CALL_SETUP_TIME_SUM,0)) AS CALL_SETUP_TIME_SUM,
		SUM(IFNULL(CALL_SETUP_TIME_CNT,0)) AS CALL_SETUP_TIME_CNT,
		SUM(IFNULL(`CALL_SETUP_TIME_VOICE_SUM`,0)) AS `CALL_SETUP_TIME_VOICE_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_VOICE_CNT`,0)) AS `CALL_SETUP_TIME_VOICE_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_VEDIO_SUM`,0)) AS `CALL_SETUP_TIME_VEDIO_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_VEDIO_CNT`,0)) AS `CALL_SETUP_TIME_VEDIO_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_R99_SUM`,0)) AS `CALL_SETUP_TIME_R99_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_R99_CNT`,0)) AS `CALL_SETUP_TIME_R99_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_HSPA_SUM`,0)) AS `CALL_SETUP_TIME_HSPA_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_HSPA_CNT`,0)) AS `CALL_SETUP_TIME_HSPA_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_MRAB_SUM`,0)) AS `CALL_SETUP_TIME_MRAB_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_MRAB_CNT`,0)) AS `CALL_SETUP_TIME_MRAB_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_SIG_SUM`,0)) AS `CALL_SETUP_TIME_SIG_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_SIG_CNT`,0)) AS `CALL_SETUP_TIME_SIG_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_OTH_SUM`,0)) AS `CALL_SETUP_TIME_OTH_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_OTH_CNT`,0)) AS `CALL_SETUP_TIME_OTH_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_SMS_SUM`,0)) AS `CALL_SETUP_TIME_SMS_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_SMS_CNT`,0)) AS `CALL_SETUP_TIME_SMS_CNT`';
	
	DECLARE TILE_UMTS_COLUMN_UPD_STR VARCHAR(10000) DEFAULT
		'RPT_TABLE_NAME.INIT_CALL_CNT=RPT_TABLE_NAME.INIT_CALL_CNT+VALUES(INIT_CALL_CNT),
		RPT_TABLE_NAME.END_CALL_CNT=RPT_TABLE_NAME.END_CALL_CNT+VALUES(END_CALL_CNT),
		RPT_TABLE_NAME.VOICE_CNT=RPT_TABLE_NAME.VOICE_CNT+VALUES(VOICE_CNT),
		RPT_TABLE_NAME.VIDEO_CNT=RPT_TABLE_NAME.VIDEO_CNT+VALUES(VIDEO_CNT),
		RPT_TABLE_NAME.PS_R99_CNT=RPT_TABLE_NAME.PS_R99_CNT+VALUES(PS_R99_CNT),
		RPT_TABLE_NAME.PS_HSPA_CNT=RPT_TABLE_NAME.PS_HSPA_CNT+VALUES(PS_HSPA_CNT),
		RPT_TABLE_NAME.M_RAB_CNT=RPT_TABLE_NAME.M_RAB_CNT+VALUES(M_RAB_CNT),
		RPT_TABLE_NAME.SIGNAL_CNT=RPT_TABLE_NAME.SIGNAL_CNT+VALUES(SIGNAL_CNT),
		RPT_TABLE_NAME.SMS_CNT=RPT_TABLE_NAME.SMS_CNT+VALUES(SMS_CNT),
		RPT_TABLE_NAME.PS_OTHER_CNT=RPT_TABLE_NAME.PS_OTHER_CNT+VALUES(PS_OTHER_CNT),
		RPT_TABLE_NAME.CALL_DUR_SUM=RPT_TABLE_NAME.CALL_DUR_SUM+VALUES(CALL_DUR_SUM),
		RPT_TABLE_NAME.CS_DUR_SUM=RPT_TABLE_NAME.CS_DUR_SUM+VALUES(CS_DUR_SUM),
		RPT_TABLE_NAME.DROP_CNT=RPT_TABLE_NAME.DROP_CNT+VALUES(DROP_CNT),
		RPT_TABLE_NAME.BLOCK_CNT=RPT_TABLE_NAME.BLOCK_CNT+VALUES(BLOCK_CNT),
		RPT_TABLE_NAME.DROP_VOICE_CNT=RPT_TABLE_NAME.DROP_VOICE_CNT+VALUES(DROP_VOICE_CNT),
		RPT_TABLE_NAME.DROP_VIDEO_CNT=RPT_TABLE_NAME.DROP_VIDEO_CNT+VALUES(DROP_VIDEO_CNT),
		RPT_TABLE_NAME.DROP_PS_R99_CNT=RPT_TABLE_NAME.DROP_PS_R99_CNT+VALUES(DROP_PS_R99_CNT),
		RPT_TABLE_NAME.DROP_PS_HSPA_CNT=RPT_TABLE_NAME.DROP_PS_HSPA_CNT+VALUES(DROP_PS_HSPA_CNT),
		RPT_TABLE_NAME.DROP_M_RAB_CNT=RPT_TABLE_NAME.DROP_M_RAB_CNT+VALUES(DROP_M_RAB_CNT),
		RPT_TABLE_NAME.DROP_SIGNAL_CNT=RPT_TABLE_NAME.DROP_SIGNAL_CNT+VALUES(DROP_SIGNAL_CNT),
		RPT_TABLE_NAME.DROP_SMS_CNT=RPT_TABLE_NAME.DROP_SMS_CNT+VALUES(DROP_SMS_CNT),
		RPT_TABLE_NAME.DROP_PS_OTHER_CNT=RPT_TABLE_NAME.DROP_PS_OTHER_CNT+VALUES(DROP_PS_OTHER_CNT),
		RPT_TABLE_NAME.PS_UL_VOLUME_SUM=RPT_TABLE_NAME.PS_UL_VOLUME_SUM+VALUES(PS_UL_VOLUME_SUM),
		RPT_TABLE_NAME.PS_DL_VOLUME_SUM=RPT_TABLE_NAME.PS_DL_VOLUME_SUM+VALUES(PS_DL_VOLUME_SUM),
		RPT_TABLE_NAME.PS_UL_SPEED_MAX=CASE WHEN RPT_TABLE_NAME.PS_UL_SPEED_MAX > VALUES(PS_UL_SPEED_MAX) THEN RPT_TABLE_NAME.PS_UL_SPEED_MAX ELSE VALUES(PS_UL_SPEED_MAX) END,    
		RPT_TABLE_NAME.PS_DL_SPEED_MAX=CASE WHEN RPT_TABLE_NAME.PS_DL_SPEED_MAX > VALUES(PS_DL_SPEED_MAX) THEN RPT_TABLE_NAME.PS_DL_SPEED_MAX ELSE VALUES(PS_DL_SPEED_MAX) END,
		RPT_TABLE_NAME.UL_THROUPUT_SUM=RPT_TABLE_NAME.UL_THROUPUT_SUM+VALUES(UL_THROUPUT_SUM),
		RPT_TABLE_NAME.UL_THROUPUT_CNT=RPT_TABLE_NAME.UL_THROUPUT_CNT+VALUES(UL_THROUPUT_CNT),
		RPT_TABLE_NAME.DL_THROUPUT_SUM=RPT_TABLE_NAME.DL_THROUPUT_SUM+VALUES(DL_THROUPUT_SUM),
		RPT_TABLE_NAME.DL_THROUPUT_CNT=RPT_TABLE_NAME.DL_THROUPUT_CNT+VALUES(DL_THROUPUT_CNT),
		RPT_TABLE_NAME.NON_BLOCK_VOICE_CNT=RPT_TABLE_NAME.NON_BLOCK_VOICE_CNT+VALUES(NON_BLOCK_VOICE_CNT),
		RPT_TABLE_NAME.NON_BLOCK_VIDEO_CNT=RPT_TABLE_NAME.NON_BLOCK_VIDEO_CNT+VALUES(NON_BLOCK_VIDEO_CNT),
		RPT_TABLE_NAME.NON_BLOCK_PS_R99_CNT=RPT_TABLE_NAME.NON_BLOCK_PS_R99_CNT+VALUES(NON_BLOCK_PS_R99_CNT),
		RPT_TABLE_NAME.NON_BLOCK_PS_HSPA_CNT=RPT_TABLE_NAME.NON_BLOCK_PS_HSPA_CNT+VALUES(NON_BLOCK_PS_HSPA_CNT),
		RPT_TABLE_NAME.NON_BLOCK_M_RAB_CNT=RPT_TABLE_NAME.NON_BLOCK_M_RAB_CNT+VALUES(NON_BLOCK_M_RAB_CNT),
		RPT_TABLE_NAME.NON_BLOCK_SIGNAL_CNT=RPT_TABLE_NAME.NON_BLOCK_SIGNAL_CNT+VALUES(NON_BLOCK_SIGNAL_CNT),
		RPT_TABLE_NAME.NON_BLOCK_SMS_CNT=RPT_TABLE_NAME.NON_BLOCK_SMS_CNT+VALUES(NON_BLOCK_SMS_CNT),
		RPT_TABLE_NAME.NON_BLOCK_PS_OTHER_CNT=RPT_TABLE_NAME.NON_BLOCK_PS_OTHER_CNT+VALUES(NON_BLOCK_PS_OTHER_CNT),
		RPT_TABLE_NAME.PS_CNT=RPT_TABLE_NAME.PS_CNT+VALUES(PS_CNT),
		RPT_TABLE_NAME.DROP_PS_CNT=RPT_TABLE_NAME.DROP_PS_CNT+VALUES(DROP_PS_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_SUM+VALUES(CALL_SETUP_TIME_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_CNT+VALUES(CALL_SETUP_TIME_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_VOICE_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_VOICE_SUM+VALUES(CALL_SETUP_TIME_VOICE_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_VOICE_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_VOICE_CNT+VALUES(CALL_SETUP_TIME_VOICE_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_VEDIO_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_VEDIO_SUM+VALUES(CALL_SETUP_TIME_VEDIO_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_VEDIO_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_VEDIO_CNT+VALUES(CALL_SETUP_TIME_VEDIO_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_R99_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_R99_SUM+VALUES(CALL_SETUP_TIME_R99_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_R99_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_R99_CNT+VALUES(CALL_SETUP_TIME_R99_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_HSPA_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_HSPA_SUM+VALUES(CALL_SETUP_TIME_HSPA_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_HSPA_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_HSPA_CNT+VALUES(CALL_SETUP_TIME_HSPA_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_MRAB_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_MRAB_SUM+VALUES(CALL_SETUP_TIME_MRAB_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_MRAB_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_MRAB_CNT+VALUES(CALL_SETUP_TIME_MRAB_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_SIG_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_SIG_SUM+VALUES(CALL_SETUP_TIME_SIG_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_SIG_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_SIG_CNT+VALUES(CALL_SETUP_TIME_SIG_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_OTH_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_OTH_SUM+VALUES(CALL_SETUP_TIME_OTH_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_OTH_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_OTH_CNT+VALUES(CALL_SETUP_TIME_OTH_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_SMS_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_SMS_SUM+VALUES(CALL_SETUP_TIME_SMS_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_SMS_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_SMS_CNT+VALUES(CALL_SETUP_TIME_SMS_CNT)';
	
	DECLARE TILE_LTE_COLUMN_STR VARCHAR(2000) DEFAULT 
		'`INIT_CALL_CNT`,
		`END_CALL_CNT`,
		`SIGNAL_CNT`,
		`DATA_CNT`,
		`UNSPECIFIED_CNT`,
		`CALL_DUR_SUM`,
		`BLOCK_CNT`,
		`DROP_CNT`,
		`CSFB_CNT`,
		`PS_UL_VOLUME_SUM`,
		`PS_DL_VOLUME_SUM`,
		`PS_UL_SPEED_MAX`,
		`PS_DL_SPEED_MAX`,
		`DROP_SIGNAL_CNT`,
		`DROP_DATA_CNT`,
		`DROP_SMS_CNT`,
		`DROP_VOLTE_CNT`,
		`DROP_UNSPECIFIED_CNT`,
		`END_NON_BLOCK_CALL_CNT`,
		`UL_THROUPUT_SUM`,
		`UL_THROUPUT_CNT`,
		`DL_THROUPUT_SUM`,
		`DL_THROUPUT_CNT`,
		`END_NON_BLOCK_SIGNAL_CNT`,
		`END_NON_BLOCK_DATA_CNT`,
		`CALL_SETUP_TIME_SUM`,
		`CALL_SETUP_TIME_CNT`,
		`CALL_SETUP_TIME_SIG_SUM`,
		`CALL_SETUP_TIME_SIG_CNT`,
		`CALL_SETUP_TIME_DATA_SUM`,
		`CALL_SETUP_TIME_DATA_CNT`,
		`CALL_SETUP_TIME_SMS_SUM`,
		`CALL_SETUP_TIME_SMS_CNT`,
		`CALL_SETUP_TIME_VOLTE_SUM`,
		`CALL_SETUP_TIME_VOLTE_CNT`,
		`CALL_SETUP_TIME_UNSP_SUM`,
		`CALL_SETUP_TIME_UNSP_CNT`';
		  
	DECLARE TILE_LTE_COLUMN_IFNULL_STR VARCHAR(2500) DEFAULT 
		'IFNULL(`INIT_CALL_CNT`,0) AS INIT_CALL_CNT,
		IFNULL(`END_CALL_CNT`,0) AS END_CALL_CNT,
		IFNULL(`SIGNAL_CNT`,0) AS SIGNAL_CNT,
		IFNULL(`DATA_CNT`,0) AS DATA_CNT,
		IFNULL(`UNSPECIFIED_CNT`,0) AS UNSPECIFIED_CNT,
		IFNULL(`CALL_DUR_SUM`,0) AS CALL_DUR_SUM,
		IFNULL(`BLOCK_CNT`,0) AS BLOCK_CNT,
		IFNULL(`DROP_CNT`,0) AS DROP_CNT,
		IFNULL(`CSFB_CNT`,0) AS CSFB_CNT,
		IFNULL(`PS_UL_VOLUME_SUM`,0) AS PS_UL_VOLUME_SUM,
		IFNULL(`PS_DL_VOLUME_SUM`,0) AS PS_DL_VOLUME_SUM,
		IFNULL(`PS_UL_SPEED_MAX`,0) AS PS_UL_SPEED_MAX,
		IFNULL(`PS_DL_SPEED_MAX`,0) AS PS_DL_SPEED_MAX,
		IFNULL(`DROP_SIGNAL_CNT`,0) AS DROP_SIGNAL_CNT,
		IFNULL(`DROP_DATA_CNT`,0) AS DROP_DATA_CNT,
		IFNULL(`DROP_SMS_CNT`,0) AS DROP_SMS_CNT,
		IFNULL(`DROP_VOLTE_CNT`,0) AS DROP_VOLTE_CNT,
		IFNULL(`DROP_UNSPECIFIED_CNT`,0) AS DROP_UNSPECIFIED_CNT,
		IFNULL(`END_NON_BLOCK_CALL_CNT`,0) AS END_NON_BLOCK_CALL_CNT,
		IFNULL(`UL_THROUPUT_SUM`,0) AS UL_THROUPUT_SUM,
		IFNULL(`UL_THROUPUT_CNT`,0) AS UL_THROUPUT_CNT,
		IFNULL(`DL_THROUPUT_SUM`,0) AS DL_THROUPUT_SUM,
		IFNULL(`DL_THROUPUT_CNT`,0) AS DL_THROUPUT_CNT,
		IFNULL(`END_NON_BLOCK_SIGNAL_CNT`,0) AS END_NON_BLOCK_SIGNAL_CNT,
		IFNULL(`END_NON_BLOCK_DATA_CNT`,0) AS END_NON_BLOCK_DATA_CNT,
		IFNULL(CALL_SETUP_TIME_SUM,0) AS CALL_SETUP_TIME_SUM,
		IFNULL(CALL_SETUP_TIME_CNT,0) AS CALL_SETUP_TIME_CNT,
		IFNULL(`CALL_SETUP_TIME_SIG_SUM`,0) AS `CALL_SETUP_TIME_SIG_SUM`,
		IFNULL(`CALL_SETUP_TIME_SIG_CNT`,0) AS `CALL_SETUP_TIME_SIG_CNT`,
		IFNULL(`CALL_SETUP_TIME_DATA_SUM`,0) AS `CALL_SETUP_TIME_DATA_SUM`,
		IFNULL(`CALL_SETUP_TIME_DATA_CNT`,0) AS `CALL_SETUP_TIME_DATA_CNT`,
		IFNULL(`CALL_SETUP_TIME_SMS_SUM`,0) AS `CALL_SETUP_TIME_SMS_SUM`,
		IFNULL(`CALL_SETUP_TIME_SMS_CNT`,0) AS `CALL_SETUP_TIME_SMS_CNT`,
		IFNULL(`CALL_SETUP_TIME_VOLTE_SUM`,0) AS `CALL_SETUP_TIME_VOLTE_SUM`,
		IFNULL(`CALL_SETUP_TIME_VOLTE_CNT`,0) AS `CALL_SETUP_TIME_VOLTE_CNT`,
		IFNULL(`CALL_SETUP_TIME_UNSP_SUM`,0) AS `CALL_SETUP_TIME_UNSP_SUM`,
		IFNULL(`CALL_SETUP_TIME_UNSP_CNT`,0) AS `CALL_SETUP_TIME_UNSP_CNT`';
		
	DECLARE TILE_LTE_COLUMN_SUM_STR VARCHAR(2500) DEFAULT 
		'SUM(IFNULL(`INIT_CALL_CNT`,0)) AS INIT_CALL_CNT,
		SUM(IFNULL(`END_CALL_CNT`,0)) AS END_CALL_CNT,
		SUM(IFNULL(`SIGNAL_CNT`,0)) AS SIGNAL_CNT,
		SUM(IFNULL(`DATA_CNT`,0)) AS DATA_CNT,
		SUM(IFNULL(`UNSPECIFIED_CNT`,0)) AS UNSPECIFIED_CNT,
		SUM(IFNULL(`CALL_DUR_SUM`,0)) AS CALL_DUR_SUM,
		SUM(IFNULL(`BLOCK_CNT`,0)) AS BLOCK_CNT,
		SUM(IFNULL(`DROP_CNT`,0)) AS DROP_CNT,
		SUM(IFNULL(`CSFB_CNT`,0)) AS CSFB_CNT,
		SUM(IFNULL(`PS_UL_VOLUME_SUM`,0)) AS PS_UL_VOLUME_SUM,
		SUM(IFNULL(`PS_DL_VOLUME_SUM`,0)) AS PS_DL_VOLUME_SUM,
		MAX(IFNULL(`PS_UL_SPEED_MAX`,0)) AS PS_UL_SPEED_MAX,
		MAX(IFNULL(`PS_DL_SPEED_MAX`,0)) AS PS_DL_SPEED_MAX,
		SUM(IFNULL(`DROP_SIGNAL_CNT`,0)) AS DROP_SIGNAL_CNT,
		SUM(IFNULL(`DROP_DATA_CNT`,0)) AS DROP_DATA_CNT,
		SUM(IFNULL(`DROP_SMS_CNT`,0)) AS DROP_SMS_CNT,
		SUM(IFNULL(`DROP_VOLTE_CNT`,0)) AS DROP_VOLTE_CNT,
		SUM(IFNULL(`DROP_UNSPECIFIED_CNT`,0)) AS DROP_UNSPECIFIED_CNT,
		SUM(IFNULL(`END_NON_BLOCK_CALL_CNT`,0)) AS END_NON_BLOCK_CALL_CNT,
		SUM(IFNULL(`UL_THROUPUT_SUM`,0)) AS UL_THROUPUT_SUM,
		SUM(IFNULL(`UL_THROUPUT_CNT`,0)) AS UL_THROUPUT_CNT,
		SUM(IFNULL(`DL_THROUPUT_SUM`,0)) AS DL_THROUPUT_SUM,
		SUM(IFNULL(`DL_THROUPUT_CNT`,0)) AS DL_THROUPUT_CNT,
		SUM(IFNULL(`END_NON_BLOCK_SIGNAL_CNT`,0)) AS END_NON_BLOCK_SIGNAL_CNT,
		SUM(IFNULL(`END_NON_BLOCK_DATA_CNT`,0)) AS END_NON_BLOCK_DATA_CNT,
		SUM(IFNULL(CALL_SETUP_TIME_SUM,0)) AS CALL_SETUP_TIME_SUM,
		SUM(IFNULL(CALL_SETUP_TIME_CNT,0)) AS CALL_SETUP_TIME_CNT,
		SUM(IFNULL(`CALL_SETUP_TIME_SIG_SUM`,0)) AS `CALL_SETUP_TIME_SIG_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_SIG_CNT`,0)) AS `CALL_SETUP_TIME_SIG_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_DATA_SUM`,0)) AS `CALL_SETUP_TIME_DATA_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_DATA_CNT`,0)) AS `CALL_SETUP_TIME_DATA_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_SMS_SUM`,0)) AS `CALL_SETUP_TIME_SMS_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_SMS_CNT`,0)) AS `CALL_SETUP_TIME_SMS_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_VOLTE_SUM`,0)) AS `CALL_SETUP_TIME_VOLTE_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_VOLTE_CNT`,0)) AS `CALL_SETUP_TIME_VOLTE_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_UNSP_SUM`,0)) AS `CALL_SETUP_TIME_UNSP_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_UNSP_CNT`,0)) AS `CALL_SETUP_TIME_UNSP_CNT`';
		
	DECLARE TILE_LTE_COLUMN_UPD_STR VARCHAR(10000) DEFAULT
		'RPT_TABLE_NAME.INIT_CALL_CNT=RPT_TABLE_NAME.INIT_CALL_CNT+VALUES(INIT_CALL_CNT),
		RPT_TABLE_NAME.END_CALL_CNT=RPT_TABLE_NAME.END_CALL_CNT+VALUES(END_CALL_CNT),
		RPT_TABLE_NAME.SIGNAL_CNT=RPT_TABLE_NAME.SIGNAL_CNT+VALUES(SIGNAL_CNT),
		RPT_TABLE_NAME.DATA_CNT=RPT_TABLE_NAME.DATA_CNT+VALUES(DATA_CNT),
		RPT_TABLE_NAME.UNSPECIFIED_CNT=RPT_TABLE_NAME.UNSPECIFIED_CNT+VALUES(UNSPECIFIED_CNT),
		RPT_TABLE_NAME.CALL_DUR_SUM=RPT_TABLE_NAME.CALL_DUR_SUM+VALUES(CALL_DUR_SUM),
		RPT_TABLE_NAME.BLOCK_CNT=RPT_TABLE_NAME.BLOCK_CNT+VALUES(BLOCK_CNT),
		RPT_TABLE_NAME.DROP_CNT=RPT_TABLE_NAME.DROP_CNT+VALUES(DROP_CNT),
		RPT_TABLE_NAME.CSFB_CNT=RPT_TABLE_NAME.CSFB_CNT+VALUES(CSFB_CNT),
		RPT_TABLE_NAME.PS_UL_VOLUME_SUM=RPT_TABLE_NAME.PS_UL_VOLUME_SUM+VALUES(PS_UL_VOLUME_SUM),
		RPT_TABLE_NAME.PS_DL_VOLUME_SUM=RPT_TABLE_NAME.PS_DL_VOLUME_SUM+VALUES(PS_DL_VOLUME_SUM),
		RPT_TABLE_NAME.PS_UL_SPEED_MAX=CASE WHEN RPT_TABLE_NAME.PS_UL_SPEED_MAX > VALUES(PS_UL_SPEED_MAX) THEN RPT_TABLE_NAME.PS_UL_SPEED_MAX ELSE VALUES(PS_UL_SPEED_MAX) END,    
		RPT_TABLE_NAME.PS_DL_SPEED_MAX=CASE WHEN RPT_TABLE_NAME.PS_DL_SPEED_MAX > VALUES(PS_DL_SPEED_MAX) THEN RPT_TABLE_NAME.PS_DL_SPEED_MAX ELSE VALUES(PS_DL_SPEED_MAX) END,
		RPT_TABLE_NAME.DROP_SIGNAL_CNT=RPT_TABLE_NAME.DROP_SIGNAL_CNT+VALUES(DROP_SIGNAL_CNT),
		RPT_TABLE_NAME.DROP_DATA_CNT=RPT_TABLE_NAME.DROP_DATA_CNT+VALUES(DROP_DATA_CNT),
		RPT_TABLE_NAME.DROP_SMS_CNT=RPT_TABLE_NAME.DROP_SMS_CNT+VALUES(DROP_SMS_CNT),
		RPT_TABLE_NAME.DROP_VOLTE_CNT=RPT_TABLE_NAME.DROP_VOLTE_CNT+VALUES(DROP_VOLTE_CNT),
		RPT_TABLE_NAME.DROP_UNSPECIFIED_CNT=RPT_TABLE_NAME.DROP_UNSPECIFIED_CNT+VALUES(DROP_UNSPECIFIED_CNT),
		RPT_TABLE_NAME.END_NON_BLOCK_CALL_CNT=RPT_TABLE_NAME.END_NON_BLOCK_CALL_CNT+VALUES(END_NON_BLOCK_CALL_CNT),
		RPT_TABLE_NAME.UL_THROUPUT_SUM=RPT_TABLE_NAME.UL_THROUPUT_SUM+VALUES(UL_THROUPUT_SUM),
		RPT_TABLE_NAME.UL_THROUPUT_CNT=RPT_TABLE_NAME.UL_THROUPUT_CNT+VALUES(UL_THROUPUT_CNT),
		RPT_TABLE_NAME.DL_THROUPUT_SUM=RPT_TABLE_NAME.DL_THROUPUT_SUM+VALUES(DL_THROUPUT_SUM),
		RPT_TABLE_NAME.DL_THROUPUT_CNT=RPT_TABLE_NAME.DL_THROUPUT_CNT+VALUES(DL_THROUPUT_CNT),
		RPT_TABLE_NAME.END_NON_BLOCK_SIGNAL_CNT=RPT_TABLE_NAME.END_NON_BLOCK_SIGNAL_CNT+VALUES(END_NON_BLOCK_SIGNAL_CNT),
		RPT_TABLE_NAME.END_NON_BLOCK_DATA_CNT=RPT_TABLE_NAME.END_NON_BLOCK_DATA_CNT+VALUES(END_NON_BLOCK_DATA_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_SUM+VALUES(CALL_SETUP_TIME_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_CNT+VALUES(CALL_SETUP_TIME_CNT),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_SUM`+VALUES(`CALL_SETUP_TIME_SIG_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_CNT`+VALUES(`CALL_SETUP_TIME_SIG_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_DATA_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_DATA_SUM`+VALUES(`CALL_SETUP_TIME_DATA_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_DATA_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_DATA_CNT`+VALUES(`CALL_SETUP_TIME_DATA_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_SUM`+VALUES(`CALL_SETUP_TIME_SMS_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_CNT`+VALUES(`CALL_SETUP_TIME_SMS_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_VOLTE_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_VOLTE_SUM`+VALUES(`CALL_SETUP_TIME_VOLTE_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_VOLTE_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_VOLTE_CNT`+VALUES(`CALL_SETUP_TIME_VOLTE_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_UNSP_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_UNSP_SUM`+VALUES(`CALL_SETUP_TIME_UNSP_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_UNSP_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_UNSP_CNT`+VALUES(`CALL_SETUP_TIME_UNSP_CNT`)';
		
	DECLARE TILE_GSM_COLUMN_STR VARCHAR(2000) DEFAULT 
		'INIT_CALL_CNT, 
		  END_CALL_CNT,
		  VOICE_CNT,
		  SIGNAL_CNT,
		  SMS_CNT,
		  GPRS_CNT,
		  OTHER_CNT,
		  BLOCK_CNT,
		  DROP_VOICE_CNT,
		  DROP_SIGNAL_CNT,
		  DROP_SMS_CNT,
		  DROP_GPRS_CNT,
		  DROP_OTHER_CNT,
		  NON_BLOCK_VOICE_CNT,
		  NON_BLOCK_SIGNAL_CNT,
		  NON_BLOCK_SMS_CNT,
		  NON_BLOCK_GPRS_CNT,
		  NON_BLOCK_OTHER_CNT,
		  CALL_DUR_SUM,
		  CALL_SETUP_TIME_SUM,
		  CALL_SETUP_TIME_CNT,
		  CALL_SETUP_TIME_VOICE_SUM,
		  CALL_SETUP_TIME_VOICE_CNT,
		  CALL_SETUP_TIME_SIG_SUM,
		  CALL_SETUP_TIME_SIG_CNT,
		  CALL_SETUP_TIME_SMS_SUM,
		  CALL_SETUP_TIME_SMS_CNT,
		  CALL_SETUP_TIME_GPRS_SUM,
		  CALL_SETUP_TIME_GPRS_CNT,	
		  CALL_SETUP_TIME_OTH_SUM,
		  CALL_SETUP_TIME_OTH_CNT';
		
	DECLARE TILE_GSM_COLUMN_IFNULL_STR VARCHAR(2000) DEFAULT 
		'IFNULL(INIT_CALL_CNT,0) AS INIT_CALL_CNT,           
		IFNULL(END_CALL_CNT,0) AS END_CALL_CNT,          
		IFNULL(VOICE_CNT,0) AS VOICE_CNT,           
		IFNULL(SIGNAL_CNT,0) AS SIGNAL_CNT,          
		IFNULL(SMS_CNT,0) AS SMS_CNT,             
		IFNULL(GPRS_CNT,0) AS GPRS_CNT,            
		IFNULL(OTHER_CNT,0) AS OTHER_CNT,           
		IFNULL(BLOCK_CNT,0) AS BLOCK_CNT,           
		IFNULL(DROP_VOICE_CNT,0) AS DROP_VOICE_CNT,      
		IFNULL(DROP_SIGNAL_CNT,0) AS DROP_SIGNAL_CNT,     
		IFNULL(DROP_SMS_CNT,0) AS DROP_SMS_CNT,        
		IFNULL(DROP_GPRS_CNT,0) AS DROP_GPRS_CNT,       
		IFNULL(DROP_OTHER_CNT,0) AS DROP_OTHER_CNT,      
		IFNULL(NON_BLOCK_VOICE_CNT,0) AS NON_BLOCK_VOICE_CNT, 
		IFNULL(NON_BLOCK_SIGNAL_CNT,0) AS NON_BLOCK_SIGNAL_CNT,
		IFNULL(NON_BLOCK_SMS_CNT,0) AS NON_BLOCK_SMS_CNT,   
		IFNULL(NON_BLOCK_GPRS_CNT,0) AS NON_BLOCK_GPRS_CNT,  
		IFNULL(NON_BLOCK_OTHER_CNT,0) AS NON_BLOCK_OTHER_CNT, 
		IFNULL(CALL_DUR_SUM,0) AS CALL_DUR_SUM,
		IFNULL(CALL_SETUP_TIME_SUM,0) AS CALL_SETUP_TIME_SUM,
		IFNULL(CALL_SETUP_TIME_CNT,0) AS CALL_SETUP_TIME_CNT,
		IFNULL(`CALL_SETUP_TIME_VOICE_SUM`,0) AS `CALL_SETUP_TIME_VOICE_SUM`,
		IFNULL(`CALL_SETUP_TIME_VOICE_CNT`,0) AS `CALL_SETUP_TIME_VOICE_CNT`,
		IFNULL(`CALL_SETUP_TIME_SIG_SUM`,0) AS `CALL_SETUP_TIME_SIG_SUM`,
		IFNULL(`CALL_SETUP_TIME_SIG_CNT`,0) AS `CALL_SETUP_TIME_SIG_CNT`,
		IFNULL(`CALL_SETUP_TIME_SMS_SUM`,0) AS `CALL_SETUP_TIME_SMS_SUM`,
		IFNULL(`CALL_SETUP_TIME_SMS_CNT`,0) AS `CALL_SETUP_TIME_SMS_CNT`,
		IFNULL(`CALL_SETUP_TIME_GPRS_SUM`,0) AS `CALL_SETUP_TIME_GPRS_SUM`,
		IFNULL(`CALL_SETUP_TIME_GPRS_CNT`,0) AS `CALL_SETUP_TIME_GPRS_CNT`,
		IFNULL(`CALL_SETUP_TIME_OTH_SUM`,0) AS `CALL_SETUP_TIME_OTH_SUM`,
		IFNULL(`CALL_SETUP_TIME_OTH_CNT`,0) AS `CALL_SETUP_TIME_OTH_CNT`';
		
	DECLARE TILE_GSM_COLUMN_SUM_STR VARCHAR(2000) DEFAULT 
		'SUM(IFNULL(INIT_CALL_CNT,0)) AS INIT_CALL_CNT,           
		SUM(IFNULL(END_CALL_CNT,0)) AS END_CALL_CNT,          
		SUM(IFNULL(VOICE_CNT,0)) AS VOICE_CNT,
		SUM(IFNULL(SIGNAL_CNT,0)) AS SIGNAL_CNT,
		SUM(IFNULL(SMS_CNT,0)) AS SMS_CNT,
		SUM(IFNULL(GPRS_CNT,0)) AS GPRS_CNT,
		SUM(IFNULL(OTHER_CNT,0)) AS OTHER_CNT,
		SUM(IFNULL(BLOCK_CNT,0)) AS BLOCK_CNT,
		SUM(IFNULL(DROP_VOICE_CNT,0)) AS DROP_VOICE_CNT,
		SUM(IFNULL(DROP_SIGNAL_CNT,0)) AS DROP_SIGNAL_CNT,
		SUM(IFNULL(DROP_SMS_CNT,0)) AS DROP_SMS_CNT,
		SUM(IFNULL(DROP_GPRS_CNT,0)) AS DROP_GPRS_CNT,
		SUM(IFNULL(DROP_OTHER_CNT,0)) AS DROP_OTHER_CNT,
		SUM(IFNULL(NON_BLOCK_VOICE_CNT,0)) AS NON_BLOCK_VOICE_CNT,
		SUM(IFNULL(NON_BLOCK_SIGNAL_CNT,0)) AS NON_BLOCK_SIGNAL_CNT,
		SUM(IFNULL(NON_BLOCK_SMS_CNT,0)) AS NON_BLOCK_SMS_CNT,
		SUM(IFNULL(NON_BLOCK_GPRS_CNT,0)) AS NON_BLOCK_GPRS_CNT,
		SUM(IFNULL(NON_BLOCK_OTHER_CNT,0)) AS NON_BLOCK_OTHER_CNT,
		SUM(IFNULL(CALL_DUR_SUM,0)) AS CALL_DUR_SUM,
		SUM(IFNULL(CALL_SETUP_TIME_SUM,0)) AS CALL_SETUP_TIME_SUM,
		SUM(IFNULL(CALL_SETUP_TIME_CNT,0)) AS CALL_SETUP_TIME_CNT,
		SUM(IFNULL(`CALL_SETUP_TIME_VOICE_SUM`,0)) AS `CALL_SETUP_TIME_VOICE_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_VOICE_CNT`,0)) AS `CALL_SETUP_TIME_VOICE_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_SIG_SUM`,0)) AS `CALL_SETUP_TIME_SIG_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_SIG_CNT`,0)) AS `CALL_SETUP_TIME_SIG_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_SMS_SUM`,0)) AS `CALL_SETUP_TIME_SMS_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_SMS_CNT`,0)) AS `CALL_SETUP_TIME_SMS_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_GPRS_SUM`,0)) AS `CALL_SETUP_TIME_GPRS_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_GPRS_CNT`,0)) AS `CALL_SETUP_TIME_GPRS_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_OTH_SUM`,0)) AS `CALL_SETUP_TIME_OTH_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_OTH_CNT`,0)) AS `CALL_SETUP_TIME_OTH_CNT`';
		
	DECLARE TILE_GSM_COLUMN_UPD_STR VARCHAR(10000) DEFAULT
		'RPT_TABLE_NAME.INIT_CALL_CNT=RPT_TABLE_NAME.INIT_CALL_CNT+VALUES(INIT_CALL_CNT),
		RPT_TABLE_NAME.END_CALL_CNT=RPT_TABLE_NAME.END_CALL_CNT+VALUES(END_CALL_CNT),
		RPT_TABLE_NAME.VOICE_CNT=RPT_TABLE_NAME.VOICE_CNT+VALUES(VOICE_CNT),
		RPT_TABLE_NAME.SIGNAL_CNT=RPT_TABLE_NAME.SIGNAL_CNT+VALUES(SIGNAL_CNT),
		RPT_TABLE_NAME.SMS_CNT=RPT_TABLE_NAME.SMS_CNT+VALUES(SMS_CNT),
		RPT_TABLE_NAME.GPRS_CNT=RPT_TABLE_NAME.GPRS_CNT+VALUES(GPRS_CNT),
		RPT_TABLE_NAME.OTHER_CNT=RPT_TABLE_NAME.OTHER_CNT+VALUES(OTHER_CNT),
		RPT_TABLE_NAME.BLOCK_CNT=RPT_TABLE_NAME.BLOCK_CNT+VALUES(BLOCK_CNT),
		RPT_TABLE_NAME.DROP_VOICE_CNT=RPT_TABLE_NAME.DROP_VOICE_CNT+VALUES(DROP_VOICE_CNT),
		RPT_TABLE_NAME.DROP_SIGNAL_CNT=RPT_TABLE_NAME.DROP_SIGNAL_CNT+VALUES(DROP_SIGNAL_CNT),
		RPT_TABLE_NAME.DROP_SMS_CNT=RPT_TABLE_NAME.DROP_SMS_CNT+VALUES(DROP_SMS_CNT),
		RPT_TABLE_NAME.DROP_GPRS_CNT=RPT_TABLE_NAME.DROP_GPRS_CNT+VALUES(DROP_GPRS_CNT),
		RPT_TABLE_NAME.DROP_OTHER_CNT=RPT_TABLE_NAME.DROP_OTHER_CNT+VALUES(DROP_OTHER_CNT),
		RPT_TABLE_NAME.NON_BLOCK_VOICE_CNT=RPT_TABLE_NAME.NON_BLOCK_VOICE_CNT+VALUES(NON_BLOCK_VOICE_CNT),
		RPT_TABLE_NAME.NON_BLOCK_SIGNAL_CNT=RPT_TABLE_NAME.NON_BLOCK_SIGNAL_CNT+VALUES(NON_BLOCK_SIGNAL_CNT),
		RPT_TABLE_NAME.NON_BLOCK_SMS_CNT=RPT_TABLE_NAME.NON_BLOCK_SMS_CNT+VALUES(NON_BLOCK_SMS_CNT),
		RPT_TABLE_NAME.NON_BLOCK_GPRS_CNT=RPT_TABLE_NAME.NON_BLOCK_GPRS_CNT+VALUES(NON_BLOCK_GPRS_CNT),
		RPT_TABLE_NAME.NON_BLOCK_OTHER_CNT=RPT_TABLE_NAME.NON_BLOCK_OTHER_CNT+VALUES(NON_BLOCK_OTHER_CNT),
		RPT_TABLE_NAME.CALL_DUR_SUM=RPT_TABLE_NAME.CALL_DUR_SUM+VALUES(CALL_DUR_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_SUM+VALUES(CALL_SETUP_TIME_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_CNT+VALUES(CALL_SETUP_TIME_CNT),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_VOICE_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_VOICE_SUM`+VALUES(`CALL_SETUP_TIME_VOICE_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_VOICE_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_VOICE_CNT`+VALUES(`CALL_SETUP_TIME_VOICE_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_SUM`+VALUES(`CALL_SETUP_TIME_SIG_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_CNT`+VALUES(`CALL_SETUP_TIME_SIG_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_SUM`+VALUES(`CALL_SETUP_TIME_SMS_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_CNT`+VALUES(`CALL_SETUP_TIME_SMS_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_GPRS_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_GPRS_SUM`+VALUES(`CALL_SETUP_TIME_GPRS_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_GPRS_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_GPRS_CNT`+VALUES(`CALL_SETUP_TIME_GPRS_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_OTH_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_OTH_SUM`+VALUES(`CALL_SETUP_TIME_OTH_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_OTH_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_OTH_CNT`+VALUES(`CALL_SETUP_TIME_OTH_CNT`)';
		
	DECLARE TILE_PU_MAPPING_COLUMN_STR VARCHAR(200) DEFAULT 
		' TILE_ID,PU_ID,DATA_DATE ';	
	
	DECLARE CONTINUE HANDLER FOR SQLEXCEPTION
	BEGIN
		SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS `gt_global_statistic`.`nw_error_log`
				(
				  `TABLE_NAME` VARCHAR(50) NOT NULL,
				  `SP_NAME` VARCHAR(50) DEFAULT NULL,
				  `INSERT_CMD` VARCHAR(100) DEFAULT NULL,
				  `INSERT_TIME` DATETIME DEFAULT NULL
				) ENGINE=MYISAM;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		INSERT INTO `gt_global_statistic`.`nw_error_log`(`TABLE_NAME`,`SP_NAME`,`INSERT_CMD`,`INSERT_TIME`)
		VALUES (@SOURCE_TABLE_NAME,
			'SP_Generate_Global_Statistic_Sub_roamer_Aggr',
			CONCAT('Step ',@ERROR_FLAG,' error'),
			NOW());
	
		SET @SqlCmd=CONCAT('REPAIR TABLE ',@REPAIR_TABLE_NAME,';');				
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		SET @SqlCmd=CONCAT('SELECT  GROUP_CONCAT(DISTINCT CONCAT(TABLE_NAME)) INTO @DROP_TABLE_LIST
					FROM information_schema.TABLES 
					WHERE TABLE_SCHEMA=''gt_aggregate_db''
					AND TABLE_NAME<>''tmp_dim_handset''
					AND TABLE_NAME <> ''',@tmp_romer_tile_19_umts_hr,'''
					AND TABLE_NAME <> ''',@tmp_romer_tile_19_lte_hr,'''
					AND TABLE_NAME <> ''',@tmp_romer_tile_19_gsm_hr,''';');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		
		SET @v_i=1;
		SET @Quotient_v=1;
		SET @v_R_Max=(CHAR_LENGTH(@DROP_TABLE_LIST) - CHAR_LENGTH(REPLACE(@DROP_TABLE_LIST,',','')))/(CHAR_LENGTH(','))+1;	
		WHILE @v_i <= @v_R_Max DO
		BEGIN
			SET @DROP_TABLE=gt_strtok(@DROP_TABLE_LIST,@v_i,',');
			
			SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS gt_aggregate_db.',@DROP_TABLE_LIST,' ;');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
	
		SET @v_i=@v_i+@Quotient_v;	
		END;
		END WHILE;	
	END;	
	
  	CALL gt_gw_main.`SP_Sub_Set_Session_Param_LTE`('');
  	
	SET @global_db='gt_global_statistic';
	
	SET @ZOOM_LEVEL = gt_covmo_csv_get(TileResolution,3);
	SET @TILE_ID_LVL1 = CONCAT('TILE_ID_',gt_covmo_csv_get(TileResolution,1));
	SET @TILE_ID_LVL2 = CONCAT('TILE_ID_',gt_covmo_csv_get(TileResolution,2));
				
	SET @FLAG_ROMER_TILE_19_UMTS_HR=0;
	SET @FLAG_ROMER_TILE_19_UMTS_DY=0;
	SET @FLAG_ROMER_TILE_16_UMTS_HR=0;
	SET @FLAG_ROMER_TILE_16_UMTS_DY=0;
	SET @FLAG_ROMER_TILE_13_UMTS_HR=0;
	SET @FLAG_ROMER_TILE_13_UMTS_DY=0;
	SET @FLAG_ROMER_TILE_19_UMTS_WK=0;
	SET @FLAG_ROMER_TILE_19_UMTS_MN=0;
	SET @FLAG_ROMER_TILE_16_UMTS_WK=0;
	SET @FLAG_ROMER_TILE_16_UMTS_MN=0;
	SET @FLAG_ROMER_TILE_13_UMTS_WK=0;
	SET @FLAG_ROMER_TILE_13_UMTS_MN=0;
	SET @FLAG_ROMER_REG_3_UMTS_HR=0;
	SET @FLAG_ROMER_REG_3_UMTS_DY=0;
	SET @FLAG_ROMER_REG_2_UMTS_HR=0;
	SET @FLAG_ROMER_REG_2_UMTS_DY=0;
	SET @FLAG_ROMER_REG_1_UMTS_HR=0;
	SET @FLAG_ROMER_REG_1_UMTS_DY=0;
	SET @FLAG_ROMER_REG_3_UMTS_WK=0;
	SET @FLAG_ROMER_REG_3_UMTS_MN=0;
	SET @FLAG_ROMER_REG_2_UMTS_WK=0;
	SET @FLAG_ROMER_REG_2_UMTS_MN=0;
	SET @FLAG_ROMER_REG_1_UMTS_WK=0;
	SET @FLAG_ROMER_REG_1_UMTS_MN=0;
	SET @FLAG_ROMER_TILE_19_LTE_HR=0;
	SET @FLAG_ROMER_TILE_19_LTE_DY=0;
	SET @FLAG_ROMER_TILE_16_LTE_HR=0;
	SET @FLAG_ROMER_TILE_16_LTE_DY=0;
	SET @FLAG_ROMER_TILE_13_LTE_HR=0;
	SET @FLAG_ROMER_TILE_19_LTE_WK=0;
	SET @FLAG_ROMER_TILE_19_LTE_MN=0;
	SET @FLAG_ROMER_TILE_16_LTE_WK=0;
	SET @FLAG_ROMER_TILE_16_LTE_MN=0;
	SET @FLAG_ROMER_TILE_13_LTE_WK=0;
	SET @FLAG_ROMER_TILE_13_LTE_MN=0;
	SET @FLAG_ROMER_TILE_13_LTE_DY=0;
	SET @FLAG_ROMER_REG_3_LTE_HR=0;
	SET @FLAG_ROMER_REG_3_LTE_DY=0;
	SET @FLAG_ROMER_REG_2_LTE_HR=0;
	SET @FLAG_ROMER_REG_2_LTE_DY=0;
	SET @FLAG_ROMER_REG_1_LTE_HR=0;
	SET @FLAG_ROMER_REG_1_LTE_DY=0;
	SET @FLAG_ROMER_REG_3_LTE_WK=0;
	SET @FLAG_ROMER_REG_3_LTE_MN=0;
	SET @FLAG_ROMER_REG_2_LTE_WK=0;
	SET @FLAG_ROMER_REG_2_LTE_MN=0;
	SET @FLAG_ROMER_REG_1_LTE_WK=0;
	SET @FLAG_ROMER_REG_1_LTE_MN=0;
	
	SET @FLAG_ROMER_TILE_19_GSM_HR=0;
	SET @FLAG_ROMER_TILE_19_GSM_DY=0;
	SET @FLAG_ROMER_TILE_16_GSM_HR=0;
	SET @FLAG_ROMER_TILE_16_GSM_DY=0;
	SET @FLAG_ROMER_TILE_13_GSM_HR=0;
	SET @FLAG_ROMER_TILE_13_GSM_DY=0;
	SET @FLAG_ROMER_TILE_19_GSM_WK=0;
	SET @FLAG_ROMER_TILE_19_GSM_MN=0;
	SET @FLAG_ROMER_TILE_16_GSM_WK=0;
	SET @FLAG_ROMER_TILE_16_GSM_MN=0;
	SET @FLAG_ROMER_TILE_13_GSM_WK=0;
	SET @FLAG_ROMER_TILE_13_GSM_MN=0;
	SET @FLAG_ROMER_REG_3_GSM_HR=0;
	SET @FLAG_ROMER_REG_3_GSM_DY=0;
	SET @FLAG_ROMER_REG_2_GSM_HR=0;
	SET @FLAG_ROMER_REG_2_GSM_DY=0;
	SET @FLAG_ROMER_REG_1_GSM_HR=0;
	SET @FLAG_ROMER_REG_1_GSM_DY=0;
	SET @FLAG_ROMER_REG_3_GSM_WK=0;
	SET @FLAG_ROMER_REG_3_GSM_MN=0;
	SET @FLAG_ROMER_REG_2_GSM_WK=0;
	SET @FLAG_ROMER_REG_2_GSM_MN=0;
	SET @FLAG_ROMER_REG_1_GSM_WK=0;
	SET @FLAG_ROMER_REG_1_GSM_MN=0;
	
	SET SHARE_IP ='127.0.0.1';
	SET SHARE_PORT ='3308';
	
	SELECT `value` INTO SHARE_ACCOUNT FROM `gt_gw_main`.`integration_param` WHERE gt_group='system' AND gt_name='apDbUser';
	SELECT `value` INTO SHARE_PW FROM `gt_gw_main`.`integration_param` WHERE gt_group='system' AND gt_name='apDbPass';
	
	SET SHARE_DB='gt_aggregate_db';
	
	INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT(TECH_MASK,',',WORKER_ID,' START'), START_TIME);
	SET STEP_START_TIME := SYSDATE();
	IF FLAG IN (1,0) THEN 
		SET @SqlCmd=CONCAT('SELECT GROUP_CONCAT(DISTINCT CONCAT(`DATA_DATE`,'','',`DATA_HOUR`,'','',`TECH_MASK`) SEPARATOR ''|'' ) INTO @PU_STR_TECH
					FROM ',@global_db,'.tmp_table_call_cnt_',WORKER_ID,' 
					WHERE TECH_MASK=',TECH_MASK,';');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',@SqlCmd, START_TIME);		
		
		SET @SqlCmd=CONCAT('SELECT GROUP_CONCAT(DISTINCT `group_id` ORDER BY `group_id` SEPARATOR ''|'' ) INTO @REG_GROUP FROM ',@global_db,'.`usr_polygon_reg_3`;');
	
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		
		SET @v_reg_m=1;
		SET @v_reg_Max=gt_covmo_csv_count(@REG_GROUP,'|');
		WHILE @v_reg_m <= @v_reg_Max DO
		BEGIN
			SET v_group_db_name=CONCAT('gt_global_statistic_g',gt_strtok(@REG_GROUP, @v_reg_m, '|'));
					
			SET v_i=1;
			SET v_R_Max=gt_covmo_csv_count(@PU_STR_TECH,'|');
			INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT(TECH_MASK,',',WORKER_ID,',',v_R_Max), START_TIME);		
			WHILE v_i <= v_R_Max DO
			BEGIN	
				SET v_DATA_DATE:=gt_covmo_csv_get(gt_strtok(@PU_STR_TECH, v_i, '|'),1);
				SET v_DATA_HOUR:=gt_covmo_csv_get(gt_strtok(@PU_STR_TECH, v_i, '|'),2);
				SET v_TECH_MASK:=gt_covmo_csv_get(gt_strtok(@PU_STR_TECH, v_i, '|'),3);
				SELECT `DAY_OF_WEEK`(v_DATA_DATE) INTO @DAY_OF_WEEK;
				SET @FIRST_DAY=gt_strtok(@DAY_OF_WEEK, 1, '|');
				SET @END_DAY=gt_strtok(@DAY_OF_WEEK, 2, '|');
				SET @DATE_WK=CONCAT(DATE_FORMAT(@FIRST_DAY,'%Y%m%d'),'_',DATE_FORMAT(@END_DAY,'%Y%m%d'));
				SET @DATE_MN=DATE_FORMAT(v_DATA_DATE,'%Y%m');
				SET @DATE_DY=DATE_FORMAT(v_DATA_DATE,'%Y%m%d');
				SET @EX_DATE=CONCAT(DATE_FORMAT(v_DATA_DATE,'%Y%m%d_'),v_DATA_HOUR,'_',WORKER_ID);
		
				SET @tmp_romer_tile_19_umts_hr=CONCAT('tmp_romer_tile_',@ZOOM_LEVEL,'_umts_hr_',@EX_DATE);
				SET @tmp_romer_tile_19_lte_hr=CONCAT('tmp_romer_tile_',@ZOOM_LEVEL,'_lte_hr_',@EX_DATE);
				SET @tmp_romer_tile_19_gsm_hr=CONCAT('tmp_romer_tile_',@ZOOM_LEVEL,'_gsm_hr_',@EX_DATE);
				
				SET @table_romer_tile_19_umts_hr=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_umts_hr_',@DATE_DY);
				SET @table_romer_tile_19_umts_dy=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_umts_dy_',@DATE_DY);
				SET @table_romer_tile_19_umts_wk=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_umts_wk_',@DATE_WK);
				SET @table_romer_tile_19_umts_mn=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_umts_mn_',@DATE_MN);
				
				SET @table_romer_tile_19_lte_hr=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_lte_hr_',@DATE_DY);
				SET @table_romer_tile_19_lte_dy=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_lte_dy_',@DATE_DY);
				SET @table_romer_tile_19_lte_wk=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_lte_wk_',@DATE_WK);
				SET @table_romer_tile_19_lte_mn=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_lte_mn_',@DATE_MN);
				
				SET @table_romer_reg_3_umts_hr=CONCAT('table_romer_reg_3_umts_hr_',@DATE_DY);
				SET @table_romer_reg_2_umts_hr=CONCAT('table_romer_reg_2_umts_hr_',@DATE_DY);
				SET @table_romer_reg_1_umts_hr=CONCAT('table_romer_reg_1_umts_hr_',@DATE_DY);
				SET @table_romer_reg_3_umts_dy=CONCAT('table_romer_reg_3_umts_dy_',@DATE_DY);
				SET @table_romer_reg_2_umts_dy=CONCAT('table_romer_reg_2_umts_dy_',@DATE_DY);
				SET @table_romer_reg_1_umts_dy=CONCAT('table_romer_reg_1_umts_dy_',@DATE_DY);
				SET @table_romer_reg_3_umts_wk=CONCAT('table_romer_reg_3_umts_wk_',@DATE_WK);
				SET @table_romer_reg_2_umts_wk=CONCAT('table_romer_reg_2_umts_wk_',@DATE_WK);
				SET @table_romer_reg_1_umts_wk=CONCAT('table_romer_reg_1_umts_wk_',@DATE_WK);
				SET @table_romer_reg_3_umts_mn=CONCAT('table_romer_reg_3_umts_mn_',@DATE_MN);
				SET @table_romer_reg_2_umts_mn=CONCAT('table_romer_reg_2_umts_mn_',@DATE_MN);
				SET @table_romer_reg_1_umts_mn=CONCAT('table_romer_reg_1_umts_mn_',@DATE_MN);	
				
				SET @table_romer_reg_3_lte_hr=CONCAT('table_romer_reg_3_lte_hr_',@DATE_DY);
				SET @table_romer_reg_2_lte_hr=CONCAT('table_romer_reg_2_lte_hr_',@DATE_DY);
				SET @table_romer_reg_1_lte_hr=CONCAT('table_romer_reg_1_lte_hr_',@DATE_DY);
				SET @table_romer_reg_3_lte_dy=CONCAT('table_romer_reg_3_lte_dy_',@DATE_DY);
				SET @table_romer_reg_2_lte_dy=CONCAT('table_romer_reg_2_lte_dy_',@DATE_DY);
				SET @table_romer_reg_1_lte_dy=CONCAT('table_romer_reg_1_lte_dy_',@DATE_DY);
				SET @table_romer_reg_3_lte_wk=CONCAT('table_romer_reg_3_lte_wk_',@DATE_WK);
				SET @table_romer_reg_2_lte_wk=CONCAT('table_romer_reg_2_lte_wk_',@DATE_WK);
				SET @table_romer_reg_1_lte_wk=CONCAT('table_romer_reg_1_lte_wk_',@DATE_WK);
				SET @table_romer_reg_3_lte_mn=CONCAT('table_romer_reg_3_lte_mn_',@DATE_MN);
				SET @table_romer_reg_2_lte_mn=CONCAT('table_romer_reg_2_lte_mn_',@DATE_MN);
				SET @table_romer_reg_1_lte_mn=CONCAT('table_romer_reg_1_lte_mn_',@DATE_MN);	
				
				SET @table_romer_tile_19_gsm_hr=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_gsm_hr_',@DATE_DY);
				SET @table_romer_tile_19_gsm_dy=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_gsm_dy_',@DATE_DY);
				SET @table_romer_tile_19_gsm_wk=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_gsm_wk_',@DATE_WK);
				SET @table_romer_tile_19_gsm_mn=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_gsm_mn_',@DATE_MN);
				
				SET @table_romer_reg_3_gsm_hr=CONCAT('table_romer_reg_3_gsm_hr_',@DATE_DY);
				SET @table_romer_reg_2_gsm_hr=CONCAT('table_romer_reg_2_gsm_hr_',@DATE_DY);
				SET @table_romer_reg_1_gsm_hr=CONCAT('table_romer_reg_1_gsm_hr_',@DATE_DY);
				SET @table_romer_reg_3_gsm_dy=CONCAT('table_romer_reg_3_gsm_dy_',@DATE_DY);
				SET @table_romer_reg_2_gsm_dy=CONCAT('table_romer_reg_2_gsm_dy_',@DATE_DY);
				SET @table_romer_reg_1_gsm_dy=CONCAT('table_romer_reg_1_gsm_dy_',@DATE_DY);
				SET @table_romer_reg_3_gsm_wk=CONCAT('table_romer_reg_3_gsm_wk_',@DATE_WK);
				SET @table_romer_reg_2_gsm_wk=CONCAT('table_romer_reg_2_gsm_wk_',@DATE_WK);
				SET @table_romer_reg_1_gsm_wk=CONCAT('table_romer_reg_1_gsm_wk_',@DATE_WK);
				SET @table_romer_reg_3_gsm_mn=CONCAT('table_romer_reg_3_gsm_mn_',@DATE_MN);
				SET @table_romer_reg_2_gsm_mn=CONCAT('table_romer_reg_2_gsm_mn_',@DATE_MN);
				SET @table_romer_reg_1_gsm_mn=CONCAT('table_romer_reg_1_gsm_mn_',@DATE_MN);	
	
				SET @SqlCmd=CONCAT('SELECT `att_value` INTO @ZOOM_LEVEL FROM gt_covmo.`sys_config` WHERE `group_name`=''system'' AND att_name = ''MapResolution'';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt; 
				
				IF v_TECH_MASK=2 THEN 
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@tmp_romer_tile_19_umts_hr,';'); 
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
		
					SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@tmp_romer_tile_19_umts_hr,' LIKE ',@global_db,'.tmp_romer_tile_umts_',@EX_DATE,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
	
					SET @SOURCE_TABLE_NAME=@tmp_romer_tile_19_umts_hr;
					SET @ERROR_FLAG='10_tmp_romer_tile_19_umts_hr_1';
					
					SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@tmp_romer_tile_19_umts_hr,' 
							    (`TILE_ID`,MCC,MNC,
							     `FREQUENCY`,
							     `UARFCN`,
							     `DATA_DATE`,
							     `DATA_HOUR`,
							     ',TILE_UMTS_COLUMN_STR,',
							     `',@TILE_ID_LVL2,'`,
							     `',@TILE_ID_LVL1,'`)
							SELECT
							  `TILE_ID`,MCC,MNC,
							  `FREQUENCY`,
							  `UARFCN`,
							  `DATA_DATE`,
							  `DATA_HOUR`,
							  ',TILE_UMTS_COLUMN_SUM_STR,' ,
							  ',@TILE_ID_LVL2,' AS ',@TILE_ID_LVL2,',
							  ',@TILE_ID_LVL1,' AS ',@TILE_ID_LVL1,'
							FROM ',@global_db,'.tmp_romer_tile_umts_',@EX_DATE,' 
							GROUP BY `TILE_ID`,MCC,MNC,`FREQUENCY`,`UARFCN`,`DATA_DATE`,`DATA_HOUR`
							ORDER BY NULL;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					CALL gt_global_statistic.SP_Generate_Global_Statistic_Sub_Tile_Reg_Map(CONCAT(SHARE_DB,'.',@tmp_romer_tile_19_umts_hr),WORKER_ID,0,gt_strtok(@REG_GROUP, @v_reg_m, '|'));
			
					IF FLAG IN (0,1) THEN 
						
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_tile_19_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_romer_tile_19_umts_hr,' LIKE ',v_group_db_name,'.',@table_romer_tile_19_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_romer_tile_19_umts_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_tile_19_umts_hr);
						SET @ERROR_FLAG='10_romer_tile_19_umts_hr_2';
	
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_tile_19_umts_hr,'
								    (`TILE_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `UARFCN`,
								     `DATA_DATE`,
								     `DATA_HOUR`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT
								  `TILE_ID`,MCC,MNC,
								  `FREQUENCY`,
								  `UARFCN`,
								  `DATA_DATE`,
								  `DATA_HOUR`,
								  ',TILE_UMTS_COLUMN_IFNULL_STR,' 
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_umts_hr
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_tile_19_umts_hr))
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_romer_tile_19_umts_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_tile_19_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_ROMER_TILE_19_UMTS_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_umts_hr,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_TileResolution_Insert_MV`(TECH_MASK,@table_romer_tile_19_umts_hr,@tmp_romer_tile_19_umts_hr,'HR',PENDING_FLAG,TileResolution,SHARE_DB, v_group_db_name,v_DATA_HOUR);						
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_umts_hr,' HR cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @FLAG_ROMER_TILE_16_UMTS_HR=1;
						SET @FLAG_ROMER_TILE_13_UMTS_HR=1;
	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_reg_3_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_romer_reg_3_umts_hr,' LIKE ',v_group_db_name,'.',@table_romer_reg_3_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_umts_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_3_umts_hr);
						SET @ERROR_FLAG='10_romer_reg_3_umts_hr_3';
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_3_umts_hr,'
								    (`REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `UARFCN`,
								     `DATA_DATE`,
								     `DATA_HOUR`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT
								  `REG_3_ID` AS `REG_ID`,MCC,MNC,
								  `FREQUENCY`,
								  `UARFCN`,
								  `DATA_DATE`,
								  `DATA_HOUR`,
								  ',TILE_UMTS_COLUMN_SUM_STR,' 
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_umts_hr,' 
								GROUP BY `REG_3_ID`,MCC,MNC,`FREQUENCY`,`UARFCN`,`DATA_DATE`,`DATA_HOUR`
								ORDER BY NULL '
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_reg_3_umts_hr))
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_romer_reg_3_umts_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_reg_3_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_ROMER_REG_3_UMTS_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_3_umts_hr,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_reg_2_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_romer_reg_2_umts_hr,' LIKE ',v_group_db_name,'.',@table_romer_reg_2_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_umts_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_2_umts_hr);
						SET @ERROR_FLAG='10_romer_reg_2_umts_hr_4';
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_2_umts_hr,'
								    (
								     `REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `UARFCN`,
								     `DATA_DATE`,
								     `DATA_HOUR`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT
									`REG_2_ID` AS `REG_ID`,MCC,MNC,
									`FREQUENCY`,
									`UARFCN`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',TILE_UMTS_COLUMN_SUM_STR,' 
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_umts_hr,' 
								GROUP BY `REG_2_ID`,MCC,MNC,`FREQUENCY`,`UARFCN`,`DATA_DATE`,`DATA_HOUR`
								ORDER BY NULL '
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_reg_2_umts_hr))
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_romer_reg_2_umts_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_reg_2_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_ROMER_REG_2_UMTS_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_2_umts_hr,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_reg_1_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_romer_reg_1_umts_hr,' LIKE ',v_group_db_name,'.',@table_romer_reg_1_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_umts_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_1_umts_hr);
						SET @ERROR_FLAG='10_romer_reg_1_umts_hr_5';
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_1_umts_hr,' 
								    (`REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `UARFCN`,
								     `DATA_DATE`,
								     `DATA_HOUR`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT
									`REG_1_ID` AS `REG_ID`,MCC,MNC,
									  `FREQUENCY`,
									  `UARFCN`,
									  `DATA_DATE`,
									  `DATA_HOUR`,
									  ',TILE_UMTS_COLUMN_SUM_STR,' 
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_umts_hr,' 
								GROUP BY `REG_1_ID`,MCC,MNC,`FREQUENCY`,`UARFCN`,`DATA_DATE`,`DATA_HOUR`
								ORDER BY NULL '
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_reg_1_umts_hr))
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_romer_reg_1_umts_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_reg_1_umts_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_ROMER_REG_1_UMTS_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_1_umts_hr,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SOURCE_TABLE_NAME=@table_romer_tile_19_umts_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_tile_19_umts_dy);
						SET @ERROR_FLAG='10_romer_tile_19_umts_dy_6';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_tile_19_umts_dy,' 
									(`TILE_ID`,MCC,MNC,
									`FREQUENCY`,
									`UARFCN`,
									`DATA_DATE`,
									',TILE_UMTS_COLUMN_STR,',
									',@TILE_ID_LVL2,',
									',@TILE_ID_LVL1,',
									`REG_1_ID`,
									`REG_2_ID`,
									`REG_3_ID`)
									SELECT
										`TILE_ID`,MCC,MNC,
										`FREQUENCY`,
										`UARFCN`,
										`DATA_DATE`,
										',TILE_UMTS_COLUMN_IFNULL_STR,' ,
										',@TILE_ID_LVL2,',
										',@TILE_ID_LVL1,',
										`REG_1_ID`,
										`REG_2_ID`,
										`REG_3_ID`
									FROM ',SHARE_DB,'.',@tmp_romer_tile_19_umts_hr,' 
									ON DUPLICATE KEY UPDATE 
									',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_tile_19_umts_dy),',
									',@table_romer_tile_19_umts_dy,'.',@TILE_ID_LVL2,'=IF(',@table_romer_tile_19_umts_dy,'.',@TILE_ID_LVL2,' IS NULL,VALUES(',@TILE_ID_LVL2,'),',@table_romer_tile_19_umts_dy,'.',@TILE_ID_LVL2,'),
									',@table_romer_tile_19_umts_dy,'.',@TILE_ID_LVL1,'=IF(',@table_romer_tile_19_umts_dy,'.',@TILE_ID_LVL1,' IS NULL,VALUES(',@TILE_ID_LVL1,'),',@table_romer_tile_19_umts_dy,'.',@TILE_ID_LVL1,'),
									',@table_romer_tile_19_umts_dy,'.REG_1_ID=IF(',@table_romer_tile_19_umts_dy,'.REG_1_ID IS NULL,VALUES(REG_1_ID),',@table_romer_tile_19_umts_dy,'.REG_1_ID),
									',@table_romer_tile_19_umts_dy,'.REG_2_ID=IF(',@table_romer_tile_19_umts_dy,'.REG_2_ID IS NULL,VALUES(REG_2_ID),',@table_romer_tile_19_umts_dy,'.REG_2_ID),
									',@table_romer_tile_19_umts_dy,'.REG_3_ID=IF(',@table_romer_tile_19_umts_dy,'.REG_3_ID IS NULL,VALUES(REG_3_ID),',@table_romer_tile_19_umts_dy,'.REG_3_ID)
									;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_romer_tile_19_umts_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_TILE_19_UMTS_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_umts_dy,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_TileResolution_Insert_MV`(TECH_MASK,@table_romer_tile_19_umts_dy,@tmp_romer_tile_19_umts_hr,'DY',PENDING_FLAG,TileResolution,SHARE_DB,v_group_db_name,v_DATA_HOUR);
		
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_umts_dy,' DY cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						SET @FLAG_ROMER_TILE_16_UMTS_DY=1;
						SET @FLAG_ROMER_TILE_13_UMTS_DY=1;
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_umts_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_3_umts_dy);
						SET @ERROR_FLAG='10_romer_reg_3_umts_dy_7';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_3_umts_dy,' 
								    (`REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `UARFCN`,
								     `DATA_DATE`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT `REG_3_ID` AS `REG_ID`,MCC,MNC,
								  `FREQUENCY`,
								  `UARFCN`,
								  `DATA_DATE`,
								  ',TILE_UMTS_COLUMN_SUM_STR,' 
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_umts_hr,' 
								GROUP BY `REG_3_ID`,MCC,MNC,`FREQUENCY`,`UARFCN`,`DATA_DATE`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_reg_3_umts_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_umts_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_3_UMTS_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_3_umts_dy,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_umts_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_2_umts_dy);
						SET @ERROR_FLAG='10_romer_reg_2_umts_dy_8';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
	
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_2_umts_dy,' 
								    (`REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `UARFCN`,
								     `DATA_DATE`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT `REG_2_ID` AS `REG_ID`,MCC,MNC,
									  `FREQUENCY`,
									  `UARFCN`,
									  `DATA_DATE`,
									  ',TILE_UMTS_COLUMN_SUM_STR,' 
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_umts_hr,' 
								GROUP BY `REG_2_ID`,MCC,MNC,`FREQUENCY`,`UARFCN`,`DATA_DATE`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_reg_2_umts_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_umts_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_2_UMTS_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_2_umts_dy,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_umts_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_1_umts_dy);
						SET @ERROR_FLAG='10_romer_reg_1_umts_dy_9';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_1_umts_dy,' 
								    (`REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `UARFCN`,
								     `DATA_DATE`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT `REG_1_ID` AS `REG_ID`,MCC,MNC,
									  `FREQUENCY`,
									  `UARFCN`,
									  `DATA_DATE`,
									  ',TILE_UMTS_COLUMN_SUM_STR,' 
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_umts_hr,' 
								GROUP BY `REG_1_ID`,MCC,MNC,`FREQUENCY`,`UARFCN`,`DATA_DATE`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_reg_1_umts_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_umts_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_1_UMTS_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_1_umts_dy,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE(); 
					END IF;
		
					IF FLAG = 0 THEN 
						SET @SOURCE_TABLE_NAME=@table_romer_tile_19_umts_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_tile_19_umts_wk);
						SET @ERROR_FLAG='10_romer_tile_19_umts_wk_10';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_tile_19_umts_wk,' 
								    (`TILE_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `UARFCN`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT `TILE_ID`,MCC,MNC,
								  `FREQUENCY`,
								  `UARFCN`,
								  ',TILE_UMTS_COLUMN_IFNULL_STR,'  
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_umts_hr,' 
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_tile_19_umts_wk)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_romer_tile_19_umts_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_TILE_19_UMTS_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_umts_wk,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_TileResolution_Insert_MV`(TECH_MASK,@table_romer_tile_19_umts_wk,@tmp_romer_tile_19_umts_hr,'WK',PENDING_FLAG,TileResolution,SHARE_DB, v_group_db_name,v_DATA_HOUR);
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_umts_wk,' WK cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @FLAG_ROMER_TILE_16_UMTS_WK=1;
						SET @FLAG_ROMER_TILE_13_UMTS_WK=1;
														
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_umts_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_3_umts_wk);
						SET @ERROR_FLAG='10_romer_reg_3_umts_wk_11';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_3_umts_wk,' 
								    (`REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT `REG_3_ID` AS `REG_ID`,MCC,MNC,
								  `FREQUENCY`,
								  ',TILE_UMTS_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_umts_hr,' 
								GROUP BY `REG_3_ID`,MCC,MNC,`FREQUENCY`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_3_umts_wk)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
		
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_umts_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_3_UMTS_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_3_umts_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_umts_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_2_umts_wk);
						SET @ERROR_FLAG='10_romer_reg_2_umts_wk_12';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_2_umts_wk,' 
								    (
								     `REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `UARFCN`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT `REG_2_ID` AS `REG_ID`,MCC,MNC,
									  `FREQUENCY`,
									  `UARFCN`,
									  ',TILE_UMTS_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_umts_hr,' 
								GROUP BY `REG_2_ID`,MCC,MNC,`FREQUENCY`,`UARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_2_umts_wk)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_umts_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_2_UMTS_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_2_umts_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_umts_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_1_umts_wk);
						SET @ERROR_FLAG='10_romer_reg_1_umts_wk_13';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_1_umts_wk,' 
								    (
								     `REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `UARFCN`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT `REG_1_ID` AS `REG_ID`,MCC,MNC,
									  `FREQUENCY`,
									  `UARFCN`,
									  ',TILE_UMTS_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_umts_hr,' 
								GROUP BY `REG_1_ID`,MCC,MNC,`FREQUENCY`,`UARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_1_umts_wk)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_umts_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_1_UMTS_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_1_umts_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_romer_tile_19_umts_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_tile_19_umts_mn);
						SET @ERROR_FLAG='10_romer_tile_19_umts_mn_14';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_tile_19_umts_mn,' 
								    (`TILE_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `UARFCN`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT `TILE_ID`,MCC,MNC,
								  `FREQUENCY`,
								  `UARFCN`,
								  ',TILE_UMTS_COLUMN_IFNULL_STR,'  
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_umts_hr,' 
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_tile_19_umts_mn)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_romer_tile_19_umts_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_TILE_19_UMTS_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_umts_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_TileResolution_Insert_MV`(TECH_MASK,@table_romer_tile_19_umts_mn,@tmp_romer_tile_19_umts_hr,'MN',PENDING_FLAG,TileResolution,SHARE_DB, v_group_db_name,v_DATA_HOUR);
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_umts_mn,' MN cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						SET @FLAG_ROMER_TILE_16_UMTS_MN=1;
						SET @FLAG_ROMER_TILE_13_UMTS_MN=1;						
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_umts_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_3_umts_mn);
						SET @ERROR_FLAG='10_romer_reg_3_umts_mn_15';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_3_umts_mn,' 
								    (`REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `UARFCN`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT `REG_3_ID` AS `REG_ID`,MCC,MNC,
								  `FREQUENCY`,
								  `UARFCN`,
								  ',TILE_UMTS_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_umts_hr,' 
								GROUP BY `REG_3_ID`,MCC,MNC,`FREQUENCY`,`UARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_3_umts_mn)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_umts_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_3_UMTS_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_3_umts_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_umts_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_2_umts_mn);
						SET @ERROR_FLAG='10_romer_reg_2_umts_mn_16';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_2_umts_mn,' 
								    (
								     `REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `UARFCN`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT `REG_2_ID` AS `REG_ID`,MCC,MNC,
									  `FREQUENCY`,
									  `UARFCN`,
									  ',TILE_UMTS_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_umts_hr,' 
								GROUP BY `REG_2_ID`,MCC,MNC,`FREQUENCY`,`UARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_2_umts_mn)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_umts_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_2_UMTS_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_2_umts_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_umts_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_1_umts_mn);
						SET @ERROR_FLAG='10_romer_reg_1_umts_mn_17';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_1_umts_mn,' 
								    (
								     `REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `UARFCN`,
								     ',TILE_UMTS_COLUMN_STR,')
								SELECT `REG_1_ID` AS `REG_ID`,MCC,MNC,
									  `FREQUENCY`,
									  `UARFCN`,
									  ',TILE_UMTS_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_umts_hr,' 
								GROUP BY `REG_1_ID`,MCC,MNC,`FREQUENCY`,`UARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_1_umts_mn)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_umts_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
								
						SET @FLAG_ROMER_REG_1_UMTS_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_1_umts_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
					END IF;
			
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@tmp_romer_tile_19_umts_hr,';');					
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.tmp_table_call_cnt_',WORKER_ID,' A
						SET 
						  A.`FLAG_ROMER_TILE_19_HR` = ',@FLAG_ROMER_TILE_19_UMTS_HR,',
						  A.`FLAG_ROMER_TILE_19_DY` = ',@FLAG_ROMER_TILE_19_UMTS_DY,',
						  A.`FLAG_ROMER_TILE_16_HR` = ',@FLAG_ROMER_TILE_16_UMTS_HR,',
						  A.`FLAG_ROMER_TILE_16_DY` = ',@FLAG_ROMER_TILE_16_UMTS_DY,',
						  A.`FLAG_ROMER_TILE_13_HR` = ',@FLAG_ROMER_TILE_13_UMTS_HR,',
						  A.`FLAG_ROMER_TILE_13_DY` = ',@FLAG_ROMER_TILE_13_UMTS_DY,',
						  A.`FLAG_ROMER_TILE_19_WK` = ',@FLAG_ROMER_TILE_19_UMTS_WK,',
						  A.`FLAG_ROMER_TILE_19_MN` = ',@FLAG_ROMER_TILE_19_UMTS_MN,',
						  A.`FLAG_ROMER_TILE_16_WK` = ',@FLAG_ROMER_TILE_16_UMTS_WK,',
						  A.`FLAG_ROMER_TILE_16_MN` = ',@FLAG_ROMER_TILE_16_UMTS_MN,',
						  A.`FLAG_ROMER_TILE_13_WK` = ',@FLAG_ROMER_TILE_13_UMTS_WK,',
						  A.`FLAG_ROMER_TILE_13_MN` = ',@FLAG_ROMER_TILE_13_UMTS_MN,', 
						  A.`FLAG_ROMER_REG_3_HR` = ',@FLAG_ROMER_REG_3_UMTS_HR,',
						  A.`FLAG_ROMER_REG_3_DY` = ',@FLAG_ROMER_REG_3_UMTS_DY,',
						  A.`FLAG_ROMER_REG_2_HR` = ',@FLAG_ROMER_REG_2_UMTS_HR,',
						  A.`FLAG_ROMER_REG_2_DY` = ',@FLAG_ROMER_REG_2_UMTS_DY,',
						  A.`FLAG_ROMER_REG_1_HR` = ',@FLAG_ROMER_REG_1_UMTS_HR,',
						  A.`FLAG_ROMER_REG_1_DY` = ',@FLAG_ROMER_REG_1_UMTS_DY,',
						  A.`FLAG_ROMER_REG_3_WK` = ',@FLAG_ROMER_REG_3_UMTS_WK,',
						  A.`FLAG_ROMER_REG_3_MN` = ',@FLAG_ROMER_REG_3_UMTS_MN,',
						  A.`FLAG_ROMER_REG_2_WK` = ',@FLAG_ROMER_REG_2_UMTS_WK,',
						  A.`FLAG_ROMER_REG_2_MN` = ',@FLAG_ROMER_REG_2_UMTS_MN,',
						  A.`FLAG_ROMER_REG_1_WK` = ',@FLAG_ROMER_REG_1_UMTS_WK,',
						  A.`FLAG_ROMER_REG_1_MN` = ',@FLAG_ROMER_REG_1_UMTS_MN,'  
						WHERE A.`TECH_MASK`=2
						;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('UMTS SELECT COUNT(*),TRUE,',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				END IF;
		
				IF v_TECH_MASK=1 THEN 
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
		
					SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr,' LIKE ',@global_db,'.tmp_romer_tile_gsm_',@EX_DATE,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
						
					SET @SOURCE_TABLE_NAME=@tmp_romer_tile_19_gsm_hr;
					SET @ERROR_FLAG='10_tmp_romer_tile_19_gsm_hr_18';
	
					SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr,' 
							    (`TILE_ID`,MCC,MNC,
							     `FREQUENCY`,
							     `BCCH_ARFCN`,
							     `DATA_DATE`,
							     `DATA_HOUR`,
							     ',TILE_GSM_COLUMN_STR,',
							     `',@TILE_ID_LVL2,'`,
							     `',@TILE_ID_LVL1,'`,
							     `REG_1_ID`,
							     `REG_2_ID`,
							     `REG_3_ID`)
							SELECT
							  `TILE_ID`,MCC,MNC,
							  `FREQUENCY`,
							  `BCCH_ARFCN`,
							  `DATA_DATE`,
							  `DATA_HOUR`,
							  ',TILE_GSM_COLUMN_SUM_STR,',
							  ',@TILE_ID_LVL2,' AS ',@TILE_ID_LVL2,',
							  ',@TILE_ID_LVL1,' AS ',@TILE_ID_LVL1,',
							  REG_1_ID AS REG_1_ID,
							  REG_2_ID AS REG_2_ID,
							  REG_3_ID AS REG_3_ID
							FROM ',@global_db,'.tmp_romer_tile_gsm_',@EX_DATE,' 
							WHERE `TILE_ID` IS NOT NULL AND `TILE_ID`>0
							GROUP BY `TILE_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`,`DATA_DATE`,`DATA_HOUR`
							ORDER BY NULL
							;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					CALL gt_global_statistic.SP_Generate_Global_Statistic_Sub_Tile_Reg_Map(CONCAT(SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr),WORKER_ID,0,gt_strtok(@REG_GROUP, @v_reg_m, '|'));
			
					IF FLAG IN (0,1) THEN 	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_tile_19_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_romer_tile_19_gsm_hr,' LIKE ',v_group_db_name,'.',@table_romer_tile_19_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_romer_tile_19_gsm_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_tile_19_gsm_hr);
						SET @ERROR_FLAG='10_romer_tile_19_gsm_hr_19';
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_tile_19_gsm_hr,'
								    (`TILE_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     `DATA_DATE`,
								     `DATA_HOUR`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
								  `TILE_ID`,MCC,MNC,
								  `FREQUENCY`,
								  `BCCH_ARFCN`,
								  `DATA_DATE`,
								  `DATA_HOUR`,
								  ',TILE_GSM_COLUMN_IFNULL_STR,' 
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_tile_19_gsm_hr))
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_romer_tile_19_gsm_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_tile_19_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_ROMER_TILE_19_gsm_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_gsm_hr,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_TileResolution_Insert_MV`(TECH_MASK,@table_romer_tile_19_gsm_hr,@tmp_romer_tile_19_gsm_hr,'HR',PENDING_FLAG,TileResolution,SHARE_DB, v_group_db_name,v_DATA_HOUR);
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_gsm_hr,' HR cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						SET @FLAG_ROMER_TILE_16_gsm_HR=1;
						SET @FLAG_ROMER_TILE_13_gsm_HR=1;
	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_reg_3_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_romer_reg_3_gsm_hr,' LIKE ',v_group_db_name,'.',@table_romer_reg_3_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_gsm_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_3_gsm_hr);
						SET @ERROR_FLAG='10_romer_reg_3_gsm_hr_20';
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_3_gsm_hr,'
								    (`REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     `DATA_DATE`,
								     `DATA_HOUR`,
								     ',TILE_GSM_COLUMN_STR,')
							SELECT
							  `REG_3_ID` AS `REG_ID`,MCC,MNC,
							  `FREQUENCY`,
							  `BCCH_ARFCN`,
							  `DATA_DATE`,
							  `DATA_HOUR`,
							  ',TILE_GSM_COLUMN_SUM_STR,' 
							FROM ',SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr,' 
							GROUP BY `REG_3_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`,`DATA_DATE`,`DATA_HOUR`
							ORDER BY NULL '
							,CASE PENDING_FLAG WHEN 1 THEN 
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_reg_3_gsm_hr))
								ELSE '' END
							,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_romer_reg_3_gsm_hr,'#P#h',v_DATA_HOUR,'.*');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_reg_3_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_ROMER_REG_3_gsm_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_3_gsm_hr,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_reg_2_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_romer_reg_2_gsm_hr,' LIKE ',v_group_db_name,'.',@table_romer_reg_2_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_gsm_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_2_gsm_hr);
						SET @ERROR_FLAG='10_romer_reg_2_gsm_hr_21';
	
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_2_gsm_hr,'
								    (
									`REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     `DATA_DATE`,
								     `DATA_HOUR`,
								     ',TILE_GSM_COLUMN_STR,')
							SELECT
								`REG_2_ID` AS `REG_ID`,MCC,MNC,
								  `FREQUENCY`,
								  `BCCH_ARFCN`,
								  `DATA_DATE`,
								  `DATA_HOUR`,
								  ',TILE_GSM_COLUMN_SUM_STR,' 
							FROM ',SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr,' 
							GROUP BY `REG_2_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`,`DATA_DATE`,`DATA_HOUR`
							ORDER BY NULL '
							,CASE PENDING_FLAG WHEN 1 THEN 
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_reg_2_gsm_hr))
								ELSE '' END
							,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_romer_reg_2_gsm_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_reg_2_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_ROMER_REG_2_gsm_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_2_gsm_hr,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_reg_1_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_romer_reg_1_gsm_hr,' LIKE ',v_group_db_name,'.',@table_romer_reg_1_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_gsm_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_1_gsm_hr);
						SET @ERROR_FLAG='10_romer_reg_1_gsm_hr_22';
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_1_gsm_hr,'
								    (
									`REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     `DATA_DATE`,
								     `DATA_HOUR`,
								     ',TILE_GSM_COLUMN_STR,')
							SELECT
								`REG_1_ID` AS `REG_ID`,MCC,MNC,
								  `FREQUENCY`,
								  `BCCH_ARFCN`,
								  `DATA_DATE`,
								  `DATA_HOUR`,
								  ',TILE_GSM_COLUMN_SUM_STR,' 
							FROM ',SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr,' 
							GROUP BY `REG_1_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`,`DATA_DATE`,`DATA_HOUR`
							ORDER BY NULL '
							,CASE PENDING_FLAG WHEN 1 THEN 
								CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_reg_1_gsm_hr))
								ELSE '' END
							,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_romer_reg_1_gsm_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_reg_1_gsm_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_ROMER_REG_1_gsm_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_1_gsm_hr,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SOURCE_TABLE_NAME=@table_romer_tile_19_gsm_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_tile_19_gsm_dy);
						SET @ERROR_FLAG='10_romer_tile_19_gsm_dy_23';
						
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_tile_19_gsm_dy,' 
								    (`TILE_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     `DATA_DATE`,
								     ',TILE_GSM_COLUMN_STR,',
									',@TILE_ID_LVL2,',
									',@TILE_ID_LVL1,',
									`REG_1_ID`,
									`REG_2_ID`,
									`REG_3_ID`)
								SELECT
								  `TILE_ID`,MCC,MNC,
								  `FREQUENCY`,
								  `BCCH_ARFCN`,
								  `DATA_DATE`,
								  ',TILE_GSM_COLUMN_IFNULL_STR,',
									',@TILE_ID_LVL2,',
									',@TILE_ID_LVL1,',
									`REG_1_ID`,
									`REG_2_ID`,
									`REG_3_ID` 
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr,' 
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_tile_19_gsm_dy),',
								',@table_romer_tile_19_gsm_dy,'.',@TILE_ID_LVL2,'=IF(',@table_romer_tile_19_gsm_dy,'.',@TILE_ID_LVL2,' IS NULL,VALUES(',@TILE_ID_LVL2,'),',@table_romer_tile_19_gsm_dy,'.',@TILE_ID_LVL2,'),
								',@table_romer_tile_19_gsm_dy,'.',@TILE_ID_LVL1,'=IF(',@table_romer_tile_19_gsm_dy,'.',@TILE_ID_LVL1,' IS NULL,VALUES(',@TILE_ID_LVL1,'),',@table_romer_tile_19_gsm_dy,'.',@TILE_ID_LVL1,'),
								',@table_romer_tile_19_gsm_dy,'.REG_1_ID=IF(',@table_romer_tile_19_gsm_dy,'.REG_1_ID IS NULL,VALUES(REG_1_ID),',@table_romer_tile_19_gsm_dy,'.REG_1_ID),
								',@table_romer_tile_19_gsm_dy,'.REG_2_ID=IF(',@table_romer_tile_19_gsm_dy,'.REG_2_ID IS NULL,VALUES(REG_2_ID),',@table_romer_tile_19_gsm_dy,'.REG_2_ID),
								',@table_romer_tile_19_gsm_dy,'.REG_3_ID=IF(',@table_romer_tile_19_gsm_dy,'.REG_3_ID IS NULL,VALUES(REG_3_ID),',@table_romer_tile_19_gsm_dy,'.REG_3_ID)
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
				
						SET @SOURCE_TABLE_NAME=@table_romer_tile_19_gsm_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_TILE_19_gsm_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_gsm_dy,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_TileResolution_Insert_MV`(TECH_MASK,@table_romer_tile_19_gsm_dy,@tmp_romer_tile_19_gsm_hr,'DY',PENDING_FLAG,TileResolution,SHARE_DB,v_group_db_name,v_DATA_HOUR);
					
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_gsm_dy,' DY cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();						
						SET @FLAG_ROMER_TILE_16_gsm_DY=1;
						SET @FLAG_ROMER_TILE_13_gsm_DY=1;
		
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_gsm_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_3_gsm_dy);
						SET @ERROR_FLAG='10_romer_reg_3_gsm_dy_24';
	
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_3_gsm_dy,' 
								    (`REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     `DATA_DATE`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
								  `REG_3_ID` AS `REG_ID`,MCC,MNC,
								  `FREQUENCY`,
								  `BCCH_ARFCN`,
								  `DATA_DATE`,
								  ',TILE_GSM_COLUMN_SUM_STR,' 
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr,' 
								GROUP BY `REG_3_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`,`DATA_DATE`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE   
								',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_reg_3_gsm_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_gsm_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);					
						
						SET @FLAG_ROMER_REG_3_gsm_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_3_gsm_dy,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_gsm_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_2_gsm_dy);
						SET @ERROR_FLAG='10_romer_reg_2_gsm_dy_25';
	
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_2_gsm_dy,' 
								    (
									`REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     `DATA_DATE`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
									`REG_2_ID` AS `REG_ID`,MCC,MNC,
									  `FREQUENCY`,
									  `BCCH_ARFCN`,
									  `DATA_DATE`,
									  ',TILE_GSM_COLUMN_SUM_STR,' 
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr,' 
								GROUP BY `REG_2_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`,`DATA_DATE`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE  
								',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_reg_2_gsm_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_gsm_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_2_gsm_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_2_gsm_dy,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_gsm_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_1_gsm_dy);						SET @ERROR_FLAG='10_romer_reg_1_gsm_dy_26';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
	
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_1_gsm_dy,' 
								    (
									`REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     `DATA_DATE`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
									`REG_1_ID` AS `REG_ID`,MCC,MNC,
									  `FREQUENCY`,
									  `BCCH_ARFCN`,
									  `DATA_DATE`,
									  ',TILE_GSM_COLUMN_SUM_STR,' 
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr,' 
								GROUP BY `REG_1_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`,`DATA_DATE`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE  
								',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_reg_1_gsm_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_gsm_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
	
						SET @FLAG_ROMER_REG_1_gsm_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_1_gsm_dy,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE(); 
					END IF;
					IF FLAG = 0 THEN  
						SET @SOURCE_TABLE_NAME=@table_romer_tile_19_gsm_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_tile_19_gsm_wk);
						SET @ERROR_FLAG='10_romer_tile_19_gsm_wk_27';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
							
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_tile_19_gsm_wk,' 
								    (`TILE_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
								  `TILE_ID`,MCC,MNC,
								  `FREQUENCY`,
								  `BCCH_ARFCN`,
								  ',TILE_GSM_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr,' 
								GROUP BY `TILE_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE  
								',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_tile_19_gsm_wk)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_romer_tile_19_gsm_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_TILE_19_gsm_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_gsm_wk,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_TileResolution_Insert_MV`(TECH_MASK,@table_romer_tile_19_gsm_wk,@tmp_romer_tile_19_gsm_hr,'WK',PENDING_FLAG,TileResolution,SHARE_DB, v_group_db_name,v_DATA_HOUR);
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_gsm_wk,' WK cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						SET @FLAG_ROMER_TILE_16_gsm_WK=1;
						SET @FLAG_ROMER_TILE_13_gsm_WK=1;
						 
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_gsm_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_3_gsm_wk);
						SET @ERROR_FLAG='10_romer_reg_3_gsm_wk_28';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_3_gsm_wk,' 
								    (`REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
								  `REG_3_ID` AS `REG_ID`,MCC,MNC,
								  `FREQUENCY`,
								  `BCCH_ARFCN`,
								  ',TILE_GSM_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr,' 
								GROUP BY `REG_3_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_3_gsm_wk)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_gsm_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_3_gsm_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_3_gsm_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_gsm_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_2_gsm_wk);
						SET @ERROR_FLAG='10_romer_reg_2_gsm_wk_29';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_2_gsm_wk,' 
								    (`REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
									`REG_2_ID` AS `REG_ID`,MCC,MNC,
									  `FREQUENCY`,
									  `BCCH_ARFCN`,
									  ',TILE_GSM_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr,' 
								GROUP BY `REG_2_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_2_gsm_wk)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_gsm_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_2_gsm_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_2_gsm_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_gsm_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_1_gsm_wk);
						SET @ERROR_FLAG='10_romer_reg_1_gsm_wk_30';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_1_gsm_wk,' 
								    (
									`REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
									`REG_1_ID` AS `REG_ID`,MCC,MNC,
									  `FREQUENCY`,
									  `BCCH_ARFCN`,
									  ',TILE_GSM_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr,' 
								GROUP BY `REG_1_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_1_gsm_wk)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_gsm_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_1_gsm_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_1_gsm_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();						
						
						SET @SOURCE_TABLE_NAME=@table_romer_tile_19_gsm_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_tile_19_gsm_mn);
						SET @ERROR_FLAG='10_romer_tile_19_gsm_mn_31';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_tile_19_gsm_mn,' 
								    (`TILE_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
								  `TILE_ID`,MCC,MNC,
								  `FREQUENCY`,
								  `BCCH_ARFCN`,
								  ',TILE_GSM_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr,' 
								GROUP BY `TILE_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_tile_19_gsm_mn)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_romer_tile_19_gsm_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_TILE_19_gsm_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_gsm_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_TileResolution_Insert_MV`(TECH_MASK,@table_romer_tile_19_gsm_mn,@tmp_romer_tile_19_gsm_hr,'WK',PENDING_FLAG,TileResolution,SHARE_DB, v_group_db_name,v_DATA_HOUR);
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_gsm_mn,' MN cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @FLAG_ROMER_TILE_16_gsm_MN=1;
						SET @FLAG_ROMER_TILE_13_gsm_MN=1;	
						
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_gsm_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_3_gsm_mn);
						SET @ERROR_FLAG='10_romer_reg_3_gsm_mn_32';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_3_gsm_mn,' 
								    (`REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
								  `REG_3_ID` AS `REG_ID`,MCC,MNC,
								  `FREQUENCY`,
								  `BCCH_ARFCN`,
								  ',TILE_GSM_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr,' 
								GROUP BY `REG_3_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_3_gsm_mn)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_gsm_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_3_gsm_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_3_gsm_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_gsm_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_2_gsm_mn);
						SET @ERROR_FLAG='10_romer_reg_2_gsm_mn_33';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_2_gsm_mn,' 
								    (
									`REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
									`REG_2_ID` AS `REG_ID`,MCC,MNC,
									  `FREQUENCY`,
									  `BCCH_ARFCN`,
									  ',TILE_GSM_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr,' 
								GROUP BY `REG_2_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_2_gsm_mn)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_gsm_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_2_gsm_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_2_gsm_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_gsm_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_1_gsm_mn);
						SET @ERROR_FLAG='10_romer_reg_1_gsm_mn_34';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_1_gsm_mn,' 
								    (
									`REG_ID`,MCC,MNC,
								     `FREQUENCY`,
								     `BCCH_ARFCN`,
								     ',TILE_GSM_COLUMN_STR,')
								SELECT
									`REG_1_ID` AS `REG_ID`,MCC,MNC,
									  `FREQUENCY`,
									  `BCCH_ARFCN`,
									  ',TILE_GSM_COLUMN_SUM_STR,'  
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr,' 
								GROUP BY `REG_1_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_1_gsm_mn)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_gsm_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
								
						SET @FLAG_ROMER_REG_1_gsm_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_1_gsm_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE(); 
					END IF;
			
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@tmp_romer_tile_19_gsm_hr,';');					
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.tmp_table_call_cnt_',WORKER_ID,' A
						SET 
						  A.`FLAG_ROMER_TILE_19_HR` = ',@FLAG_ROMER_TILE_19_gsm_HR,',
						  A.`FLAG_ROMER_TILE_19_DY` = ',@FLAG_ROMER_TILE_19_gsm_DY,',
						  A.`FLAG_ROMER_TILE_16_HR` = ',@FLAG_ROMER_TILE_16_gsm_HR,',
						  A.`FLAG_ROMER_TILE_16_DY` = ',@FLAG_ROMER_TILE_16_gsm_DY,',
						  A.`FLAG_ROMER_TILE_13_HR` = ',@FLAG_ROMER_TILE_13_gsm_HR,',
						  A.`FLAG_ROMER_TILE_13_DY` = ',@FLAG_ROMER_TILE_13_gsm_DY,',
						  A.`FLAG_ROMER_TILE_19_WK` = ',@FLAG_ROMER_TILE_19_gsm_WK,',
						  A.`FLAG_ROMER_TILE_19_MN` = ',@FLAG_ROMER_TILE_19_gsm_MN,',
						  A.`FLAG_ROMER_TILE_16_WK` = ',@FLAG_ROMER_TILE_16_gsm_WK,',
						  A.`FLAG_ROMER_TILE_16_MN` = ',@FLAG_ROMER_TILE_16_gsm_MN,',
						  A.`FLAG_ROMER_TILE_13_WK` = ',@FLAG_ROMER_TILE_13_gsm_WK,',
						  A.`FLAG_ROMER_TILE_13_MN` = ',@FLAG_ROMER_TILE_13_gsm_MN,', 
						  A.`FLAG_ROMER_REG_3_HR` = ',@FLAG_ROMER_REG_3_gsm_HR,',
						  A.`FLAG_ROMER_REG_3_DY` = ',@FLAG_ROMER_REG_3_gsm_DY,',
						  A.`FLAG_ROMER_REG_2_HR` = ',@FLAG_ROMER_REG_2_gsm_HR,',
						  A.`FLAG_ROMER_REG_2_DY` = ',@FLAG_ROMER_REG_2_gsm_DY,',
						  A.`FLAG_ROMER_REG_1_HR` = ',@FLAG_ROMER_REG_1_gsm_HR,',
						  A.`FLAG_ROMER_REG_1_DY` = ',@FLAG_ROMER_REG_1_gsm_DY,',
						  A.`FLAG_ROMER_REG_3_WK` = ',@FLAG_ROMER_REG_3_gsm_WK,',
						  A.`FLAG_ROMER_REG_3_MN` = ',@FLAG_ROMER_REG_3_gsm_MN,',
						  A.`FLAG_ROMER_REG_2_WK` = ',@FLAG_ROMER_REG_2_gsm_WK,',
						  A.`FLAG_ROMER_REG_2_MN` = ',@FLAG_ROMER_REG_2_gsm_MN,',
						  A.`FLAG_ROMER_REG_1_WK` = ',@FLAG_ROMER_REG_1_gsm_WK,',
						  A.`FLAG_ROMER_REG_1_MN` = ',@FLAG_ROMER_REG_1_gsm_MN,'  
						WHERE A.`TECH_MASK`=1
						;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('GSM SELECT COUNT(*),TRUE,',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				END IF;		
		
				IF v_TECH_MASK=4 THEN
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@tmp_romer_tile_19_lte_hr,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;	
		
					SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@tmp_romer_tile_19_lte_hr,' LIKE ',@global_db,'.tmp_romer_tile_lte_',@EX_DATE,' ;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
				
					SET @SOURCE_TABLE_NAME=@tmp_romer_tile_19_lte_hr;
					SET @ERROR_FLAG='10_tmp_romer_tile_19_lte_hr_35';
					
					SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@tmp_romer_tile_19_lte_hr,' 
								(
								`TILE_ID`,MCC,MNC,
								`EARFCN`,
								`EUTRABAND`,
								`DATA_DATE`,
								`DATA_HOUR`,
								',TILE_LTE_COLUMN_STR,',
								',@TILE_ID_LVL2,',
								',@TILE_ID_LVL1,',
								`REG_1_ID`,
								`REG_2_ID`,
								`REG_3_ID`)
							SELECT
								`TILE_ID` AS `TILE_ID`,MCC,MNC,
								`EARFCN`,
								`EUTRABAND`,
								`DATA_DATE`,
								`DATA_HOUR`,
								',TILE_LTE_COLUMN_SUM_STR,',
								',@TILE_ID_LVL2,',
								',@TILE_ID_LVL1,',
								`REG_1_ID`,
								`REG_2_ID`,
								`REG_3_ID`
							FROM ',@global_db,'.tmp_romer_tile_lte_',@EX_DATE,' 
							GROUP BY `TILE_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`,`DATA_DATE`,`DATA_HOUR`
							ORDER BY NULL
							;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
		
					CALL gt_global_statistic.SP_Generate_Global_Statistic_Sub_Tile_Reg_Map(CONCAT(SHARE_DB,'.',@tmp_romer_tile_19_lte_hr),WORKER_ID,0,gt_strtok(@REG_GROUP, @v_reg_m, '|'));
					IF FLAG IN (0,1) THEN		
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_tile_19_lte_hr,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
		
					SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_romer_tile_19_lte_hr,' LIKE ',v_group_db_name,'.',@table_romer_tile_19_lte_hr,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
				
					SET @SOURCE_TABLE_NAME=@table_romer_tile_19_lte_hr;
					SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_tile_19_lte_hr);
					SET @ERROR_FLAG='10_romer_tile_19_lte_hr_36';
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_tile_19_lte_hr,' 
								    (
									`TILE_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',TILE_LTE_COLUMN_STR,',
									`REG_1_ID`,
									`REG_2_ID`,
									`REG_3_ID`)
								SELECT
									`TILE_ID` AS `TILE_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',TILE_LTE_COLUMN_IFNULL_STR,',
									`REG_1_ID`,
									`REG_2_ID`,
									`REG_3_ID`
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_lte_hr
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_tile_19_lte_hr),',
									',@table_romer_tile_19_lte_hr,'.REG_1_ID=IF(',@table_romer_tile_19_lte_hr,'.REG_1_ID IS NULL,VALUES(REG_1_ID),',@table_romer_tile_19_lte_hr,'.REG_1_ID),
									',@table_romer_tile_19_lte_hr,'.REG_2_ID=IF(',@table_romer_tile_19_lte_hr,'.REG_2_ID IS NULL,VALUES(REG_2_ID),',@table_romer_tile_19_lte_hr,'.REG_2_ID),
									',@table_romer_tile_19_lte_hr,'.REG_3_ID=IF(',@table_romer_tile_19_lte_hr,'.REG_3_ID IS NULL,VALUES(REG_3_ID),',@table_romer_tile_19_lte_hr,'.REG_3_ID)')
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_romer_tile_19_lte_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_tile_19_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_ROMER_TILE_19_LTE_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_lte_hr,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_TileResolution_Insert_MV`(TECH_MASK,@table_romer_tile_19_lte_hr,@tmp_romer_tile_19_lte_hr,'HR',PENDING_FLAG,TileResolution,SHARE_DB, v_group_db_name,v_DATA_HOUR);
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_lte_hr,' HR cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @FLAG_ROMER_TILE_16_LTE_HR=1;
						SET @FLAG_ROMER_TILE_13_LTE_HR=1;
	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_reg_3_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_romer_reg_3_lte_hr,' LIKE ',v_group_db_name,'.',@table_romer_reg_3_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_lte_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_3_lte_hr);
						SET @ERROR_FLAG='10_romer_reg_3_lte_hr_37';
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_3_lte_hr,'
								    (
									`REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_3_ID` AS `REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_lte_hr,'
								GROUP BY `REG_3_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`,`DATA_DATE`,`DATA_HOUR`
								ORDER BY NULL '
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_reg_3_lte_hr))
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_romer_reg_3_lte_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_reg_3_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_ROMER_REG_3_LTE_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_3_lte_hr,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_reg_2_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_romer_reg_2_lte_hr,' LIKE ',v_group_db_name,'.',@table_romer_reg_2_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_lte_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_2_lte_hr);
						SET @ERROR_FLAG='10_romer_reg_2_lte_hr_38';
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_2_lte_hr,'
								    (
									`REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_2_ID` AS `REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_lte_hr,'
								GROUP BY `REG_2_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`,`DATA_DATE`,`DATA_HOUR`
								ORDER BY NULL '
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_reg_2_lte_hr))
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_romer_reg_2_lte_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_reg_2_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_ROMER_REG_2_LTE_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_2_lte_hr,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_reg_1_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SqlCmd=CONCAT('CREATE TABLE ',SHARE_DB,'.',@table_romer_reg_1_lte_hr,' LIKE ',v_group_db_name,'.',@table_romer_reg_1_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_lte_hr;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_1_lte_hr);
						SET @ERROR_FLAG='10_romer_reg_1_lte_hr_39';
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_1_lte_hr,'
								    (
									`REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_1_ID` AS `REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									`DATA_HOUR`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_lte_hr,'
								GROUP BY `REG_1_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`,`DATA_DATE`,`DATA_HOUR`
								ORDER BY NULL '
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_reg_1_lte_hr))
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=CONCAT(@table_romer_reg_1_lte_hr,'#P#h',v_DATA_HOUR,'.');
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_reg_1_lte_hr,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_ROMER_REG_1_LTE_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_1_lte_hr,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SOURCE_TABLE_NAME=@table_romer_tile_19_lte_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_tile_19_lte_dy);
						SET @ERROR_FLAG='10_romer_tile_19_lte_dy_40';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_tile_19_lte_dy,' 
								    (
									`TILE_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									',TILE_LTE_COLUMN_STR,',
									`REG_1_ID`,
									`REG_2_ID`,
									`REG_3_ID`,
									',@TILE_ID_LVL2,',
									',@TILE_ID_LVL1,')
								SELECT
									`TILE_ID` AS `TILE_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									',TILE_LTE_COLUMN_IFNULL_STR,',
									`REG_1_ID`,
									`REG_2_ID`,
									`REG_3_ID`,
									',@TILE_ID_LVL2,',
									',@TILE_ID_LVL1,'
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_lte_hr,' 
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_tile_19_lte_dy),',
								',@table_romer_tile_19_lte_dy,'.REG_1_ID=IF(',@table_romer_tile_19_lte_dy,'.REG_1_ID IS NULL,VALUES(REG_1_ID),',@table_romer_tile_19_lte_dy,'.REG_1_ID),
								',@table_romer_tile_19_lte_dy,'.REG_2_ID=IF(',@table_romer_tile_19_lte_dy,'.REG_2_ID IS NULL,VALUES(REG_2_ID),',@table_romer_tile_19_lte_dy,'.REG_2_ID),
								',@table_romer_tile_19_lte_dy,'.REG_3_ID=IF(',@table_romer_tile_19_lte_dy,'.REG_3_ID IS NULL,VALUES(REG_3_ID),',@table_romer_tile_19_lte_dy,'.REG_3_ID),
								',@table_romer_tile_19_lte_dy,'.',@TILE_ID_LVL2,'=IF(',@table_romer_tile_19_lte_dy,'.',@TILE_ID_LVL2,' IS NULL,VALUES(',@TILE_ID_LVL2,'),',@table_romer_tile_19_lte_dy,'.',@TILE_ID_LVL2,'),
								',@table_romer_tile_19_lte_dy,'.',@TILE_ID_LVL1,'=IF(',@table_romer_tile_19_lte_dy,'.',@TILE_ID_LVL1,' IS NULL,VALUES(',@TILE_ID_LVL1,'),',@table_romer_tile_19_lte_dy,'.',@TILE_ID_LVL1,')
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_romer_tile_19_lte_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_TILE_19_lte_dy=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_lte_dy,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_TileResolution_Insert_MV`(TECH_MASK,@table_romer_tile_19_lte_dy,@tmp_romer_tile_19_lte_hr,'DY',PENDING_FLAG,TileResolution,SHARE_DB,v_group_db_name,v_DATA_HOUR);
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_lte_dy,' DY cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						SET @FLAG_ROMER_TILE_16_lte_dy=1;
						SET @FLAG_ROMER_TILE_13_lte_dy=1;
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_lte_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_3_lte_dy);
						SET @ERROR_FLAG='10_romer_reg_3_lte_dy_41';
	
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
															
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_3_lte_dy,'  
								    (
									`REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_3_ID` AS `REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_lte_hr,'
								GROUP BY `REG_3_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`,`DATA_DATE`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_reg_3_lte_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
			
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_lte_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_3_lte_dy=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_3_lte_dy,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();	
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_lte_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_2_lte_dy);
						SET @ERROR_FLAG='10_romer_reg_2_lte_dy_42';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
									
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_2_lte_dy,'  
								    (
									`REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_2_ID` AS `REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_lte_hr,'
								GROUP BY `REG_2_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`,`DATA_DATE`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_reg_2_lte_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
							
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_lte_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
	
						SET @FLAG_ROMER_REG_2_lte_dy=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_2_lte_dy,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();	
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_lte_dy;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_1_lte_dy);
						SET @ERROR_FLAG='10_romer_reg_1_lte_dy_43';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
									
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_1_lte_dy,'  
								    (
									`REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_1_ID` AS `REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									`DATA_DATE`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_lte_hr,'
								GROUP BY `REG_1_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`,`DATA_DATE`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_romer_reg_1_lte_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
	
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_lte_dy;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_1_lte_dy=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_1_lte_dy,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
					END IF; 
		
					IF FLAG =0 THEN 		
						SET @SOURCE_TABLE_NAME=@table_romer_tile_19_lte_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_tile_19_lte_wk);
						SET @ERROR_FLAG='10_romer_tile_19_lte_wk_44';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_tile_19_lte_wk,' 
								    (
									`TILE_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_STR,',
									`REG_1_ID`,
									`REG_2_ID`,
									`REG_3_ID`)
								SELECT
									`TILE_ID` AS `TILE_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_IFNULL_STR,',
									`REG_1_ID`,
									`REG_2_ID`,
									`REG_3_ID`
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_lte_hr,' 
								ON DUPLICATE KEY UPDATE  
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_wk)),',
								',SHARE_DB,'.',@table_romer_tile_19_lte_wk,'.REG_1_ID=IF(',SHARE_DB,'.',@table_romer_tile_19_lte_wk,'.REG_1_ID IS NULL,VALUES(REG_1_ID),',SHARE_DB,'.',@table_romer_tile_19_lte_wk,'.REG_1_ID),
								',SHARE_DB,'.',@table_romer_tile_19_lte_wk,'.REG_2_ID=IF(',SHARE_DB,'.',@table_romer_tile_19_lte_wk,'.REG_2_ID IS NULL,VALUES(REG_2_ID),',SHARE_DB,'.',@table_romer_tile_19_lte_wk,'.REG_2_ID),
								',SHARE_DB,'.',@table_romer_tile_19_lte_wk,'.REG_3_ID=IF(',SHARE_DB,'.',@table_romer_tile_19_lte_wk,'.REG_3_ID IS NULL,VALUES(REG_3_ID),',SHARE_DB,'.',@table_romer_tile_19_lte_wk,'.REG_3_ID)
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_romer_tile_19_lte_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_TILE_19_lte_wk=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_TileResolution_Insert_MV`(TECH_MASK,@table_romer_tile_19_lte_wk,@tmp_romer_tile_19_lte_hr,'WK',PENDING_FLAG,TileResolution,SHARE_DB, v_group_db_name,v_DATA_HOUR);
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_lte_wk,' WK cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						SET @FLAG_ROMER_TILE_16_lte_wk=1;
						SET @FLAG_ROMER_TILE_13_lte_wk=1;
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_lte_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_3_lte_wk);
						SET @ERROR_FLAG='10_romer_reg_3_lte_wk_45';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_3_lte_wk,' 
								    (
									`REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_3_ID` AS `REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_lte_hr,' 
								GROUP BY `REG_3_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE  
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_3_lte_wk)),'
								;'); 
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_lte_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_3_lte_wk=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_3_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_lte_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_2_lte_wk);
						SET @ERROR_FLAG='10_romer_reg_2_lte_wk_46';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_2_lte_wk,' 
								    (
									`REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_2_ID` AS `REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_lte_hr,' 
								GROUP BY `REG_2_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE  
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_2_lte_wk)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_lte_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_2_lte_wk=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_2_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_lte_wk;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_1_lte_wk);
						SET @ERROR_FLAG='10_romer_reg_1_lte_wk_47';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_1_lte_wk,' 
								    (
									`REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_1_ID` AS `REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_lte_hr,' 
								GROUP BY `REG_1_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE  
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_1_lte_wk)),'
								;'); 
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_lte_wk;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_1_lte_wk=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_1_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_romer_tile_19_lte_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_tile_19_lte_mn);
						SET @ERROR_FLAG='10_romer_tile_19_lte_mn_48';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_tile_19_lte_mn,' 
								    (
									`TILE_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_STR,',
									`REG_1_ID`,
									`REG_2_ID`,
									`REG_3_ID`)
								SELECT
									`TILE_ID` AS `TILE_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_IFNULL_STR,',
									`REG_1_ID`,
									`REG_2_ID`,
									`REG_3_ID`
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_lte_hr,' 
								ON DUPLICATE KEY UPDATE  
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_mn)),',
								',SHARE_DB,'.',@table_romer_tile_19_lte_mn,'.REG_1_ID=IF(',SHARE_DB,'.',@table_romer_tile_19_lte_mn,'.REG_1_ID IS NULL,VALUES(REG_1_ID),',SHARE_DB,'.',@table_romer_tile_19_lte_mn,'.REG_1_ID),
								',SHARE_DB,'.',@table_romer_tile_19_lte_mn,'.REG_2_ID=IF(',SHARE_DB,'.',@table_romer_tile_19_lte_mn,'.REG_2_ID IS NULL,VALUES(REG_2_ID),',SHARE_DB,'.',@table_romer_tile_19_lte_mn,'.REG_2_ID),
								',SHARE_DB,'.',@table_romer_tile_19_lte_mn,'.REG_3_ID=IF(',SHARE_DB,'.',@table_romer_tile_19_lte_mn,'.REG_3_ID IS NULL,VALUES(REG_3_ID),',SHARE_DB,'.',@table_romer_tile_19_lte_mn,'.REG_3_ID)
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_romer_tile_19_lte_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_TILE_19_lte_mn=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_lte_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_TileResolution_Insert_MV`(TECH_MASK,@table_romer_tile_19_lte_mn,@tmp_romer_tile_19_lte_hr,'MN',PENDING_FLAG,TileResolution,SHARE_DB, v_group_db_name,v_DATA_HOUR);
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_lte_mn,' MN cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
						SET @FLAG_ROMER_TILE_16_lte_mn=1;
						SET @FLAG_ROMER_TILE_13_lte_mn=1;
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_lte_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_3_lte_mn);
						SET @ERROR_FLAG='10_romer_reg_3_lte_mn_49';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
												
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_3_lte_mn,' 
								    (
									`REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_3_ID` AS `REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_lte_hr,' 
								GROUP BY `REG_3_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_3_lte_mn)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_3_lte_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_3_lte_mn=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_3_lte_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_lte_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_2_lte_mn);
						SET @ERROR_FLAG='10_romer_reg_2_lte_mn_50';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_2_lte_mn,' 
								    (
									`REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_2_ID` AS `REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_lte_hr,' 
								GROUP BY `REG_2_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_2_lte_mn)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_2_lte_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_2_lte_mn=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_2_lte_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_lte_mn;
						SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_1_lte_mn);
						SET @ERROR_FLAG='10_romer_reg_1_lte_mn_51';
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_1_lte_mn,' 
								    (
									`REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_STR,')
								SELECT
									`REG_1_ID` AS `REG_ID`,MCC,MNC,
									`EARFCN`,
									`EUTRABAND`,
									',TILE_LTE_COLUMN_SUM_STR,'
								FROM ',SHARE_DB,'.',@tmp_romer_tile_19_lte_hr,' 
								GROUP BY `REG_1_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`
								ORDER BY NULL
								ON DUPLICATE KEY UPDATE 
								',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_1_lte_mn)),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
								
						SET @SOURCE_TABLE_NAME=@table_romer_reg_1_lte_mn;
						CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
						
						SET @FLAG_ROMER_REG_1_lte_mn=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_1_lte_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
					END IF;
			
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@tmp_romer_tile_19_lte_hr,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.tmp_table_call_cnt_',WORKER_ID,' A
								SET 
								  A.`FLAG_ROMER_TILE_19_HR` = ',@FLAG_ROMER_TILE_19_LTE_HR,',
								  A.`FLAG_ROMER_TILE_19_DY` = ',@FLAG_ROMER_TILE_19_LTE_DY,',
								  A.`FLAG_ROMER_TILE_16_HR` = ',@FLAG_ROMER_TILE_16_LTE_HR,',
								  A.`FLAG_ROMER_TILE_16_DY` = ',@FLAG_ROMER_TILE_16_LTE_DY,',
								  A.`FLAG_ROMER_TILE_13_HR` = ',@FLAG_ROMER_TILE_13_LTE_HR,',
								  A.`FLAG_ROMER_TILE_13_DY` = ',@FLAG_ROMER_TILE_13_LTE_DY,',
								  A.`FLAG_ROMER_TILE_19_WK` = ',@FLAG_ROMER_TILE_19_LTE_WK,',
								  A.`FLAG_ROMER_TILE_19_MN` = ',@FLAG_ROMER_TILE_19_LTE_MN,',
								  A.`FLAG_ROMER_TILE_16_WK` = ',@FLAG_ROMER_TILE_16_LTE_WK,',
								  A.`FLAG_ROMER_TILE_16_MN` = ',@FLAG_ROMER_TILE_16_LTE_MN,',
								  A.`FLAG_ROMER_TILE_13_WK` = ',@FLAG_ROMER_TILE_13_LTE_WK,',
								  A.`FLAG_ROMER_TILE_13_MN` = ',@FLAG_ROMER_TILE_13_LTE_MN,',
								  A.`FLAG_ROMER_REG_3_HR` = ',@FLAG_ROMER_REG_3_LTE_HR,',
								  A.`FLAG_ROMER_REG_3_DY` = ',@FLAG_ROMER_REG_3_LTE_DY,',
								  A.`FLAG_ROMER_REG_2_HR` = ',@FLAG_ROMER_REG_2_LTE_HR,',
								  A.`FLAG_ROMER_REG_2_DY` = ',@FLAG_ROMER_REG_2_LTE_DY,',
								  A.`FLAG_ROMER_REG_1_HR` = ',@FLAG_ROMER_REG_1_LTE_HR,',
								  A.`FLAG_ROMER_REG_1_DY` = ',@FLAG_ROMER_REG_1_LTE_DY,',
								  A.`FLAG_ROMER_REG_3_WK` = ',@FLAG_ROMER_REG_3_LTE_WK,',
								  A.`FLAG_ROMER_REG_3_MN` = ',@FLAG_ROMER_REG_3_LTE_MN,',
								  A.`FLAG_ROMER_REG_2_WK` = ',@FLAG_ROMER_REG_2_LTE_WK,',
								  A.`FLAG_ROMER_REG_2_MN` = ',@FLAG_ROMER_REG_2_LTE_MN,',
								  A.`FLAG_ROMER_REG_1_WK` = ',@FLAG_ROMER_REG_1_LTE_WK,',
								  A.`FLAG_ROMER_REG_1_MN` = ',@FLAG_ROMER_REG_1_LTE_MN,' 
								WHERE A.`TECH_MASK`=4;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('LTE UPDATE table_call_cnt_',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				END IF;	
				SET v_i=v_i+1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT(v_TECH_MASK,',',WORKER_ID,',',v_i), NOW());
			END;
			END WHILE;
			SET @v_reg_m=@v_reg_m+1;
		END;
		END WHILE;
		IF TECH_MASK=2 THEN
			SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',@global_db,'.tmp_romer_tile_umts_',@EX_DATE,';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('UMTS DROP ',@global_db,'.tmp_romer_tile_umts_',@EX_DATE,' ',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
			SET STEP_START_TIME := SYSDATE();
		END IF;	
		
		IF TECH_MASK=1 THEN	
			SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',@global_db,'.tmp_romer_tile_gsm_',@EX_DATE,';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('GSM DROP ',@global_db,'.tmp_romer_tile_gsm_',@EX_DATE,' ',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
			SET STEP_START_TIME := SYSDATE();
		END IF;	
		
		IF TECH_MASK=4 THEN		
			SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',@global_db,'.tmp_romer_tile_lte_',@EX_DATE,';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('GSM DROP ',@global_db,'.tmp_romer_tile_lte_',@EX_DATE,' ',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
			SET STEP_START_TIME := SYSDATE();
		END IF;	
		
		INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT(v_DATA_DATE,',',v_DATA_HOUR,',',v_TECH_MASK,',',WORKER_ID,' Done: ',TIMESTAMPDIFF(SECOND,START_TIME,SYSDATE()),' seconds.'), NOW());
	END IF;
	
	IF FLAG=2 THEN 
		SET @SqlCmd=CONCAT('SELECT `att_value` INTO @ZOOM_LEVEL FROM gt_covmo.`sys_config` WHERE `group_name`=''system'' AND att_name = ''MapResolution'';');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt; 
	
		IF exDate IS NOT NULL THEN 
			SET @v_DATA_DATE=CAST(exDate AS DATE);
		ELSE 
			SET @v_DATA_DATE=DATE(DATE_ADD(START_TIME,INTERVAL -1 DAY));
		END IF;
		SELECT `DAY_OF_WEEK`(@v_DATA_DATE) INTO @DAY_OF_WEEK;
		SET @FIRST_DAY=gt_strtok(@DAY_OF_WEEK, 1, '|');
		SET @END_DAY=gt_strtok(@DAY_OF_WEEK, 2, '|');
		SET @DATE_WK=CONCAT(DATE_FORMAT(@FIRST_DAY,'%Y%m%d'),'_',DATE_FORMAT(@END_DAY,'%Y%m%d'));
		SET @DATE_MN=DATE_FORMAT(@v_DATA_DATE,'%Y%m');
		SET @EX_DATE=CONCAT(DATE_FORMAT(@v_DATA_DATE,'%Y%m%d_'),WORKER_ID);
		SET @SR_DATE=CONCAT(DATE_FORMAT(@v_DATA_DATE,'%Y%m%d'));
		
		SET @SqlCmd=CONCAT('SELECT GROUP_CONCAT(DISTINCT `group_id` ORDER BY `group_id` SEPARATOR ''|'' ) INTO @REG_GROUP FROM ',@global_db,'.`usr_polygon_reg_3`;');
	
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;		
			
		SET @v_reg_m=1;
		SET @v_reg_Max=gt_covmo_csv_count(@REG_GROUP,'|');
		WHILE @v_reg_m <= @v_reg_Max DO
		BEGIN			
			SET v_group_db_name=CONCAT('gt_global_statistic_g',gt_strtok(@REG_GROUP, @v_reg_m, '|'));
				
			IF TECH_MASK=2 THEN 
				SET @table_romer_tile_19_umts_dy=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_umts_dy_',@SR_DATE);
				SET @table_romer_tile_19_umts_wk=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_umts_wk_',@DATE_WK);
				SET @table_romer_tile_19_umts_mn=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_umts_mn_',@DATE_MN);
				SET @table_romer_reg_3_umts_wk=CONCAT('table_romer_reg_3_umts_wk_',@DATE_WK);
				SET @table_romer_reg_2_umts_wk=CONCAT('table_romer_reg_2_umts_wk_',@DATE_WK);
				SET @table_romer_reg_1_umts_wk=CONCAT('table_romer_reg_1_umts_wk_',@DATE_WK);
				SET @table_romer_reg_3_umts_mn=CONCAT('table_romer_reg_3_umts_mn_',@DATE_MN);
				SET @table_romer_reg_2_umts_mn=CONCAT('table_romer_reg_2_umts_mn_',@DATE_MN);
				SET @table_romer_reg_1_umts_mn=CONCAT('table_romer_reg_1_umts_mn_',@DATE_MN);
				
				SET @SOURCE_TABLE_NAME=CONCAT(@table_romer_tile_19_umts_dy,',',@table_romer_tile_19_umts_wk);
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_tile_19_umts_wk);
				SET @ERROR_FLAG='2_romer_tile_19_umts_wk_1';
	
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_tile_19_umts_wk,' 
						    (`TILE_ID`,MCC,MNC,
						     `FREQUENCY`,
						     `UARFCN`,
						     ',TILE_UMTS_COLUMN_STR,')
						SELECT
						  `TILE_ID`,MCC,MNC,
						  `FREQUENCY`,
						  `UARFCN`,
						  ',TILE_UMTS_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_romer_tile_19_umts_dy,' 
						GROUP BY `TILE_ID`,MCC,MNC,`FREQUENCY`,`UARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_tile_19_umts_wk)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_tile_19_umts_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_TILE_19_UMTS_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_umts_wk,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_TileResolution_Insert_MV`(TECH_MASK,@table_romer_tile_19_umts_wk,@table_romer_tile_19_umts_dy,'WK',PENDING_FLAG,TileResolution,SHARE_DB, v_group_db_name,v_DATA_HOUR);
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_umts_wk,' WK cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				SET @FLAG_ROMER_TILE_16_UMTS_WK=1;
				SET @FLAG_ROMER_TILE_13_UMTS_WK=1;
		
				SET @SOURCE_TABLE_NAME=@table_romer_reg_3_umts_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_3_umts_wk);
				SET @ERROR_FLAG='2_romer_reg_3_umts_wk_2';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_3_umts_wk,' 
						    (`REG_ID`,MCC,MNC,
						     `FREQUENCY`,
						     `UARFCN`,
						     ',TILE_UMTS_COLUMN_STR,')
						SELECT
						  `REG_3_ID` AS `REG_ID`,MCC,MNC,
						  `FREQUENCY`,
						  `UARFCN`,
						  ',TILE_UMTS_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_romer_tile_19_umts_dy,' 
						GROUP BY `REG_3_ID`,MCC,MNC,`FREQUENCY`,`UARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_3_umts_wk)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_3_umts_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_REG_3_UMTS_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_3_umts_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_2_umts_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_2_umts_wk);
				SET @ERROR_FLAG='2_romer_reg_2_umts_wk_3';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_2_umts_wk,' 
						    (`REG_ID`,MCC,MNC,
						     `FREQUENCY`,
						     `UARFCN`,
						     ',TILE_UMTS_COLUMN_STR,')
						SELECT
							`REG_2_ID` AS `REG_ID`,MCC,MNC,
							  `FREQUENCY`,
							  `UARFCN`,
							  ',TILE_UMTS_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_romer_tile_19_umts_dy,' 
						GROUP BY `REG_2_ID`,MCC,MNC,`FREQUENCY`,`UARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_2_umts_wk)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_2_umts_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_REG_2_UMTS_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_2_umts_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_1_umts_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_1_umts_wk);
				SET @ERROR_FLAG='2_romer_reg_1_umts_wk_4';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_1_umts_wk,' 
						    (`REG_ID`,MCC,MNC,
						     `FREQUENCY`,
						     `UARFCN`,
						     ',TILE_UMTS_COLUMN_STR,')
						SELECT
							`REG_1_ID` AS `REG_ID`,MCC,MNC,
							  `FREQUENCY`,
							  `UARFCN`,
							  ',TILE_UMTS_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_romer_tile_19_umts_dy,' 
						GROUP BY `REG_1_ID`,MCC,MNC,`FREQUENCY`,`UARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_1_umts_wk)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_1_umts_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_REG_1_UMTS_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_1_umts_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_romer_tile_19_umts_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_tile_19_umts_mn);
				SET @ERROR_FLAG='2_romer_tile_19_umts_mn_5';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_tile_19_umts_mn,' 
						    (`TILE_ID`,MCC,MNC,
						     `FREQUENCY`,
						     `UARFCN`,
						     ',TILE_UMTS_COLUMN_STR,')
						SELECT
						  `TILE_ID`,MCC,MNC,
						  `FREQUENCY`,
						  `UARFCN`,
						  ',TILE_UMTS_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_romer_tile_19_umts_dy,' 
						GROUP BY `TILE_ID`,MCC,MNC,`FREQUENCY`,`UARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_tile_19_umts_mn)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_tile_19_umts_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
			
				SET @FLAG_ROMER_TILE_19_UMTS_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_umts_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_TileResolution_Insert_MV`(TECH_MASK,@table_romer_tile_19_umts_mn,@table_romer_tile_19_umts_dy,'MN',PENDING_FLAG,TileResolution,SHARE_DB, v_group_db_name,v_DATA_HOUR);
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_umts_mn,' MN cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				SET @FLAG_ROMER_TILE_16_UMTS_MN=1;
				SET @FLAG_ROMER_TILE_13_UMTS_MN=1;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_3_umts_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_3_umts_mn);
				SET @ERROR_FLAG='2_romer_reg_3_umts_mn_6';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_3_umts_mn,' 
						    (`REG_ID`,MCC,MNC,
						     `FREQUENCY`,
						     `UARFCN`,
						     ',TILE_UMTS_COLUMN_STR,')
						SELECT
						  `REG_3_ID` AS `REG_ID`,MCC,MNC,
						  `FREQUENCY`,
						  `UARFCN`,
						  ',TILE_UMTS_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_romer_tile_19_umts_dy,' 
						GROUP BY `REG_3_ID`,MCC,MNC,`FREQUENCY`,`UARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_3_umts_mn)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_3_umts_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_REG_3_UMTS_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_3_umts_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_2_umts_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_2_umts_mn);
				SET @ERROR_FLAG='2_romer_reg_2_umts_mn_7';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_2_umts_mn,' 
						    (`REG_ID`,MCC,MNC,
						     `FREQUENCY`,
						     `UARFCN`,
						     ',TILE_UMTS_COLUMN_STR,')
						SELECT
							`REG_2_ID` AS `REG_ID`,MCC,MNC,
							  `FREQUENCY`,
							  `UARFCN`,
							  ',TILE_UMTS_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_romer_tile_19_umts_dy,' 
						GROUP BY `REG_2_ID`,MCC,MNC,`FREQUENCY`,`UARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_2_umts_mn)),'
						;');
					PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_2_umts_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_REG_2_UMTS_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_2_umts_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_1_umts_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_1_umts_mn);
				SET @ERROR_FLAG='2_romer_reg_1_umts_mn_8';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_1_umts_mn,' 
						    (`REG_ID`,MCC,MNC,
						     `FREQUENCY`,
						     `UARFCN`,
						     ',TILE_UMTS_COLUMN_STR,')
						SELECT
							`REG_1_ID` AS `REG_ID`,MCC,MNC,
							  `FREQUENCY`,
							  `UARFCN`,
							  ',TILE_UMTS_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_romer_tile_19_umts_dy,' 
						GROUP BY `REG_1_ID`,MCC,MNC,`FREQUENCY`,`UARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_1_umts_mn)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_1_umts_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_REG_1_UMTS_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_1_umts_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();			
				
				SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_tile_19_umts_dy,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.`table_call_cnt_history` A
					SET 
					  A.`FLAG_ROMER_TILE_19_WK` = ',@FLAG_ROMER_TILE_19_UMTS_WK,',
					  A.`FLAG_ROMER_TILE_19_MN` = ',@FLAG_ROMER_TILE_19_UMTS_MN,',
					  A.`FLAG_ROMER_TILE_16_WK` = ',@FLAG_ROMER_TILE_16_UMTS_WK,',
					  A.`FLAG_ROMER_TILE_16_MN` = ',@FLAG_ROMER_TILE_16_UMTS_MN,',
					  A.`FLAG_ROMER_TILE_13_WK` = ',@FLAG_ROMER_TILE_13_UMTS_WK,',
					  A.`FLAG_ROMER_TILE_13_MN` = ',@FLAG_ROMER_TILE_13_UMTS_MN,', 
					  A.`FLAG_ROMER_REG_3_WK` = ',@FLAG_ROMER_REG_3_UMTS_WK,',
					  A.`FLAG_ROMER_REG_3_MN` = ',@FLAG_ROMER_REG_3_UMTS_MN,',
					  A.`FLAG_ROMER_REG_2_WK` = ',@FLAG_ROMER_REG_2_UMTS_WK,',
					  A.`FLAG_ROMER_REG_2_MN` = ',@FLAG_ROMER_REG_2_UMTS_MN,',
					  A.`FLAG_ROMER_REG_1_WK` = ',@FLAG_ROMER_REG_1_UMTS_WK,',
					  A.`FLAG_ROMER_REG_1_MN` = ',@FLAG_ROMER_REG_1_UMTS_MN,'  
					WHERE A.`DATA_DATE`=''',@v_DATA_DATE,''' AND `TECH_MASK`=2
					;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('UMTS SELECT COUNT(*),TRUE,',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
			END IF;
			
			IF TECH_MASK=1 THEN 
				SET @table_romer_tile_19_gsm_dy=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_gsm_dy_',@SR_DATE);
				SET @table_romer_tile_19_gsm_wk=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_gsm_wk_',@DATE_WK);
				SET @table_romer_tile_19_gsm_mn=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_gsm_mn_',@DATE_MN);
				SET @table_romer_reg_3_gsm_wk=CONCAT('table_romer_reg_3_gsm_wk_',@DATE_WK);
				SET @table_romer_reg_2_gsm_wk=CONCAT('table_romer_reg_2_gsm_wk_',@DATE_WK);
				SET @table_romer_reg_1_gsm_wk=CONCAT('table_romer_reg_1_gsm_wk_',@DATE_WK);
				SET @table_romer_reg_3_gsm_mn=CONCAT('table_romer_reg_3_gsm_mn_',@DATE_MN);
				SET @table_romer_reg_2_gsm_mn=CONCAT('table_romer_reg_2_gsm_mn_',@DATE_MN);
				SET @table_romer_reg_1_gsm_mn=CONCAT('table_romer_reg_1_gsm_mn_',@DATE_MN);
	
				SET @SOURCE_TABLE_NAME=CONCAT(@table_romer_tile_19_gsm_dy,',',@table_romer_tile_19_gsm_wk);
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_tile_19_gsm_wk);
				SET @ERROR_FLAG='2_romer_tile_19_gsm_wk_9';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);				
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_tile_19_gsm_wk,' 
						    (`TILE_ID`,MCC,MNC,
						     `FREQUENCY`,
						     `BCCH_ARFCN`,
						     ',TILE_GSM_COLUMN_STR,')
						SELECT
						  `TILE_ID`,MCC,MNC,
						  `FREQUENCY`,
						  `BCCH_ARFCN`,
						  ',TILE_GSM_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_romer_tile_19_gsm_dy,' 
						GROUP BY `TILE_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_tile_19_gsm_wk)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_tile_19_gsm_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_TILE_19_gsm_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_gsm_wk,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_TileResolution_Insert_MV`(TECH_MASK,@table_romer_tile_19_gsm_wk,@table_romer_tile_19_gsm_dy,'WK',PENDING_FLAG,TileResolution,SHARE_DB, v_group_db_name,v_DATA_HOUR);
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_gsm_wk,' WK cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				SET @FLAG_ROMER_TILE_16_gsm_WK=1;
				SET @FLAG_ROMER_TILE_13_gsm_WK=1;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_3_gsm_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_3_gsm_wk);
				SET @ERROR_FLAG='2_romer_reg_3_gsm_wk_10';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_3_gsm_wk,' 
						    (`REG_ID`,MCC,MNC,
						     `FREQUENCY`,
						     `BCCH_ARFCN`,
						     ',TILE_GSM_COLUMN_STR,')
						SELECT
						  `REG_3_ID` AS `REG_ID`,MCC,MNC,
						  `FREQUENCY`,
						  `BCCH_ARFCN`,
						  ',TILE_GSM_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_romer_tile_19_gsm_dy,' 
						GROUP BY `REG_3_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_3_gsm_wk)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_3_gsm_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_REG_3_gsm_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_3_gsm_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_2_gsm_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_2_gsm_wk);
				SET @ERROR_FLAG='2_romer_reg_2_gsm_wk_11';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_2_gsm_wk,' 
						    (`REG_ID`,MCC,MNC,
						     `FREQUENCY`,
						     `BCCH_ARFCN`,
						     ',TILE_GSM_COLUMN_STR,')
						SELECT
							`REG_2_ID` AS `REG_ID`,MCC,MNC,
							  `FREQUENCY`,
							  `BCCH_ARFCN`,
							  ',TILE_GSM_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_romer_tile_19_gsm_dy,' 
						GROUP BY `REG_2_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_2_gsm_wk)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_2_gsm_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_REG_2_gsm_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_2_gsm_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_1_gsm_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_1_gsm_wk);
				SET @ERROR_FLAG='2_romer_reg_1_gsm_wk_12';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_1_gsm_wk,' 
						    (`REG_ID`,MCC,MNC,
						     `FREQUENCY`,
						     `BCCH_ARFCN`,
						     ',TILE_GSM_COLUMN_STR,')
						SELECT
							`REG_1_ID` AS `REG_ID`,MCC,MNC,
							  `FREQUENCY`,
							  `BCCH_ARFCN`,
							  ',TILE_GSM_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_romer_tile_19_gsm_dy,' 
						GROUP BY `REG_1_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_1_gsm_wk)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_1_gsm_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_REG_1_gsm_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_1_gsm_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_romer_tile_19_gsm_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_tile_19_gsm_mn);
				SET @ERROR_FLAG='2_romer_tile_19_gsm_mn_13';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_tile_19_gsm_mn,' 
						    (`TILE_ID`,MCC,MNC,
						     `FREQUENCY`,
						     `BCCH_ARFCN`,
						     ',TILE_GSM_COLUMN_STR,')
						SELECT
						  `TILE_ID`,MCC,MNC,
						  `FREQUENCY`,
						  `BCCH_ARFCN`,
						  ',TILE_GSM_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_romer_tile_19_gsm_dy,' 
						GROUP BY `TILE_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_tile_19_gsm_mn)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_tile_19_gsm_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_TILE_19_gsm_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_gsm_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_TileResolution_Insert_MV`(TECH_MASK,@table_romer_tile_19_gsm_mn,@table_romer_tile_19_gsm_dy,'MN',PENDING_FLAG,TileResolution,SHARE_DB, v_group_db_name,v_DATA_HOUR);
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_gsm_mn,' MN cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				SET @FLAG_ROMER_TILE_16_gsm_MN=1;
				SET @FLAG_ROMER_TILE_13_gsm_MN=1;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_3_gsm_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_3_gsm_mn);
				SET @ERROR_FLAG='2_romer_reg_3_gsm_mn_14';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);										
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_3_gsm_mn,' 
						    (`REG_ID`,MCC,MNC,
						     `FREQUENCY`,
						     `BCCH_ARFCN`,
						     ',TILE_GSM_COLUMN_STR,')
						SELECT
						  `REG_3_ID` AS `REG_ID`,MCC,MNC,
						  `FREQUENCY`,
						  `BCCH_ARFCN`,
						  ',TILE_GSM_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_romer_tile_19_gsm_dy,' 
						GROUP BY `REG_3_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_3_gsm_mn)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_3_gsm_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_REG_3_gsm_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_3_gsm_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_2_gsm_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_2_gsm_mn);
				SET @ERROR_FLAG='2_romer_reg_2_gsm_mn_15';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_2_gsm_mn,' 
						    (`REG_ID`,MCC,MNC,
						     `FREQUENCY`,
						     `BCCH_ARFCN`,
						     ',TILE_GSM_COLUMN_STR,')
						SELECT
							`REG_2_ID` AS `REG_ID`,MCC,MNC,
							  `FREQUENCY`,
							  `BCCH_ARFCN`,
							  ',TILE_GSM_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_romer_tile_19_gsm_dy,' 
						GROUP BY `REG_2_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_2_gsm_mn)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_2_gsm_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_REG_2_gsm_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_2_gsm_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_1_gsm_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_1_gsm_mn);
				SET @ERROR_FLAG='2_romer_reg_1_gsm_mn_16';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_1_gsm_mn,' 
						    (`REG_ID`,MCC,MNC,
						     `FREQUENCY`,
						     `BCCH_ARFCN`,
						     ',TILE_GSM_COLUMN_STR,')
						SELECT
							`REG_1_ID` AS `REG_ID`,MCC,MNC,
							  `FREQUENCY`,
							  `BCCH_ARFCN`,
							  ',TILE_GSM_COLUMN_SUM_STR,'  
						FROM ',SHARE_DB,'.',@table_romer_tile_19_gsm_dy,' 
						GROUP BY `REG_1_ID`,MCC,MNC,`FREQUENCY`,`BCCH_ARFCN`
						ORDER BY NULL
						ON DUPLICATE KEY UPDATE 
						',REPLACE(TILE_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_1_gsm_mn)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_1_gsm_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_REG_1_gsm_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_1_gsm_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE(); 			
				
				SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_tile_19_gsm_dy,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.`table_call_cnt_history` A
					SET 
					  A.`FLAG_ROMER_TILE_19_WK` = ',@FLAG_ROMER_TILE_19_GSM_WK,',
					  A.`FLAG_ROMER_TILE_19_MN` = ',@FLAG_ROMER_TILE_19_GSM_MN,',
					  A.`FLAG_ROMER_TILE_16_WK` = ',@FLAG_ROMER_TILE_16_GSM_WK,',
					  A.`FLAG_ROMER_TILE_16_MN` = ',@FLAG_ROMER_TILE_16_GSM_MN,',
					  A.`FLAG_ROMER_TILE_13_WK` = ',@FLAG_ROMER_TILE_13_GSM_WK,',
					  A.`FLAG_ROMER_TILE_13_MN` = ',@FLAG_ROMER_TILE_13_GSM_MN,',
					  A.`FLAG_ROMER_REG_3_WK` = ',@FLAG_ROMER_REG_3_GSM_WK,',
					  A.`FLAG_ROMER_REG_3_MN` = ',@FLAG_ROMER_REG_3_GSM_MN,',
					  A.`FLAG_ROMER_REG_2_WK` = ',@FLAG_ROMER_REG_2_GSM_WK,',
					  A.`FLAG_ROMER_REG_2_MN` = ',@FLAG_ROMER_REG_2_GSM_MN,',
					  A.`FLAG_ROMER_REG_1_WK` = ',@FLAG_ROMER_REG_1_GSM_WK,',
					  A.`FLAG_ROMER_REG_1_MN` = ',@FLAG_ROMER_REG_1_GSM_MN,' 
					WHERE A.`DATA_DATE`=''',@v_DATA_DATE,''' AND `TECH_MASK`=1
					;');
		
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('UMTS SELECT COUNT(*),TRUE,',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
			END IF;
			IF TECH_MASK=4 THEN
				SET @table_romer_tile_19_lte_dy=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_lte_dy_',@SR_DATE);
				SET @table_romer_tile_19_lte_wk=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_lte_wk_',@DATE_WK);
				SET @table_romer_tile_19_lte_mn=CONCAT('table_romer_tile_',@ZOOM_LEVEL,'_lte_mn_',@DATE_MN);
				SET @table_romer_reg_3_lte_wk=CONCAT('table_romer_reg_3_lte_wk_',@DATE_WK);
				SET @table_romer_reg_2_lte_wk=CONCAT('table_romer_reg_2_lte_wk_',@DATE_WK);
				SET @table_romer_reg_1_lte_wk=CONCAT('table_romer_reg_1_lte_wk_',@DATE_WK);
				SET @table_romer_reg_3_lte_mn=CONCAT('table_romer_reg_3_lte_mn_',@DATE_MN);
				SET @table_romer_reg_2_lte_mn=CONCAT('table_romer_reg_2_lte_mn_',@DATE_MN);
				SET @table_romer_reg_1_lte_mn=CONCAT('table_romer_reg_1_lte_mn_',@DATE_MN);
				
				SET @SOURCE_TABLE_NAME=CONCAT(@table_romer_tile_19_lte_dy,',',@table_romer_tile_19_lte_wk);
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_tile_19_lte_wk);
				SET @ERROR_FLAG='2_romer_tile_19_lte_wk_17';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_tile_19_lte_wk,' 
						    (
							`TILE_ID`,MCC,MNC,
							`EARFCN`,
							`EUTRABAND`,
							',TILE_LTE_COLUMN_STR,',
							`REG_1_ID`,
							`REG_2_ID`,
							`REG_3_ID`)
					SELECT
						`TILE_ID` AS `TILE_ID`,MCC,MNC,
						`EARFCN`,
						`EUTRABAND`,
						',TILE_LTE_COLUMN_SUM_STR,',
						`REG_1_ID`,
						`REG_2_ID`,
						`REG_3_ID`
					FROM ',SHARE_DB,'.',@table_romer_tile_19_lte_dy,'
					GROUP BY `TILE_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`
					ORDER BY NULL
					ON DUPLICATE KEY UPDATE  
					',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_wk)),',
					',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_wk),'.REG_1_ID=IF(',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_wk),'.REG_1_ID IS NULL,VALUES(REG_1_ID),',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_wk),'.REG_1_ID),
					',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_wk),'.REG_2_ID=IF(',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_wk),'.REG_2_ID IS NULL,VALUES(REG_2_ID),',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_wk),'.REG_2_ID),
					',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_wk),'.REG_3_ID=IF(',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_wk),'.REG_3_ID IS NULL,VALUES(REG_3_ID),',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_wk),'.REG_3_ID)
					;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_tile_19_lte_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_TILE_19_lte_wk=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_TileResolution_Insert_MV`(TECH_MASK,@table_romer_tile_19_lte_wk,@table_romer_tile_19_lte_dy,'WK',PENDING_FLAG,TileResolution,SHARE_DB, v_group_db_name,v_DATA_HOUR);
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_lte_wk,' WK cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @FLAG_ROMER_TILE_16_lte_wk=1;
				SET @FLAG_ROMER_TILE_13_lte_wk=1;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_3_lte_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_3_lte_wk);
				SET @ERROR_FLAG='2_romer_reg_3_lte_wk_18';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
									
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_3_lte_wk,' 
						    (
							`REG_ID`,MCC,MNC,
							`EARFCN`,
							`EUTRABAND`,
							',TILE_LTE_COLUMN_STR,')
					SELECT
						`REG_3_ID` AS `REG_ID`,MCC,MNC,
						`EARFCN`,
						`EUTRABAND`,
						',TILE_LTE_COLUMN_SUM_STR,'
					FROM ',SHARE_DB,'.',@table_romer_tile_19_lte_dy,'
					GROUP BY `REG_3_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`
					ORDER BY NULL
					ON DUPLICATE KEY UPDATE  
					',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_3_lte_wk)),'
					;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_3_lte_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_REG_3_lte_wk=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_3_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_2_lte_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_2_lte_wk);
				SET @ERROR_FLAG='2_romer_reg_2_lte_wk_19';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_2_lte_wk,' 
						    (
							`REG_ID`,MCC,MNC,
							`EARFCN`,
							`EUTRABAND`,
							',TILE_LTE_COLUMN_STR,')
					SELECT
						`REG_2_ID` AS `REG_ID`,MCC,MNC,
						`EARFCN`,
						`EUTRABAND`,
						',TILE_LTE_COLUMN_SUM_STR,'
					FROM ',SHARE_DB,'.',@table_romer_tile_19_lte_dy,'
					GROUP BY `REG_2_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`
					ORDER BY NULL
					ON DUPLICATE KEY UPDATE  
					',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_2_lte_wk)),'
					;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_2_lte_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_REG_2_lte_wk=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_2_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_1_lte_wk;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_1_lte_wk);
				SET @ERROR_FLAG='2_romer_reg_1_lte_wk_20';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_1_lte_wk,' 
						    (
							`REG_ID`,MCC,MNC,
							`EARFCN`,
							`EUTRABAND`,
							',TILE_LTE_COLUMN_STR,')
					SELECT
						`REG_1_ID` AS `REG_ID`,MCC,MNC,
						`EARFCN`,
						`EUTRABAND`,
						',TILE_LTE_COLUMN_SUM_STR,'
					FROM ',SHARE_DB,'.',@table_romer_tile_19_lte_dy,'
					GROUP BY `REG_1_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`
					ORDER BY NULL
					ON DUPLICATE KEY UPDATE  
					',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_1_lte_wk)),'
					;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_1_lte_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_REG_1_lte_wk=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_1_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_romer_tile_19_lte_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_tile_19_lte_mn);
				SET @ERROR_FLAG='2_romer_tile_19_lte_mn_21';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
								
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_tile_19_lte_mn,' 
						    (
							`TILE_ID`,MCC,MNC,
							`EARFCN`,
							`EUTRABAND`,
							',TILE_LTE_COLUMN_STR,',
							`REG_1_ID`,
							`REG_2_ID`,
							`REG_3_ID`)
					SELECT
						`TILE_ID` AS `TILE_ID`,MCC,MNC,
						`EARFCN`,
						`EUTRABAND`,
						',TILE_LTE_COLUMN_SUM_STR,',
						`REG_1_ID`,
						`REG_2_ID`,
						`REG_3_ID`
					FROM ',SHARE_DB,'.',@table_romer_tile_19_lte_dy,'
					GROUP BY `TILE_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`
					ORDER BY NULL
					ON DUPLICATE KEY UPDATE  
					',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_mn)),',
					',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_mn),'.REG_1_ID=IF(',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_mn),'.REG_1_ID IS NULL,VALUES(REG_1_ID),',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_mn),'.REG_1_ID),
					',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_mn),'.REG_2_ID=IF(',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_mn),'.REG_2_ID IS NULL,VALUES(REG_2_ID),',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_mn),'.REG_2_ID),
					',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_mn),'.REG_3_ID=IF(',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_mn),'.REG_3_ID IS NULL,VALUES(REG_3_ID),',CONCAT(SHARE_DB,'.',@table_romer_tile_19_lte_mn),'.REG_3_ID)
					;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_tile_19_lte_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_TILE_19_lte_mn=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_lte_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_TileResolution_Insert_MV`(TECH_MASK,@table_romer_tile_19_lte_mn,@table_romer_tile_19_lte_dy,'MN',PENDING_FLAG,TileResolution,SHARE_DB, v_group_db_name,v_DATA_HOUR);
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_tile_19_lte_mn,' MN cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @FLAG_ROMER_TILE_16_lte_mn=1;
				SET @FLAG_ROMER_TILE_13_lte_mn=1;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_3_lte_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_3_lte_mn);
				SET @ERROR_FLAG='2_romer_reg_3_lte_mn_22';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_3_lte_mn,' 
						    (
							`REG_ID`,MCC,MNC,
							`EARFCN`,
							`EUTRABAND`,
							',TILE_LTE_COLUMN_STR,')
					SELECT
						`REG_3_ID` AS `REG_ID`,MCC,MNC,
						`EARFCN`,
						`EUTRABAND`,
						',TILE_LTE_COLUMN_SUM_STR,'
					FROM ',SHARE_DB,'.',@table_romer_tile_19_lte_dy,'
					GROUP BY `REG_3_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`
					ORDER BY NULL
					ON DUPLICATE KEY UPDATE  
					',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_3_lte_mn)),'
					;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_3_lte_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_REG_3_lte_mn=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_3_lte_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_2_lte_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_2_lte_mn);
				SET @ERROR_FLAG='2_romer_reg_2_lte_mn_23';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_2_lte_mn,' 
						    (
							`REG_ID`,MCC,MNC,
							`EARFCN`,
							`EUTRABAND`,
							',TILE_LTE_COLUMN_STR,')
					SELECT
						`REG_2_ID` AS `REG_ID`,MCC,MNC,
						`EARFCN`,
						`EUTRABAND`,
						',TILE_LTE_COLUMN_SUM_STR,'
					FROM ',SHARE_DB,'.',@table_romer_tile_19_lte_dy,'
					GROUP BY `REG_2_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`
					ORDER BY NULL
					ON DUPLICATE KEY UPDATE
					',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_2_lte_mn)),'
					;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_2_lte_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_REG_2_lte_mn=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_2_lte_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_1_lte_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_romer_reg_1_lte_mn);
				SET @ERROR_FLAG='2_romer_reg_1_lte_mn_24';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_romer_reg_1_lte_mn,' 
						    (
							`REG_ID`,MCC,MNC,
							`EARFCN`,
							`EUTRABAND`,
							',TILE_LTE_COLUMN_STR,')
					SELECT
						`REG_1_ID` AS `REG_ID`,MCC,MNC,
						`EARFCN`,
						`EUTRABAND`,
						',TILE_LTE_COLUMN_SUM_STR,'
					FROM ',SHARE_DB,'.',@table_romer_tile_19_lte_dy,'
					GROUP BY `REG_1_ID`,MCC,MNC,`EARFCN`,`EUTRABAND`
					ORDER BY NULL
					ON DUPLICATE KEY UPDATE
					',REPLACE(TILE_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_romer_reg_1_lte_mn)),'
					;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_romer_reg_1_lte_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_ROMER_REG_1_lte_mn=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT('INSERT INTO ',@table_romer_reg_1_lte_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_romer_tile_19_lte_dy,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.`table_call_cnt_history` A
					SET 
					  A.`FLAG_ROMER_TILE_19_WK` = ',@FLAG_ROMER_TILE_19_LTE_WK,',
					  A.`FLAG_ROMER_TILE_19_MN` = ',@FLAG_ROMER_TILE_19_LTE_MN,',
					  A.`FLAG_ROMER_TILE_16_WK` = ',@FLAG_ROMER_TILE_16_LTE_WK,',
					  A.`FLAG_ROMER_TILE_16_MN` = ',@FLAG_ROMER_TILE_16_LTE_MN,',
					  A.`FLAG_ROMER_TILE_13_WK` = ',@FLAG_ROMER_TILE_13_LTE_WK,',
					  A.`FLAG_ROMER_TILE_13_MN` = ',@FLAG_ROMER_TILE_13_LTE_MN,',
					  A.`FLAG_ROMER_REG_3_WK` = ',@FLAG_ROMER_REG_3_LTE_WK,',
					  A.`FLAG_ROMER_REG_3_MN` = ',@FLAG_ROMER_REG_3_LTE_MN,',
					  A.`FLAG_ROMER_REG_2_WK` = ',@FLAG_ROMER_REG_2_LTE_WK,',
					  A.`FLAG_ROMER_REG_2_MN` = ',@FLAG_ROMER_REG_2_LTE_MN,',
					  A.`FLAG_ROMER_REG_1_WK` = ',@FLAG_ROMER_REG_1_LTE_WK,',
					  A.`FLAG_ROMER_REG_1_MN` = ',@FLAG_ROMER_REG_1_LTE_MN,' 
					WHERE A.`DATA_DATE`=''',@v_DATA_DATE,''' AND `TECH_MASK`=4
					;');
	
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_roamer_Aggr',CONCAT(v_DATA_DATE,',',v_TECH_MASK,',',WORKER_ID,' Done: ',TIMESTAMPDIFF(SECOND,START_TIME,SYSDATE()),' seconds.'), NOW());
			END IF;
			SET @v_reg_m=@v_reg_m+1;
		END;
		END WHILE;
	END IF;
END$$
DELIMITER ;

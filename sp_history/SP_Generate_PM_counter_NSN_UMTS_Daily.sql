DELIMITER $$
USE `gt_gw_main`$$
DROP PROCEDURE IF EXISTS `SP_CreateDB_LTE`$$
CREATE DEFINER=`covmo`@`%` PROCEDURE `SP_Generate_PM_counter_NSN_UMTS_Daily`(IN GT_DB VARCHAR(100))
a_label:
BEGIN
	DECLARE START_TIME DATETIME DEFAULT SYSDATE();
	DECLARE O_GT_DB VARCHAR(100) DEFAULT GT_DB;
	DECLARE STARTHOUR VARCHAR(2) DEFAULT SUBSTRING(RIGHT(GT_DB,18),10,2);
	DECLARE ENDHOUR VARCHAR(2) DEFAULT IF(SUBSTRING(RIGHT(GT_DB,18),15,2)='00','24',SUBSTRING(RIGHT(GT_DB,18),15,2));
	DECLARE SH_EH VARCHAR(9) DEFAULT RIGHT(GT_DB,9);
	DECLARE WORKER_ID VARCHAR(10) DEFAULT CONNECTION_ID();
	DECLARE CURRENT_NT_DB VARCHAR(50) DEFAULT CONCAT('gt_nt_',gt_strtok(GT_DB,3,'_'));
	DECLARE DATA_DATE VARCHAR(8);
	DECLARE PROC_TIME DATETIME;
	
  	INSERT INTO gt_gw_main.SP_LOG VALUES(O_GT_DB,'SP_Generate_PM_counter_NSN_UMTS_Daily','Start', START_TIME);
 
	SELECT gt_strtok(GT_DB,3,'_') INTO DATA_DATE; 
	SELECT REPLACE(GT_DB,SH_EH,'0000_0000') INTO GT_DB;
	SELECT STR_TO_DATE(CONCAT(DATA_DATE, ' ', STARTHOUR), '%Y%m%d %H') INTO PROC_TIME;
	INSERT INTO gt_gw_main.sp_log VALUES(O_GT_DB,'SP_Generate_PM_counter_NSN_UMTS_Daily','tmp_table_pm_packet_call', NOW());
	
	SET @SqlCmd=CONCAT('DROP  TABLE IF EXISTS ',GT_DB,'.`tmp_table_pm_counter_nsn_umts_',WORKER_ID,'`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	SET @SqlCmd=CONCAT('CREATE  TABLE ',GT_DB,'.`tmp_table_pm_counter_nsn_umts_',WORKER_ID,'` LIKE ',GT_DB,'.table_pm_nokia_umts');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DELETE FROM ',GT_DB,'.`table_pm_nokia_umts` WHERE `TIMESTAMP` = ''',PROC_TIME,''';');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',GT_DB,'.`tmp_table_pm_packet_call_',WORKER_ID,'` ;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	SET @SqlCmd=CONCAT('CREATE  TEMPORARY TABLE ',GT_DB,'.`tmp_table_pm_packet_call_',WORKER_ID,'` 
				SELECT  RNC_ID,TIME,SITE_ID,WCELL_INDEX,
				M1022C202,
				M1022C203,
				M1022C204,
				M1022C208,
				M1022C209,
				M1022C210,
				M1022C211,
				M1022C212,
				M1022C213,
				M1022C45,
				M1022C46,
				M1022C47,
				M1022C48,
				M1022C49,
				M1022C50,
				M1022C57,
				M1022C58,
				M1022C59,
				M1022C60,
				M1022C61,
				M1022C62,
				M1022C63,
				M1022C64,
				M1022C65,
				M1022C66,
				M1022C67,
				M1022C68 
				FROM ',GT_DB,'.table_pm_packet_call;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;	
	
	SET @SqlCmd=CONCAT('ALTER TABLE ',GT_DB,'.`tmp_table_pm_packet_call_',WORKER_ID,'` 
					ADD COLUMN `CELL_ID` mediumint(9),
					ADD COLUMN `TIMESTAMP` datetime,
					ADD COLUMN `TIMESTAMP_DATE` date,
					ADD COLUMN `TIMESTAMP_HOURLY` tinyint(4);');
		
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('ALTER TABLE ',GT_DB,'.`tmp_table_pm_packet_call_',WORKER_ID,'` ADD INDEX (RNC_ID,CELL_ID,TIMESTAMP,SITE_ID)');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;	
	
	SET @SqlCmd=CONCAT('UPDATE ',GT_DB,'.`tmp_table_pm_packet_call_',WORKER_ID,'` A, ',CURRENT_NT_DB,'.nt_current B
				SET 
				A.CELL_ID=B.CELL_ID
				WHERE A.WCELL_INDEX=B.wcel_index
				AND A.SITE_ID=B.SITE_ID
				;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('UPDATE ',GT_DB,'.`tmp_table_pm_packet_call_',WORKER_ID,'` 
				SET 
				TIMESTAMP=CONCAT(LEFT(`time`,10),'' '',SUBSTRING(`time`,12,8)),
				TIMESTAMP_DATE=LEFT(`time`,10),
				TIMESTAMP_HOURLY=SUBSTRING(`time`,12,2)
				
				;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
		
	SET @SqlCmd=CONCAT('REPLACE INTO ',GT_DB,'.`tmp_table_pm_counter_nsn_umts_',WORKER_ID,'`
			(`RNC_ID`,`CELL_ID`,`TIMESTAMP`,`DATA_DATE`,`DATA_HOUR`,
			M1022C202,M1022C203,M1022C204,M1022C208,
			M1022C209,M1022C210,M1022C211,M1022C212,
			M1022C213,M1022C45,M1022C46,M1022C47,M1022C48,
			M1022C49,M1022C50,M1022C57,M1022C58,M1022C59,
			M1022C60,M1022C61,M1022C62,M1022C63,M1022C64,
			M1022C65,M1022C66,M1022C67,M1022C68
			)
		SELECT
			A.`RNC_ID`,A.`CELL_ID`,A.`TIMESTAMP`,A.`TIMESTAMP_DATE`,A.`TIMESTAMP_HOURLY`,
			A.M1022C202,A.M1022C203,A.M1022C204,A.M1022C208,
			A.M1022C209,A.M1022C210,A.M1022C211,A.M1022C212,
			A.M1022C213,A.M1022C45,A.M1022C46,A.M1022C47,A.M1022C48,
			A.M1022C49,A.M1022C50,A.M1022C57,A.M1022C58,A.M1022C59,
			A.M1022C60,A.M1022C61,A.M1022C62,A.M1022C63,A.M1022C64,
			A.M1022C65,A.M1022C66,A.M1022C67,A.M1022C68
		FROM ',GT_DB,'.`tmp_table_pm_packet_call_',WORKER_ID,'`  A LEFT JOIN ',GT_DB,'.`tmp_table_pm_counter_nsn_umts_',WORKER_ID,'` B
		ON A.RNC_ID = B.RNC_ID AND A.CELL_ID = B.CELL_ID  AND A.TIMESTAMP = B.TIMESTAMP
		WHERE A.`TIMESTAMP` = ''',PROC_TIME,'''
		;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',GT_DB,'.`tmp_table_pm_packet_call_',WORKER_ID,'` ;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	INSERT INTO gt_gw_main.sp_log VALUES(O_GT_DB,'SP_Generate_PM_counter_NSN_UMTS_Daily','tmp_table_pm_service_level', NOW());
	
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',GT_DB,'.`tmp_table_pm_service_level_',WORKER_ID,'` ;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	SET @SqlCmd=CONCAT('CREATE TEMPORARY TABLE ',GT_DB,'.`tmp_table_pm_service_level_',WORKER_ID,'` 
				SELECT  RNC_ID,TIME,SITE_ID,WCELL_INDEX,
				M1001C0,M1001C1,M1001C115,M1001C120,M1001C121,
				M1001C136,M1001C140,M1001C141,M1001C142,M1001C143,
				M1001C144,M1001C145,M1001C146,M1001C147,M1001C148,
				M1001C150,M1001C153,M1001C169,M1001C170,M1001C171,
				M1001C172,M1001C179,M1001C180,M1001C181,M1001C182,
				M1001C184,M1001C185,M1001C186,M1001C187,M1001C188,
				M1001C190,M1001C191,M1001C192,M1001C193,M1001C194,
				M1001C196,M1001C22,M1001C23,M1001C259,M1001C26,
				M1001C260,M1001C27,M1001C28,M1001C29,M1001C32,
				M1001C33,M1001C36,M1001C37,M1001C38,M1001C39,
				M1001C392,M1001C396,M1001C397,M1001C398,
				M1001C40,M1001C41,M1001C553,M1001C555,
				M1001C556,M1001C558,M1001C560,M1001C561,
				M1001C562,M1001C573,M1001C575,
				M1001C576,M1001C578,M1001C580,
				M1001C581,M1001C582,M1001C617,M1001C644,
				M1001C647,M1001C650,M1001C66,M1001C690,
				M1001C693,M1001C694,M1001C695,M1001C71,
				M1001C72,M1001C801,M1001C802,M1001C804,
				M1001C805,M1001C806,M1001C807
				FROM ',GT_DB,'.table_pm_service_level;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('ALTER TABLE ',GT_DB,'.`tmp_table_pm_service_level_',WORKER_ID,'` 
					ADD COLUMN `CELL_ID` mediumint(9),
					ADD COLUMN `TIMESTAMP` datetime,
					ADD COLUMN `TIMESTAMP_DATE` date,
					ADD COLUMN `TIMESTAMP_HOURLY` tinyint(4);');
		
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('ALTER TABLE ',GT_DB,'.`tmp_table_pm_service_level_',WORKER_ID,'` ADD INDEX (RNC_ID,CELL_ID,TIMESTAMP,SITE_ID)');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('UPDATE ',GT_DB,'.`tmp_table_pm_service_level_',WORKER_ID,'` A, ',CURRENT_NT_DB,'.nt_current B
				SET 
				A.CELL_ID=B.CELL_ID
				WHERE A.WCELL_INDEX=B.wcel_index
				AND A.SITE_ID=B.SITE_ID
				;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	SET @SqlCmd=CONCAT('UPDATE ',GT_DB,'.`tmp_table_pm_service_level_',WORKER_ID,'` 
				SET 
				TIMESTAMP=CONCAT(LEFT(`time`,10),'' '',SUBSTRING(`time`,12,8)),
				TIMESTAMP_DATE=LEFT(`time`,10),
				TIMESTAMP_HOURLY=SUBSTRING(`time`,12,2)
				
				;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
		
	SET @SqlCmd=CONCAT('REPLACE INTO ',GT_DB,'.`tmp_table_pm_counter_nsn_umts_',WORKER_ID,'`
			(`RNC_ID`,`CELL_ID`,`TIMESTAMP`,`DATA_DATE`,`DATA_HOUR`,
			M1001C0,M1001C1,M1001C115,M1001C120,M1001C121,
				M1001C136,M1001C140,M1001C141,M1001C142,M1001C143,
				M1001C144,M1001C145,M1001C146,M1001C147,M1001C148,
				M1001C150,M1001C153,M1001C169,M1001C170,M1001C171,
				M1001C172,M1001C179,M1001C180,M1001C181,M1001C182,
				M1001C184,M1001C185,M1001C186,M1001C187,M1001C188,
				M1001C190,M1001C191,M1001C192,M1001C193,M1001C194,
				M1001C196,M1001C22,M1001C23,M1001C259,M1001C26,
				M1001C260,M1001C27,M1001C28,M1001C29,M1001C32,
				M1001C33,M1001C36,M1001C37,M1001C38,M1001C39,
				M1001C392,M1001C396,M1001C397,M1001C398,
				M1001C40,M1001C41,M1001C553,M1001C555,
				M1001C556,M1001C558,M1001C560,M1001C561,
				M1001C562,M1001C573,M1001C575,
				M1001C576,M1001C578,M1001C580,
				M1001C581,M1001C582,M1001C617,M1001C644,
				M1001C647,M1001C650,M1001C66,M1001C690,
				M1001C693,M1001C694,M1001C695,M1001C71,
				M1001C72,M1001C801,M1001C802,M1001C804,
				M1001C805,M1001C806,M1001C807
			)
		SELECT
			A.`RNC_ID`,A.`CELL_ID`,A.`TIMESTAMP`,A.`TIMESTAMP_DATE`,A.`TIMESTAMP_HOURLY`,
				A.M1001C0,A.M1001C1,A.M1001C115,A.M1001C120,A.M1001C121,
				A.M1001C136,A.M1001C140,A.M1001C141,A.M1001C142,A.M1001C143,
				A.M1001C144,A.M1001C145,A.M1001C146,A.M1001C147,A.M1001C148,
				A.M1001C150,A.M1001C153,A.M1001C169,A.M1001C170,A.M1001C171,
				A.M1001C172,A.M1001C179,A.M1001C180,A.M1001C181,A.M1001C182,
				A.M1001C184,A.M1001C185,A.M1001C186,A.M1001C187,A.M1001C188,
				A.M1001C190,A.M1001C191,A.M1001C192,A.M1001C193,A.M1001C194,
				A.M1001C196,A.M1001C22,A.M1001C23,A.M1001C259,A.M1001C26,
				A.M1001C260,A.M1001C27,A.M1001C28,A.M1001C29,A.M1001C32,
				A.M1001C33,A.M1001C36,A.M1001C37,A.M1001C38,A.M1001C39,
				A.M1001C392,A.M1001C396,A.M1001C397,A.M1001C398,
				A.M1001C40,A.M1001C41,A.M1001C553,A.M1001C555,
				A.M1001C556,A.M1001C558,A.M1001C560,A.M1001C561,
				A.M1001C562,A.M1001C573,A.M1001C575,
				A.M1001C576,A.M1001C578,A.M1001C580,
				A.M1001C581,A.M1001C582,A.M1001C617,A.M1001C644,
				A.M1001C647,A.M1001C650,A.M1001C66,A.M1001C690,
				A.M1001C693,A.M1001C694,A.M1001C695,A.M1001C71,
				A.M1001C72,A.M1001C801,A.M1001C802,A.M1001C804,
				A.M1001C805,A.M1001C806,A.M1001C807
		FROM ',GT_DB,'.`tmp_table_pm_service_level_',WORKER_ID,'`  A LEFT JOIN ',GT_DB,'.`tmp_table_pm_counter_nsn_umts_',WORKER_ID,'` B
		ON A.RNC_ID = B.RNC_ID AND A.CELL_ID = B.CELL_ID AND A.TIMESTAMP = B.TIMESTAMP
		WHERE A.`TIMESTAMP` = ''',PROC_TIME,'''
		;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',GT_DB,'.`tmp_table_pm_service_level_',WORKER_ID,'` ;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	INSERT INTO gt_gw_main.sp_log VALUES(O_GT_DB,'SP_Generate_PM_counter_NSN_UMTS_Daily','tmp_table_pm_inter_system_handover', NOW());
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',GT_DB,'.`tmp_table_pm_inter_system_handover_',WORKER_ID,'` ;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	SET @SqlCmd=CONCAT('CREATE TEMPORARY TABLE ',GT_DB,'.`tmp_table_pm_inter_system_handover_',WORKER_ID,'` 
				SELECT  RNC_ID,TIME,SITE_ID,WCELL_INDEX,
				M1010C137,M1010C138,M1010C139,
				M1010C140,M1010C141,M1010C149,
				M1010C150,M1010C151,M1010C152,
				M1010C153,M1010C18,M1010C185,
				M1010C186,M1010C19,M1010C195,
				M1010C196,M1010C197,M1010C198,
				M1010C219,M1010C22,M1010C226,
				M1010C23,M1010C234,M1010C26,
				M1010C27,M1010C30,M1010C31,
				M1010C34,M1010C35,M1010C76,
				M1010C77,M1010C97,M1010C98
				FROM ',GT_DB,'.table_pm_inter_system_handover;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('ALTER TABLE ',GT_DB,'.`tmp_table_pm_inter_system_handover_',WORKER_ID,'` 
					ADD COLUMN `CELL_ID` mediumint(9),
					ADD COLUMN `TIMESTAMP` datetime,
					ADD COLUMN `TIMESTAMP_DATE` date,
					ADD COLUMN `TIMESTAMP_HOURLY` tinyint(4);');
		
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('ALTER TABLE ',GT_DB,'.`tmp_table_pm_inter_system_handover_',WORKER_ID,'` ADD INDEX (RNC_ID,CELL_ID,TIMESTAMP,SITE_ID)');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('UPDATE ',GT_DB,'.`tmp_table_pm_inter_system_handover_',WORKER_ID,'` A, ',CURRENT_NT_DB,'.nt_current B
				SET 
				A.CELL_ID=B.CELL_ID
				WHERE A.WCELL_INDEX=B.wcel_index
				AND A.SITE_ID=B.SITE_ID
				;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	
	SET @SqlCmd=CONCAT('UPDATE ',GT_DB,'.`tmp_table_pm_inter_system_handover_',WORKER_ID,'` 
				SET 
				TIMESTAMP=CONCAT(LEFT(`time`,10),'' '',SUBSTRING(`time`,12,8)),
				TIMESTAMP_DATE=LEFT(`time`,10),
				TIMESTAMP_HOURLY=SUBSTRING(`time`,12,2)
				
				;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
		
	SET @SqlCmd=CONCAT('REPLACE INTO ',GT_DB,'.`tmp_table_pm_counter_nsn_umts_',WORKER_ID,'`
			(`RNC_ID`,`CELL_ID`,`TIMESTAMP`,`DATA_DATE`,`DATA_HOUR`,
				M1010C137,M1010C138,M1010C139,
				M1010C140,M1010C141,M1010C149,
				M1010C150,M1010C151,M1010C152,
				M1010C153,M1010C18,M1010C185,
				M1010C186,M1010C19,M1010C195,
				M1010C196,M1010C197,M1010C198,
				M1010C219,M1010C22,M1010C226,
				M1010C23,M1010C234,M1010C26,
				M1010C27,M1010C30,M1010C31,
				M1010C34,M1010C35,M1010C76,
				M1010C77,M1010C97,M1010C98
			)
		SELECT
			A.`RNC_ID`,A.`CELL_ID`,A.`TIMESTAMP`,A.`TIMESTAMP_DATE`,A.`TIMESTAMP_HOURLY`,
				A.M1010C137,A.M1010C138,A.M1010C139,
				A.M1010C140,A.M1010C141,A.M1010C149,
				A.M1010C150,A.M1010C151,A.M1010C152,
				A.M1010C153,A.M1010C18,A.M1010C185,
				A.M1010C186,A.M1010C19,A.M1010C195,
				A.M1010C196,A.M1010C197,A.M1010C198,
				A.M1010C219,A.M1010C22,A.M1010C226,
				A.M1010C23,A.M1010C234,A.M1010C26,
				A.M1010C27,A.M1010C30,A.M1010C31,
				A.M1010C34,A.M1010C35,A.M1010C76,
				A.M1010C77,A.M1010C97,A.M1010C98
		FROM ',GT_DB,'.`tmp_table_pm_inter_system_handover_',WORKER_ID,'`  A LEFT JOIN ',GT_DB,'.`tmp_table_pm_counter_nsn_umts_',WORKER_ID,'` B
		ON A.RNC_ID = B.RNC_ID AND A.CELL_ID = B.CELL_ID AND A.TIMESTAMP = B.TIMESTAMP
		WHERE A.`TIMESTAMP` = ''',PROC_TIME,'''
		;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP TEMPORARY TABLE IF EXISTS ',GT_DB,'.`tmp_table_pm_inter_system_handover_',WORKER_ID,'` ;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	
	INSERT INTO gt_gw_main.sp_log VALUES(O_GT_DB,'SP_Generate_PM_counter_NSN_UMTS_Daily','Update RNC_NAME', NOW());
	
	SET @SqlCmd=CONCAT('UPDATE ',GT_DB,'.`tmp_table_pm_counter_nsn_umts_',WORKER_ID,'` A, ',CURRENT_NT_DB,'.nt_rnc_current B
			SET
				A.RNC_NAME = B.RNC_NAME				
			WHERE A.RNC_ID = B.RNC_ID;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('INSERT INTO ',GT_DB,'.table_pm_nokia_umts SELECT * FROM ',GT_DB,'.`tmp_table_pm_counter_nsn_umts_',WORKER_ID,'`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;
	
	SET @SqlCmd=CONCAT('DROP  TABLE IF EXISTS ',GT_DB,'.`tmp_table_pm_counter_nsn_umts_',WORKER_ID,'`;');
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt;	
	INSERT INTO gt_gw_main.SP_LOG VALUES(O_GT_DB,'SP_Generate_PM_counter_NSN_UMTS_Daily',CONCAT('Done: ',TIMESTAMPDIFF(SECOND,START_TIME,SYSDATE()),' seconds.'), NOW());
	
END$$
DELIMITER ;

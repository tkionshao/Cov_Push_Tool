DELIMITER $$
USE `gt_gw_main`$$
DROP PROCEDURE IF EXISTS `SP_CreateDB_LTE`$$
CREATE DEFINER=`covmo`@`%` PROCEDURE `SP_Generate_Global_Statistic_Sub_cell_Aggr`(IN TECH_MASK TINYINT(2),IN WORKER_ID VARCHAR(10),IN FLAG TINYINT(2),IN exDate VARCHAR(10),IN DS_FLAG TINYINT(2),PENDING_FLAG TINYINT(2))
BEGIN
	DECLARE START_TIME DATETIME DEFAULT SYSDATE();
	DECLARE STEP_START_TIME DATETIME DEFAULT SYSDATE();
	DECLARE SP_Process VARCHAR(100) DEFAULT NULL;
	DECLARE KPI_ERROR CONDITION FOR SQLSTATE '99999' ;
	DECLARE FIRSTDAY_OF_WEEK TINYINT(4) DEFAULT 6;
	DECLARE v_DATA_DATE VARCHAR(10) DEFAULT NULL;
	DECLARE v_DATA_HOUR TINYINT(2) DEFAULT NULL;
	DECLARE v_PU_ID MEDIUMINT(9) DEFAULT NULL;
	DECLARE v_TECH_MASK TINYINT(2) DEFAULT NULL;
	DECLARE v_group_db_name VARCHAR(100) DEFAULT '';
	
	DECLARE SHARE_IP VARCHAR(100) DEFAULT NULL;
	DECLARE SHARE_PORT VARCHAR(10) DEFAULT NULL;
	DECLARE SHARE_ACCOUNT VARCHAR(100) DEFAULT NULL;
	DECLARE SHARE_PW VARCHAR(100) DEFAULT NULL;	
	DECLARE SHARE_DB VARCHAR(100) DEFAULT NULL;	
		
	DECLARE CELL_AGG_UMTS_COLUMN_STR VARCHAR(2000) DEFAULT 
		'`INIT_CALL_CNT`,
		`END_CALL_CNT`,
		`VOICE_CNT`,
		`VIDEO_CNT`,
		`PS_R99_CNT`,
		`PS_HSPA_CNT`,
		`M_RAB_CNT`,
		`SIGNAL_CNT`,
		`SMS_CNT`,
		`PS_OTHER_CNT`,
		`END_VOICE_CNT`,
		`END_VIDEO_CNT`,
		`END_PS_R99_CNT`,
		`END_PS_HSPA_CNT`,
		`END_M_RAB_CNT`,
		`END_SIGNAL_CNT`,
		`END_SMS_CNT`,
		`END_PS_OTHER_CNT`,
		`DROP_VOICE_CNT`,
		`DROP_VIDEO_CNT`,
		`DROP_PS_R99_CNT`,
		`DROP_PS_HSPA_CNT`,
		`DROP_M_RAB_CNT`,
		`DROP_SIGNAL_CNT`,
		`DROP_SMS_CNT`,
		`DROP_PS_OTHER_CNT`,
		`NON_BLOCK_VOICE_CNT`,
		`NON_BLOCK_VIDEO_CNT`,
		`NON_BLOCK_PS_R99_CNT`,
		`NON_BLOCK_PS_HSPA_CNT`,
		`NON_BLOCK_M_RAB_CNT`,
		`NON_BLOCK_SIGNAL_CNT`,
		`NON_BLOCK_SMS_CNT`,
		`NON_BLOCK_PS_OTHER_CNT`,
		`BLOCK_VOICE_CNT`,
		`BLOCK_VEDIO_CNT`,
		`BLOCK_R99_CNT`,
		`BLOCK_HSPA_CNT`,
		`BLOCK_MRAB_CNT`,
		`BLOCK_SIGNAL_CNT`,
		`BLOCK_SMS_CNT`,
		`BLOCK_PS_OTHER_CNT`,
		`RSCP_SUM`,
		`RSCP_CNT`,
		`ECN0_SUM`,
		`ECN0_CNT`,
		`UL_VOLUME_SUM`,
		`DL_VOLUME_SUM`,
		`UL_THROUPUT_MAX`,
		`DL_THROUPUT_MAX`,
		`UL_THROUPUT_SUM`,
		`UL_THROUPUT_CNT`,
		`DL_THROUPUT_SUM`,
		`DL_THROUPUT_CNT`,
		`FP_RSCP_1`,
		`FP_ECN0_1`,
		`BEST_CNT`,
		`CALL_SETUP_TIME_VOICE_SUM`,
		`CALL_SETUP_TIME_VOICE_CNT`,
		`CALL_SETUP_TIME_VEDIO_SUM`,
		`CALL_SETUP_TIME_VEDIO_CNT`,
		`CALL_SETUP_TIME_R99_SUM`,
		`CALL_SETUP_TIME_R99_CNT`,
		`CALL_SETUP_TIME_HSPA_SUM`,
		`CALL_SETUP_TIME_HSPA_CNT`,
		`CALL_SETUP_TIME_MRAB_SUM`,
		`CALL_SETUP_TIME_MRAB_CNT`,
		`CALL_SETUP_TIME_SIG_SUM`,
		`CALL_SETUP_TIME_SIG_CNT`,
		`CALL_SETUP_TIME_OTH_SUM`,
		`CALL_SETUP_TIME_OTH_CNT`,
		`CALL_SETUP_TIME_SMS_SUM`,
		`CALL_SETUP_TIME_SMS_CNT`,
		`CALL_SETUP_TIME_SUM`,
		`CALL_SETUP_TIME_CNT`,
		`SF_VOICE_CNT`,
		`SF_VEDIO_CNT`,
		`SF_R99_CNT`,
		`SF_HSPA_CNT`,
		`SF_MRAB_CNT`,
		`SF_OTHER_CNT`,
		`SF_SMS_CNT`,
		`SF_SIGNAL_CNT`,
		`CALL_DUR_SUM`,
		`VOICE_DUR_SUM`,
		`VIDEO_DUR_SUM`,
		`R99_DUR_SUM`,
		`HSPA_DUR_SUM`,
		`MRAB_DUR_SUM`';
		  
	DECLARE CELL_AGG_UMTS_COLUMN_IFNULL_STR VARCHAR(5000) DEFAULT 
		'IFNULL(`INIT_CALL_CNT`,0) AS `INIT_CALL_CNT`,
		IFNULL(`END_CALL_CNT`,0) AS `END_CALL_CNT`,
		IFNULL(`VOICE_CNT`,0) AS `VOICE_CNT`,
		IFNULL(`VIDEO_CNT`,0) AS `VIDEO_CNT`,
		IFNULL(`PS_R99_CNT`,0) AS `PS_R99_CNT`,
		IFNULL(`PS_HSPA_CNT`,0) AS `PS_HSPA_CNT`,
		IFNULL(`M_RAB_CNT`,0) AS `M_RAB_CNT`,
		IFNULL(`SIGNAL_CNT`,0) AS `SIGNAL_CNT`,
		IFNULL(`SMS_CNT`,0) AS `SMS_CNT`,
		IFNULL(`PS_OTHER_CNT`,0) AS `PS_OTHER_CNT`,
		IFNULL(`END_VOICE_CNT`,0) AS `END_VOICE_CNT`,
		IFNULL(`END_VIDEO_CNT`,0) AS `END_VIDEO_CNT`,
		IFNULL(`END_PS_R99_CNT`,0) AS `END_PS_R99_CNT`,
		IFNULL(`END_PS_HSPA_CNT`,0) AS `END_PS_HSPA_CNT`,
		IFNULL(`END_M_RAB_CNT`,0) AS `END_M_RAB_CNT`,
		IFNULL(`END_SIGNAL_CNT`,0) AS `END_SIGNAL_CNT`,
		IFNULL(`END_SMS_CNT`,0) AS `END_SMS_CNT`,
		IFNULL(`END_PS_OTHER_CNT`,0) AS `END_PS_OTHER_CNT`,
		IFNULL(`DROP_VOICE_CNT`,0) AS `DROP_VOICE_CNT`,
		IFNULL(`DROP_VIDEO_CNT`,0) AS `DROP_VIDEO_CNT`,
		IFNULL(`DROP_PS_R99_CNT`,0) AS `DROP_PS_R99_CNT`,
		IFNULL(`DROP_PS_HSPA_CNT`,0) AS `DROP_PS_HSPA_CNT`,
		IFNULL(`DROP_M_RAB_CNT`,0) AS `DROP_M_RAB_CNT`,
		IFNULL(`DROP_SIGNAL_CNT`,0) AS `DROP_SIGNAL_CNT`,
		IFNULL(`DROP_SMS_CNT`,0) AS `DROP_SMS_CNT`,
		IFNULL(`DROP_PS_OTHER_CNT`,0) AS `DROP_PS_OTHER_CNT`,
		IFNULL(`NON_BLOCK_VOICE_CNT`,0) AS `NON_BLOCK_VOICE_CNT`,
		IFNULL(`NON_BLOCK_VIDEO_CNT`,0) AS `NON_BLOCK_VIDEO_CNT`,
		IFNULL(`NON_BLOCK_PS_R99_CNT`,0) AS `NON_BLOCK_PS_R99_CNT`,
		IFNULL(`NON_BLOCK_PS_HSPA_CNT`,0) AS `NON_BLOCK_PS_HSPA_CNT`,
		IFNULL(`NON_BLOCK_M_RAB_CNT`,0) AS `NON_BLOCK_M_RAB_CNT`,
		IFNULL(`NON_BLOCK_SIGNAL_CNT`,0) AS `NON_BLOCK_SIGNAL_CNT`,
		IFNULL(`NON_BLOCK_SMS_CNT`,0) AS `NON_BLOCK_SMS_CNT`,
		IFNULL(`NON_BLOCK_PS_OTHER_CNT`,0) AS `NON_BLOCK_PS_OTHER_CNT`,
		IFNULL(`BLOCK_VOICE_CNT`,0) AS `BLOCK_VOICE_CNT`,
		IFNULL(`BLOCK_VEDIO_CNT`,0) AS `BLOCK_VEDIO_CNT`,
		IFNULL(`BLOCK_R99_CNT`,0) AS `BLOCK_R99_CNT`,
		IFNULL(`BLOCK_HSPA_CNT`,0) AS `BLOCK_HSPA_CNT`,
		IFNULL(`BLOCK_MRAB_CNT`,0) AS `BLOCK_MRAB_CNT`,
		IFNULL(`BLOCK_SIGNAL_CNT`,0) AS `BLOCK_SIGNAL_CNT`,
		IFNULL(`BLOCK_SMS_CNT`,0) AS `BLOCK_SMS_CNT`,
		IFNULL(`BLOCK_PS_OTHER_CNT`,0) AS `BLOCK_PS_OTHER_CNT`,
		IFNULL(`RSCP_SUM`,0) AS `RSCP_SUM`,
		IFNULL(`RSCP_CNT`,0) AS `RSCP_CNT`,
		IFNULL(`ECN0_SUM`,0) AS `ECN0_SUM`,
		IFNULL(`ECN0_CNT`,0) AS `ECN0_CNT`,
		IFNULL(`UL_VOLUME_SUM`,0) AS `UL_VOLUME_SUM`,
		IFNULL(`DL_VOLUME_SUM`,0) AS `DL_VOLUME_SUM`,
		IFNULL(`UL_THROUPUT_MAX`,0) AS `UL_THROUPUT_MAX`,
		IFNULL(`DL_THROUPUT_MAX`,0) AS `DL_THROUPUT_MAX`,
		IFNULL(`UL_THROUPUT_SUM`,0) AS `UL_THROUPUT_SUM`,
		IFNULL(`UL_THROUPUT_CNT`,0) AS `UL_THROUPUT_CNT`,
		IFNULL(`DL_THROUPUT_SUM`,0) AS `DL_THROUPUT_SUM`,
		IFNULL(`DL_THROUPUT_CNT`,0) AS `DL_THROUPUT_CNT`,
		IFNULL(`FP_RSCP_1`,0) AS `FP_RSCP_1`,
		IFNULL(`FP_ECN0_1`,0) AS `FP_ECN0_1`,
		IFNULL(`BEST_CNT`,0) AS `BEST_CNT`,
		IFNULL(`CALL_SETUP_TIME_VOICE_SUM`,0) AS `CALL_SETUP_TIME_VOICE_SUM`,
		IFNULL(`CALL_SETUP_TIME_VOICE_CNT`,0) AS `CALL_SETUP_TIME_VOICE_CNT`,
		IFNULL(`CALL_SETUP_TIME_VEDIO_SUM`,0) AS `CALL_SETUP_TIME_VEDIO_SUM`,
		IFNULL(`CALL_SETUP_TIME_VEDIO_CNT`,0) AS `CALL_SETUP_TIME_VEDIO_CNT`,
		IFNULL(`CALL_SETUP_TIME_R99_SUM`,0) AS `CALL_SETUP_TIME_R99_SUM`,
		IFNULL(`CALL_SETUP_TIME_R99_CNT`,0) AS `CALL_SETUP_TIME_R99_CNT`,
		IFNULL(`CALL_SETUP_TIME_HSPA_SUM`,0) AS `CALL_SETUP_TIME_HSPA_SUM`,
		IFNULL(`CALL_SETUP_TIME_HSPA_CNT`,0) AS `CALL_SETUP_TIME_HSPA_CNT`,
		IFNULL(`CALL_SETUP_TIME_MRAB_SUM`,0) AS `CALL_SETUP_TIME_MRAB_SUM`,
		IFNULL(`CALL_SETUP_TIME_MRAB_CNT`,0) AS `CALL_SETUP_TIME_MRAB_CNT`,
		IFNULL(`CALL_SETUP_TIME_SIG_SUM`,0) AS `CALL_SETUP_TIME_SIG_SUM`,
		IFNULL(`CALL_SETUP_TIME_SIG_CNT`,0) AS `CALL_SETUP_TIME_SIG_CNT`,
		IFNULL(`CALL_SETUP_TIME_OTH_SUM`,0) AS `CALL_SETUP_TIME_OTH_SUM`,
		IFNULL(`CALL_SETUP_TIME_OTH_CNT`,0) AS `CALL_SETUP_TIME_OTH_CNT`,
		IFNULL(`CALL_SETUP_TIME_SMS_SUM`,0) AS `CALL_SETUP_TIME_SMS_SUM`,
		IFNULL(`CALL_SETUP_TIME_SMS_CNT`,0) AS `CALL_SETUP_TIME_SMS_CNT`,
		IFNULL(`CALL_SETUP_TIME_SUM`,0) AS `CALL_SETUP_TIME_SUM`,
		IFNULL(`CALL_SETUP_TIME_CNT`,0) AS `CALL_SETUP_TIME_CNT`,
		IFNULL(`SF_VOICE_CNT`,0) AS `SF_VOICE_CNT`,
		IFNULL(`SF_VEDIO_CNT`,0) AS `SF_VEDIO_CNT`,
		IFNULL(`SF_R99_CNT`,0) AS `SF_R99_CNT`,
		IFNULL(`SF_HSPA_CNT`,0) AS `SF_HSPA_CNT`,
		IFNULL(`SF_MRAB_CNT`,0) AS `SF_MRAB_CNT`,
		IFNULL(`SF_OTHER_CNT`,0) AS `SF_OTHER_CNT`,
		IFNULL(`SF_SMS_CNT`,0) AS `SF_SMS_CNT`,
		IFNULL(`SF_SIGNAL_CNT`,0) AS `SF_SIGNAL_CNT`,
		IFNULL(`CALL_DUR_SUM`,0) AS `CALL_DUR_SUM`,
		IFNULL(`VOICE_DUR_SUM`,0) AS `VOICE_DUR_SUM`,
		IFNULL(`VIDEO_DUR_SUM`,0) AS `VIDEO_DUR_SUM`,
		IFNULL(`R99_DUR_SUM`,0) AS `R99_DUR_SUM`,
		IFNULL(`HSPA_DUR_SUM`,0) AS `HSPA_DUR_SUM`,
		IFNULL(`MRAB_DUR_SUM`,0) AS `MRAB_DUR_SUM`';
		
	DECLARE CELL_AGG_UMTS_COLUMN_SUM_STR VARCHAR(6000) DEFAULT 
		'SUM(IFNULL(`INIT_CALL_CNT`,0)) AS `INIT_CALL_CNT`,
		SUM(IFNULL(`END_CALL_CNT`,0)) AS `END_CALL_CNT`,
		SUM(IFNULL(`VOICE_CNT`,0)) AS `VOICE_CNT`,
		SUM(IFNULL(`VIDEO_CNT`,0)) AS `VIDEO_CNT`,
		SUM(IFNULL(`PS_R99_CNT`,0)) AS `PS_R99_CNT`,
		SUM(IFNULL(`PS_HSPA_CNT`,0)) AS `PS_HSPA_CNT`,
		SUM(IFNULL(`M_RAB_CNT`,0)) AS `M_RAB_CNT`,
		SUM(IFNULL(`SIGNAL_CNT`,0)) AS `SIGNAL_CNT`,
		SUM(IFNULL(`SMS_CNT`,0)) AS `SMS_CNT`,
		SUM(IFNULL(`PS_OTHER_CNT`,0)) AS `PS_OTHER_CNT`,
		SUM(IFNULL(`END_VOICE_CNT`,0)) AS `END_VOICE_CNT`,
		SUM(IFNULL(`END_VIDEO_CNT`,0)) AS `END_VIDEO_CNT`,
		SUM(IFNULL(`END_PS_R99_CNT`,0)) AS `END_PS_R99_CNT`,
		SUM(IFNULL(`END_PS_HSPA_CNT`,0)) AS `END_PS_HSPA_CNT`,
		SUM(IFNULL(`END_M_RAB_CNT`,0)) AS `END_M_RAB_CNT`,
		SUM(IFNULL(`END_SIGNAL_CNT`,0)) AS `END_SIGNAL_CNT`,
		SUM(IFNULL(`END_SMS_CNT`,0)) AS `END_SMS_CNT`,
		SUM(IFNULL(`END_PS_OTHER_CNT`,0)) AS `END_PS_OTHER_CNT`,
		SUM(IFNULL(`DROP_VOICE_CNT`,0)) AS `DROP_VOICE_CNT`,
		SUM(IFNULL(`DROP_VIDEO_CNT`,0)) AS `DROP_VIDEO_CNT`,
		SUM(IFNULL(`DROP_PS_R99_CNT`,0)) AS `DROP_PS_R99_CNT`,
		SUM(IFNULL(`DROP_PS_HSPA_CNT`,0)) AS `DROP_PS_HSPA_CNT`,
		SUM(IFNULL(`DROP_M_RAB_CNT`,0)) AS `DROP_M_RAB_CNT`,
		SUM(IFNULL(`DROP_SIGNAL_CNT`,0)) AS `DROP_SIGNAL_CNT`,
		SUM(IFNULL(`DROP_SMS_CNT`,0)) AS `DROP_SMS_CNT`,
		SUM(IFNULL(`DROP_PS_OTHER_CNT`,0)) AS `DROP_PS_OTHER_CNT`,
		SUM(IFNULL(`NON_BLOCK_VOICE_CNT`,0)) AS `NON_BLOCK_VOICE_CNT`,
		SUM(IFNULL(`NON_BLOCK_VIDEO_CNT`,0)) AS `NON_BLOCK_VIDEO_CNT`,
		SUM(IFNULL(`NON_BLOCK_PS_R99_CNT`,0)) AS `NON_BLOCK_PS_R99_CNT`,
		SUM(IFNULL(`NON_BLOCK_PS_HSPA_CNT`,0)) AS `NON_BLOCK_PS_HSPA_CNT`,
		SUM(IFNULL(`NON_BLOCK_M_RAB_CNT`,0)) AS `NON_BLOCK_M_RAB_CNT`,
		SUM(IFNULL(`NON_BLOCK_SIGNAL_CNT`,0)) AS `NON_BLOCK_SIGNAL_CNT`,
		SUM(IFNULL(`NON_BLOCK_SMS_CNT`,0)) AS `NON_BLOCK_SMS_CNT`,
		SUM(IFNULL(`NON_BLOCK_PS_OTHER_CNT`,0)) AS `NON_BLOCK_PS_OTHER_CNT`,
		SUM(IFNULL(`BLOCK_VOICE_CNT`,0)) AS `BLOCK_VOICE_CNT`,
		SUM(IFNULL(`BLOCK_VEDIO_CNT`,0)) AS `BLOCK_VEDIO_CNT`,
		SUM(IFNULL(`BLOCK_R99_CNT`,0)) AS `BLOCK_R99_CNT`,
		SUM(IFNULL(`BLOCK_HSPA_CNT`,0)) AS `BLOCK_HSPA_CNT`,
		SUM(IFNULL(`BLOCK_MRAB_CNT`,0)) AS `BLOCK_MRAB_CNT`,
		SUM(IFNULL(`BLOCK_SIGNAL_CNT`,0)) AS `BLOCK_SIGNAL_CNT`,
		SUM(IFNULL(`BLOCK_SMS_CNT`,0)) AS `BLOCK_SMS_CNT`,
		SUM(IFNULL(`BLOCK_PS_OTHER_CNT`,0)) AS `BLOCK_PS_OTHER_CNT`,
		SUM(IFNULL(`RSCP_SUM`,0)) AS `RSCP_SUM`,
		SUM(IFNULL(`RSCP_CNT`,0)) AS `RSCP_CNT`,
		SUM(IFNULL(`ECN0_SUM`,0)) AS `ECN0_SUM`,
		SUM(IFNULL(`ECN0_CNT`,0)) AS `ECN0_CNT`,
		SUM(IFNULL(`UL_VOLUME_SUM`,0)) AS `UL_VOLUME_SUM`,
		SUM(IFNULL(`DL_VOLUME_SUM`,0)) AS `DL_VOLUME_SUM`,
		MAX(IFNULL(`UL_THROUPUT_MAX`,0)) AS `UL_THROUPUT_MAX`,
		MAX(IFNULL(`DL_THROUPUT_MAX`,0)) AS `DL_THROUPUT_MAX`,
		SUM(IFNULL(`UL_THROUPUT_SUM`,0)) AS `UL_THROUPUT_SUM`,
		SUM(IFNULL(`UL_THROUPUT_CNT`,0)) AS `UL_THROUPUT_CNT`,
		SUM(IFNULL(`DL_THROUPUT_SUM`,0)) AS `DL_THROUPUT_SUM`,
		SUM(IFNULL(`DL_THROUPUT_CNT`,0)) AS `DL_THROUPUT_CNT`,
		SUM(IFNULL(`FP_RSCP_1`,0)) AS `FP_RSCP_1`,
		SUM(IFNULL(`FP_ECN0_1`,0)) AS `FP_ECN0_1`,
		SUM(IFNULL(`BEST_CNT`,0)) AS `BEST_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_VOICE_SUM`,0)) AS `CALL_SETUP_TIME_VOICE_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_VOICE_CNT`,0)) AS `CALL_SETUP_TIME_VOICE_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_VEDIO_SUM`,0)) AS `CALL_SETUP_TIME_VEDIO_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_VEDIO_CNT`,0)) AS `CALL_SETUP_TIME_VEDIO_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_R99_SUM`,0)) AS `CALL_SETUP_TIME_R99_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_R99_CNT`,0)) AS `CALL_SETUP_TIME_R99_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_HSPA_SUM`,0)) AS `CALL_SETUP_TIME_HSPA_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_HSPA_CNT`,0)) AS `CALL_SETUP_TIME_HSPA_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_MRAB_SUM`,0)) AS `CALL_SETUP_TIME_MRAB_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_MRAB_CNT`,0)) AS `CALL_SETUP_TIME_MRAB_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_SIG_SUM`,0)) AS `CALL_SETUP_TIME_SIG_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_SIG_CNT`,0)) AS `CALL_SETUP_TIME_SIG_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_OTH_SUM`,0)) AS `CALL_SETUP_TIME_OTH_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_OTH_CNT`,0)) AS `CALL_SETUP_TIME_OTH_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_SMS_SUM`,0)) AS `CALL_SETUP_TIME_SMS_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_SMS_CNT`,0)) AS `CALL_SETUP_TIME_SMS_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_SUM`,0)) AS `CALL_SETUP_TIME_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_CNT`,0)) AS `CALL_SETUP_TIME_CNT`,
		SUM(IFNULL(`SF_VOICE_CNT`,0)) AS `SF_VOICE_CNT`,
		SUM(IFNULL(`SF_VEDIO_CNT`,0)) AS `SF_VEDIO_CNT`,
		SUM(IFNULL(`SF_R99_CNT`,0)) AS `SF_R99_CNT`,
		SUM(IFNULL(`SF_HSPA_CNT`,0)) AS `SF_HSPA_CNT`,
		SUM(IFNULL(`SF_MRAB_CNT`,0)) AS `SF_MRAB_CNT`,
		SUM(IFNULL(`SF_OTHER_CNT`,0)) AS `SF_OTHER_CNT`,
		SUM(IFNULL(`SF_SMS_CNT`,0)) AS `SF_SMS_CNT`,
		SUM(IFNULL(`SF_SIGNAL_CNT`,0)) AS `SF_SIGNAL_CNT`,
		SUM(IFNULL(`CALL_DUR_SUM`,0)) AS `CALL_DUR_SUM`,
		SUM(IFNULL(`VOICE_DUR_SUM`,0)) AS `VOICE_DUR_SUM`,
		SUM(IFNULL(`VIDEO_DUR_SUM`,0)) AS `VIDEO_DUR_SUM`,
		SUM(IFNULL(`R99_DUR_SUM`,0)) AS `R99_DUR_SUM`,
		SUM(IFNULL(`HSPA_DUR_SUM`,0)) AS `HSPA_DUR_SUM`,
		SUM(IFNULL(`MRAB_DUR_SUM`,0)) AS `MRAB_DUR_SUM`';
		
	DECLARE CELL_AGG_UMTS_COLUMN_UPD_STR VARCHAR(10000) DEFAULT 
		'RPT_TABLE_NAME.INIT_CALL_CNT=RPT_TABLE_NAME.INIT_CALL_CNT+VALUES(INIT_CALL_CNT),
		RPT_TABLE_NAME.END_CALL_CNT=RPT_TABLE_NAME.END_CALL_CNT+VALUES(END_CALL_CNT),	
		RPT_TABLE_NAME.VOICE_CNT=RPT_TABLE_NAME.VOICE_CNT+VALUES(VOICE_CNT),
		RPT_TABLE_NAME.VIDEO_CNT=RPT_TABLE_NAME.VIDEO_CNT+VALUES(VIDEO_CNT),
		RPT_TABLE_NAME.PS_R99_CNT=RPT_TABLE_NAME.PS_R99_CNT+VALUES(PS_R99_CNT),
		RPT_TABLE_NAME.PS_HSPA_CNT=RPT_TABLE_NAME.PS_HSPA_CNT+VALUES(PS_HSPA_CNT),
		RPT_TABLE_NAME.M_RAB_CNT=RPT_TABLE_NAME.M_RAB_CNT+VALUES(M_RAB_CNT),
		RPT_TABLE_NAME.SIGNAL_CNT=RPT_TABLE_NAME.SIGNAL_CNT+VALUES(SIGNAL_CNT),
		RPT_TABLE_NAME.SMS_CNT=RPT_TABLE_NAME.SMS_CNT+VALUES(SMS_CNT),
		RPT_TABLE_NAME.PS_OTHER_CNT=RPT_TABLE_NAME.PS_OTHER_CNT+VALUES(PS_OTHER_CNT),
		RPT_TABLE_NAME.END_VOICE_CNT=RPT_TABLE_NAME.END_VOICE_CNT+VALUES(END_VOICE_CNT),
		RPT_TABLE_NAME.END_VIDEO_CNT=RPT_TABLE_NAME.END_VIDEO_CNT+VALUES(END_VIDEO_CNT),
		RPT_TABLE_NAME.END_PS_R99_CNT=RPT_TABLE_NAME.END_PS_R99_CNT+VALUES(END_PS_R99_CNT),
		RPT_TABLE_NAME.END_PS_HSPA_CNT=RPT_TABLE_NAME.END_PS_HSPA_CNT+VALUES(END_PS_HSPA_CNT),
		RPT_TABLE_NAME.END_M_RAB_CNT=RPT_TABLE_NAME.END_M_RAB_CNT+VALUES(END_M_RAB_CNT),
		RPT_TABLE_NAME.END_SIGNAL_CNT=RPT_TABLE_NAME.END_SIGNAL_CNT+VALUES(END_SIGNAL_CNT),
		RPT_TABLE_NAME.END_SMS_CNT=RPT_TABLE_NAME.END_SMS_CNT+VALUES(END_SMS_CNT),
		RPT_TABLE_NAME.END_PS_OTHER_CNT=RPT_TABLE_NAME.END_PS_OTHER_CNT+VALUES(END_PS_OTHER_CNT),
		RPT_TABLE_NAME.DROP_VOICE_CNT=RPT_TABLE_NAME.DROP_VOICE_CNT+VALUES(DROP_VOICE_CNT),
		RPT_TABLE_NAME.DROP_VIDEO_CNT=RPT_TABLE_NAME.DROP_VIDEO_CNT+VALUES(DROP_VIDEO_CNT),
		RPT_TABLE_NAME.DROP_PS_R99_CNT=RPT_TABLE_NAME.DROP_PS_R99_CNT+VALUES(DROP_PS_R99_CNT),
		RPT_TABLE_NAME.DROP_PS_HSPA_CNT=RPT_TABLE_NAME.DROP_PS_HSPA_CNT+VALUES(DROP_PS_HSPA_CNT),
		RPT_TABLE_NAME.DROP_M_RAB_CNT=RPT_TABLE_NAME.DROP_M_RAB_CNT+VALUES(DROP_M_RAB_CNT),
		RPT_TABLE_NAME.DROP_SIGNAL_CNT=RPT_TABLE_NAME.DROP_SIGNAL_CNT+VALUES(DROP_SIGNAL_CNT),
		RPT_TABLE_NAME.DROP_SMS_CNT=RPT_TABLE_NAME.DROP_SMS_CNT+VALUES(DROP_SMS_CNT),
		RPT_TABLE_NAME.DROP_PS_OTHER_CNT=RPT_TABLE_NAME.DROP_PS_OTHER_CNT+VALUES(DROP_PS_OTHER_CNT),
		RPT_TABLE_NAME.NON_BLOCK_VOICE_CNT=RPT_TABLE_NAME.NON_BLOCK_VOICE_CNT+VALUES(NON_BLOCK_VOICE_CNT),
		RPT_TABLE_NAME.NON_BLOCK_VIDEO_CNT=RPT_TABLE_NAME.NON_BLOCK_VIDEO_CNT+VALUES(NON_BLOCK_VIDEO_CNT),
		RPT_TABLE_NAME.NON_BLOCK_PS_R99_CNT=RPT_TABLE_NAME.NON_BLOCK_PS_R99_CNT+VALUES(NON_BLOCK_PS_R99_CNT),
		RPT_TABLE_NAME.NON_BLOCK_PS_HSPA_CNT=RPT_TABLE_NAME.NON_BLOCK_PS_HSPA_CNT+VALUES(NON_BLOCK_PS_HSPA_CNT),
		RPT_TABLE_NAME.NON_BLOCK_M_RAB_CNT=RPT_TABLE_NAME.NON_BLOCK_M_RAB_CNT+VALUES(NON_BLOCK_M_RAB_CNT),
		RPT_TABLE_NAME.NON_BLOCK_SIGNAL_CNT=RPT_TABLE_NAME.NON_BLOCK_SIGNAL_CNT+VALUES(NON_BLOCK_SIGNAL_CNT),
		RPT_TABLE_NAME.NON_BLOCK_SMS_CNT=RPT_TABLE_NAME.NON_BLOCK_SMS_CNT+VALUES(NON_BLOCK_SMS_CNT),
		RPT_TABLE_NAME.NON_BLOCK_PS_OTHER_CNT=RPT_TABLE_NAME.NON_BLOCK_PS_OTHER_CNT+VALUES(NON_BLOCK_PS_OTHER_CNT),
		RPT_TABLE_NAME.BLOCK_VOICE_CNT=RPT_TABLE_NAME.BLOCK_VOICE_CNT+VALUES(BLOCK_VOICE_CNT),
		RPT_TABLE_NAME.BLOCK_VEDIO_CNT=RPT_TABLE_NAME.BLOCK_VEDIO_CNT+VALUES(BLOCK_VEDIO_CNT),
		RPT_TABLE_NAME.BLOCK_R99_CNT=RPT_TABLE_NAME.BLOCK_R99_CNT+VALUES(BLOCK_R99_CNT),
		RPT_TABLE_NAME.BLOCK_HSPA_CNT=RPT_TABLE_NAME.BLOCK_HSPA_CNT+VALUES(BLOCK_HSPA_CNT),
		RPT_TABLE_NAME.BLOCK_MRAB_CNT=RPT_TABLE_NAME.BLOCK_MRAB_CNT+VALUES(BLOCK_MRAB_CNT),
		RPT_TABLE_NAME.BLOCK_SIGNAL_CNT=RPT_TABLE_NAME.BLOCK_SIGNAL_CNT+VALUES(BLOCK_SIGNAL_CNT),
		RPT_TABLE_NAME.BLOCK_SMS_CNT=RPT_TABLE_NAME.BLOCK_SMS_CNT+VALUES(BLOCK_SMS_CNT),
		RPT_TABLE_NAME.BLOCK_PS_OTHER_CNT=RPT_TABLE_NAME.BLOCK_PS_OTHER_CNT+VALUES(BLOCK_PS_OTHER_CNT),
		RPT_TABLE_NAME.RSCP_SUM=RPT_TABLE_NAME.RSCP_SUM+VALUES(RSCP_SUM),
		RPT_TABLE_NAME.RSCP_CNT=RPT_TABLE_NAME.RSCP_CNT+VALUES(RSCP_CNT),
		RPT_TABLE_NAME.ECN0_SUM=RPT_TABLE_NAME.ECN0_SUM+VALUES(ECN0_SUM),
		RPT_TABLE_NAME.ECN0_CNT=RPT_TABLE_NAME.ECN0_CNT+VALUES(ECN0_CNT),
		RPT_TABLE_NAME.UL_VOLUME_SUM=RPT_TABLE_NAME.UL_VOLUME_SUM+VALUES(UL_VOLUME_SUM),
		RPT_TABLE_NAME.DL_VOLUME_SUM=RPT_TABLE_NAME.DL_VOLUME_SUM+VALUES(DL_VOLUME_SUM),
		RPT_TABLE_NAME.UL_THROUPUT_MAX=CASE WHEN RPT_TABLE_NAME.UL_THROUPUT_MAX > VALUES(UL_THROUPUT_MAX) THEN RPT_TABLE_NAME.UL_THROUPUT_MAX ELSE VALUES(UL_THROUPUT_MAX) END,
		RPT_TABLE_NAME.DL_THROUPUT_MAX=CASE WHEN RPT_TABLE_NAME.DL_THROUPUT_MAX > VALUES(DL_THROUPUT_MAX) THEN RPT_TABLE_NAME.DL_THROUPUT_MAX ELSE VALUES(DL_THROUPUT_MAX) END,
		RPT_TABLE_NAME.UL_THROUPUT_SUM=RPT_TABLE_NAME.UL_THROUPUT_SUM+VALUES(UL_THROUPUT_SUM),
		RPT_TABLE_NAME.UL_THROUPUT_CNT=RPT_TABLE_NAME.UL_THROUPUT_CNT+VALUES(UL_THROUPUT_CNT),
		RPT_TABLE_NAME.DL_THROUPUT_SUM=RPT_TABLE_NAME.DL_THROUPUT_SUM+VALUES(DL_THROUPUT_SUM),
		RPT_TABLE_NAME.DL_THROUPUT_CNT=RPT_TABLE_NAME.DL_THROUPUT_CNT+VALUES(DL_THROUPUT_CNT),
		RPT_TABLE_NAME.FP_RSCP_1=RPT_TABLE_NAME.FP_RSCP_1+VALUES(FP_RSCP_1),
		RPT_TABLE_NAME.FP_ECN0_1=RPT_TABLE_NAME.FP_ECN0_1+VALUES(FP_ECN0_1),
		RPT_TABLE_NAME.BEST_CNT=RPT_TABLE_NAME.BEST_CNT+VALUES(BEST_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_VOICE_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_VOICE_SUM+VALUES(CALL_SETUP_TIME_VOICE_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_VOICE_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_VOICE_CNT+VALUES(CALL_SETUP_TIME_VOICE_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_VEDIO_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_VEDIO_SUM+VALUES(CALL_SETUP_TIME_VEDIO_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_VEDIO_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_VEDIO_CNT+VALUES(CALL_SETUP_TIME_VEDIO_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_R99_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_R99_SUM+VALUES(CALL_SETUP_TIME_R99_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_R99_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_R99_CNT+VALUES(CALL_SETUP_TIME_R99_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_HSPA_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_HSPA_SUM+VALUES(CALL_SETUP_TIME_HSPA_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_HSPA_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_HSPA_CNT+VALUES(CALL_SETUP_TIME_HSPA_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_MRAB_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_MRAB_SUM+VALUES(CALL_SETUP_TIME_MRAB_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_MRAB_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_MRAB_CNT+VALUES(CALL_SETUP_TIME_MRAB_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_SIG_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_SIG_SUM+VALUES(CALL_SETUP_TIME_SIG_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_SIG_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_SIG_CNT+VALUES(CALL_SETUP_TIME_SIG_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_OTH_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_OTH_SUM+VALUES(CALL_SETUP_TIME_OTH_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_OTH_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_OTH_CNT+VALUES(CALL_SETUP_TIME_OTH_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_SMS_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_SMS_SUM+VALUES(CALL_SETUP_TIME_SMS_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_SMS_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_SMS_CNT+VALUES(CALL_SETUP_TIME_SMS_CNT),
		RPT_TABLE_NAME.CALL_SETUP_TIME_SUM=RPT_TABLE_NAME.CALL_SETUP_TIME_SUM+VALUES(CALL_SETUP_TIME_SUM),
		RPT_TABLE_NAME.CALL_SETUP_TIME_CNT=RPT_TABLE_NAME.CALL_SETUP_TIME_CNT+VALUES(CALL_SETUP_TIME_CNT),
		RPT_TABLE_NAME.SF_VOICE_CNT=RPT_TABLE_NAME.SF_VOICE_CNT+VALUES(SF_VOICE_CNT),
		RPT_TABLE_NAME.SF_VEDIO_CNT=RPT_TABLE_NAME.SF_VEDIO_CNT+VALUES(SF_VEDIO_CNT),
		RPT_TABLE_NAME.SF_R99_CNT=RPT_TABLE_NAME.SF_R99_CNT+VALUES(SF_R99_CNT),
		RPT_TABLE_NAME.SF_HSPA_CNT=RPT_TABLE_NAME.SF_HSPA_CNT+VALUES(SF_HSPA_CNT),
		RPT_TABLE_NAME.SF_MRAB_CNT=RPT_TABLE_NAME.SF_MRAB_CNT+VALUES(SF_MRAB_CNT),
		RPT_TABLE_NAME.SF_OTHER_CNT=RPT_TABLE_NAME.SF_OTHER_CNT+VALUES(SF_OTHER_CNT),
		RPT_TABLE_NAME.SF_SMS_CNT=RPT_TABLE_NAME.SF_SMS_CNT+VALUES(SF_SMS_CNT),
		RPT_TABLE_NAME.SF_SIGNAL_CNT=RPT_TABLE_NAME.SF_SIGNAL_CNT+VALUES(SF_SIGNAL_CNT),
		RPT_TABLE_NAME.CALL_DUR_SUM=RPT_TABLE_NAME.CALL_DUR_SUM+VALUES(CALL_DUR_SUM),
		RPT_TABLE_NAME.VOICE_DUR_SUM=RPT_TABLE_NAME.VOICE_DUR_SUM+VALUES(VOICE_DUR_SUM),
		RPT_TABLE_NAME.VIDEO_DUR_SUM=RPT_TABLE_NAME.VIDEO_DUR_SUM+VALUES(VIDEO_DUR_SUM),
		RPT_TABLE_NAME.R99_DUR_SUM=RPT_TABLE_NAME.R99_DUR_SUM+VALUES(R99_DUR_SUM),
		RPT_TABLE_NAME.HSPA_DUR_SUM=RPT_TABLE_NAME.HSPA_DUR_SUM+VALUES(HSPA_DUR_SUM),
		RPT_TABLE_NAME.MRAB_DUR_SUM=RPT_TABLE_NAME.MRAB_DUR_SUM+VALUES(MRAB_DUR_SUM)';
			
	DECLARE CELL_AGG_LTE_COLUMN_STR VARCHAR(2000) DEFAULT 
		'`INIT_CALL_CNT`,
		`END_CALL_CNT`,
		`SIGNAL_CNT`,
		`DATA_CNT`,
		`SMS_CNT`,
		`VOLTE_CNT`,
		`UNSPECIFIED_CNT`,
		`END_SIGNAL_CNT`,
		`END_DATA_CNT`,
		`END_SMS_CNT`,
		`END_VOLTE_CNT`,
		`END_UNSPECIFIED_CNT`,
		`DROP_SIGNAL_CNT`,
		`DROP_DATA_CNT`,
		`DROP_SMS_CNT`,
		`DROP_VOLTE_CNT`,
		`DROP_UNSPECIFIED_CNT`,
		`BLOCK_SIGNAL_CNT`,
		`BLOCK_DATA_CNT`,
		`BLOCK_SMS_CNT`,
		`BLOCK_VOLTE_CNT`,
		`BLOCK_UNSPECIFIED_CNT`,
		`CSFB_SIGNAL_CNT`,
		`CSFB_DATA_CNT`,
		`CSFB_SMS_CNT`,
		`CSFB_VOLTE_CNT`,
		`CSFB_UNSPECIFIED_CNT`,
		`NON_BLOCK_SIGNAL_CNT`,
		`NON_BLOCK_DATA_CNT`,
		`NON_BLOCK_SMS_CNT`,
		`NON_BLOCK_VOLTE_CNT`,
		`NON_BLOCK_UNSPECIFIED_CNT`,
		`RSRP_SUM`,
		`RSRP_CNT`,
		`RSRQ_SUM`,
		`RSRQ_CNT`,
		`UL_VOLUME_SUM`,
		`DL_VOLUME_SUM`,
		`UL_THROUPUT_MAX`,
		`DL_THROUPUT_MAX`,
		`UL_THROUPUT_SUM`,
		`UL_THROUPUT_CNT`,
		`DL_THROUPUT_SUM`,
		`DL_THROUPUT_CNT`,
		`INTER_FREQ_ATTEMPT_CNT`,
		`INTER_FREQ_FAILURE_CNT`,
		`INTRA_FREQ_ATTEMPT_CNT`,
		`INTRA_FREQ_FAILURE_CNT`,
		`4G_3G_ATTEMPT_CNT`,
		`4G_3G_FAILURE_CNT`,
		`4G_2G_ATTEMPT_CNT`,
		`4G_2G_FAILURE_CNT`,
		`MR_4G_RSRP_SERVING_SUM`,
		`MR_4G_RSRP_SERVING_CNT`,
		`MR_4G_RSRQ_SERVING_SUM`,
		`MR_4G_RSRQ_SERVING_CNT`,
		`CALL_SETUP_TIME_SUM`,
		`CALL_SETUP_TIME_CNT`,
		`CALL_SETUP_TIME_SIG_SUM`,
		`CALL_SETUP_TIME_SIG_CNT`,
		`CALL_SETUP_TIME_DATA_SUM`,
		`CALL_SETUP_TIME_DATA_CNT`,
		`CALL_SETUP_TIME_SMS_SUM`,
		`CALL_SETUP_TIME_SMS_CNT`,
		`CALL_SETUP_TIME_VOLTE_SUM`,
		`CALL_SETUP_TIME_VOLTE_CNT`,
		`CALL_SETUP_TIME_UNSP_SUM`,
		`CALL_SETUP_TIME_UNSP_CNT`,
		`SF_SIGNAL_CNT`,
		`SF_DATA_CNT`,
		`SF_SMS_CNT`,
		`SF_VOLTE_CNT`,
		`SF_UNSPECIFIED_CNT`,
		`SRVCC_ATTEMPT_CNT`,
		`SRVCC_FAILURE_CNT`,
		`S1_HO_ATTEMPT`,
		`S1_HO_FAILURE`,
		`X2_HO_ATTEMPT`,
		`X2_HO_FAILURE`,
		`LATENCY_SUM`,
		`LATENCY_CNT`';
		  
	DECLARE CELL_AGG_LTE_COLUMN_IFNULL_STR VARCHAR(5000) DEFAULT 
		'IFNULL(`INIT_CALL_CNT`,0) AS `INIT_CALL_CNT`,
		IFNULL(`END_CALL_CNT`,0) AS `END_CALL_CNT`,
		IFNULL(`SIGNAL_CNT`,0) AS `SIGNAL_CNT`,
		IFNULL(`DATA_CNT`,0) AS `DATA_CNT`,
		IFNULL(`SMS_CNT`,0) AS `SMS_CNT`,
		IFNULL(`VOLTE_CNT`,0) AS `VOLTE_CNT`,
		IFNULL(`UNSPECIFIED_CNT`,0) AS `UNSPECIFIED_CNT`,
		IFNULL(`END_SIGNAL_CNT`,0) AS `END_SIGNAL_CNT`,
		IFNULL(`END_DATA_CNT`,0) AS `END_DATA_CNT`,
		IFNULL(`END_SMS_CNT`,0) AS `END_SMS_CNT`,
		IFNULL(`END_VOLTE_CNT`,0) AS `END_VOLTE_CNT`,
		IFNULL(`END_UNSPECIFIED_CNT`,0) AS `END_UNSPECIFIED_CNT`,
		IFNULL(`DROP_SIGNAL_CNT`,0) AS `DROP_SIGNAL_CNT`,
		IFNULL(`DROP_DATA_CNT`,0) AS `DROP_DATA_CNT`,
		IFNULL(`DROP_SMS_CNT`,0) AS `DROP_SMS_CNT`,
		IFNULL(`DROP_VOLTE_CNT`,0) AS `DROP_VOLTE_CNT`,
		IFNULL(`DROP_UNSPECIFIED_CNT`,0) AS `DROP_UNSPECIFIED_CNT`,
		IFNULL(`BLOCK_SIGNAL_CNT`,0) AS `BLOCK_SIGNAL_CNT`,
		IFNULL(`BLOCK_DATA_CNT`,0) AS `BLOCK_DATA_CNT`,
		IFNULL(`BLOCK_SMS_CNT`,0) AS `BLOCK_SMS_CNT`,
		IFNULL(`BLOCK_VOLTE_CNT`,0) AS `BLOCK_VOLTE_CNT`,
		IFNULL(`BLOCK_UNSPECIFIED_CNT`,0) AS `BLOCK_UNSPECIFIED_CNT`,
		IFNULL(`CSFB_SIGNAL_CNT`,0) AS `CSFB_SIGNAL_CNT`,
		IFNULL(`CSFB_DATA_CNT`,0) AS `CSFB_DATA_CNT`,
		IFNULL(`CSFB_SMS_CNT`,0) AS `CSFB_SMS_CNT`,
		IFNULL(`CSFB_VOLTE_CNT`,0) AS `CSFB_VOLTE_CNT`,
		IFNULL(`CSFB_UNSPECIFIED_CNT`,0) AS `CSFB_UNSPECIFIED_CNT`,
		IFNULL(`NON_BLOCK_SIGNAL_CNT`,0) AS `NON_BLOCK_SIGNAL_CNT`,
		IFNULL(`NON_BLOCK_DATA_CNT`,0) AS `NON_BLOCK_DATA_CNT`,
		IFNULL(`NON_BLOCK_SMS_CNT`,0) AS `NON_BLOCK_SMS_CNT`,
		IFNULL(`NON_BLOCK_VOLTE_CNT`,0) AS `NON_BLOCK_VOLTE_CNT`,
		IFNULL(`NON_BLOCK_UNSPECIFIED_CNT`,0) AS `NON_BLOCK_UNSPECIFIED_CNT`,
		IFNULL(`RSRP_SUM`,0) AS `RSRP_SUM`,
		IFNULL(`RSRP_CNT`,0) AS `RSRP_CNT`,
		IFNULL(`RSRQ_SUM`,0) AS `RSRQ_SUM`,
		IFNULL(`RSRQ_CNT`,0) AS `RSRQ_CNT`,
		IFNULL(`UL_VOLUME_SUM`,0) AS `UL_VOLUME_SUM`,
		IFNULL(`DL_VOLUME_SUM`,0) AS `DL_VOLUME_SUM`,
		IFNULL(`UL_THROUPUT_MAX`,0) AS `UL_THROUPUT_MAX`,
		IFNULL(`DL_THROUPUT_MAX`,0) AS `DL_THROUPUT_MAX`,
		IFNULL(`UL_THROUPUT_SUM`,0) AS `UL_THROUPUT_SUM`,
		IFNULL(`UL_THROUPUT_CNT`,0) AS `UL_THROUPUT_CNT`,
		IFNULL(`DL_THROUPUT_SUM`,0) AS `DL_THROUPUT_SUM`,
		IFNULL(`DL_THROUPUT_CNT`,0) AS `DL_THROUPUT_CNT`,
		IFNULL(`INTER_FREQ_ATTEMPT_CNT`,0) AS `INTER_FREQ_ATTEMPT_CNT`,
		IFNULL(`INTER_FREQ_FAILURE_CNT`,0) AS `INTER_FREQ_FAILURE_CNT`,
		IFNULL(`INTRA_FREQ_ATTEMPT_CNT`,0) AS `INTRA_FREQ_ATTEMPT_CNT`,
		IFNULL(`INTRA_FREQ_FAILURE_CNT`,0) AS `INTRA_FREQ_FAILURE_CNT`,
		IFNULL(`4G_3G_ATTEMPT_CNT`,0) AS `4G_3G_ATTEMPT_CNT`,
		IFNULL(`4G_3G_FAILURE_CNT`,0) AS `4G_3G_FAILURE_CNT`,
		IFNULL(`4G_2G_ATTEMPT_CNT`,0) AS `4G_2G_ATTEMPT_CNT`,
		IFNULL(`4G_2G_FAILURE_CNT`,0) AS `4G_2G_FAILURE_CNT`,
		IFNULL(`MR_4G_RSRP_SERVING_SUM`,0) AS `MR_4G_RSRP_SERVING_SUM`,
		IFNULL(`MR_4G_RSRP_SERVING_CNT`,0) AS `MR_4G_RSRP_SERVING_CNT`,
		IFNULL(`MR_4G_RSRQ_SERVING_SUM`,0) AS `MR_4G_RSRQ_SERVING_SUM`,
		IFNULL(`MR_4G_RSRQ_SERVING_CNT`,0) AS `MR_4G_RSRQ_SERVING_CNT`,
		IFNULL(`CALL_SETUP_TIME_SUM`,0) AS `CALL_SETUP_TIME_SUM`,
		IFNULL(`CALL_SETUP_TIME_CNT`,0) AS `CALL_SETUP_TIME_CNT`,
		IFNULL(`CALL_SETUP_TIME_SIG_SUM`,0) AS `CALL_SETUP_TIME_SIG_SUM`,
		IFNULL(`CALL_SETUP_TIME_SIG_CNT`,0) AS `CALL_SETUP_TIME_SIG_CNT`,
		IFNULL(`CALL_SETUP_TIME_DATA_SUM`,0) AS `CALL_SETUP_TIME_DATA_SUM`,
		IFNULL(`CALL_SETUP_TIME_DATA_CNT`,0) AS `CALL_SETUP_TIME_DATA_CNT`,
		IFNULL(`CALL_SETUP_TIME_SMS_SUM`,0) AS `CALL_SETUP_TIME_SMS_SUM`,
		IFNULL(`CALL_SETUP_TIME_SMS_CNT`,0) AS `CALL_SETUP_TIME_SMS_CNT`,
		IFNULL(`CALL_SETUP_TIME_VOLTE_SUM`,0) AS `CALL_SETUP_TIME_VOLTE_SUM`,
		IFNULL(`CALL_SETUP_TIME_VOLTE_CNT`,0) AS `CALL_SETUP_TIME_VOLTE_CNT`,
		IFNULL(`CALL_SETUP_TIME_UNSP_SUM`,0) AS `CALL_SETUP_TIME_UNSP_SUM`,
		IFNULL(`CALL_SETUP_TIME_UNSP_CNT`,0) AS `CALL_SETUP_TIME_UNSP_CNT`,
		IFNULL(`SF_SIGNAL_CNT`,0) AS `SF_SIGNAL_CNT`,
		IFNULL(`SF_DATA_CNT`,0) AS `SF_DATA_CNT`,
		IFNULL(`SF_SMS_CNT`,0) AS `SF_SMS_CNT`,
		IFNULL(`SF_VOLTE_CNT`,0) AS `SF_VOLTE_CNT`,
		IFNULL(`SF_UNSPECIFIED_CNT`,0) AS `SF_UNSPECIFIED_CNT`,
		IFNULL(`SRVCC_ATTEMPT_CNT`,0) AS `SRVCC_ATTEMPT_CNT`,
		IFNULL(`SRVCC_FAILURE_CNT`,0) AS `SRVCC_FAILURE_CNT`,
		IFNULL(`S1_HO_ATTEMPT`,0) AS `S1_HO_ATTEMPT`,
		IFNULL(`S1_HO_FAILURE`,0) AS `S1_HO_FAILURE`,
		IFNULL(`X2_HO_ATTEMPT`,0) AS `X2_HO_ATTEMPT`,
		IFNULL(`X2_HO_FAILURE`,0) AS `X2_HO_FAILURE`,
		IFNULL(`LATENCY_SUM`,0) AS `LATENCY_SUM`,
		IFNULL(`LATENCY_CNT`,0) AS `LATENCY_CNT`';
		
	DECLARE CELL_AGG_LTE_COLUMN_SUM_STR VARCHAR(5000) DEFAULT 
		'SUM(IFNULL(`INIT_CALL_CNT`,0)) AS `INIT_CALL_CNT`,
		SUM(IFNULL(`END_CALL_CNT`,0)) AS `END_CALL_CNT`,
		SUM(IFNULL(`SIGNAL_CNT`,0)) AS `SIGNAL_CNT`,
		SUM(IFNULL(`DATA_CNT`,0)) AS `DATA_CNT`,
		SUM(IFNULL(`SMS_CNT`,0)) AS `SMS_CNT`,
		SUM(IFNULL(`VOLTE_CNT`,0)) AS `VOLTE_CNT`,
		SUM(IFNULL(`UNSPECIFIED_CNT`,0)) AS `UNSPECIFIED_CNT`,
		SUM(IFNULL(`END_SIGNAL_CNT`,0)) AS `END_SIGNAL_CNT`,
		SUM(IFNULL(`END_DATA_CNT`,0)) AS `END_DATA_CNT`,
		SUM(IFNULL(`END_SMS_CNT`,0)) AS `END_SMS_CNT`,
		SUM(IFNULL(`END_VOLTE_CNT`,0)) AS `END_VOLTE_CNT`,
		SUM(IFNULL(`END_UNSPECIFIED_CNT`,0)) AS `END_UNSPECIFIED_CNT`,
		SUM(IFNULL(`DROP_SIGNAL_CNT`,0)) AS `DROP_SIGNAL_CNT`,
		SUM(IFNULL(`DROP_DATA_CNT`,0)) AS `DROP_DATA_CNT`,
		SUM(IFNULL(`DROP_SMS_CNT`,0)) AS `DROP_SMS_CNT`,
		SUM(IFNULL(`DROP_VOLTE_CNT`,0)) AS `DROP_VOLTE_CNT`,
		SUM(IFNULL(`DROP_UNSPECIFIED_CNT`,0)) AS `DROP_UNSPECIFIED_CNT`,
		SUM(IFNULL(`BLOCK_SIGNAL_CNT`,0)) AS `BLOCK_SIGNAL_CNT`,
		SUM(IFNULL(`BLOCK_DATA_CNT`,0)) AS `BLOCK_DATA_CNT`,
		SUM(IFNULL(`BLOCK_SMS_CNT`,0)) AS `BLOCK_SMS_CNT`,
		SUM(IFNULL(`BLOCK_VOLTE_CNT`,0)) AS `BLOCK_VOLTE_CNT`,
		SUM(IFNULL(`BLOCK_UNSPECIFIED_CNT`,0)) AS `BLOCK_UNSPECIFIED_CNT`,
		SUM(IFNULL(`CSFB_SIGNAL_CNT`,0)) AS `CSFB_SIGNAL_CNT`,
		SUM(IFNULL(`CSFB_DATA_CNT`,0)) AS `CSFB_DATA_CNT`,
		SUM(IFNULL(`CSFB_SMS_CNT`,0)) AS `CSFB_SMS_CNT`,
		SUM(IFNULL(`CSFB_VOLTE_CNT`,0)) AS `CSFB_VOLTE_CNT`,
		SUM(IFNULL(`CSFB_UNSPECIFIED_CNT`,0)) AS `CSFB_UNSPECIFIED_CNT`,
		SUM(IFNULL(`NON_BLOCK_SIGNAL_CNT`,0)) AS `NON_BLOCK_SIGNAL_CNT`,
		SUM(IFNULL(`NON_BLOCK_DATA_CNT`,0)) AS `NON_BLOCK_DATA_CNT`,
		SUM(IFNULL(`NON_BLOCK_SMS_CNT`,0)) AS `NON_BLOCK_SMS_CNT`,
		SUM(IFNULL(`NON_BLOCK_VOLTE_CNT`,0)) AS `NON_BLOCK_VOLTE_CNT`,
		SUM(IFNULL(`NON_BLOCK_UNSPECIFIED_CNT`,0)) AS `NON_BLOCK_UNSPECIFIED_CNT`,
		SUM(IFNULL(`RSRP_SUM`,0)) AS `RSRP_SUM`,
		SUM(IFNULL(`RSRP_CNT`,0)) AS `RSRP_CNT`,
		SUM(IFNULL(`RSRQ_SUM`,0)) AS `RSRQ_SUM`,
		SUM(IFNULL(`RSRQ_CNT`,0)) AS `RSRQ_CNT`,
		SUM(IFNULL(`UL_VOLUME_SUM`,0)) AS `UL_VOLUME_SUM`,
		SUM(IFNULL(`DL_VOLUME_SUM`,0)) AS `DL_VOLUME_SUM`,
		MAX(IFNULL(`UL_THROUPUT_MAX`,0)) AS `UL_THROUPUT_MAX`,
		MAX(IFNULL(`DL_THROUPUT_MAX`,0)) AS `DL_THROUPUT_MAX`,
		SUM(IFNULL(`UL_THROUPUT_SUM`,0)) AS `UL_THROUPUT_SUM`,
		SUM(IFNULL(`UL_THROUPUT_CNT`,0)) AS `UL_THROUPUT_CNT`,
		SUM(IFNULL(`DL_THROUPUT_SUM`,0)) AS `DL_THROUPUT_SUM`,
		SUM(IFNULL(`DL_THROUPUT_CNT`,0)) AS `DL_THROUPUT_CNT`,
		SUM(IFNULL(`INTER_FREQ_ATTEMPT_CNT`,0)) AS `INTER_FREQ_ATTEMPT_CNT`,
		SUM(IFNULL(`INTER_FREQ_FAILURE_CNT`,0)) AS `INTER_FREQ_FAILURE_CNT`,
		SUM(IFNULL(`INTRA_FREQ_ATTEMPT_CNT`,0)) AS `INTRA_FREQ_ATTEMPT_CNT`,
		SUM(IFNULL(`INTRA_FREQ_FAILURE_CNT`,0)) AS `INTRA_FREQ_FAILURE_CNT`,
		SUM(IFNULL(`4G_3G_ATTEMPT_CNT`,0)) AS `4G_3G_ATTEMPT_CNT`,
		SUM(IFNULL(`4G_3G_FAILURE_CNT`,0)) AS `4G_3G_FAILURE_CNT`,
		SUM(IFNULL(`4G_2G_ATTEMPT_CNT`,0)) AS `4G_2G_ATTEMPT_CNT`,
		SUM(IFNULL(`4G_2G_FAILURE_CNT`,0)) AS `4G_2G_FAILURE_CNT`,
		SUM(IFNULL(`MR_4G_RSRP_SERVING_SUM`,0)) AS `MR_4G_RSRP_SERVING_SUM`,
		SUM(IFNULL(`MR_4G_RSRP_SERVING_CNT`,0)) AS `MR_4G_RSRP_SERVING_CNT`,
		SUM(IFNULL(`MR_4G_RSRQ_SERVING_SUM`,0)) AS `MR_4G_RSRQ_SERVING_SUM`,
		SUM(IFNULL(`MR_4G_RSRQ_SERVING_CNT`,0)) AS `MR_4G_RSRQ_SERVING_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_SUM`,0)) AS `CALL_SETUP_TIME_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_CNT`,0)) AS `CALL_SETUP_TIME_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_SIG_SUM`,0)) AS `CALL_SETUP_TIME_SIG_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_SIG_CNT`,0)) AS `CALL_SETUP_TIME_SIG_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_DATA_SUM`,0)) AS `CALL_SETUP_TIME_DATA_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_DATA_CNT`,0)) AS `CALL_SETUP_TIME_DATA_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_SMS_SUM`,0)) AS `CALL_SETUP_TIME_SMS_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_SMS_CNT`,0)) AS `CALL_SETUP_TIME_SMS_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_VOLTE_SUM`,0)) AS `CALL_SETUP_TIME_VOLTE_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_VOLTE_CNT`,0)) AS `CALL_SETUP_TIME_VOLTE_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_UNSP_SUM`,0)) AS `CALL_SETUP_TIME_UNSP_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_UNSP_CNT`,0)) AS `CALL_SETUP_TIME_UNSP_CNT`,
		SUM(IFNULL(`SF_SIGNAL_CNT`,0)) AS `SF_SIGNAL_CNT`,
		SUM(IFNULL(`SF_DATA_CNT`,0)) AS `SF_DATA_CNT`,
		SUM(IFNULL(`SF_SMS_CNT`,0)) AS `SF_SMS_CNT`,
		SUM(IFNULL(`SF_VOLTE_CNT`,0)) AS `SF_VOLTE_CNT`,
		SUM(IFNULL(`SF_UNSPECIFIED_CNT`,0)) AS `SF_UNSPECIFIED_CNT`,
		SUM(IFNULL(`SRVCC_ATTEMPT_CNT`,0)) AS `SRVCC_ATTEMPT_CNT`,
		SUM(IFNULL(`SRVCC_FAILURE_CNT`,0)) AS `SRVCC_FAILURE_CNT`,
		SUM(IFNULL(`S1_HO_ATTEMPT`,0)) AS `S1_HO_ATTEMPT`,
		SUM(IFNULL(`S1_HO_FAILURE`,0)) AS `S1_HO_FAILURE`,
		SUM(IFNULL(`X2_HO_ATTEMPT`,0)) AS `X2_HO_ATTEMPT`,
		SUM(IFNULL(`X2_HO_FAILURE`,0)) AS `X2_HO_FAILURE`,
		SUM(IFNULL(`LATENCY_SUM`,0)) AS `LATENCY_SUM`,
		SUM(IFNULL(`LATENCY_CNT`,0)) AS `LATENCY_CNT`';
		
	DECLARE CELL_AGG_LTE_COLUMN_UPD_STR VARCHAR(10000) DEFAULT 
		'RPT_TABLE_NAME.`INIT_CALL_CNT`=RPT_TABLE_NAME.`INIT_CALL_CNT`+VALUES(`INIT_CALL_CNT`),
		RPT_TABLE_NAME.`END_CALL_CNT`=RPT_TABLE_NAME.`END_CALL_CNT`+VALUES(`END_CALL_CNT`),
		RPT_TABLE_NAME.`SIGNAL_CNT`=RPT_TABLE_NAME.`SIGNAL_CNT`+VALUES(`SIGNAL_CNT`),
		RPT_TABLE_NAME.`DATA_CNT`=RPT_TABLE_NAME.`DATA_CNT`+VALUES(`DATA_CNT`),
		RPT_TABLE_NAME.`SMS_CNT`=RPT_TABLE_NAME.`SMS_CNT`+VALUES(`SMS_CNT`),
		RPT_TABLE_NAME.`VOLTE_CNT`=RPT_TABLE_NAME.`VOLTE_CNT`+VALUES(`VOLTE_CNT`),
		RPT_TABLE_NAME.`UNSPECIFIED_CNT`=RPT_TABLE_NAME.`UNSPECIFIED_CNT`+VALUES(`UNSPECIFIED_CNT`),
		RPT_TABLE_NAME.`END_SIGNAL_CNT`=RPT_TABLE_NAME.`END_SIGNAL_CNT`+VALUES(`END_SIGNAL_CNT`),
		RPT_TABLE_NAME.`END_DATA_CNT`=RPT_TABLE_NAME.`END_DATA_CNT`+VALUES(`END_DATA_CNT`),
		RPT_TABLE_NAME.`END_SMS_CNT`=RPT_TABLE_NAME.`END_SMS_CNT`+VALUES(`END_SMS_CNT`),
		RPT_TABLE_NAME.`END_VOLTE_CNT`=RPT_TABLE_NAME.`END_VOLTE_CNT`+VALUES(`END_VOLTE_CNT`),
		RPT_TABLE_NAME.`END_UNSPECIFIED_CNT`=RPT_TABLE_NAME.`END_UNSPECIFIED_CNT`+VALUES(`END_UNSPECIFIED_CNT`),
		RPT_TABLE_NAME.`DROP_SIGNAL_CNT`=RPT_TABLE_NAME.`DROP_SIGNAL_CNT`+VALUES(`DROP_SIGNAL_CNT`),
		RPT_TABLE_NAME.`DROP_DATA_CNT`=RPT_TABLE_NAME.`DROP_DATA_CNT`+VALUES(`DROP_DATA_CNT`),
		RPT_TABLE_NAME.`DROP_SMS_CNT`=RPT_TABLE_NAME.`DROP_SMS_CNT`+VALUES(`DROP_SMS_CNT`),
		RPT_TABLE_NAME.`DROP_VOLTE_CNT`=RPT_TABLE_NAME.`DROP_VOLTE_CNT`+VALUES(`DROP_VOLTE_CNT`),
		RPT_TABLE_NAME.`DROP_UNSPECIFIED_CNT`=RPT_TABLE_NAME.`DROP_UNSPECIFIED_CNT`+VALUES(`DROP_UNSPECIFIED_CNT`),
		RPT_TABLE_NAME.`BLOCK_SIGNAL_CNT`=RPT_TABLE_NAME.`BLOCK_SIGNAL_CNT`+VALUES(`BLOCK_SIGNAL_CNT`),
		RPT_TABLE_NAME.`BLOCK_DATA_CNT`=RPT_TABLE_NAME.`BLOCK_DATA_CNT`+VALUES(`BLOCK_DATA_CNT`),
		RPT_TABLE_NAME.`BLOCK_SMS_CNT`=RPT_TABLE_NAME.`BLOCK_SMS_CNT`+VALUES(`BLOCK_SMS_CNT`),
		RPT_TABLE_NAME.`BLOCK_VOLTE_CNT`=RPT_TABLE_NAME.`BLOCK_VOLTE_CNT`+VALUES(`BLOCK_VOLTE_CNT`),
		RPT_TABLE_NAME.`BLOCK_UNSPECIFIED_CNT`=RPT_TABLE_NAME.`BLOCK_UNSPECIFIED_CNT`+VALUES(`BLOCK_UNSPECIFIED_CNT`),
		RPT_TABLE_NAME.`CSFB_SIGNAL_CNT`=RPT_TABLE_NAME.`CSFB_SIGNAL_CNT`+VALUES(`CSFB_SIGNAL_CNT`),
		RPT_TABLE_NAME.`CSFB_DATA_CNT`=RPT_TABLE_NAME.`CSFB_DATA_CNT`+VALUES(`CSFB_DATA_CNT`),
		RPT_TABLE_NAME.`CSFB_SMS_CNT`=RPT_TABLE_NAME.`CSFB_SMS_CNT`+VALUES(`CSFB_SMS_CNT`),
		RPT_TABLE_NAME.`CSFB_VOLTE_CNT`=RPT_TABLE_NAME.`CSFB_VOLTE_CNT`+VALUES(`CSFB_VOLTE_CNT`),
		RPT_TABLE_NAME.`CSFB_UNSPECIFIED_CNT`=RPT_TABLE_NAME.`CSFB_UNSPECIFIED_CNT`+VALUES(`CSFB_UNSPECIFIED_CNT`),
		RPT_TABLE_NAME.`NON_BLOCK_SIGNAL_CNT`=RPT_TABLE_NAME.`NON_BLOCK_SIGNAL_CNT`+VALUES(`NON_BLOCK_SIGNAL_CNT`),
		RPT_TABLE_NAME.`NON_BLOCK_DATA_CNT`=RPT_TABLE_NAME.`NON_BLOCK_DATA_CNT`+VALUES(`NON_BLOCK_DATA_CNT`),
		RPT_TABLE_NAME.`NON_BLOCK_SMS_CNT`=RPT_TABLE_NAME.`NON_BLOCK_SMS_CNT`+VALUES(`NON_BLOCK_SMS_CNT`),
		RPT_TABLE_NAME.`NON_BLOCK_VOLTE_CNT`=RPT_TABLE_NAME.`NON_BLOCK_VOLTE_CNT`+VALUES(`NON_BLOCK_VOLTE_CNT`),
		RPT_TABLE_NAME.`NON_BLOCK_UNSPECIFIED_CNT`=RPT_TABLE_NAME.`NON_BLOCK_UNSPECIFIED_CNT`+VALUES(`NON_BLOCK_UNSPECIFIED_CNT`),
		RPT_TABLE_NAME.`RSRP_SUM`=RPT_TABLE_NAME.`RSRP_SUM`+VALUES(`RSRP_SUM`),
		RPT_TABLE_NAME.`RSRP_CNT`=RPT_TABLE_NAME.`RSRP_CNT`+VALUES(`RSRP_CNT`),
		RPT_TABLE_NAME.`RSRQ_SUM`=RPT_TABLE_NAME.`RSRQ_SUM`+VALUES(`RSRQ_SUM`),
		RPT_TABLE_NAME.`RSRQ_CNT`=RPT_TABLE_NAME.`RSRQ_CNT`+VALUES(`RSRQ_CNT`),
		RPT_TABLE_NAME.`UL_VOLUME_SUM`=RPT_TABLE_NAME.`UL_VOLUME_SUM`+VALUES(`UL_VOLUME_SUM`),
		RPT_TABLE_NAME.`DL_VOLUME_SUM`=RPT_TABLE_NAME.`DL_VOLUME_SUM`+VALUES(`DL_VOLUME_SUM`),
		RPT_TABLE_NAME.UL_THROUPUT_MAX=CASE WHEN RPT_TABLE_NAME.UL_THROUPUT_MAX > VALUES(UL_THROUPUT_MAX) THEN RPT_TABLE_NAME.UL_THROUPUT_MAX ELSE VALUES(UL_THROUPUT_MAX) END,
		RPT_TABLE_NAME.DL_THROUPUT_MAX=CASE WHEN RPT_TABLE_NAME.DL_THROUPUT_MAX > VALUES(DL_THROUPUT_MAX) THEN RPT_TABLE_NAME.DL_THROUPUT_MAX ELSE VALUES(DL_THROUPUT_MAX) END,
		RPT_TABLE_NAME.`UL_THROUPUT_SUM`=RPT_TABLE_NAME.`UL_THROUPUT_SUM`+VALUES(`UL_THROUPUT_SUM`),
		RPT_TABLE_NAME.`UL_THROUPUT_CNT`=RPT_TABLE_NAME.`UL_THROUPUT_CNT`+VALUES(`UL_THROUPUT_CNT`),
		RPT_TABLE_NAME.`DL_THROUPUT_SUM`=RPT_TABLE_NAME.`DL_THROUPUT_SUM`+VALUES(`DL_THROUPUT_SUM`),
		RPT_TABLE_NAME.`DL_THROUPUT_CNT`=RPT_TABLE_NAME.`DL_THROUPUT_CNT`+VALUES(`DL_THROUPUT_CNT`),
		RPT_TABLE_NAME.`INTER_FREQ_ATTEMPT_CNT`=RPT_TABLE_NAME.`INTER_FREQ_ATTEMPT_CNT`+VALUES(`INTER_FREQ_ATTEMPT_CNT`),
		RPT_TABLE_NAME.`INTER_FREQ_FAILURE_CNT`=RPT_TABLE_NAME.`INTER_FREQ_FAILURE_CNT`+VALUES(`INTER_FREQ_FAILURE_CNT`),
		RPT_TABLE_NAME.`INTRA_FREQ_ATTEMPT_CNT`=RPT_TABLE_NAME.`INTRA_FREQ_ATTEMPT_CNT`+VALUES(`INTRA_FREQ_ATTEMPT_CNT`),
		RPT_TABLE_NAME.`INTRA_FREQ_FAILURE_CNT`=RPT_TABLE_NAME.`INTRA_FREQ_FAILURE_CNT`+VALUES(`INTRA_FREQ_FAILURE_CNT`),
		RPT_TABLE_NAME.`4G_3G_ATTEMPT_CNT`=RPT_TABLE_NAME.`4G_3G_ATTEMPT_CNT`+VALUES(`4G_3G_ATTEMPT_CNT`),
		RPT_TABLE_NAME.`4G_3G_FAILURE_CNT`=RPT_TABLE_NAME.`4G_3G_FAILURE_CNT`+VALUES(`4G_3G_FAILURE_CNT`),
		RPT_TABLE_NAME.`4G_2G_ATTEMPT_CNT`=RPT_TABLE_NAME.`4G_2G_ATTEMPT_CNT`+VALUES(`4G_2G_ATTEMPT_CNT`),
		RPT_TABLE_NAME.`4G_2G_FAILURE_CNT`=RPT_TABLE_NAME.`4G_2G_FAILURE_CNT`+VALUES(`4G_2G_FAILURE_CNT`),
		RPT_TABLE_NAME.`MR_4G_RSRP_SERVING_SUM`=RPT_TABLE_NAME.`MR_4G_RSRP_SERVING_SUM`+VALUES(`MR_4G_RSRP_SERVING_SUM`),
		RPT_TABLE_NAME.`MR_4G_RSRP_SERVING_CNT`=RPT_TABLE_NAME.`MR_4G_RSRP_SERVING_CNT`+VALUES(`MR_4G_RSRP_SERVING_CNT`),
		RPT_TABLE_NAME.`MR_4G_RSRQ_SERVING_SUM`=RPT_TABLE_NAME.`MR_4G_RSRQ_SERVING_SUM`+VALUES(`MR_4G_RSRQ_SERVING_SUM`),
		RPT_TABLE_NAME.`MR_4G_RSRQ_SERVING_CNT`=RPT_TABLE_NAME.`MR_4G_RSRQ_SERVING_CNT`+VALUES(`MR_4G_RSRQ_SERVING_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SUM`+VALUES(`CALL_SETUP_TIME_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_CNT`+VALUES(`CALL_SETUP_TIME_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_SUM`+VALUES(`CALL_SETUP_TIME_SIG_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_CNT`+VALUES(`CALL_SETUP_TIME_SIG_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_DATA_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_DATA_SUM`+VALUES(`CALL_SETUP_TIME_DATA_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_DATA_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_DATA_CNT`+VALUES(`CALL_SETUP_TIME_DATA_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_SUM`+VALUES(`CALL_SETUP_TIME_SMS_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_CNT`+VALUES(`CALL_SETUP_TIME_SMS_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_VOLTE_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_VOLTE_SUM`+VALUES(`CALL_SETUP_TIME_VOLTE_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_VOLTE_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_VOLTE_CNT`+VALUES(`CALL_SETUP_TIME_VOLTE_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_UNSP_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_UNSP_SUM`+VALUES(`CALL_SETUP_TIME_UNSP_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_UNSP_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_UNSP_CNT`+VALUES(`CALL_SETUP_TIME_UNSP_CNT`),
		RPT_TABLE_NAME.`SF_SIGNAL_CNT`=RPT_TABLE_NAME.`SF_SIGNAL_CNT`+VALUES(`SF_SIGNAL_CNT`),
		RPT_TABLE_NAME.`SF_DATA_CNT`=RPT_TABLE_NAME.`SF_DATA_CNT`+VALUES(`SF_DATA_CNT`),
		RPT_TABLE_NAME.`SF_SMS_CNT`=RPT_TABLE_NAME.`SF_SMS_CNT`+VALUES(`SF_SMS_CNT`),
		RPT_TABLE_NAME.`SF_VOLTE_CNT`=RPT_TABLE_NAME.`SF_VOLTE_CNT`+VALUES(`SF_VOLTE_CNT`),
		RPT_TABLE_NAME.`SF_UNSPECIFIED_CNT`=RPT_TABLE_NAME.`SF_UNSPECIFIED_CNT`+VALUES(`SF_UNSPECIFIED_CNT`),
		RPT_TABLE_NAME.`SRVCC_ATTEMPT_CNT`=RPT_TABLE_NAME.`SRVCC_ATTEMPT_CNT`+VALUES(`SRVCC_ATTEMPT_CNT`),
		RPT_TABLE_NAME.`SRVCC_FAILURE_CNT`=RPT_TABLE_NAME.`SRVCC_FAILURE_CNT`+VALUES(`SRVCC_FAILURE_CNT`),
		RPT_TABLE_NAME.`S1_HO_ATTEMPT`=RPT_TABLE_NAME.`S1_HO_ATTEMPT`+VALUES(`S1_HO_ATTEMPT`),
		RPT_TABLE_NAME.`S1_HO_FAILURE`=RPT_TABLE_NAME.`S1_HO_FAILURE`+VALUES(`S1_HO_FAILURE`),
		RPT_TABLE_NAME.`X2_HO_ATTEMPT`=RPT_TABLE_NAME.`X2_HO_ATTEMPT`+VALUES(`X2_HO_ATTEMPT`),
		RPT_TABLE_NAME.`X2_HO_FAILURE`=RPT_TABLE_NAME.`X2_HO_FAILURE`+VALUES(`X2_HO_FAILURE`),
		RPT_TABLE_NAME.`LATENCY_SUM`=RPT_TABLE_NAME.`LATENCY_SUM`+VALUES(`LATENCY_SUM`),
		RPT_TABLE_NAME.`LATENCY_CNT`=RPT_TABLE_NAME.`LATENCY_CNT`+VALUES(`LATENCY_CNT`)';
		
	DECLARE CELL_AGG_GSM_COLUMN_STR VARCHAR(1500) DEFAULT 
		'`INIT_CALL_CNT`,
		`END_CALL_CNT`,
		`VOICE_CNT`,
		`SIGNAL_CNT`,
		`SMS_CNT`,
		`GPRS_CNT`,
		`OTHER_CNT`,
		`END_VOICE_CNT`,
		`END_SIGNAL_CNT`,
		`END_SMS_CNT`,
		`END_GPRS_CNT`,
		`END_OTHER_CNT`,
		`BLOCK_VOICE_CNT`,
		`BLOCK_GPRS_CNT`,
		`BLOCK_SMS_CNT`,
		`BLOCK_SIGNAL_CNT`,
		`BLOCK_OTHER_CNT`,
		`DROP_VOICE_CNT`,
		`DROP_SIGNAL_CNT`,
		`DROP_SMS_CNT`,
		`DROP_GPRS_CNT`,
		`DROP_OTHER_CNT`,
		`NON_BLOCK_VOICE_CNT`,
		`NON_BLOCK_SIGNAL_CNT`,
		`NON_BLOCK_SMS_CNT`,
		`NON_BLOCK_GPRS_CNT`,
		`NON_BLOCK_OTHER_CNT`,
		`RXLEV_SUM`,
		`RXLEV_CNT`,
		`RXQUAL_SUM`,
		`RXQUAL_CNT`,
		`CALL_SETUP_TIME_SUM`,
		`CALL_SETUP_TIME_CNT`,
		`CALL_SETUP_TIME_VOICE_SUM`,
		`CALL_SETUP_TIME_VOICE_CNT`,
		`CALL_SETUP_TIME_SIG_SUM`,
		`CALL_SETUP_TIME_SIG_CNT`,
		`CALL_SETUP_TIME_SMS_SUM`,
		`CALL_SETUP_TIME_SMS_CNT`,
		`CALL_SETUP_TIME_GPRS_SUM`,
		`CALL_SETUP_TIME_GPRS_CNT`,	
		`CALL_SETUP_TIME_OTH_SUM`,
		`CALL_SETUP_TIME_OTH_CNT`,
		`SF_VOICE_CNT`,
		`SF_DATA_CNT`,
		`SF_SMS_CNT`,
		`SF_SIGNAL_CNT`,
		`SF_OTHER_CNT`,
		`CALL_DUR_SUM`,
		`VOICE_DUR_SUM`,
		`DATA_DUR_SUM`';
		
	DECLARE CELL_AGG_GSM_COLUMN_IFNULL_STR VARCHAR(5000) DEFAULT 
		'
		IFNULL(`INIT_CALL_CNT`,0) AS `INIT_CALL_CNT`,
		IFNULL(`END_CALL_CNT`,0) AS `END_CALL_CNT`,
		IFNULL(`VOICE_CNT`,0) AS `VOICE_CNT`,
		IFNULL(`SIGNAL_CNT`,0) AS `SIGNAL_CNT`,
		IFNULL(`SMS_CNT`,0) AS `SMS_CNT`,
		IFNULL(`GPRS_CNT`,0) AS `GPRS_CNT`,
		IFNULL(`OTHER_CNT`,0) AS `OTHER_CNT`,
		IFNULL(`END_VOICE_CNT`,0) AS `END_VOICE_CNT`,
		IFNULL(`END_SIGNAL_CNT`,0) AS `END_SIGNAL_CNT`,
		IFNULL(`END_SMS_CNT`,0) AS `END_SMS_CNT`,
		IFNULL(`END_GPRS_CNT`,0) AS `END_GPRS_CNT`,
		IFNULL(`END_OTHER_CNT`,0) AS `END_OTHER_CNT`,
		IFNULL(`BLOCK_VOICE_CNT`,0) AS `BLOCK_VOICE_CNT`,
		IFNULL(`BLOCK_GPRS_CNT`,0) AS `BLOCK_GPRS_CNT`,
		IFNULL(`BLOCK_SMS_CNT`,0) AS `BLOCK_SMS_CNT`,
		IFNULL(`BLOCK_SIGNAL_CNT`,0) AS `BLOCK_SIGNAL_CNT`,
		IFNULL(`BLOCK_OTHER_CNT`,0) AS `BLOCK_OTHER_CNT`,
		IFNULL(`DROP_VOICE_CNT`,0) AS `DROP_VOICE_CNT`,
		IFNULL(`DROP_SIGNAL_CNT`,0) AS `DROP_SIGNAL_CNT`,
		IFNULL(`DROP_SMS_CNT`,0) AS `DROP_SMS_CNT`,
		IFNULL(`DROP_GPRS_CNT`,0) AS `DROP_GPRS_CNT`,
		IFNULL(`DROP_OTHER_CNT`,0) AS `DROP_OTHER_CNT`,
		IFNULL(`NON_BLOCK_VOICE_CNT`,0) AS `NON_BLOCK_VOICE_CNT`,
		IFNULL(`NON_BLOCK_SIGNAL_CNT`,0) AS `NON_BLOCK_SIGNAL_CNT`,
		IFNULL(`NON_BLOCK_SMS_CNT`,0) AS `NON_BLOCK_SMS_CNT`,
		IFNULL(`NON_BLOCK_GPRS_CNT`,0) AS `NON_BLOCK_GPRS_CNT`,
		IFNULL(`NON_BLOCK_OTHER_CNT`,0) AS `NON_BLOCK_OTHER_CNT`,
		IFNULL(`RXLEV_SUM`,0) AS `RXLEV_SUM`,
		IFNULL(`RXLEV_CNT`,0) AS `RXLEV_CNT`,
		IFNULL(`RXQUAL_SUM`,0) AS `RXQUAL_SUM`,
		IFNULL(`RXQUAL_CNT`,0) AS `RXQUAL_CNT`,
		IFNULL(`CALL_SETUP_TIME_SUM`,0) AS `CALL_SETUP_TIME_SUM`,
		IFNULL(`CALL_SETUP_TIME_CNT`,0) AS `CALL_SETUP_TIME_CNT`,
		IFNULL(`CALL_SETUP_TIME_VOICE_SUM`,0) AS `CALL_SETUP_TIME_VOICE_SUM`,
		IFNULL(`CALL_SETUP_TIME_VOICE_CNT`,0) AS `CALL_SETUP_TIME_VOICE_CNT`,
		IFNULL(`CALL_SETUP_TIME_SIG_SUM`,0) AS `CALL_SETUP_TIME_SIG_SUM`,
		IFNULL(`CALL_SETUP_TIME_SIG_CNT`,0) AS `CALL_SETUP_TIME_SIG_CNT`,
		IFNULL(`CALL_SETUP_TIME_SMS_SUM`,0) AS `CALL_SETUP_TIME_SMS_SUM`,
		IFNULL(`CALL_SETUP_TIME_SMS_CNT`,0) AS `CALL_SETUP_TIME_SMS_CNT`,
		IFNULL(`CALL_SETUP_TIME_GPRS_SUM`,0) AS `CALL_SETUP_TIME_GPRS_SUM`,
		IFNULL(`CALL_SETUP_TIME_GPRS_CNT`,0) AS `CALL_SETUP_TIME_GPRS_CNT`,
		IFNULL(`CALL_SETUP_TIME_OTH_SUM`,0) AS `CALL_SETUP_TIME_OTH_SUM`,
		IFNULL(`CALL_SETUP_TIME_OTH_CNT`,0) AS `CALL_SETUP_TIME_OTH_CNT`,
		IFNULL(`SF_VOICE_CNT`,0) AS `SF_VOICE_CNT`,
		IFNULL(`SF_DATA_CNT`,0) AS `SF_DATA_CNT`,
		IFNULL(`SF_SMS_CNT`,0) AS `SF_SMS_CNT`,
		IFNULL(`SF_SIGNAL_CNT`,0) AS `SF_SIGNAL_CNT`,
		IFNULL(`SF_OTHER_CNT`,0) AS `SF_OTHER_CNT`,
		IFNULL(`CALL_DUR_SUM`,0) AS `CALL_DUR_SUM`,
		IFNULL(`VOICE_DUR_SUM`,0) AS `VOICE_DUR_SUM`,
		IFNULL(`DATA_DUR_SUM`,0) AS `DATA_DUR_SUM`';
		
	DECLARE CELL_AGG_GSM_COLUMN_SUM_STR VARCHAR(5000) DEFAULT 
		'
		SUM(IFNULL(`INIT_CALL_CNT`,0)) AS `INIT_CALL_CNT`,
		SUM(IFNULL(`END_CALL_CNT`,0)) AS `END_CALL_CNT`,
		SUM(IFNULL(`VOICE_CNT`,0)) AS `VOICE_CNT`,
		SUM(IFNULL(`SIGNAL_CNT`,0)) AS `SIGNAL_CNT`,
		SUM(IFNULL(`SMS_CNT`,0)) AS `SMS_CNT`,
		SUM(IFNULL(`GPRS_CNT`,0)) AS `GPRS_CNT`,
		SUM(IFNULL(`OTHER_CNT`,0)) AS `OTHER_CNT`,
		SUM(IFNULL(`END_VOICE_CNT`,0)) AS `END_VOICE_CNT`,
		SUM(IFNULL(`END_SIGNAL_CNT`,0)) AS `END_SIGNAL_CNT`,
		SUM(IFNULL(`END_SMS_CNT`,0)) AS `END_SMS_CNT`,
		SUM(IFNULL(`END_GPRS_CNT`,0)) AS `END_GPRS_CNT`,
		SUM(IFNULL(`END_OTHER_CNT`,0)) AS `END_OTHER_CNT`,
		SUM(IFNULL(`BLOCK_VOICE_CNT`,0)) AS `BLOCK_VOICE_CNT`,
		SUM(IFNULL(`BLOCK_GPRS_CNT`,0)) AS `BLOCK_GPRS_CNT`,
		SUM(IFNULL(`BLOCK_SMS_CNT`,0)) AS `BLOCK_SMS_CNT`,
		SUM(IFNULL(`BLOCK_SIGNAL_CNT`,0)) AS `BLOCK_SIGNAL_CNT`,
		SUM(IFNULL(`BLOCK_OTHER_CNT`,0)) AS `BLOCK_OTHER_CNT`,
		SUM(IFNULL(`DROP_VOICE_CNT`,0)) AS `DROP_VOICE_CNT`,
		SUM(IFNULL(`DROP_SIGNAL_CNT`,0)) AS `DROP_SIGNAL_CNT`,
		SUM(IFNULL(`DROP_SMS_CNT`,0)) AS `DROP_SMS_CNT`,
		SUM(IFNULL(`DROP_GPRS_CNT`,0)) AS `DROP_GPRS_CNT`,
		SUM(IFNULL(`DROP_OTHER_CNT`,0)) AS `DROP_OTHER_CNT`,
		SUM(IFNULL(`NON_BLOCK_VOICE_CNT`,0)) AS `NON_BLOCK_VOICE_CNT`,
		SUM(IFNULL(`NON_BLOCK_SIGNAL_CNT`,0)) AS `NON_BLOCK_SIGNAL_CNT`,
		SUM(IFNULL(`NON_BLOCK_SMS_CNT`,0)) AS `NON_BLOCK_SMS_CNT`,
		SUM(IFNULL(`NON_BLOCK_GPRS_CNT`,0)) AS `NON_BLOCK_GPRS_CNT`,
		SUM(IFNULL(`NON_BLOCK_OTHER_CNT`,0)) AS `NON_BLOCK_OTHER_CNT`,
		SUM(IFNULL(`RXLEV_SUM`,0)) AS `RXLEV_SUM`,
		SUM(IFNULL(`RXLEV_CNT`,0)) AS `RXLEV_CNT`,
		SUM(IFNULL(`RXQUAL_SUM`,0)) AS `RXQUAL_SUM`,
		SUM(IFNULL(`RXQUAL_CNT`,0)) AS `RXQUAL_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_SUM`,0)) AS `CALL_SETUP_TIME_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_CNT`,0)) AS `CALL_SETUP_TIME_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_VOICE_SUM`,0)) AS `CALL_SETUP_TIME_VOICE_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_VOICE_CNT`,0)) AS `CALL_SETUP_TIME_VOICE_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_SIG_SUM`,0)) AS `CALL_SETUP_TIME_SIG_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_SIG_CNT`,0)) AS `CALL_SETUP_TIME_SIG_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_SMS_SUM`,0)) AS `CALL_SETUP_TIME_SMS_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_SMS_CNT`,0)) AS `CALL_SETUP_TIME_SMS_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_GPRS_SUM`,0)) AS `CALL_SETUP_TIME_GPRS_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_GPRS_CNT`,0)) AS `CALL_SETUP_TIME_GPRS_CNT`,
		SUM(IFNULL(`CALL_SETUP_TIME_OTH_SUM`,0)) AS `CALL_SETUP_TIME_OTH_SUM`,
		SUM(IFNULL(`CALL_SETUP_TIME_OTH_CNT`,0)) AS `CALL_SETUP_TIME_OTH_CNT`,
		SUM(IFNULL(`SF_VOICE_CNT`,0)) AS `SF_VOICE_CNT`,
		SUM(IFNULL(`SF_DATA_CNT`,0)) AS `SF_DATA_CNT`,
		SUM(IFNULL(`SF_SMS_CNT`,0)) AS `SF_SMS_CNT`,
		SUM(IFNULL(`SF_SIGNAL_CNT`,0)) AS `SF_SIGNAL_CNT`,
		SUM(IFNULL(`SF_OTHER_CNT`,0)) AS `SF_OTHER_CNT`,
		SUM(IFNULL(`CALL_DUR_SUM`,0)) AS `CALL_DUR_SUM`,
		SUM(IFNULL(`VOICE_DUR_SUM`,0)) AS `VOICE_DUR_SUM`,
		SUM(IFNULL(`DATA_DUR_SUM`,0)) AS `DATA_DUR_SUM`';
		
	DECLARE CELL_AGG_GSM_COLUMN_UPD_STR VARCHAR(10000) DEFAULT 
		'
		RPT_TABLE_NAME.`INIT_CALL_CNT`=RPT_TABLE_NAME.`INIT_CALL_CNT`+VALUES(`INIT_CALL_CNT`),
		RPT_TABLE_NAME.`END_CALL_CNT`=RPT_TABLE_NAME.`END_CALL_CNT`+VALUES(`END_CALL_CNT`),
		RPT_TABLE_NAME.`VOICE_CNT`=RPT_TABLE_NAME.`VOICE_CNT`+VALUES(`VOICE_CNT`),
		RPT_TABLE_NAME.`SIGNAL_CNT`=RPT_TABLE_NAME.`SIGNAL_CNT`+VALUES(`SIGNAL_CNT`),
		RPT_TABLE_NAME.`SMS_CNT`=RPT_TABLE_NAME.`SMS_CNT`+VALUES(`SMS_CNT`),
		RPT_TABLE_NAME.`GPRS_CNT`=RPT_TABLE_NAME.`GPRS_CNT`+VALUES(`GPRS_CNT`),
		RPT_TABLE_NAME.`OTHER_CNT`=RPT_TABLE_NAME.`OTHER_CNT`+VALUES(`OTHER_CNT`),
		RPT_TABLE_NAME.`END_VOICE_CNT`=RPT_TABLE_NAME.`END_VOICE_CNT`+VALUES(`END_VOICE_CNT`),
		RPT_TABLE_NAME.`END_SIGNAL_CNT`=RPT_TABLE_NAME.`END_SIGNAL_CNT`+VALUES(`END_SIGNAL_CNT`),
		RPT_TABLE_NAME.`END_SMS_CNT`=RPT_TABLE_NAME.`END_SMS_CNT`+VALUES(`END_SMS_CNT`),
		RPT_TABLE_NAME.`END_GPRS_CNT`=RPT_TABLE_NAME.`END_GPRS_CNT`+VALUES(`END_GPRS_CNT`),
		RPT_TABLE_NAME.`END_OTHER_CNT`=RPT_TABLE_NAME.`END_OTHER_CNT`+VALUES(`END_OTHER_CNT`),
		RPT_TABLE_NAME.`BLOCK_VOICE_CNT`=RPT_TABLE_NAME.`BLOCK_VOICE_CNT`+VALUES(`BLOCK_VOICE_CNT`),
		RPT_TABLE_NAME.`BLOCK_GPRS_CNT`=RPT_TABLE_NAME.`BLOCK_GPRS_CNT`+VALUES(`BLOCK_GPRS_CNT`),
		RPT_TABLE_NAME.`BLOCK_SMS_CNT`=RPT_TABLE_NAME.`BLOCK_SMS_CNT`+VALUES(`BLOCK_SMS_CNT`),
		RPT_TABLE_NAME.`BLOCK_SIGNAL_CNT`=RPT_TABLE_NAME.`BLOCK_SIGNAL_CNT`+VALUES(`BLOCK_SIGNAL_CNT`),
		RPT_TABLE_NAME.`BLOCK_OTHER_CNT`=RPT_TABLE_NAME.`BLOCK_OTHER_CNT`+VALUES(`BLOCK_OTHER_CNT`),
		RPT_TABLE_NAME.`DROP_VOICE_CNT`=RPT_TABLE_NAME.`DROP_VOICE_CNT`+VALUES(`DROP_VOICE_CNT`),
		RPT_TABLE_NAME.`DROP_SIGNAL_CNT`=RPT_TABLE_NAME.`DROP_SIGNAL_CNT`+VALUES(`DROP_SIGNAL_CNT`),
		RPT_TABLE_NAME.`DROP_SMS_CNT`=RPT_TABLE_NAME.`DROP_SMS_CNT`+VALUES(`DROP_SMS_CNT`),
		RPT_TABLE_NAME.`DROP_GPRS_CNT`=RPT_TABLE_NAME.`DROP_GPRS_CNT`+VALUES(`DROP_GPRS_CNT`),
		RPT_TABLE_NAME.`DROP_OTHER_CNT`=RPT_TABLE_NAME.`DROP_OTHER_CNT`+VALUES(`DROP_OTHER_CNT`),
		RPT_TABLE_NAME.`NON_BLOCK_VOICE_CNT`=RPT_TABLE_NAME.`NON_BLOCK_VOICE_CNT`+VALUES(`NON_BLOCK_VOICE_CNT`),
		RPT_TABLE_NAME.`NON_BLOCK_SIGNAL_CNT`=RPT_TABLE_NAME.`NON_BLOCK_SIGNAL_CNT`+VALUES(`NON_BLOCK_SIGNAL_CNT`),
		RPT_TABLE_NAME.`NON_BLOCK_SMS_CNT`=RPT_TABLE_NAME.`NON_BLOCK_SMS_CNT`+VALUES(`NON_BLOCK_SMS_CNT`),
		RPT_TABLE_NAME.`NON_BLOCK_GPRS_CNT`=RPT_TABLE_NAME.`NON_BLOCK_GPRS_CNT`+VALUES(`NON_BLOCK_GPRS_CNT`),
		RPT_TABLE_NAME.`NON_BLOCK_OTHER_CNT`=RPT_TABLE_NAME.`NON_BLOCK_OTHER_CNT`+VALUES(`NON_BLOCK_OTHER_CNT`),
		RPT_TABLE_NAME.`RXLEV_SUM`=RPT_TABLE_NAME.`RXLEV_SUM`+VALUES(`RXLEV_SUM`),
		RPT_TABLE_NAME.`RXLEV_CNT`=RPT_TABLE_NAME.`RXLEV_CNT`+VALUES(`RXLEV_CNT`),
		RPT_TABLE_NAME.`RXQUAL_SUM`=RPT_TABLE_NAME.`RXQUAL_SUM`+VALUES(`RXQUAL_SUM`),
		RPT_TABLE_NAME.`RXQUAL_CNT`=RPT_TABLE_NAME.`RXQUAL_CNT`+VALUES(`RXQUAL_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SUM`+VALUES(`CALL_SETUP_TIME_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_CNT`+VALUES(`CALL_SETUP_TIME_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_VOICE_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_VOICE_SUM`+VALUES(`CALL_SETUP_TIME_VOICE_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_VOICE_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_VOICE_CNT`+VALUES(`CALL_SETUP_TIME_VOICE_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_SUM`+VALUES(`CALL_SETUP_TIME_SIG_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SIG_CNT`+VALUES(`CALL_SETUP_TIME_SIG_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_SUM`+VALUES(`CALL_SETUP_TIME_SMS_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_SMS_CNT`+VALUES(`CALL_SETUP_TIME_SMS_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_GPRS_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_GPRS_SUM`+VALUES(`CALL_SETUP_TIME_GPRS_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_GPRS_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_GPRS_CNT`+VALUES(`CALL_SETUP_TIME_GPRS_CNT`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_OTH_SUM`=RPT_TABLE_NAME.`CALL_SETUP_TIME_OTH_SUM`+VALUES(`CALL_SETUP_TIME_OTH_SUM`),
		RPT_TABLE_NAME.`CALL_SETUP_TIME_OTH_CNT`=RPT_TABLE_NAME.`CALL_SETUP_TIME_OTH_CNT`+VALUES(`CALL_SETUP_TIME_OTH_CNT`),
		RPT_TABLE_NAME.`SF_VOICE_CNT`=RPT_TABLE_NAME.`SF_VOICE_CNT`+VALUES(`SF_VOICE_CNT`),
		RPT_TABLE_NAME.`SF_DATA_CNT`=RPT_TABLE_NAME.`SF_DATA_CNT`+VALUES(`SF_DATA_CNT`),
		RPT_TABLE_NAME.`SF_SMS_CNT`=RPT_TABLE_NAME.`SF_SMS_CNT`+VALUES(`SF_SMS_CNT`),
		RPT_TABLE_NAME.`SF_SIGNAL_CNT`=RPT_TABLE_NAME.`SF_SIGNAL_CNT`+VALUES(`SF_SIGNAL_CNT`),
		RPT_TABLE_NAME.`SF_OTHER_CNT`=RPT_TABLE_NAME.`SF_OTHER_CNT`+VALUES(`SF_OTHER_CNT`),
		RPT_TABLE_NAME.`CALL_DUR_SUM`=RPT_TABLE_NAME.`CALL_DUR_SUM`+VALUES(`CALL_DUR_SUM`),
		RPT_TABLE_NAME.`VOICE_DUR_SUM`=RPT_TABLE_NAME.`VOICE_DUR_SUM`+VALUES(`VOICE_DUR_SUM`),
		RPT_TABLE_NAME.`DATA_DUR_SUM`=RPT_TABLE_NAME.`DATA_DUR_SUM`+VALUES(`DATA_DUR_SUM`)';
		
	DECLARE CELL_PM_LTE_COLUMN_STR VARCHAR(5000) DEFAULT 
		'`RRC_CONN_SETUP_ATTEMPT`,
		`RRC_CONN_SETUP_REJECT`,
		`RRC_CONN_SETUP_MISSING_COMPLETE`,
		`ERAB_SETUP_ATTEMPT`,
		`ERAB_SETUP_REJECT`,
		`ERAB_SETUP_ACCS_DELAY`,
		`UE_CNXT_DROP_SETUP`,
		`UE_CNXT_DROP_DROP`,
		`RRC_RE_ESTABLISHMENT_ATTEMPT`,
		`RRC_RE_ESTABLISHMENT_FAILURE`,
		`MIMO_USAGE_RATIO_NUM`,
		`MIMO_USAGE_RATIO_DEN`,
		`SUBSC_PET_CELL_PER_HR`,
		`CALL_DURATION_SUM`,
		`CALL_DURATION_CNT`,
		`COVMO_DATA_AVAILABILITY`,
		`4G_4G_HO_ATTEMPT`,
		`4G_4G_HO_FAILURE`,
		`RRC_RECONFIGURATION_ATTEMPT`,
		`RRC_RECONFIGURATION_FAILURE`,
		`CSFB_EXECUTIONS`,
		`UE_CNXT_REL_TOT`,
		`IRAT_PING_PONG`,
		`IRAT_RSRP`,
		`IRAT_RSRQ`,
		`IRAT_TA`,
		`IRAT_RSCP`,
		`IRAT_ECN0`,
		`IRAT_RSSI`,
		`IRAT_CNT`,
		`4G_3G_HO_ATTEMPT`,
		`4G_3G_HO_FAILURE`,
		`4G_2G_HO_ATTEMPT`,
		`4G_2G_HO_FAILURE`,
		`BLIND_REDIR_4G_3G`,
		`BLIND_REDIR_4G_2G`,
		`4G_3G_CSFB_HO_ATT`,
		`4G_3G_CSFB_HO_SUCC`,
		`4G_3G_CSFB_HO_FAILURE`,
		`VOLTE_ATTEMPT`,
		`VOLTE_SUCCESS`,
		`VOLTE_FAILURE`,
		`PROCEDURE_TIME_SUM`,
		`PROCEDURE_TIME_CNT`,
		`ACCESSIBILITY_TIME_SUM`,
		`ACCESSIBILITY_TIME_CNT`,
		`IRAT_RSRP_CNT`,
		`IRAT_RSRQ_CNT`,
		`IRAT_TA_CNT`,
		`IRAT_RSCP_CNT`,
		`PEAK_SUBSCRIBER`,
		`PEAK_QUARTER`,
		`VOLTE_DROP`,
		`VOLTE_END`,
		`DL_VOLUME_SUM`,
		`UL_VOLUME_SUM`,
		`DL_THROUGHPUT_SUM`,
		`DL_THROUGHPUT_CNT`,
		`UL_THROUGHPUT_SUM`,
		`UL_THROUGHPUT_CNT`,
		`DL_THROUGHPUT_MAX`,
		`UL_THROUGHPUT_MAX`,
		`DL_TRAFFIC_DUR`,
		`UL_TRAFFIC_DUR`';
		  
	DECLARE CELL_PM_LTE_COLUMN_IFNULL_STR VARCHAR(5000) DEFAULT 
		'IFNULL(RRC_CONN_SETUP_ATTEMPT,0) AS RRC_CONN_SETUP_ATTEMPT,
		IFNULL(RRC_CONN_SETUP_REJECT,0) AS RRC_CONN_SETUP_REJECT,
		IFNULL(RRC_CONN_SETUP_MISSING_COMPLETE,0) AS RRC_CONN_SETUP_MISSING_COMPLETE,
		IFNULL(ERAB_SETUP_ATTEMPT,0) AS ERAB_SETUP_ATTEMPT,
		IFNULL(ERAB_SETUP_REJECT,0) AS ERAB_SETUP_REJECT,
		IFNULL(ERAB_SETUP_ACCS_DELAY,0) AS ERAB_SETUP_ACCS_DELAY,
		IFNULL(UE_CNXT_DROP_SETUP,0) AS UE_CNXT_DROP_SETUP,
		IFNULL(UE_CNXT_DROP_DROP,0) AS UE_CNXT_DROP_DROP,
		IFNULL(RRC_RE_ESTABLISHMENT_ATTEMPT,0) AS RRC_RE_ESTABLISHMENT_ATTEMPT,
		IFNULL(RRC_RE_ESTABLISHMENT_FAILURE,0) AS RRC_RE_ESTABLISHMENT_FAILURE,
		IFNULL(MIMO_USAGE_RATIO_NUM,0) AS MIMO_USAGE_RATIO_NUM,
		IFNULL(MIMO_USAGE_RATIO_DEN,0) AS MIMO_USAGE_RATIO_DEN,
		IFNULL(SUBSC_PET_CELL_PER_HR,0) AS SUBSC_PET_CELL_PER_HR,
		IFNULL(CALL_DURATION_SUM,0) AS CALL_DURATION_SUM,
		IFNULL(CALL_DURATION_CNT,0) AS CALL_DURATION_CNT,
		IFNULL(4G_4G_HO_ATTEMPT,0) AS 4G_4G_HO_ATTEMPT,
		IFNULL(4G_4G_HO_FAILURE,0) AS 4G_4G_HO_FAILURE,
		IFNULL(RRC_RECONFIGURATION_ATTEMPT,0) AS RRC_RECONFIGURATION_ATTEMPT,
		IFNULL(RRC_RECONFIGURATION_FAILURE,0) AS RRC_RECONFIGURATION_FAILURE,
		IFNULL(CSFB_EXECUTIONS,0) AS CSFB_EXECUTIONS,
		IFNULL(UE_CNXT_REL_TOT,0) AS UE_CNXT_REL_TOT,
		IFNULL(IRAT_PING_PONG,0) AS IRAT_PING_PONG,
		IFNULL(IRAT_RSRP,0) AS IRAT_RSRP,
		IFNULL(IRAT_RSRQ,0) AS IRAT_RSRQ,
		IFNULL(IRAT_TA,0) AS IRAT_TA,
		IFNULL(IRAT_RSCP,0) AS IRAT_RSCP,
		IFNULL(IRAT_ECN0,0) AS IRAT_ECN0,
		IFNULL(IRAT_RSSI,0) AS IRAT_RSSI,
		IFNULL(4G_3G_HO_ATTEMPT,0) AS 
		IFNULL(4G_3G_HO_FAILURE,0) AS 4G_3G_HO_FAILURE,
		IFNULL(4G_2G_HO_ATTEMPT,0) AS 4G_2G_HO_ATTEMPT,
		IFNULL(4G_2G_HO_FAILURE,0) AS 4G_2G_HO_FAILURE,
		IFNULL(BLIND_REDIR_4G_3G,0) AS BLIND_REDIR_4G_3G,
		IFNULL(BLIND_REDIR_4G_2G,0) AS BLIND_REDIR_4G_2G,
		IFNULL(4G_3G_CSFB_HO_ATT,0) AS 4G_3G_CSFB_HO_ATT,
		IFNULL(4G_3G_CSFB_HO_SUCC,0) AS 4G_3G_CSFB_HO_SUCC,
		IFNULL(4G_3G_CSFB_HO_FAILURE,0) AS 4G_3G_CSFB_HO_FAILURE,
		IFNULL(VOLTE_ATTEMPT,0) AS VOLTE_ATTEMPT,
		IFNULL(VOLTE_SUCCESS,0) AS VOLTE_SUCCESS,
		IFNULL(VOLTE_FAILURE,0) AS VOLTE_FAILURE,
		IFNULL(PROCEDURE_TIME_SUM,0) AS PROCEDURE_TIME_SUM,
		IFNULL(PROCEDURE_TIME_CNT,0) AS PROCEDURE_TIME_CNT,
		IFNULL(ACCESSIBILITY_TIME_SUM,0) AS ACCESSIBILITY_TIME_SUM,
		IFNULL(ACCESSIBILITY_TIME_CNT,0) AS ACCESSIBILITY_TIME_CNT,
		IFNULL(IRAT_RSRP_CNT,0) AS IRAT_RSRP_CNT,
		IFNULL(IRAT_RSRQ_CNT,0) AS IRAT_RSRQ_CNT,
		IFNULL(IRAT_TA_CNT,0) AS IRAT_TA_CNT,
		IFNULL(IRAT_RSCP_CNT,0) AS IRAT_RSCP_CNT,
		IFNULL(IRAT_ECN0_CNT,0) AS IRAT_ECN0_CNT,
		IFNULL(IRAT_RSSI_CNT,0) AS IRAT_RSSI_CNT,
		IFNULL(PEAK_SUBSCRIBER,0) AS PEAK_SUBSCRIBER,
		IFNULL(PEAK_QUARTER,0) AS PEAK_QUARTER,
		IFNULL(VOLTE_DROP,0) AS VOLTE_DROP,
		IFNULL(VOLTE_END,0) AS VOLTE_END,
		IFNULL(DL_VOLUME_SUM,0) AS DL_VOLUME_SUM,
		IFNULL(UL_VOLUME_SUM,0) AS UL_VOLUME_SUM,
		IFNULL(DL_THROUGHPUT_SUM,0) AS DL_THROUGHPUT_SUM,
		IFNULL(DL_THROUGHPUT_CNT,0) AS DL_THROUGHPUT_CNT,
		IFNULL(UL_THROUGHPUT_SUM,0) AS UL_THROUGHPUT_SUM,
		IFNULL(UL_THROUGHPUT_CNT,0) AS UL_THROUGHPUT_CNT,
		IFNULL(DL_THROUGHPUT_MAX,0) AS DL_THROUGHPUT_MAX,
		IFNULL(UL_THROUGHPUT_MAX,0) AS UL_THROUGHPUT_MAX,
		IFNULL(DL_TRAFFIC_DUR,0) AS DL_TRAFFIC_DUR,
		IFNULL(UL_TRAFFIC_DUR,0) AS UL_TRAFFIC_DUR';
		
	DECLARE CELL_PM_LTE_COLUMN_SUM_STR VARCHAR(5000) DEFAULT 
		'SUM(RRC_CONN_SETUP_ATTEMPT) AS RRC_CONN_SETUP_ATTEMPT,
		SUM(RRC_CONN_SETUP_REJECT) AS RRC_CONN_SETUP_REJECT,
		SUM(RRC_CONN_SETUP_MISSING_COMPLETE) AS RRC_CONN_SETUP_MISSING_COMPLETE,
		SUM(ERAB_SETUP_ATTEMPT) AS ERAB_SETUP_ATTEMPT,
		SUM(ERAB_SETUP_REJECT) AS ERAB_SETUP_REJECT,
		SUM(ERAB_SETUP_ACCS_DELAY) AS ERAB_SETUP_ACCS_DELAY,
		SUM(UE_CNXT_DROP_SETUP) AS UE_CNXT_DROP_SETUP,
		SUM(UE_CNXT_DROP_DROP) AS UE_CNXT_DROP_DROP,
		SUM(RRC_RE_ESTABLISHMENT_ATTEMPT) AS RRC_RE_ESTABLISHMENT_ATTEMPT,
		SUM(RRC_RE_ESTABLISHMENT_FAILURE) AS RRC_RE_ESTABLISHMENT_FAILURE,
		SUM(MIMO_USAGE_RATIO_NUM) AS MIMO_USAGE_RATIO_NUM,
		SUM(MIMO_USAGE_RATIO_DEN) AS MIMO_USAGE_RATIO_DEN,
		SUM(SUBSC_PET_CELL_PER_HR) AS SUBSC_PET_CELL_PER_HR,
		SUM(CALL_DURATION_SUM) AS CALL_DURATION_SUM,
		SUM(CALL_DURATION_CNT) AS CALL_DURATION_CNT,
		SUM(4G_4G_HO_ATTEMPT) AS 4G_4G_HO_ATTEMPT,
		SUM(4G_4G_HO_FAILURE) AS 4G_4G_HO_FAILURE,
		SUM(RRC_RECONFIGURATION_ATTEMPT) AS RRC_RECONFIGURATION_ATTEMPT,
		SUM(RRC_RECONFIGURATION_FAILURE) AS RRC_RECONFIGURATION_FAILURE,
		SUM(CSFB_EXECUTIONS) AS CSFB_EXECUTIONS,
		SUM(UE_CNXT_REL_TOT) AS UE_CNXT_REL_TOT,
		SUM(IRAT_PING_PONG) AS IRAT_PING_PONG,
		SUM(IRAT_RSRP) AS IRAT_RSRP,
		SUM(IRAT_RSRQ) AS IRAT_RSRQ,
		SUM(IRAT_TA) AS IRAT_TA,
		SUM(IRAT_RSCP) AS IRAT_RSCP,
		SUM(IRAT_ECN0) AS IRAT_ECN0,
		SUM(IRAT_RSSI) AS IRAT_RSSI,
		SUM(4G_3G_HO_ATTEMPT) AS 4G_3G_HO_ATTEMPT,
		SUM(4G_3G_HO_FAILURE) AS 4G_3G_HO_FAILURE,
		SUM(4G_2G_HO_ATTEMPT) AS 4G_2G_HO_ATTEMPT,
		SUM(4G_2G_HO_FAILURE) AS 4G_2G_HO_FAILURE,
		SUM(BLIND_REDIR_4G_3G) AS BLIND_REDIR_4G_3G,
		SUM(BLIND_REDIR_4G_2G) AS BLIND_REDIR_4G_2G,
		SUM(4G_3G_CSFB_HO_ATT) AS 4G_3G_CSFB_HO_ATT,
		SUM(4G_3G_CSFB_HO_SUCC) AS 4G_3G_CSFB_HO_SUCC,
		SUM(4G_3G_CSFB_HO_FAILURE) AS 4G_3G_CSFB_HO_FAILURE,
		SUM(VOLTE_ATTEMPT) AS VOLTE_ATTEMPT,
		SUM(VOLTE_SUCCESS) AS VOLTE_SUCCESS,
		SUM(VOLTE_FAILURE) AS VOLTE_FAILURE,
		SUM(PROCEDURE_TIME_SUM) AS PROCEDURE_TIME_SUM,
		SUM(PROCEDURE_TIME_CNT) AS PROCEDURE_TIME_CNT,
		SUM(ACCESSIBILITY_TIME_SUM) AS ACCESSIBILITY_TIME_SUM,
		SUM(ACCESSIBILITY_TIME_CNT) AS ACCESSIBILITY_TIME_CNT,
		SUM(IRAT_RSRP_CNT) AS IRAT_RSRP_CNT,
		SUM(IRAT_RSRQ_CNT) AS IRAT_RSRQ_CNT,
		SUM(IRAT_TA_CNT) AS IRAT_TA_CNT,
		SUM(IRAT_RSCP_CNT) AS IRAT_RSCP_CNT,
		SUM(IRAT_ECN0_CNT) AS IRAT_ECN0_CNT,
		SUM(IRAT_RSSI_CNT) AS IRAT_RSSI_CNT,
		SUM(PEAK_SUBSCRIBER) AS PEAK_SUBSCRIBER,
		SUM(PEAK_QUARTER) AS PEAK_QUARTER,
		SUM(VOLTE_DROP) AS VOLTE_DROP,
		SUM(VOLTE_END) AS VOLTE_END,
		SUM(DL_VOLUME_SUM) AS DL_VOLUME_SUM,
		SUM(UL_VOLUME_SUM) AS UL_VOLUME_SUM,
		SUM(DL_THROUGHPUT_SUM) AS DL_THROUGHPUT_SUM,
		SUM(DL_THROUGHPUT_CNT) AS DL_THROUGHPUT_CNT,
		SUM(UL_THROUGHPUT_SUM) AS UL_THROUGHPUT_SUM,
		SUM(UL_THROUGHPUT_CNT) AS UL_THROUGHPUT_CNT,
		SUM(DL_THROUGHPUT_MAX) AS DL_THROUGHPUT_MAX,
		SUM(UL_THROUGHPUT_MAX) AS UL_THROUGHPUT_MAX,
		SUM(DL_TRAFFIC_DUR) AS DL_TRAFFIC_DUR,
		SUM(UL_TRAFFIC_DUR) AS UL_TRAFFIC_DUR';

	DECLARE CELL_PM_LTE_COLUMN_UPD_STR VARCHAR(12000) DEFAULT 
		'RPT_TABLE_NAME.RRC_CONN_SETUP_ATTEMPT=RPT_TABLE_NAME.RRC_CONN_SETUP_ATTEMPT+VALUES(RRC_CONN_SETUP_ATTEMPT),
		RPT_TABLE_NAME.RRC_CONN_SETUP_REJECT=RPT_TABLE_NAME.RRC_CONN_SETUP_REJECT+VALUES(RRC_CONN_SETUP_REJECT),
		RPT_TABLE_NAME.RRC_CONN_SETUP_MISSING_COMPLETE=RPT_TABLE_NAME.RRC_CONN_SETUP_MISSING_COMPLETE+VALUES(RRC_CONN_SETUP_MISSING_COMPLETE),
		RPT_TABLE_NAME.ERAB_SETUP_ATTEMPT=RPT_TABLE_NAME.ERAB_SETUP_ATTEMPT+VALUES(ERAB_SETUP_ATTEMPT),
		RPT_TABLE_NAME.ERAB_SETUP_REJECT=RPT_TABLE_NAME.ERAB_SETUP_REJECT+VALUES(ERAB_SETUP_REJECT),
		RPT_TABLE_NAME.ERAB_SETUP_ACCS_DELAY=RPT_TABLE_NAME.ERAB_SETUP_ACCS_DELAY+VALUES(ERAB_SETUP_ACCS_DELAY),
		RPT_TABLE_NAME.UE_CNXT_DROP_SETUP=RPT_TABLE_NAME.UE_CNXT_DROP_SETUP+VALUES(UE_CNXT_DROP_SETUP),
		RPT_TABLE_NAME.UE_CNXT_DROP_DROP=RPT_TABLE_NAME.UE_CNXT_DROP_DROP+VALUES(UE_CNXT_DROP_DROP),
		RPT_TABLE_NAME.RRC_RE_ESTABLISHMENT_ATTEMPT=RPT_TABLE_NAME.RRC_RE_ESTABLISHMENT_ATTEMPT+VALUES(RRC_RE_ESTABLISHMENT_ATTEMPT),
		RPT_TABLE_NAME.RRC_RE_ESTABLISHMENT_FAILURE=RPT_TABLE_NAME.RRC_RE_ESTABLISHMENT_FAILURE+VALUES(RRC_RE_ESTABLISHMENT_FAILURE),
		RPT_TABLE_NAME.MIMO_USAGE_RATIO_NUM=RPT_TABLE_NAME.MIMO_USAGE_RATIO_NUM+VALUES(MIMO_USAGE_RATIO_NUM),
		RPT_TABLE_NAME.MIMO_USAGE_RATIO_DEN=RPT_TABLE_NAME.MIMO_USAGE_RATIO_DEN+VALUES(MIMO_USAGE_RATIO_DEN),
		RPT_TABLE_NAME.SUBSC_PET_CELL_PER_HR=RPT_TABLE_NAME.SUBSC_PET_CELL_PER_HR+VALUES(SUBSC_PET_CELL_PER_HR),
		RPT_TABLE_NAME.CALL_DURATION_SUM=RPT_TABLE_NAME.CALL_DURATION_SUM+VALUES(CALL_DURATION_SUM),
		RPT_TABLE_NAME.CALL_DURATION_CNT=RPT_TABLE_NAME.CALL_DURATION_CNT+VALUES(CALL_DURATION_CNT),
		RPT_TABLE_NAME.4G_4G_HO_ATTEMPT=RPT_TABLE_NAME.4G_4G_HO_ATTEMPT+VALUES(4G_4G_HO_ATTEMPT),
		RPT_TABLE_NAME.4G_4G_HO_FAILURE=RPT_TABLE_NAME.4G_4G_HO_FAILURE+VALUES(4G_4G_HO_FAILURE),
		RPT_TABLE_NAME.RRC_RECONFIGURATION_ATTEMPT=RPT_TABLE_NAME.RRC_RECONFIGURATION_ATTEMPT+VALUES(RRC_RECONFIGURATION_ATTEMPT),
		RPT_TABLE_NAME.RRC_RECONFIGURATION_FAILURE=RPT_TABLE_NAME.RRC_RECONFIGURATION_FAILURE+VALUES(RRC_RECONFIGURATION_FAILURE),
		RPT_TABLE_NAME.CSFB_EXECUTIONS=RPT_TABLE_NAME.CSFB_EXECUTIONS+VALUES(CSFB_EXECUTIONS),
		RPT_TABLE_NAME.UE_CNXT_REL_TOT=RPT_TABLE_NAME.UE_CNXT_REL_TOT+VALUES(UE_CNXT_REL_TOT),
		RPT_TABLE_NAME.IRAT_PING_PONG=RPT_TABLE_NAME.IRAT_PING_PONG+VALUES(IRAT_PING_PONG),
		RPT_TABLE_NAME.IRAT_RSRP=RPT_TABLE_NAME.IRAT_RSRP+VALUES(IRAT_RSRP),
		RPT_TABLE_NAME.IRAT_RSRQ=RPT_TABLE_NAME.IRAT_RSRQ+VALUES(IRAT_RSRQ),
		RPT_TABLE_NAME.IRAT_TA=RPT_TABLE_NAME.IRAT_TA+VALUES(IRAT_TA),
		RPT_TABLE_NAME.IRAT_RSCP=RPT_TABLE_NAME.IRAT_RSCP+VALUES(IRAT_RSCP),
		RPT_TABLE_NAME.IRAT_ECN0=RPT_TABLE_NAME.IRAT_ECN0+VALUES(IRAT_ECN0),
		RPT_TABLE_NAME.IRAT_RSSI=RPT_TABLE_NAME.IRAT_RSSI+VALUES(IRAT_RSSI),
		RPT_TABLE_NAME.4G_3G_HO_ATTEMPT=RPT_TABLE_NAME.4G_3G_HO_ATTEMPT+VALUES(	4G_3G_HO_ATTEMPT),
		RPT_TABLE_NAME.4G_3G_HO_FAILURE=RPT_TABLE_NAME.4G_3G_HO_FAILURE+VALUES(4G_3G_HO_FAILURE),
		RPT_TABLE_NAME.4G_2G_HO_ATTEMPT=RPT_TABLE_NAME.4G_2G_HO_ATTEMPT+VALUES(4G_2G_HO_ATTEMPT),
		RPT_TABLE_NAME.4G_2G_HO_FAILURE=RPT_TABLE_NAME.4G_2G_HO_FAILURE+VALUES(4G_2G_HO_FAILURE),
		RPT_TABLE_NAME.BLIND_REDIR_4G_3G=RPT_TABLE_NAME.BLIND_REDIR_4G_3G+VALUES(BLIND_REDIR_4G_3G),
		RPT_TABLE_NAME.BLIND_REDIR_4G_2G=RPT_TABLE_NAME.BLIND_REDIR_4G_2G+VALUES(BLIND_REDIR_4G_2G),
		RPT_TABLE_NAME.4G_3G_CSFB_HO_ATT=RPT_TABLE_NAME.4G_3G_CSFB_HO_ATT+VALUES(4G_3G_CSFB_HO_ATT),
		RPT_TABLE_NAME.4G_3G_CSFB_HO_SUCC=RPT_TABLE_NAME.4G_3G_CSFB_HO_SUCC+VALUES(4G_3G_CSFB_HO_SUCC),
		RPT_TABLE_NAME.4G_3G_CSFB_HO_FAILURE=RPT_TABLE_NAME.4G_3G_CSFB_HO_FAILURE+VALUES(4G_3G_CSFB_HO_FAILURE),
		RPT_TABLE_NAME.VOLTE_ATTEMPT=RPT_TABLE_NAME.VOLTE_ATTEMPT+VALUES(VOLTE_ATTEMPT),
		RPT_TABLE_NAME.VOLTE_SUCCESS=RPT_TABLE_NAME.VOLTE_SUCCESS+VALUES(VOLTE_SUCCESS),
		RPT_TABLE_NAME.VOLTE_FAILURE=RPT_TABLE_NAME.VOLTE_FAILURE+VALUES(VOLTE_FAILURE),
		RPT_TABLE_NAME.PROCEDURE_TIME_SUM=RPT_TABLE_NAME.PROCEDURE_TIME_SUM+VALUES(PROCEDURE_TIME_SUM),
		RPT_TABLE_NAME.PROCEDURE_TIME_CNT=RPT_TABLE_NAME.PROCEDURE_TIME_CNT+VALUES(PROCEDURE_TIME_CNT),
		RPT_TABLE_NAME.ACCESSIBILITY_TIME_SUM=RPT_TABLE_NAME.ACCESSIBILITY_TIME_SUM+VALUES(ACCESSIBILITY_TIME_SUM),
		RPT_TABLE_NAME.ACCESSIBILITY_TIME_CNT=RPT_TABLE_NAME.ACCESSIBILITY_TIME_CNT+VALUES(ACCESSIBILITY_TIME_CNT),
		RPT_TABLE_NAME.IRAT_RSRP_CNT=RPT_TABLE_NAME.IRAT_RSRP_CNT+VALUES(IRAT_RSRP_CNT),
		RPT_TABLE_NAME.IRAT_RSRQ_CNT=RPT_TABLE_NAME.IRAT_RSRQ_CNT+VALUES(IRAT_RSRQ_CNT),
		RPT_TABLE_NAME.IRAT_TA_CNT=RPT_TABLE_NAME.IRAT_TA_CNT+VALUES(IRAT_TA_CNT),
		RPT_TABLE_NAME.IRAT_RSCP_CNT=RPT_TABLE_NAME.IRAT_RSCP_CNT+VALUES(IRAT_RSCP_CNT),
		RPT_TABLE_NAME.IRAT_ECN0_CNT=RPT_TABLE_NAME.IRAT_ECN0_CNT+VALUES(IRAT_ECN0_CNT),
		RPT_TABLE_NAME.IRAT_RSSI_CNT=RPT_TABLE_NAME.IRAT_RSSI_CNT+VALUES(IRAT_RSSI_CNT)';
	
	DECLARE CONTINUE HANDLER FOR SQLEXCEPTION
	BEGIN
		SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS `gt_global_statistic`.`nw_error_log`
				(
				  `TABLE_NAME` VARCHAR(50) NOT NULL,
				  `SP_NAME` VARCHAR(50) DEFAULT NULL,
				  `INSERT_CMD` VARCHAR(100) DEFAULT NULL,
				  `INSERT_TIME` DATETIME DEFAULT NULL
				) ENGINE=MYISAM;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		INSERT INTO `gt_global_statistic`.`nw_error_log`(`TABLE_NAME`,`SP_NAME`,`INSERT_CMD`,`INSERT_TIME`)
		VALUES (@SOURCE_TABLE_NAME,
			'SP_Generate_Global_Statistic_Sub_cell_Aggr',
			CONCAT('Step ',@ERROR_FLAG,' error'),
			NOW());
	
		SET @SqlCmd=CONCAT('REPAIR TABLE ',@REPAIR_TABLE_NAME,';');				
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
	
		SET @SqlCmd=CONCAT('SELECT  GROUP_CONCAT(DISTINCT CONCAT(TABLE_NAME)) INTO @DROP_TABLE_LIST
					FROM information_schema.TABLES 
					WHERE TABLE_SCHEMA=''gt_aggregate_db''
					AND table_name<>''tmp_dim_handset''
					AND TABLE_NAME <> ''',@tmp_share_cell_agg_gsm_hr,'''
					AND TABLE_NAME <> ''',@tmp_share_cell_agg_umts_hr,'''
					AND TABLE_NAME <> ''',@tmp_share_cell_agg_lte_hr,'''
					AND TABLE_NAME <> ''',@tmp_share_cell_lte_hr,''';;');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		
		SET @v_i=1;
		SET @Quotient_v=1;
		SET @v_R_Max=(CHAR_LENGTH(@DROP_TABLE_LIST) - CHAR_LENGTH(REPLACE(@DROP_TABLE_LIST,',','')))/(CHAR_LENGTH(','))+1;	
		WHILE @v_i <= @v_R_Max DO
		BEGIN
			SET @DROP_TABLE=gt_strtok(@DROP_TABLE_LIST,@v_i,',');
			
			SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS gt_aggregate_db.',@DROP_TABLE_LIST,' ;');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
	
		SET @v_i=@v_i+@Quotient_v;	
		END;
		END WHILE;
		
	END;	
		
  	-- CALL gt_gw_main.`SP_Sub_Set_Session_Param_LTE`('');
  	
	SET @global_db='gt_global_statistic';
			
	SET @FLAG_CELL_AGG_UMTS_HR=0;
	SET @FLAG_CELL_AGG_UMTS_DY=0;
	SET @FLAG_CELL_AGG_UMTS_WK=0;
	SET @FLAG_CELL_AGG_UMTS_MN=0;
	SET @FLAG_CELL_AGG_LTE_HR=0;
	SET @FLAG_CELL_AGG_LTE_DY=0;
	SET @FLAG_CELL_AGG_LTE_WK=0;
	SET @FLAG_CELL_AGG_LTE_MN=0;	
	SET @FLAG_CELL_AGG_GSM_HR=0;
	SET @FLAG_CELL_AGG_GSM_DY=0;
	SET @FLAG_CELL_AGG_GSM_WK=0;
	SET @FLAG_CELL_AGG_GSM_MN=0;
	SET @FLAG_CELL_PM_LTE_HR=0;
	SET @FLAG_CELL_PM_LTE_DY=0;
	SET @FLAG_CELL_PM_LTE_WK=0;
	SET @FLAG_CELL_PM_LTE_MN=0;
	
	SET SHARE_IP ='127.0.0.1';
	SELECT `VARIABLE_VALUE` INTO SHARE_PORT FROM `information_schema`.`GLOBAL_VARIABLES` WHERE VARIABLE_NAME = 'port';
	SELECT `value` INTO SHARE_ACCOUNT FROM `gt_gw_main`.`integration_param` WHERE gt_group='system' AND gt_name='apDbUser';
	SELECT `value` INTO SHARE_PW FROM `gt_gw_main`.`integration_param` WHERE gt_group='system' AND gt_name='apDbPass';
	SET SHARE_DB='gt_aggregate_db';
	
	INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('START ', TECH_MASK,',',WORKER_ID), START_TIME);
	SET STEP_START_TIME := SYSDATE();
	IF FLAG IN (1,0) THEN 	
		SET @SqlCmd=CONCAT('SELECT GROUP_CONCAT(DISTINCT CONCAT(`DATA_DATE`,'','',`DATA_HOUR`,'','',`TECH_MASK`) SEPARATOR ''|'' ) INTO @PU_STR
					FROM ',@global_db,'.tmp_table_call_cnt_',WORKER_ID,' 
					WHERE TECH_MASK=',TECH_MASK,';');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;
		
		SET @SqlCmd=CONCAT('SELECT GROUP_CONCAT(DISTINCT `group_id` ORDER BY `group_id` SEPARATOR ''|'' ) INTO @REG_GROUP FROM ',@global_db,'.`usr_polygon_reg_3`;');
	
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;		
			
		SET @v_reg_m=1;
		SET @v_reg_Max=gt_covmo_csv_count(@REG_GROUP,'|');
		WHILE @v_reg_m <= @v_reg_Max DO
		BEGIN
			SET v_group_db_name=CONCAT('gt_global_statistic_g',gt_strtok(@REG_GROUP, @v_reg_m, '|'));
		
			SET @v_i=1;
			SET @v_R_Max=gt_covmo_csv_count(@PU_STR,'|');
			
			WHILE @v_i <= @v_R_Max DO
			BEGIN	
				SET v_DATA_DATE:=gt_covmo_csv_get(gt_strtok(@PU_STR, @v_i, '|'),1);
				SET v_DATA_HOUR:=gt_covmo_csv_get(gt_strtok(@PU_STR, @v_i, '|'),2);
				SET v_TECH_MASK:=gt_covmo_csv_get(gt_strtok(@PU_STR, @v_i, '|'),3);
				SELECT `DAY_OF_WEEK`(v_DATA_DATE) INTO @DAY_OF_WEEK;
				SET @FIRST_DAY=gt_strtok(@DAY_OF_WEEK, 1, '|');
				SET @END_DAY=gt_strtok(@DAY_OF_WEEK, 2, '|');
				SET @DATE_WK=CONCAT(DATE_FORMAT(@FIRST_DAY,'%Y%m%d'),'_',DATE_FORMAT(@END_DAY,'%Y%m%d'));
				SET @DATE_MN=DATE_FORMAT(v_DATA_DATE,'%Y%m');
				SET @DATE_DY=DATE_FORMAT(v_DATA_DATE,'%Y%m%d');
				SET @EX_DATE=CONCAT(DATE_FORMAT(v_DATA_DATE,'%Y%m%d_'),v_DATA_HOUR,'_',WORKER_ID);
	
				SET @tmp_share_cell_agg_umts_hr=CONCAT('tmp_cell_agg_umts_hr_',@EX_DATE);
				SET @tmp_share_cell_agg_lte_hr=CONCAT('tmp_cell_agg_lte_hr_',@EX_DATE);
				SET @tmp_share_cell_agg_gsm_hr=CONCAT('tmp_cell_agg_gsm_hr_',@EX_DATE);
				SET @tmp_share_cell_lte_hr=CONCAT('tmp_cell_lte_hr_',@EX_DATE);
		
				SET @tmp_cell_agg_umts_hr=CONCAT(v_group_db_name,'.tmp_cell_agg_umts_hr_',@EX_DATE);
				SET @tmp_cell_agg_lte_hr=CONCAT(v_group_db_name,'.tmp_cell_agg_lte_hr_',@EX_DATE);
				SET @tmp_cell_agg_gsm_hr=CONCAT(v_group_db_name,'.tmp_cell_agg_gsm_hr_',@EX_DATE);
				SET @tmp_cell_lte_hr=CONCAT(v_group_db_name,'.tmp_cell_lte_hr_',@EX_DATE);
				
				SET @table_cell_agg_umts_hr=CONCAT(v_group_db_name,'.table_cell_agg_umts_hr_',@DATE_DY);
				SET @table_cell_agg_umts_dy=CONCAT(v_group_db_name,'.table_cell_agg_umts_dy_',@DATE_DY);
				SET @table_cell_agg_umts_wk=CONCAT(v_group_db_name,'.table_cell_agg_umts_wk_',@DATE_WK);
				SET @table_cell_agg_umts_mn=CONCAT(v_group_db_name,'.table_cell_agg_umts_mn_',@DATE_MN);			
				
				SET @table_cell_agg_lte_hr=CONCAT(v_group_db_name,'.table_cell_agg_lte_hr_',@DATE_DY);
				SET @table_cell_agg_lte_dy=CONCAT(v_group_db_name,'.table_cell_agg_lte_dy_',@DATE_DY);
				SET @table_cell_agg_lte_wk=CONCAT(v_group_db_name,'.table_cell_agg_lte_wk_',@DATE_WK);
				SET @table_cell_agg_lte_mn=CONCAT(v_group_db_name,'.table_cell_agg_lte_mn_',@DATE_MN);
				
				SET @table_cell_agg_gsm_hr=CONCAT(v_group_db_name,'.table_cell_agg_gsm_hr_',@DATE_DY);
				SET @table_cell_agg_gsm_dy=CONCAT(v_group_db_name,'.table_cell_agg_gsm_dy_',@DATE_DY);
				SET @table_cell_agg_gsm_wk=CONCAT(v_group_db_name,'.table_cell_agg_gsm_wk_',@DATE_WK);
				SET @table_cell_agg_gsm_mn=CONCAT(v_group_db_name,'.table_cell_agg_gsm_mn_',@DATE_MN);
				
				SET @table_cell_lte_hr=CONCAT(v_group_db_name,'.table_cell_lte_hr_',@DATE_DY);
				SET @table_cell_lte_dy=CONCAT(v_group_db_name,'.table_cell_lte_dy_',@DATE_DY);
				SET @table_cell_lte_wk=CONCAT(v_group_db_name,'.table_cell_lte_wk_',@DATE_WK);
				SET @table_cell_lte_mn=CONCAT(v_group_db_name,'.table_cell_lte_mn_',@DATE_MN);
				SET @table_cell_lte_mn_all=CONCAT(v_group_db_name,'.table_cell_lte_mn_all');
				SET @table_nt_gsm=CONCAT('gt_nt_',@DATE_DY,'.`nt_cell_current_gsm`');
				SET @table_nt_umts=CONCAT('gt_nt_',@DATE_DY,'.`nt_current`');
				SET @table_nt_lte=CONCAT('gt_nt_',@DATE_DY,'.`nt_cell_current_lte`');
								
				SET @SqlCmd=CONCAT('SELECT `att_value` INTO @ZOOM_LEVEL FROM gt_covmo.`sys_config` WHERE `group_name`=''system'' AND att_name = ''MapResolution'';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt; 
				
				IF v_TECH_MASK=2 THEN 
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',@tmp_cell_agg_umts_hr,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
		
					SET @SqlCmd=CONCAT('CREATE TABLE ',@tmp_cell_agg_umts_hr,' LIKE ',@global_db,'.tmp_cell_agg_umts_',@EX_DATE,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
	
					SET @SOURCE_TABLE_NAME=@tmp_cell_agg_umts_hr;
					SET @ERROR_FLAG='10_tmp_cell_agg_umts_hr_1';
					
					SET @SqlCmd=CONCAT('INSERT INTO ',@tmp_cell_agg_umts_hr,' 
							    (`CELL_ID`,`SITE_ID`,`RNC_ID`,CLUSTER_ID,FREQUENCY,UARFCN,
							     `DATA_DATE`,
							     `DATA_HOUR`,
							     ',CELL_AGG_UMTS_COLUMN_STR,')
							SELECT
							  `CELL_ID`,`SITE_ID`,`RNC_ID`,CLUSTER_ID,FREQUENCY,UARFCN,
							  `DATA_DATE`,
							  `DATA_HOUR`,
							  ',CELL_AGG_UMTS_COLUMN_SUM_STR,'
							FROM ',@global_db,'.tmp_cell_agg_umts_',@EX_DATE,' 
							GROUP BY `CELL_ID`,`RNC_ID`,`DATA_DATE`,`DATA_HOUR`
							ORDER BY NULL
							;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
	
					SET @SqlCmd=CONCAT('ALTER TABLE ',@tmp_cell_agg_umts_hr,' ADD `CELL_NAME` varchar(50) CHARACTER SET utf8 DEFAULT NULL;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					SET @SqlCmd=CONCAT('CREATE INDEX `ix_cell` ON ',@tmp_cell_agg_umts_hr,' (`CELL_ID`,`RNC_ID`);');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					SET @SqlCmd=CONCAT('UPDATE ',@tmp_cell_agg_umts_hr,' A LEFT JOIN ',@table_nt_umts,' B
								ON A.CELL_ID=B.CELL_ID AND A.RNC_ID=B.RNC_ID
								SET A.CELL_NAME=B.CELL_NAME;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
						
					INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@tmp_cell_agg_umts_hr,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
					SET STEP_START_TIME := SYSDATE();
					
					IF FLAG IN (0,1) THEN 	
	
						SET @SOURCE_TABLE_NAME=@table_cell_agg_umts_hr;
						SET @REPAIR_TABLE_NAME=@table_cell_agg_umts_hr;
						SET @ERROR_FLAG='10_cell_agg_umts_hr_2';
		
						SET @SqlCmd=CONCAT('INSERT INTO ',@table_cell_agg_umts_hr,' 
								    (`CELL_ID`,`SITE_ID`,`RNC_ID`,CLUSTER_ID,FREQUENCY,UARFCN,
								     `DATA_DATE`,
								     `DATA_HOUR`,
								     `CELL_NAME`,
								     ',CELL_AGG_UMTS_COLUMN_STR,')
								SELECT
								  `CELL_ID`,`SITE_ID`,`RNC_ID`,CLUSTER_ID,FREQUENCY,UARFCN,
								  `DATA_DATE`,
								  `DATA_HOUR`,
								  `CELL_NAME`,
								  ',CELL_AGG_UMTS_COLUMN_IFNULL_STR,' 
								FROM ',@tmp_cell_agg_umts_hr
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(CELL_AGG_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_cell_agg_umts_hr))
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_CELL_AGG_UMTS_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_agg_umts_hr,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SOURCE_TABLE_NAME=@table_cell_agg_umts_dy;
						SET @REPAIR_TABLE_NAME=@table_cell_agg_umts_dy;
						SET @ERROR_FLAG='10_cell_agg_umts_dy_3';
						
						SET @SqlCmd=CONCAT('INSERT INTO ',@table_cell_agg_umts_dy,' 
								    (`CELL_ID`,`SITE_ID`,`RNC_ID`,CLUSTER_ID,FREQUENCY,UARFCN,
								     `DATA_DATE`,
								     `CELL_NAME`,
								     ',CELL_AGG_UMTS_COLUMN_STR,')
								SELECT
								  `CELL_ID`,`SITE_ID`,`RNC_ID`,CLUSTER_ID,FREQUENCY,UARFCN,
								  `DATA_DATE`,
								  `CELL_NAME`,
								  ',CELL_AGG_UMTS_COLUMN_IFNULL_STR,' 
								FROM ',@tmp_cell_agg_umts_hr,' 
								ON DUPLICATE KEY UPDATE 
								',REPLACE(CELL_AGG_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_cell_agg_umts_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						SET @FLAG_CELL_AGG_UMTS_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_agg_umts_dy,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
					END IF;
		
					IF FLAG = 0 THEN 
						SET @SOURCE_TABLE_NAME=@table_cell_agg_umts_wk;
						SET @REPAIR_TABLE_NAME=@table_cell_agg_umts_wk;
						SET @ERROR_FLAG='10_cell_agg_umts_wk_4';
						SET @SqlCmd=CONCAT('INSERT INTO ',@table_cell_agg_umts_wk,' 
								    (`CELL_ID`,`SITE_ID`,`RNC_ID`,CLUSTER_ID,FREQUENCY,UARFCN,
								    `CELL_NAME`,
								     ',CELL_AGG_UMTS_COLUMN_STR,')
								SELECT
								  `CELL_ID`,`SITE_ID`,`RNC_ID`,CLUSTER_ID,FREQUENCY,UARFCN,
								  `CELL_NAME`,
								  ',CELL_AGG_UMTS_COLUMN_IFNULL_STR,'  
								FROM ',@tmp_cell_agg_umts_hr,' 
								ON DUPLICATE KEY UPDATE 
								',REPLACE(CELL_AGG_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_cell_agg_umts_wk),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_CELL_AGG_UMTS_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_agg_umts_wk,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SOURCE_TABLE_NAME=@table_cell_agg_umts_mn;
						SET @REPAIR_TABLE_NAME=@table_cell_agg_umts_mn;
						SET @ERROR_FLAG='10_cell_agg_umts_mn_5';
						
						SET @SqlCmd=CONCAT('INSERT INTO ',@table_cell_agg_umts_mn,' 
								    (`CELL_ID`,`SITE_ID`,`RNC_ID`,CLUSTER_ID,FREQUENCY,UARFCN,
								    `CELL_NAME`,
								     ',CELL_AGG_UMTS_COLUMN_STR,')
								SELECT
								  `CELL_ID`,`SITE_ID`,`RNC_ID`,CLUSTER_ID,FREQUENCY,UARFCN,
								  `CELL_NAME`,
								  ',CELL_AGG_UMTS_COLUMN_IFNULL_STR,'  
								FROM ',@tmp_cell_agg_umts_hr,' 
								ON DUPLICATE KEY UPDATE 
								',REPLACE(CELL_AGG_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_cell_agg_umts_mn),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						SET @FLAG_CELL_AGG_UMTS_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_agg_umts_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
					END IF;
			
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',@tmp_cell_agg_umts_hr,';');					
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.tmp_table_call_cnt_',WORKER_ID,' A
						SET 
						  A.`FLAG_CELL_AGG_HR` = ',@FLAG_CELL_AGG_UMTS_HR,',
						  A.`FLAG_CELL_AGG_DY` = ',@FLAG_CELL_AGG_UMTS_DY,',
						  A.`FLAG_CELL_AGG_WK` = ',@FLAG_CELL_AGG_UMTS_WK,',
						  A.`FLAG_CELL_AGG_MN` = ',@FLAG_CELL_AGG_UMTS_MN,'
						WHERE A.`TECH_MASK`=2
						;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('UMTS SELECT COUNT(*),TRUE,',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				END IF;
		
				IF v_TECH_MASK=1 THEN 
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',@tmp_cell_agg_gsm_hr,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
		
					SET @SqlCmd=CONCAT('CREATE TABLE ',@tmp_cell_agg_gsm_hr,' LIKE ',@global_db,'.tmp_cell_agg_gsm_',@EX_DATE,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
	
					SET @SOURCE_TABLE_NAME=@tmp_cell_agg_gsm_hr;
					SET @ERROR_FLAG='10_tmp_cell_agg_gsm_hr_1';
					
					SET @SqlCmd=CONCAT('INSERT INTO ',@tmp_cell_agg_gsm_hr,' 
							    (`CELL_ID`,`SITE_ID`,`BSC_ID`,BCCH_ARFCN,BANDINDEX,
							     `DATA_DATE`,
							     `DATA_HOUR`,
							     ',CELL_AGG_GSM_COLUMN_STR,')
							SELECT
							  `CELL_ID`,`SITE_ID`,`BSC_ID`,BCCH_ARFCN,BANDINDEX,
							  `DATA_DATE`,
							  `DATA_HOUR`,
							  ',CELL_AGG_GSM_COLUMN_SUM_STR,'
							FROM ',@global_db,'.tmp_cell_agg_gsm_',@EX_DATE,' 
							GROUP BY `CELL_ID`,`BSC_ID`,`DATA_DATE`,`DATA_HOUR`
							ORDER BY NULL
							;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
	
					SET @SqlCmd=CONCAT('ALTER TABLE ',@tmp_cell_agg_gsm_hr,' ADD `CELL_NAME` varchar(50) CHARACTER SET utf8 DEFAULT NULL;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					SET @SqlCmd=CONCAT('CREATE INDEX `ix_cell` ON ',@tmp_cell_agg_gsm_hr,' (`CELL_ID`,`BSC_ID`);');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					SET @SqlCmd=CONCAT('UPDATE ',@tmp_cell_agg_gsm_hr,' A LEFT JOIN ',@table_nt_gsm,' B
								ON A.CELL_ID=B.CELL_ID AND A.BSC_ID=B.BSC_ID
								SET A.CELL_NAME=B.CELL_NAME;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					IF FLAG IN (0,1) THEN 
						SET @SOURCE_TABLE_NAME=@table_cell_agg_gsm_hr;
						SET @REPAIR_TABLE_NAME=@table_cell_agg_gsm_hr;
						SET @ERROR_FLAG='10_cell_agg_gsm_hr_2';
	
						SET @SqlCmd=CONCAT('INSERT INTO ',@table_cell_agg_gsm_hr,' 
								    (`CELL_ID`,`SITE_ID`,`BSC_ID`,BCCH_ARFCN,BANDINDEX,
								     `DATA_DATE`,
								     `DATA_HOUR`,
								     `CELL_NAME`,
								     ',CELL_AGG_GSM_COLUMN_STR,')
								SELECT
								  `CELL_ID`,`SITE_ID`,`BSC_ID`,BCCH_ARFCN,BANDINDEX,
								  `DATA_DATE`,
								  `DATA_HOUR`,
								  `CELL_NAME`,
								  ',CELL_AGG_GSM_COLUMN_IFNULL_STR,' 
								FROM ',@tmp_cell_agg_gsm_hr
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(CELL_AGG_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_cell_agg_gsm_hr))
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_CELL_AGG_gsm_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_agg_gsm_hr,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SOURCE_TABLE_NAME=@table_cell_agg_gsm_dy;
						SET @REPAIR_TABLE_NAME=@table_cell_agg_gsm_dy;
						SET @ERROR_FLAG='10_cell_agg_gsm_dy_3';
	
						SET @SqlCmd=CONCAT('INSERT INTO ',@table_cell_agg_gsm_dy,' 
								    (`CELL_ID`,`SITE_ID`,`BSC_ID`,BCCH_ARFCN,BANDINDEX,
								     `DATA_DATE`,
								     `CELL_NAME`,
								     ',CELL_AGG_GSM_COLUMN_STR,')
								SELECT
								  `CELL_ID`,`SITE_ID`,`BSC_ID`,BCCH_ARFCN,BANDINDEX,
								  `DATA_DATE`,
								  `CELL_NAME`,
								  ',CELL_AGG_GSM_COLUMN_IFNULL_STR,' 
								FROM ',@tmp_cell_agg_gsm_hr,' 
								ON DUPLICATE KEY UPDATE 
								',REPLACE(CELL_AGG_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_cell_agg_gsm_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						SET @FLAG_CELL_AGG_gsm_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_agg_gsm_dy,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
					END IF;
					IF FLAG = 0 THEN 
						SET @SOURCE_TABLE_NAME=@table_cell_agg_gsm_wk;
						SET @REPAIR_TABLE_NAME=@table_cell_agg_gsm_wk;
						SET @ERROR_FLAG='10_cell_agg_gsm_wk_4';
						SET @SqlCmd=CONCAT('INSERT INTO ',@table_cell_agg_gsm_wk,' 
								    (`CELL_ID`,`SITE_ID`,`BSC_ID`,BCCH_ARFCN,BANDINDEX,
								    `CELL_NAME`,
								     ',CELL_AGG_GSM_COLUMN_STR,')
								SELECT
								  `CELL_ID`,`SITE_ID`,`BSC_ID`,BCCH_ARFCN,BANDINDEX,
								  `CELL_NAME`,
								  ',CELL_AGG_GSM_COLUMN_IFNULL_STR,'  
								FROM ',@tmp_cell_agg_gsm_hr,' 
								ON DUPLICATE KEY UPDATE  
								',REPLACE(CELL_AGG_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_cell_agg_gsm_wk),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_CELL_AGG_gsm_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_agg_gsm_wk,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SOURCE_TABLE_NAME=@table_cell_agg_gsm_mn;
						SET @REPAIR_TABLE_NAME=@table_cell_agg_gsm_mn;
						SET @ERROR_FLAG='10_cell_agg_gsm_mn_5';
	
						SET @SqlCmd=CONCAT('INSERT INTO ',@table_cell_agg_gsm_mn,' 
								    (`CELL_ID`,`SITE_ID`,`BSC_ID`,BCCH_ARFCN,BANDINDEX,
								    `CELL_NAME`,
								     ',CELL_AGG_GSM_COLUMN_STR,')
								SELECT
								  `CELL_ID`,`SITE_ID`,`BSC_ID`,BCCH_ARFCN,BANDINDEX,
								  `CELL_NAME`,
								  ',CELL_AGG_GSM_COLUMN_IFNULL_STR,'  
								FROM ',@tmp_cell_agg_gsm_hr,' 
								ON DUPLICATE KEY UPDATE  
								',REPLACE(CELL_AGG_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_cell_agg_gsm_mn),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						SET @FLAG_CELL_AGG_gsm_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_agg_gsm_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
					END IF;
			
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',@tmp_cell_agg_gsm_hr,';');					
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.tmp_table_call_cnt_',WORKER_ID,' A
						SET 
						  A.`FLAG_CELL_AGG_HR` = ',@FLAG_CELL_AGG_gsm_HR,',
						  A.`FLAG_CELL_AGG_DY` = ',@FLAG_CELL_AGG_gsm_DY,',
						  A.`FLAG_CELL_AGG_WK` = ',@FLAG_CELL_AGG_gsm_WK,',
						  A.`FLAG_CELL_AGG_MN` = ',@FLAG_CELL_AGG_gsm_MN,'
						WHERE A.`TECH_MASK`=1
						;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('GSM SELECT COUNT(*),TRUE,',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				END IF;		
		
				IF v_TECH_MASK=4 THEN 
					
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',@tmp_cell_agg_lte_hr,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;	
		
					SET @SqlCmd=CONCAT('CREATE TABLE ',@tmp_cell_agg_lte_hr,' LIKE ',@global_db,'.tmp_cell_agg_lte_',@EX_DATE,' ;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
	
					SET @SOURCE_TABLE_NAME=@tmp_cell_agg_lte_hr;
					SET @ERROR_FLAG='10_tmp_cell_agg_lte_hr_1';
					
					SET @SqlCmd=CONCAT('INSERT INTO ',@tmp_cell_agg_lte_hr,' 
								(
								`CELL_ID`,`ENODEB_ID`,PU_ID,EARFCN,EUTRABAND,
								`DATA_DATE`,
								`DATA_HOUR`,
								',CELL_AGG_LTE_COLUMN_STR,')
							SELECT
								`CELL_ID`,`ENODEB_ID`,PU_ID,EARFCN,EUTRABAND,
								`DATA_DATE`,
								`DATA_HOUR`,
								',CELL_AGG_LTE_COLUMN_SUM_STR,'
							FROM ',@global_db,'.tmp_cell_agg_lte_',@EX_DATE,' 
							GROUP BY `CELL_ID`,`ENODEB_ID`,PU_ID,`DATA_DATE`,`DATA_HOUR`
							ORDER BY NULL
							;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@tmp_cell_agg_lte_hr,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
					SET STEP_START_TIME := SYSDATE();
	
					SET @SqlCmd=CONCAT('ALTER TABLE ',@tmp_cell_agg_lte_hr,' ADD `CELL_NAME` varchar(50) CHARACTER SET utf8 DEFAULT NULL;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					SET @SqlCmd=CONCAT('CREATE INDEX `ix_cell` ON ',@tmp_cell_agg_lte_hr,' (`CELL_ID`,`ENODEB_ID`,`PU_ID`);');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					SET @SqlCmd=CONCAT('UPDATE ',@tmp_cell_agg_lte_hr,' A LEFT JOIN ',@table_nt_lte,' B
								ON A.CELL_ID=B.CELL_ID AND A.ENODEB_ID=B.ENODEB_ID AND A.PU_ID=B.PU_ID
								SET A.CELL_NAME=B.CELL_NAME;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',@tmp_cell_lte_hr,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					SET @SqlCmd=CONCAT('CREATE TABLE ',@tmp_cell_lte_hr,' LIKE ',@global_db,'.tmp_cell_lte_',@EX_DATE,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;	
	
					SET @SOURCE_TABLE_NAME=@tmp_cell_lte_hr;
					SET @ERROR_FLAG='10_tmp_cell_lte_hr_2';
						
					SET @SqlCmd=CONCAT('INSERT INTO ',@tmp_cell_lte_hr,'(	  
								PU_ID,
								ENODEB_ID,
								CELL_ID,
								CELL_NAME,
								SUB_REGION_ID,
								EUTRABAND,
								EARFCN,
								DATA_DATE,
								DATA_HOUR,
								CELL_OSS_NODE_ID,
								',CELL_PM_LTE_COLUMN_STR,'
								)
							SELECT  PU_ID,
								ENODEB_ID,
								CELL_ID,
								CELL_NAME,
								SUB_REGION_ID,
								EUTRABAND,
								EARFCN,
								DATA_DATE,
								DATA_HOUR,
								CELL_OSS_NODE_ID,
								',CELL_PM_LTE_COLUMN_SUM_STR,'
								FROM ',@global_db,'.tmp_cell_lte_',@EX_DATE,' 
	                                                        WHERE RRC_CONN_SETUP_ATTEMPT > 0
								GROUP BY `ENODEB_ID`,`CELL_ID`,`DATA_DATE`,`DATA_HOUR`,SUB_REGION_ID,PU_ID
								;');
	
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@tmp_cell_lte_hr,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
					SET STEP_START_TIME := SYSDATE();
	
					
					SET @SqlCmd=CONCAT('CREATE INDEX `ix_cell` ON ',@tmp_cell_lte_hr,' (`CELL_ID`,`ENODEB_ID`,`PU_ID`);');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
		
					IF FLAG IN (0,1) THEN 	
					
						SET @SOURCE_TABLE_NAME=@table_cell_agg_lte_hr;
						SET @REPAIR_TABLE_NAME=@table_cell_agg_lte_hr;
						SET @ERROR_FLAG='10_cell_agg_lte_hr_3';
									
						SET @SqlCmd=CONCAT('INSERT INTO ',@table_cell_agg_lte_hr,' 
								    (`CELL_ID`,`ENODEB_ID`,PU_ID,EARFCN,EUTRABAND,
									`DATA_DATE`,
									`DATA_HOUR`,
									`CELL_NAME`,
									',CELL_AGG_LTE_COLUMN_STR,')
								SELECT
									`CELL_ID`,`ENODEB_ID`,PU_ID,EARFCN,EUTRABAND,
									`DATA_DATE`,
									`DATA_HOUR`,
									`CELL_NAME`,
									',CELL_AGG_LTE_COLUMN_IFNULL_STR,'
								FROM ',@tmp_cell_agg_lte_hr
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(CELL_AGG_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_cell_agg_lte_hr))
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_CELL_AGG_LTE_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_agg_lte_hr,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SOURCE_TABLE_NAME=@table_cell_agg_lte_dy;
						SET @REPAIR_TABLE_NAME=@table_cell_agg_lte_dy;
						SET @ERROR_FLAG='10_cell_agg_lte_dy_4';
						
						SET @SqlCmd=CONCAT('INSERT INTO ',@table_cell_agg_lte_dy,' 
								    (`CELL_ID`,`ENODEB_ID`,PU_ID,EARFCN,EUTRABAND,
									`DATA_DATE`,
									`CELL_NAME`,
									',CELL_AGG_LTE_COLUMN_STR,')
								SELECT
									`CELL_ID`,`ENODEB_ID`,PU_ID,EARFCN,EUTRABAND,
									`DATA_DATE`,
									`CELL_NAME`,
									',CELL_AGG_LTE_COLUMN_IFNULL_STR,'
								FROM ',@tmp_cell_agg_lte_hr,' 
								ON DUPLICATE KEY UPDATE  
								',REPLACE(CELL_AGG_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_cell_agg_lte_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_CELL_AGG_lte_dy=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_agg_lte_dy,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
					
						SET @SOURCE_TABLE_NAME=@table_cell_lte_hr;
						SET @REPAIR_TABLE_NAME=@table_cell_lte_hr;
						SET @ERROR_FLAG='10_cell_lte_hr_5';
						
						SET @SqlCmd=CONCAT('INSERT INTO ',@table_cell_lte_hr,'(	  
									PU_ID,
									ENODEB_ID,
									CELL_ID,
									CELL_NAME,
									SUB_REGION_ID,
									EUTRABAND,
									EARFCN,
									DATA_DATE,
									DATA_HOUR,
									CELL_OSS_NODE_ID,
									',CELL_PM_LTE_COLUMN_STR,'
									)
								SELECT 	PU_ID,
									ENODEB_ID,
									CELL_ID,
									CELL_NAME,
									SUB_REGION_ID,
									EUTRABAND,
									EARFCN,
									DATA_DATE,
									DATA_HOUR,
									CELL_OSS_NODE_ID,
									',CELL_PM_LTE_COLUMN_IFNULL_STR,'
								FROM ',@tmp_cell_lte_hr
								,CASE PENDING_FLAG WHEN 1 THEN 
									CONCAT(' ON DUPLICATE KEY UPDATE ',REPLACE(CELL_PM_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_cell_lte_hr))
									ELSE '' END
								,';');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;					
						SET @FLAG_CELL_PM_LTE_HR=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_lte_hr,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SOURCE_TABLE_NAME=@table_cell_lte_dy;
						SET @REPAIR_TABLE_NAME=@table_cell_lte_dy;
						SET @ERROR_FLAG='10_cell_lte_dy_6';
						
						SET @SqlCmd=CONCAT('INSERT INTO ',@table_cell_lte_dy,'(
									PU_ID,
									ENODEB_ID,
									CELL_ID,
									CELL_NAME,
									SUB_REGION_ID,
									EUTRABAND,
									EARFCN,
									DATA_DATE,
									CELL_OSS_NODE_ID,
									',CELL_PM_LTE_COLUMN_STR,'
									)
								SELECT 	PU_ID,
									ENODEB_ID,
									CELL_ID,
									CELL_NAME,
									SUB_REGION_ID,
									EUTRABAND,
									EARFCN,
									DATA_DATE,
									CELL_OSS_NODE_ID,
									',CELL_PM_LTE_COLUMN_IFNULL_STR,'
								FROM ',@tmp_cell_lte_hr,' 
								ON DUPLICATE KEY UPDATE 
								',REPLACE(CELL_PM_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_cell_lte_dy),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;					
						SET @FLAG_CELL_PM_LTE_DY=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_lte_dy,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
					END IF; 
		
					IF FLAG =0 THEN 
						SET @SOURCE_TABLE_NAME=@table_cell_agg_lte_wk;
						SET @REPAIR_TABLE_NAME=@table_cell_agg_lte_wk;
						SET @ERROR_FLAG='10_cell_lte_wk_7';
	
						SET @SqlCmd=CONCAT('INSERT INTO ',@table_cell_agg_lte_wk,' 
								    (
									`CELL_ID`,`ENODEB_ID`,PU_ID,EARFCN,EUTRABAND,
									`CELL_NAME`,
									',CELL_AGG_LTE_COLUMN_STR,')
								SELECT
									`CELL_ID`,`ENODEB_ID`,PU_ID,EARFCN,EUTRABAND,
									`CELL_NAME`,
									',CELL_AGG_LTE_COLUMN_IFNULL_STR,'
								FROM ',@tmp_cell_agg_lte_hr,'  
								ON DUPLICATE KEY UPDATE  
								',REPLACE(CELL_AGG_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_cell_agg_lte_wk),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						
						SET @FLAG_CELL_AGG_lte_wk=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_agg_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
	
						SET @SOURCE_TABLE_NAME=@table_cell_agg_lte_mn;
						SET @REPAIR_TABLE_NAME=@table_cell_agg_lte_mn;
						SET @ERROR_FLAG='10_cell_lte_mn_8';
						
						SET @SqlCmd=CONCAT('INSERT INTO ',@table_cell_agg_lte_mn,' 
								    (
									`CELL_ID`,`ENODEB_ID`,PU_ID,EARFCN,EUTRABAND,
									`CELL_NAME`,
									',CELL_AGG_LTE_COLUMN_STR,')
								SELECT
									`CELL_ID`,`ENODEB_ID`,PU_ID,EARFCN,EUTRABAND,
									`CELL_NAME`,
									',CELL_AGG_LTE_COLUMN_IFNULL_STR,'
								FROM ',@tmp_cell_agg_lte_hr,'  
								ON DUPLICATE KEY UPDATE  
								',REPLACE(CELL_AGG_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_cell_agg_lte_mn),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;
						SET @FLAG_CELL_AGG_lte_mn=1;
	
						SET @SOURCE_TABLE_NAME=@table_cell_lte_wk;
						SET @REPAIR_TABLE_NAME=@table_cell_lte_wk;
						SET @ERROR_FLAG='10_cell_lte_wk_9';
					
						SET @SqlCmd=CONCAT('INSERT INTO ',@table_cell_lte_wk,' 
								    ( 	PU_ID,
									ENODEB_ID,
									CELL_ID,
									CELL_NAME,
									SUB_REGION_ID,
									EUTRABAND,
									EARFCN,
									DATA_DATE,
									CELL_OSS_NODE_ID,
									',CELL_PM_LTE_COLUMN_STR,'
									)
								SELECT 	PU_ID,
									ENODEB_ID,
									CELL_ID,
									CELL_NAME,
									SUB_REGION_ID,
									EUTRABAND,
									EARFCN,
									DATA_DATE,
									CELL_OSS_NODE_ID,
									',CELL_PM_LTE_COLUMN_IFNULL_STR,'
								FROM ',@tmp_cell_lte_hr,' 
								ON DUPLICATE KEY UPDATE 
								',REPLACE(CELL_PM_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_cell_lte_wk),'
								;');
		
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;					
						SET @FLAG_CELL_PM_LTE_WK=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();	
	
						SET @SOURCE_TABLE_NAME=@table_cell_lte_mn;
						SET @REPAIR_TABLE_NAME=@table_cell_lte_mn;
						SET @ERROR_FLAG='10_cell_lte_wk_10';
						
						SET @SqlCmd=CONCAT('INSERT INTO ',@table_cell_lte_mn,' 
								    ( 	PU_ID,
									ENODEB_ID,
									CELL_ID,
									CELL_NAME,
									SUB_REGION_ID,
									EUTRABAND,
									EARFCN,
									DATA_DATE,
									CELL_OSS_NODE_ID,
									',CELL_PM_LTE_COLUMN_STR,'
									)
								SELECT 	PU_ID,
									ENODEB_ID,
									CELL_ID,
									CELL_NAME,
									SUB_REGION_ID,
									EUTRABAND,
									EARFCN,
									DATA_DATE,
									CELL_OSS_NODE_ID,
									',CELL_PM_LTE_COLUMN_IFNULL_STR,'
								FROM ',@tmp_cell_lte_hr,' 
								ON DUPLICATE KEY UPDATE 
								',REPLACE(CELL_PM_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_cell_lte_mn),'
								;');
						PREPARE Stmt FROM @SqlCmd;
						EXECUTE Stmt;
						DEALLOCATE PREPARE Stmt;	
	
						SET @SqlCmd=CONCAT('INSERT INTO ',@table_cell_lte_mn_all,'( 
									PU_ID,
									ENODEB_ID,
									CELL_ID,
									CELL_NAME,
									SUB_REGION_ID,
									EUTRABAND,
									EARFCN,
									DATA_DATE,
									CELL_OSS_NODE_ID,
									',CELL_PM_LTE_COLUMN_STR,'
									)
								SELECT PU_ID,
									ENODEB_ID,
									CELL_ID,
									CELL_NAME,
									SUB_REGION_ID,
									EUTRABAND,
									EARFCN,
									DATA_DATE,
									CELL_OSS_NODE_ID,
									',CELL_PM_LTE_COLUMN_IFNULL_STR,'
							FROM ',@tmp_cell_lte_hr,' 
							ON DUPLICATE KEY UPDATE 
							',REPLACE(CELL_PM_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',@table_cell_lte_mn_all),'
							;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
	
						SET @FLAG_CELL_PM_LTE_MN=1;
						INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_tile_16_lte_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
						SET STEP_START_TIME := SYSDATE();
					END IF;
			
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',@tmp_cell_agg_lte_hr,';');					
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					
					SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.tmp_table_call_cnt_',WORKER_ID,' A
								SET 
								  A.`FLAG_CELL_AGG_HR` = ',@FLAG_CELL_AGG_LTE_HR,',
								  A.`FLAG_CELL_AGG_DY` = ',@FLAG_CELL_AGG_LTE_DY,',
								  A.`FLAG_CELL_AGG_WK` = ',@FLAG_CELL_AGG_LTE_WK,',
								  A.`FLAG_CELL_AGG_MN` = ',@FLAG_CELL_AGG_LTE_MN,'
								WHERE A.`TECH_MASK`=4;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('LTE UPDATE table_call_cnt_',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
					
					
					SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',@tmp_cell_lte_hr,';');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
										
					SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.tmp_table_call_cnt_',WORKER_ID,' A
						SET 
						  A.`FLAG_CELL_PM_HR` = ',@FLAG_CELL_PM_LTE_HR,',
						  A.`FLAG_CELL_PM_DY` = ',@FLAG_CELL_PM_LTE_DY,',
						  A.`FLAG_CELL_PM_WK` = ',@FLAG_CELL_PM_LTE_WK,',
						  A.`FLAG_CELL_PM_MN` = ',@FLAG_CELL_PM_LTE_MN,'
						WHERE A.TECH_MASK=4 ;');
					PREPARE Stmt FROM @SqlCmd;
					EXECUTE Stmt;
					DEALLOCATE PREPARE Stmt;
					INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('UPDATE table_call_cnt_',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				END IF;	
				SET @v_i=@v_i+1;
			END;
			END WHILE;
			SET @v_reg_m=@v_reg_m+1;
		END;
		END WHILE;
			
		IF v_TECH_MASK=2 THEN 
			SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',@global_db,'.tmp_cell_agg_umts_',@EX_DATE,';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('UMTS DROP ',@global_db,'.tmp_cell_agg_umts_',@EX_DATE,' ',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
			SET STEP_START_TIME := SYSDATE();
		END IF;	
						
		IF v_TECH_MASK=1 THEN 
			SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',@global_db,'.tmp_cell_agg_gsm_',@EX_DATE,';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('GSM DROP ',@global_db,'.tmp_cell_agg_gsm_',@EX_DATE,' ',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
			SET STEP_START_TIME := SYSDATE();
		END IF;	
						
		IF v_TECH_MASK=4 THEN 
			SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',@global_db,'.tmp_cell_agg_lte_',@EX_DATE,';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;
			INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('LTE DROP ',@global_db,'.tmp_cell_agg_lte_',@EX_DATE,' ',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
			SET STEP_START_TIME := SYSDATE();
								
			SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',@global_db,'.tmp_cell_lte_',@EX_DATE,';');
			PREPARE Stmt FROM @SqlCmd;
			EXECUTE Stmt;
			DEALLOCATE PREPARE Stmt;			
			INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('LTE DROP ',@global_db,'.tmp_cell_lte_',@EX_DATE,' ',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
			SET STEP_START_TIME := SYSDATE();
			
		END IF;	
				
		INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT(v_DATA_DATE,',',v_DATA_HOUR,',',v_TECH_MASK,',',WORKER_ID,' Done: ',TIMESTAMPDIFF(SECOND,START_TIME,SYSDATE()),' seconds.'), NOW());
	END IF;
	
	IF FLAG=2 THEN 
		SET @SqlCmd=CONCAT('SELECT `att_value` INTO @ZOOM_LEVEL FROM gt_covmo.`sys_config` WHERE `group_name`=''system'' AND att_name = ''MapResolution'';');
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt; 
	
		IF exDate IS NOT NULL THEN 
			SET @v_DATA_DATE=CAST(exDate AS DATE);
		ELSE 
			SET @v_DATA_DATE=DATE(DATE_ADD(START_TIME,INTERVAL -1 DAY));
		END IF;
		SELECT `DAY_OF_WEEK`(@v_DATA_DATE) INTO @DAY_OF_WEEK;
		SET @FIRST_DAY=gt_strtok(@DAY_OF_WEEK, 1, '|');
		SET @END_DAY=gt_strtok(@DAY_OF_WEEK, 2, '|');
		SET @DATE_WK=CONCAT(DATE_FORMAT(@FIRST_DAY,'%Y%m%d'),'_',DATE_FORMAT(@END_DAY,'%Y%m%d'));
		SET @DATE_MN=DATE_FORMAT(@v_DATA_DATE,'%Y%m');
		SET @EX_DATE=CONCAT(DATE_FORMAT(@v_DATA_DATE,'%Y%m%d_'),WORKER_ID);
		SET @SR_DATE=CONCAT(DATE_FORMAT(@v_DATA_DATE,'%Y%m%d'));
		
		SET @SqlCmd=CONCAT('SELECT GROUP_CONCAT(DISTINCT `group_id` ORDER BY `group_id` SEPARATOR ''|'' ) INTO @REG_GROUP FROM ',@global_db,'.`usr_polygon_reg_3`;');
	
		PREPARE Stmt FROM @SqlCmd;
		EXECUTE Stmt;
		DEALLOCATE PREPARE Stmt;		
			
		SET @v_reg_m=1;
		SET @v_reg_Max=gt_covmo_csv_count(@REG_GROUP,'|');
		WHILE @v_reg_m <= @v_reg_Max DO
		BEGIN			
			SET v_group_db_name=CONCAT('gt_global_statistic_g',gt_strtok(@REG_GROUP, @v_reg_m, '|'));
		
			IF TECH_MASK=2 THEN 
				SET @table_cell_agg_umts_dy=CONCAT('table_cell_agg_umts_dy_',@SR_DATE);
				SET @table_cell_agg_umts_wk=CONCAT('table_cell_agg_umts_wk_',@DATE_WK);
				SET @table_cell_agg_umts_mn=CONCAT('table_cell_agg_umts_mn_',@DATE_MN);
				
				SET @SOURCE_TABLE_NAME=CONCAT(@table_cell_agg_umts_dy,',',@table_cell_agg_umts_wk);
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_cell_agg_umts_wk);
				SET @ERROR_FLAG='2_cell_agg_umts_wk_1';
	
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_cell_agg_umts_wk,' 
						    (`CELL_ID`,`SITE_ID`,`RNC_ID`,CLUSTER_ID,FREQUENCY,UARFCN,
						    `CELL_NAME`,
						     ',CELL_AGG_UMTS_COLUMN_STR,')
						SELECT
						  `CELL_ID`,`SITE_ID`,`RNC_ID`,CLUSTER_ID,FREQUENCY,UARFCN,
						  `CELL_NAME`,
						  ',CELL_AGG_UMTS_COLUMN_IFNULL_STR,'  
						FROM ',SHARE_DB,'.',@table_cell_agg_umts_dy,' 
						ON DUPLICATE KEY UPDATE 
						',REPLACE(CELL_AGG_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_cell_agg_umts_wk)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_cell_agg_umts_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_CELL_AGG_UMTS_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_agg_umts_wk,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_cell_agg_umts_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_cell_agg_umts_mn);
				SET @ERROR_FLAG='2_cell_agg_umts_mn_2';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_cell_agg_umts_mn,' 
						    (`CELL_ID`,`SITE_ID`,`RNC_ID`,CLUSTER_ID,FREQUENCY,UARFCN,
						    `CELL_NAME`,
						     ',CELL_AGG_UMTS_COLUMN_STR,')
						SELECT
						  `CELL_ID`,`SITE_ID`,`RNC_ID`,CLUSTER_ID,FREQUENCY,UARFCN,
						  `CELL_NAME`,
						  ',CELL_AGG_UMTS_COLUMN_IFNULL_STR,'  
						FROM ',SHARE_DB,'.',@table_cell_agg_umts_dy,' 
						ON DUPLICATE KEY UPDATE 
						',REPLACE(CELL_AGG_UMTS_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_cell_agg_umts_mn)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_cell_agg_umts_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_CELL_AGG_UMTS_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_agg_umts_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();			
				
				SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_cell_agg_umts_dy,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.`table_call_cnt_history` A
					SET 
					  A.`FLAG_CELL_AGG_WK` = ',@FLAG_CELL_AGG_UMTS_WK,',
					  A.`FLAG_CELL_AGG_MN` = ',@FLAG_CELL_AGG_UMTS_MN,'
					WHERE A.`DATA_DATE`=''',@v_DATA_DATE,''' AND `TECH_MASK`=2
					;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('UMTS SELECT COUNT(*),TRUE,',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
			END IF;
			IF TECH_MASK=1 THEN 
				SET @table_cell_agg_gsm_dy=CONCAT('table_cell_agg_gsm_dy_',@SR_DATE);
				SET @table_cell_agg_gsm_wk=CONCAT('table_cell_agg_gsm_wk_',@DATE_WK);
				SET @table_cell_agg_gsm_mn=CONCAT('table_cell_agg_gsm_mn_',@DATE_MN);
				
				SET @SOURCE_TABLE_NAME=CONCAT(@table_cell_agg_gsm_dy,',',@table_cell_agg_gsm_wk);
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_cell_agg_gsm_wk);
				SET @ERROR_FLAG='2_cell_agg_gsm_wk_1';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);			
							
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_cell_agg_gsm_wk,' 
						    (`CELL_ID`,`SITE_ID`,`BSC_ID`,BCCH_ARFCN,BANDINDEX,
						    `CELL_NAME`,
						     ',CELL_AGG_GSM_COLUMN_STR,')
						SELECT
							`CELL_ID`,`SITE_ID`,`BSC_ID`,BCCH_ARFCN,BANDINDEX,
							`CELL_NAME`,
							',CELL_AGG_GSM_COLUMN_IFNULL_STR,'  
						FROM ',SHARE_DB,'.',@table_cell_agg_gsm_dy,' 
						ON DUPLICATE KEY UPDATE  
						',REPLACE(CELL_AGG_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_cell_agg_gsm_wk)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_cell_agg_gsm_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_CELL_AGG_gsm_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_agg_gsm_wk,', cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_cell_agg_gsm_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_cell_agg_gsm_mn);
				SET @ERROR_FLAG='2_cell_agg_gsm_mn_2';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_cell_agg_gsm_mn,' 
						    (`CELL_ID`,`SITE_ID`,`BSC_ID`,BCCH_ARFCN,BANDINDEX,
						    `CELL_NAME`,
						     ',CELL_AGG_GSM_COLUMN_STR,')
						SELECT
							`CELL_ID`,`SITE_ID`,`BSC_ID`,BCCH_ARFCN,BANDINDEX,
							`CELL_NAME`,
							',CELL_AGG_GSM_COLUMN_IFNULL_STR,'  
						FROM ',SHARE_DB,'.',@table_cell_agg_gsm_dy,' 
						ON DUPLICATE KEY UPDATE  
						',REPLACE(CELL_AGG_GSM_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_cell_agg_gsm_mn)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_cell_agg_gsm_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_CELL_AGG_gsm_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_agg_gsm_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();			
				
				SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_cell_agg_gsm_dy,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.`table_call_cnt_history` A
					SET 
					  A.`FLAG_CELL_AGG_WK` = ',@FLAG_CELL_AGG_GSM_WK,',
					  A.`FLAG_CELL_AGG_MN` = ',@FLAG_CELL_AGG_GSM_MN,'
					WHERE A.`DATA_DATE`=''',@v_DATA_DATE,''' AND `TECH_MASK`=1
					;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('UMTS SELECT COUNT(*),TRUE,',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
			END IF;
			IF TECH_MASK=4 THEN			
				SET @table_cell_agg_lte_dy=CONCAT('table_cell_agg_lte_dy_',@SR_DATE);
				SET @table_cell_agg_lte_wk=CONCAT('table_cell_agg_lte_wk_',@DATE_WK);
				SET @table_cell_agg_lte_mn=CONCAT('table_cell_agg_lte_mn_',@DATE_MN);
				
				SET @SOURCE_TABLE_NAME=CONCAT(@table_cell_agg_lte_dy,',',@table_cell_agg_lte_wk);
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_cell_agg_lte_wk);
				SET @ERROR_FLAG='2_cell_agg_lte_wk_1';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_cell_agg_lte_wk,' 
						    (
							`CELL_ID`,`ENODEB_ID`,PU_ID,EARFCN,EUTRABAND,
							`CELL_NAME`,
							',CELL_AGG_LTE_COLUMN_STR,')
						SELECT
							`CELL_ID`,`ENODEB_ID`,PU_ID,EARFCN,EUTRABAND,
							`CELL_NAME`,
							',CELL_AGG_LTE_COLUMN_IFNULL_STR,'
						FROM ',SHARE_DB,'.',@table_cell_agg_lte_dy,'  
						ON DUPLICATE KEY UPDATE  
						',REPLACE(CELL_AGG_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_cell_agg_lte_wk)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_cell_agg_lte_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_CELL_AGG_lte_wk=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_agg_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_cell_agg_lte_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_cell_agg_lte_mn);
				SET @ERROR_FLAG='2_cell_agg_lte_mn_2';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_cell_agg_lte_mn,' 
						    (
							`CELL_ID`,`ENODEB_ID`,PU_ID,EARFCN,EUTRABAND,
							`CELL_NAME`,
							',CELL_AGG_LTE_COLUMN_STR,')
						SELECT
							`CELL_ID`,`ENODEB_ID`,PU_ID,EARFCN,EUTRABAND,
							`CELL_NAME`,
							',CELL_AGG_LTE_COLUMN_IFNULL_STR,'
						FROM ',SHARE_DB,'.',@table_cell_agg_lte_dy,'  
						ON DUPLICATE KEY UPDATE  
						',REPLACE(CELL_AGG_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_cell_agg_lte_mn)),'
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_cell_agg_lte_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_CELL_AGG_LTE_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT(@table_cell_agg_lte_mn,' INSERT cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_cell_agg_lte_dy,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.`table_call_cnt_history` A
					SET 
					  A.`FLAG_CELL_AGG_WK` = ',@FLAG_CELL_AGG_LTE_WK,',
					  A.`FLAG_CELL_AGG_MN` = ',@FLAG_CELL_AGG_LTE_MN,'
					WHERE A.`DATA_DATE`=''',@v_DATA_DATE,''' AND `TECH_MASK`=4
					;');	
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT(v_DATA_DATE,',',v_TECH_MASK,',',WORKER_ID,' Done: ',TIMESTAMPDIFF(SECOND,START_TIME,SYSDATE()),' seconds.'), NOW());
				
				SET @table_cell_lte_dy=CONCAT('table_cell_lte_dy_',@SR_DATE);
				SET @table_cell_lte_wk=CONCAT('table_cell_lte_wk_',@DATE_WK);
				SET @table_cell_lte_mn=CONCAT('table_cell_lte_mn_',@DATE_MN);
				SET @table_cell_lte_mn_all=CONCAT('table_cell_lte_mn_all');
				
				SET @SOURCE_TABLE_NAME=CONCAT(@table_cell_lte_dy,',',@table_cell_lte_wk);
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_cell_lte_wk);
				SET @ERROR_FLAG='2_cell_agg_lte_wk_3';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
							
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_cell_lte_wk,' ( 
							PU_ID,
							ENODEB_ID,
							CELL_ID,
							CELL_NAME,
							SUB_REGION_ID,
							EUTRABAND,
							EARFCN,
							DATA_DATE,
							CELL_OSS_NODE_ID,
							',CELL_PM_LTE_COLUMN_STR,'
							)
						SELECT 
							PU_ID,
							ENODEB_ID,
							CELL_ID,
							CELL_NAME,
							SUB_REGION_ID,
							EUTRABAND,
							EARFCN,
							DATA_DATE,
							CELL_OSS_NODE_ID,
							',CELL_PM_LTE_COLUMN_IFNULL_STR,'
							FROM ',SHARE_DB,'.',@table_cell_lte_dy,' 
							ON DUPLICATE KEY UPDATE   
							',REPLACE(CELL_PM_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_cell_lte_wk)),'
							;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_cell_lte_wk;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_CELL_LTE_WK=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_lte_wk,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_cell_lte_mn;
				SET @REPAIR_TABLE_NAME=CONCAT(v_group_db_name,'.',@table_cell_lte_mn);
				SET @ERROR_FLAG='2_cell_lte_mn_4';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);				
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_cell_lte_mn,'( 
							PU_ID,
							ENODEB_ID,
							CELL_ID,
							CELL_NAME,
							SUB_REGION_ID,
							EUTRABAND,
							EARFCN,
							DATA_DATE,
							CELL_OSS_NODE_ID,
							',CELL_PM_LTE_COLUMN_STR,'
							)
						SELECT 
							PU_ID,
							ENODEB_ID,
							CELL_ID,
							CELL_NAME,
							SUB_REGION_ID,
							EUTRABAND,
							EARFCN,
							DATA_DATE,
							CELL_OSS_NODE_ID,
							',CELL_PM_LTE_COLUMN_IFNULL_STR,'
							FROM ',SHARE_DB,'.',@table_cell_lte_dy,' 
							ON DUPLICATE KEY UPDATE   
							',REPLACE(CELL_PM_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_cell_lte_mn)),'
							;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_cell_lte_mn;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
				
				SET @FLAG_CELL_LTE_MN=1;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_lte_mn,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
	
	
				SET STEP_START_TIME := SYSDATE();
				
				SET @SOURCE_TABLE_NAME=@table_cell_lte_mn_all;
				SET @ERROR_FLAG='2_cell_lte_mn_all_4';
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_cp`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);				
				
				SET @SqlCmd=CONCAT('INSERT INTO ',SHARE_DB,'.',@table_cell_lte_mn_all,'( 
							PU_ID,
							ENODEB_ID,
							CELL_ID,
							CELL_NAME,
							SUB_REGION_ID,
							EUTRABAND,
							EARFCN,
							DATA_DATE,
							CELL_OSS_NODE_ID,
							',CELL_PM_LTE_COLUMN_STR,'
							)
						SELECT 
							PU_ID,
							ENODEB_ID,
							CELL_ID,
							CELL_NAME,
							SUB_REGION_ID,
							EUTRABAND,
							EARFCN,
							DATA_DATE,
							CELL_OSS_NODE_ID,
							',CELL_PM_LTE_COLUMN_IFNULL_STR,'
							FROM ',SHARE_DB,'.',@table_cell_lte_dy,' 
							ON DUPLICATE KEY UPDATE   
							',REPLACE(CELL_PM_LTE_COLUMN_UPD_STR,'RPT_TABLE_NAME',CONCAT(SHARE_DB,'.',@table_cell_lte_mn_all)),'
							;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				
				SET @SOURCE_TABLE_NAME=@table_cell_lte_mn_all;
				CALL gt_global_statistic.`SP_Generate_Global_Statistic_db_mv`(SHARE_IP,SHARE_PORT,SHARE_ACCOUNT,SHARE_PW,v_group_db_name,SHARE_DB,@SOURCE_TABLE_NAME,WORKER_ID);
	
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('INSERT INTO ',@table_cell_lte_mn_all,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
	
	
	
				SET STEP_START_TIME := SYSDATE();
				
				SET @SqlCmd=CONCAT('DROP TABLE IF EXISTS ',SHARE_DB,'.',@table_cell_lte_dy,';');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				SET @SqlCmd=CONCAT('UPDATE `gt_global_statistic`.`table_call_cnt_history`
							SET 
							  `FLAG_CELL_PM_WK` = ',@FLAG_CELL_LTE_WK,',
							  `FLAG_CELL_PM_MN` = ',@FLAG_CELL_LTE_MN,'
							WHERE `DATA_DATE`=''',@v_DATA_DATE,''' AND `TECH_MASK`=4
						;');
				PREPARE Stmt FROM @SqlCmd;
				EXECUTE Stmt;
				DEALLOCATE PREPARE Stmt;
				INSERT INTO gt_gw_main.SP_LOG VALUES(@global_db,'SP_Generate_Global_Statistic_Sub_cell_Aggr',CONCAT('SELECT COUNT(*),TRUE,',WORKER_ID,' cost:',TIMESTAMPDIFF(SECOND,STEP_START_TIME,SYSDATE()),' sec.'), NOW());
			END IF;
			SET @v_reg_m=@v_reg_m+1;
		END;
		END WHILE;
	END IF;
END$$
DELIMITER ;

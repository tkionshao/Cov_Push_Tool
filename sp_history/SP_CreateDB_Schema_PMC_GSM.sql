DELIMITER $$
USE `gt_gw_main`$$
DROP PROCEDURE IF EXISTS `SP_CreateDB_LTE`$$
CREATE DEFINER=`covmo`@`%` PROCEDURE `SP_CreateDB_Schema_PMC_GSM`(IN GT_DB VARCHAR(100))
BEGIN
	SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',GT_DB,'.`table_tile_pmc_gsm_c` 
				(
					DATA_DATE DATE NOT NULL COMMENT ''KEY'',
					DATA_HOUR TINYINT(4) NOT NULL COMMENT ''KEY'',
					BSC_ID MEDIUMINT(9) NOT NULL COMMENT ''KEY'',
					CELL_ID MEDIUMINT(9) NOT NULL COMMENT ''KEY'',
					CELL_LON DOUBLE DEFAULT NULL COMMENT ''TAG'',
					CELL_LAT DOUBLE DEFAULT NULL COMMENT ''TAG'',
					BANDINDEX VARCHAR(10) DEFAULT NULL COMMENT ''TAG'',
					BCCH_ARFCN MEDIUMINT(9) DEFAULT NULL COMMENT ''TAG'',
					CELL_NAME VARCHAR(50) CHARACTER SET utf8 COLLATE utf8_swedish_ci DEFAULT NULL COMMENT ''TAG'',
					CALL_CNT MEDIUMINT(9) DEFAULT 0,
					RXLEV_FULL_DOWNLINK_CNT MEDIUMINT(9) DEFAULT NULL,
					RXLEV_FULL_DOWNLINK_SUM FLOAT DEFAULT NULL,
					RXQUAL_FULL_DOWNLINK_CNT MEDIUMINT(9) DEFAULT NULL,
					RXQUAL_FULL_DOWNLINK_SUM FLOAT DEFAULT NULL,
					RXLEV_FULL_DOWNLINK_AVG DOUBLE DEFAULT NULL,
					RXQUAL_FULL_DOWNLINK_AVG DOUBLE DEFAULT NULL,
					IMSI_CNT INT(11) DEFAULT NULL,
					CALL_TYPE_10 MEDIUMINT(9) DEFAULT NULL,
					CALL_TYPE_16 MEDIUMINT(9) DEFAULT NULL,
					CALL_TYPE_20 MEDIUMINT(9) DEFAULT NULL,
					CALL_TYPE_99 MEDIUMINT(9) DEFAULT NULL,
					RXLEV_FULL_UPLINK_SUM DOUBLE DEFAULT NULL,
					RXQUAL_FULL_UPLINK_SUM DOUBLE DEFAULT NULL,
					RXLEV_FULL_UPLINK_CNT INT(11) DEFAULT NULL,
					RXQUAL_FULL_UPLINK_CNT INT(11) DEFAULT NULL,
					RXLEV_FULL_UPLINK_MED_AVG FLOAT DEFAULT NULL,
					RXQUAL_FULL_UPLINK_MED_AVG FLOAT DEFAULT NULL,		
					CALL_CNT_END MEDIUMINT(9) DEFAULT 0,
					RXLEV_FULL_DOWNLINK_CNT_END MEDIUMINT(9) DEFAULT NULL,
					RXLEV_FULL_DOWNLINK_SUM_END FLOAT DEFAULT NULL,
					RXQUAL_FULL_DOWNLINK_CNT_END MEDIUMINT(9) DEFAULT NULL,
					RXQUAL_FULL_DOWNLINK_SUM_END FLOAT DEFAULT NULL,
					RXLEV_FULL_UPLINK_SUM_END DOUBLE DEFAULT NULL,
					RXQUAL_FULL_UPLINK_SUM_END DOUBLE DEFAULT NULL,
					RXLEV_FULL_UPLINK_CNT_END INT(11) DEFAULT NULL,
					RXQUAL_FULL_UPLINK_CNT_END INT(11) DEFAULT NULL,
					RXLEV_FULL_UPLINK_MED_AVG_END FLOAT DEFAULT NULL,
					RXQUAL_FULL_UPLINK_MED_AVG_END FLOAT DEFAULT NULL,
					BSSMAP_11 MEDIUMINT(9) DEFAULT NULL,
					BSSMAP_12 MEDIUMINT(9) DEFAULT NULL,
					BSSMAP_13 MEDIUMINT(9) DEFAULT NULL,
					BSSMAP_14 MEDIUMINT(9) DEFAULT NULL,
					BSSMAP_15 MEDIUMINT(9) DEFAULT NULL,
					BSSMAP_16 MEDIUMINT(9) DEFAULT NULL,
					BSSMAP_17 MEDIUMINT(9) DEFAULT NULL,
					BSSMAP_18 MEDIUMINT(9) DEFAULT NULL,
					RSL_21 MEDIUMINT(9) DEFAULT NULL,
					RSL_22 MEDIUMINT(9) DEFAULT NULL,
					RSL_23 MEDIUMINT(9) DEFAULT NULL,
					RR_31 MEDIUMINT(9) DEFAULT NULL,
					RR_32 MEDIUMINT(9) DEFAULT NULL,
					RR_33 MEDIUMINT(9) DEFAULT NULL,
					RR_34 MEDIUMINT(9) DEFAULT NULL,
					RR_35 MEDIUMINT(9) DEFAULT NULL,
					RR_36 MEDIUMINT(9) DEFAULT NULL,
					FP_RXLEV_BEST_SUM DOUBLE DEFAULT NULL,
					FP_RXQUAL_BEST_SUM DOUBLE DEFAULT NULL,
					FP_RXLEV_BEST_MED_AVG DOUBLE DEFAULT NULL,
					FP_RXQUAL_BEST_MED_AVG DOUBLE DEFAULT NULL,
					FP_RXLEV_ALL_SUM DOUBLE DEFAULT NULL,
					FP_RXQUAL_ALL_SUM DOUBLE DEFAULT NULL,
					FP_RXLEV_ALL_MED_AVG DOUBLE DEFAULT NULL,
					FP_RXQUAL_ALL_MED_AVG DOUBLE DEFAULT NULL,
					MMR_CNT MEDIUMINT(9) DEFAULT NULL,
					BEST_CNT MEDIUMINT(9) DEFAULT NULL,
					BEST_SERVING_CNT MEDIUMINT(9) DEFAULT NULL,
					SERVING_CNT MEDIUMINT(9) DEFAULT NULL,
					RXLEV_GAP_SUM DOUBLE DEFAULT NULL,
					RXLEV_GAP_CNT MEDIUMINT(9) DEFAULT NULL,
					SERVING_RXLEV_BETTER_GAP_SUM DOUBLE DEFAULT NULL,
					SERVING_RXLEV_BETTER_GAP_CNT MEDIUMINT(9) DEFAULT NULL,
					SERVING_RXLEV_WORSE_GAP_SUM DOUBLE DEFAULT NULL,
					SERVING_RXLEV_WORSE_GAP_CNT MEDIUMINT(9) DEFAULT NULL,
					INTERFERED_CNT MEDIUMINT(9) DEFAULT NULL,
					MS_POWER_SUM MEDIUMINT(9) DEFAULT NULL,
					MS_POWER_CNT MEDIUMINT(9) DEFAULT NULL,
					TOTAL_SERVING_CNT MEDIUMINT(9) DEFAULT NULL,
					DURATION BIGINT(20) DEFAULT NULL,
					INTER_CELL_HO_CNT INT(11) DEFAULT NULL,
					INTER_CELL_HO_FAIL_CNT INT(11) DEFAULT NULL,
					INTRA_CELL_HO_CNT INT(11) DEFAULT NULL,
					INTRA_CELL_HO_FAIL_CNT INT(11) DEFAULT NULL,
					SDCCH_ATT MEDIUMINT(9) DEFAULT NULL,
					SDCCH_FAIL MEDIUMINT(9) DEFAULT NULL,
					TCH_ATT MEDIUMINT(9) DEFAULT NULL,
					TCH_FAIL MEDIUMINT(9) DEFAULT NULL,
					RE_ESTAB_ATT MEDIUMINT(9) DEFAULT NULL,
					RE_ESTAB_FAIL MEDIUMINT(9) DEFAULT NULL,
					PRIMARY KEY(DATA_DATE,DATA_HOUR,BSC_ID,CELL_ID)
				) ENGINE=MYISAM DEFAULT CHARSET=latin1 DELAY_KEY_WRITE=1;');	
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	SET @SqlCmd=CONCAT('CREATE TABLE IF NOT EXISTS ',GT_DB,'.`table_tile_pmc_gsm_dy_c` 
				(
					DATA_DATE DATE NOT NULL COMMENT ''KEY'',
					BSC_ID MEDIUMINT(9) NOT NULL COMMENT ''KEY'',
					CELL_ID MEDIUMINT(9) NOT NULL COMMENT ''KEY'',
					CELL_LON DOUBLE DEFAULT NULL COMMENT ''TAG'',
					CELL_LAT DOUBLE DEFAULT NULL COMMENT ''TAG'',
					BANDINDEX VARCHAR(10) DEFAULT NULL COMMENT ''TAG'',
					BCCH_ARFCN MEDIUMINT(9) DEFAULT NULL COMMENT ''TAG'',
					CELL_NAME VARCHAR(50) CHARACTER SET utf8 COLLATE utf8_swedish_ci DEFAULT NULL COMMENT ''TAG'',
					CALL_CNT MEDIUMINT(9) DEFAULT 0,
					RXLEV_FULL_DOWNLINK_CNT MEDIUMINT(9) DEFAULT NULL,
					RXLEV_FULL_DOWNLINK_SUM FLOAT DEFAULT NULL,
					RXQUAL_FULL_DOWNLINK_CNT MEDIUMINT(9) DEFAULT NULL,
					RXQUAL_FULL_DOWNLINK_SUM FLOAT DEFAULT NULL,
					RXLEV_FULL_DOWNLINK_AVG DOUBLE DEFAULT NULL,
					RXQUAL_FULL_DOWNLINK_AVG DOUBLE DEFAULT NULL,
					IMSI_CNT INT(11) DEFAULT NULL,
					CALL_TYPE_10 MEDIUMINT(9) DEFAULT NULL,
					CALL_TYPE_16 MEDIUMINT(9) DEFAULT NULL,
					CALL_TYPE_20 MEDIUMINT(9) DEFAULT NULL,
					CALL_TYPE_99 MEDIUMINT(9) DEFAULT NULL,
					RXLEV_FULL_UPLINK_SUM DOUBLE DEFAULT NULL,
					RXQUAL_FULL_UPLINK_SUM DOUBLE DEFAULT NULL,
					RXLEV_FULL_UPLINK_CNT INT(11) DEFAULT NULL,
					RXQUAL_FULL_UPLINK_CNT INT(11) DEFAULT NULL,
					RXLEV_FULL_UPLINK_MED_AVG FLOAT DEFAULT NULL,
					RXQUAL_FULL_UPLINK_MED_AVG FLOAT DEFAULT NULL,		
					CALL_CNT_END MEDIUMINT(9) DEFAULT 0,
					RXLEV_FULL_DOWNLINK_CNT_END MEDIUMINT(9) DEFAULT NULL,
					RXLEV_FULL_DOWNLINK_SUM_END FLOAT DEFAULT NULL,
					RXQUAL_FULL_DOWNLINK_CNT_END MEDIUMINT(9) DEFAULT NULL,
					RXQUAL_FULL_DOWNLINK_SUM_END FLOAT DEFAULT NULL,
					RXLEV_FULL_UPLINK_SUM_END DOUBLE DEFAULT NULL,
					RXQUAL_FULL_UPLINK_SUM_END DOUBLE DEFAULT NULL,
					RXLEV_FULL_UPLINK_CNT_END INT(11) DEFAULT NULL,
					RXQUAL_FULL_UPLINK_CNT_END INT(11) DEFAULT NULL,
					RXLEV_FULL_UPLINK_MED_AVG_END FLOAT DEFAULT NULL,
					RXQUAL_FULL_UPLINK_MED_AVG_END FLOAT DEFAULT NULL,
					BSSMAP_11 MEDIUMINT(9) DEFAULT NULL,
					BSSMAP_12 MEDIUMINT(9) DEFAULT NULL,
					BSSMAP_13 MEDIUMINT(9) DEFAULT NULL,
					BSSMAP_14 MEDIUMINT(9) DEFAULT NULL,
					BSSMAP_15 MEDIUMINT(9) DEFAULT NULL,
					BSSMAP_16 MEDIUMINT(9) DEFAULT NULL,
					BSSMAP_17 MEDIUMINT(9) DEFAULT NULL,
					BSSMAP_18 MEDIUMINT(9) DEFAULT NULL,
					RSL_21 MEDIUMINT(9) DEFAULT NULL,
					RSL_22 MEDIUMINT(9) DEFAULT NULL,
					RSL_23 MEDIUMINT(9) DEFAULT NULL,
					RR_31 MEDIUMINT(9) DEFAULT NULL,
					RR_32 MEDIUMINT(9) DEFAULT NULL,
					RR_33 MEDIUMINT(9) DEFAULT NULL,
					RR_34 MEDIUMINT(9) DEFAULT NULL,
					RR_35 MEDIUMINT(9) DEFAULT NULL,
					RR_36 MEDIUMINT(9) DEFAULT NULL,
					FP_RXLEV_BEST_SUM DOUBLE DEFAULT NULL,
					FP_RXQUAL_BEST_SUM DOUBLE DEFAULT NULL,
					FP_RXLEV_BEST_MED_AVG DOUBLE DEFAULT NULL,
					FP_RXQUAL_BEST_MED_AVG DOUBLE DEFAULT NULL,
					FP_RXLEV_ALL_SUM DOUBLE DEFAULT NULL,
					FP_RXQUAL_ALL_SUM DOUBLE DEFAULT NULL,
					FP_RXLEV_ALL_MED_AVG DOUBLE DEFAULT NULL,
					FP_RXQUAL_ALL_MED_AVG DOUBLE DEFAULT NULL,
					MMR_CNT MEDIUMINT(9) DEFAULT NULL,
					BEST_CNT MEDIUMINT(9) DEFAULT NULL,
					BEST_SERVING_CNT MEDIUMINT(9) DEFAULT NULL,
					SERVING_CNT MEDIUMINT(9) DEFAULT NULL,
					RXLEV_GAP_SUM DOUBLE DEFAULT NULL,
					RXLEV_GAP_CNT MEDIUMINT(9) DEFAULT NULL,
					SERVING_RXLEV_BETTER_GAP_SUM DOUBLE DEFAULT NULL,
					SERVING_RXLEV_BETTER_GAP_CNT MEDIUMINT(9) DEFAULT NULL,
					SERVING_RXLEV_WORSE_GAP_SUM DOUBLE DEFAULT NULL,
					SERVING_RXLEV_WORSE_GAP_CNT MEDIUMINT(9) DEFAULT NULL,
					INTERFERED_CNT MEDIUMINT(9) DEFAULT NULL,
					MS_POWER_SUM MEDIUMINT(9) DEFAULT NULL,
					MS_POWER_CNT MEDIUMINT(9) DEFAULT NULL,
					TOTAL_SERVING_CNT MEDIUMINT(9) DEFAULT NULL,
					DURATION BIGINT(20) DEFAULT NULL,
					INTER_CELL_HO_CNT INT(11) DEFAULT NULL,
					INTER_CELL_HO_FAIL_CNT INT(11) DEFAULT NULL,
					INTRA_CELL_HO_CNT INT(11) DEFAULT NULL,
					INTRA_CELL_HO_FAIL_CNT INT(11) DEFAULT NULL,
					SDCCH_ATT MEDIUMINT(9) DEFAULT NULL,
					SDCCH_FAIL MEDIUMINT(9) DEFAULT NULL,
					TCH_ATT MEDIUMINT(9) DEFAULT NULL,
					TCH_FAIL MEDIUMINT(9) DEFAULT NULL,
					RE_ESTAB_ATT MEDIUMINT(9) DEFAULT NULL,
					RE_ESTAB_FAIL MEDIUMINT(9) DEFAULT NULL,
					PRIMARY KEY(DATA_DATE,BSC_ID,CELL_ID)
				) ENGINE=MYISAM DEFAULT CHARSET=latin1 DELAY_KEY_WRITE=1;');	
	PREPARE Stmt FROM @SqlCmd;
	EXECUTE Stmt;
	DEALLOCATE PREPARE Stmt; 
	
	CALL gt_gw_main.SP_Create_Merge_Rename_24H(GT_DB,'table_tile_pmc_gsm_c');
END$$
DELIMITER ;
